<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>OpenID Provider Commands 1.0 - draft 02</title>
<meta content="Dick Hardt" name="author">
<meta content="Karl McGuinness" name="author">
<meta content="
       OpenID Connect defines a protocol for an end-user to use an OpenID Provider (OP) to log in to a Relying Party (RP) and assert Claims about the end-user using an ID Token. RPs will often use the identity Claims about the user to implicitly (or explicitly) establish an Account for the user at the RP 
       OpenID Provider Commands complements OpenID Connect by introducing a set of Commands for an OP to directly manage an end-user Account at an RP. These Commands enable an OP to activate, maintain, suspend, reactivate, archive, restore, delete, audit, invalidate an end-user Account, and migrate authentication of an existing account. Command Tokens build on the OpenID Connect ID Token schema and verification, simplifying adoption by RPs. 
    " name="description">
<meta content="xml2rfc 3.30.2" name="generator">
<meta content="security" name="keyword">
<meta content="openid" name="keyword">
<meta content="lifecycle" name="keyword">
<meta name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.30.2
    Python 3.10.18
    ConfigArgParse 1.7.1
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 6.0.2
    platformdirs 4.4.0
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.5
    setuptools 65.5.0
    wcwidth 0.2.14
-->
<link href="openid-provider-commands-1_0.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
@media print {
  svg {
    max-height: 850px;
    max-width: 660px;
  }
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    max-width: 100%;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > blockquote:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left"></td>
<td class="center">openid-provider-commands</td>
<td class="right">September 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Hardt &amp; McGuinness</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">OpenID Connect</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-09-25" class="published">25 September 2025</time>
    </dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Hardt</div>
<div class="org">Hellō</div>
</div>
<div class="author">
      <div class="author-name">K. McGuinness</div>
<div class="org">Independent</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">OpenID Provider Commands 1.0 - draft 02</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">OpenID Connect defines a protocol for an end-user to use an OpenID Provider (OP) to log in to a Relying Party (RP) and assert Claims about the end-user using an ID Token. RPs will often use the identity Claims about the user to implicitly (or explicitly) establish an Account for the user at the RP<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">OpenID Provider Commands complements OpenID Connect by introducing a set of Commands for an OP to directly manage an end-user Account at an RP. These Commands enable an OP to activate, maintain, suspend, reactivate, archive, restore, delete, audit, invalidate an end-user Account, and migrate authentication of an existing account. Command Tokens build on the OpenID Connect ID Token schema and verification, simplifying adoption by RPs.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-requirements-notation-and-c" class="internal xref">Requirements Notation and Conventions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-protocol-overview" class="internal xref">Protocol Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="auto internal xref">1.4</a>.  <a href="#name-command-use-cases" class="internal xref">Command Use Cases</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4.2.1">
                    <p id="section-toc.1-1.1.2.4.2.1.1"><a href="#section-1.4.1" class="auto internal xref">1.4.1</a>.  <a href="#name-personal-applications" class="internal xref">Personal Applications</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4.2.2">
                    <p id="section-toc.1-1.1.2.4.2.2.1"><a href="#section-1.4.2" class="auto internal xref">1.4.2</a>.  <a href="#name-enterprise-application-migr" class="internal xref">Enterprise Application Migration</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4.2.3">
                    <p id="section-toc.1-1.1.2.4.2.3.1"><a href="#section-1.4.3" class="auto internal xref">1.4.3</a>.  <a href="#name-enterprise-application-inte" class="internal xref">Enterprise Application Integration</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4.2.4">
                    <p id="section-toc.1-1.1.2.4.2.4.1"><a href="#section-1.4.4" class="auto internal xref">1.4.4</a>.  <a href="#name-compliance-auditing" class="internal xref">Compliance Auditing</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4.2.5">
                    <p id="section-toc.1-1.1.2.4.2.5.1"><a href="#section-1.4.5" class="auto internal xref">1.4.5</a>.  <a href="#name-security-incident-response" class="internal xref">Security Incident Response</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-claims-and-properties" class="internal xref">Claims and Properties</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-claims-in-command-tokens" class="internal xref">Claims in Command Tokens</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-properties-in-responses" class="internal xref">Properties in Responses</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-command-request" class="internal xref">Command Request</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-command-response" class="internal xref">Command Response</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-invalid-request-error" class="internal xref">Invalid Request Error</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-unrecognized-provider-error" class="internal xref">Unrecognized Provider Error</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-unsupported-command-error" class="internal xref">Unsupported Command Error</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-server-error" class="internal xref">Server Error</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-command-token" class="internal xref">Command Token</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-account-commands" class="internal xref">Account Commands</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-account-lifecycle-states" class="internal xref">Account Lifecycle States</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-success-response" class="internal xref">Success Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-incompatible-state-response" class="internal xref">Incompatible State Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-asynchronous-response" class="internal xref">Asynchronous Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-activate-command" class="internal xref">Activate Command</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a href="#section-6.6" class="auto internal xref">6.6</a>.  <a href="#name-maintain-command" class="internal xref">Maintain Command</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7">
                <p id="section-toc.1-1.6.2.7.1"><a href="#section-6.7" class="auto internal xref">6.7</a>.  <a href="#name-suspend-command" class="internal xref">Suspend Command</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.8">
                <p id="section-toc.1-1.6.2.8.1"><a href="#section-6.8" class="auto internal xref">6.8</a>.  <a href="#name-reactivate-command" class="internal xref">Reactivate Command</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.9">
                <p id="section-toc.1-1.6.2.9.1"><a href="#section-6.9" class="auto internal xref">6.9</a>.  <a href="#name-archive-command" class="internal xref">Archive Command</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.10">
                <p id="section-toc.1-1.6.2.10.1"><a href="#section-6.10" class="auto internal xref">6.10</a>. <a href="#name-restore-command" class="internal xref">Restore Command</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.11">
                <p id="section-toc.1-1.6.2.11.1"><a href="#section-6.11" class="auto internal xref">6.11</a>. <a href="#name-delete-command" class="internal xref">Delete Command</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.12">
                <p id="section-toc.1-1.6.2.12.1"><a href="#section-6.12" class="auto internal xref">6.12</a>. <a href="#name-audit-command" class="internal xref">Audit Command</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.13">
                <p id="section-toc.1-1.6.2.13.1"><a href="#section-6.13" class="auto internal xref">6.13</a>. <a href="#name-invalidate-command" class="internal xref">Invalidate Command</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.14">
                <p id="section-toc.1-1.6.2.14.1"><a href="#section-6.14" class="auto internal xref">6.14</a>. <a href="#name-invalidate-functionality" class="internal xref">Invalidate Functionality</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.15">
                <p id="section-toc.1-1.6.2.15.1"><a href="#section-6.15" class="auto internal xref">6.15</a>. <a href="#name-migrate-command" class="internal xref">Migrate Command</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.15.2.1">
                    <p id="section-toc.1-1.6.2.15.2.1.1"><a href="#section-6.15.1" class="auto internal xref">6.15.1</a>.  <a href="#name-access-denied-error" class="internal xref">Access Denied Error</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.15.2.2">
                    <p id="section-toc.1-1.6.2.15.2.2.1"><a href="#section-6.15.2" class="auto internal xref">6.15.2</a>.  <a href="#name-authentication-not-transfer" class="internal xref">Authentication Not Transferable Error</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-tenant-commands" class="internal xref">Tenant Commands</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-metadata-command" class="internal xref">Metadata Command</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.1">
                    <p id="section-toc.1-1.7.2.1.2.1.1"><a href="#section-7.1.1" class="auto internal xref">7.1.1</a>.  <a href="#name-op-metadata-object" class="internal xref">OP Metadata Object</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-metadata-response" class="internal xref">Metadata Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-metadata-refresh-request" class="internal xref">Metadata Refresh Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-streaming-request" class="internal xref">Streaming Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-streaming-response" class="internal xref">Streaming Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="auto internal xref">7.6</a>.  <a href="#name-audit-tenant-command" class="internal xref">Audit Tenant Command</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="auto internal xref">7.7</a>.  <a href="#name-audit-tenant-response" class="internal xref">Audit Tenant Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.8">
                <p id="section-toc.1-1.7.2.8.1"><a href="#section-7.8" class="auto internal xref">7.8</a>.  <a href="#name-audit-tenant-refresh-reques" class="internal xref">Audit Tenant Refresh Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.9">
                <p id="section-toc.1-1.7.2.9.1"><a href="#section-7.9" class="auto internal xref">7.9</a>.  <a href="#name-suspend-tenant-command" class="internal xref">Suspend Tenant Command</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.10">
                <p id="section-toc.1-1.7.2.10.1"><a href="#section-7.10" class="auto internal xref">7.10</a>. <a href="#name-archive-tenant-command" class="internal xref">Archive Tenant Command</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.11">
                <p id="section-toc.1-1.7.2.11.1"><a href="#section-7.11" class="auto internal xref">7.11</a>. <a href="#name-delete-tenant-command" class="internal xref">Delete Tenant Command</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.12">
                <p id="section-toc.1-1.7.2.12.1"><a href="#section-7.12" class="auto internal xref">7.12</a>. <a href="#name-invalidate-tenant-command" class="internal xref">Invalidate Tenant Command</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-extensibility" class="internal xref">Extensibility</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-defining-new-commands" class="internal xref">Defining New Commands</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-defining-new-tenant-metadat" class="internal xref">Defining New Tenant Metadata</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-defining-new-relying-party-" class="internal xref">Defining New Relying Party Metadata</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-openid-provider-command-sup" class="internal xref">OpenID Provider Command Support</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-implementation-consideratio" class="internal xref">Implementation Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-cross-jwt-confusion" class="internal xref">Cross-JWT Confusion</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-json-web-token-claims" class="internal xref">JSON Web Token Claims</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1.2.1">
                    <p id="section-toc.1-1.13.2.1.2.1.1"><a href="#section-13.1.1" class="auto internal xref">13.1.1</a>.  <a href="#name-registry-contents" class="internal xref">Registry Contents</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-oauth-dynamic-client-regist" class="internal xref">OAuth Dynamic Client Registration Metadata Registration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2.2.1">
                    <p id="section-toc.1-1.13.2.2.2.1.1"><a href="#section-13.2.1" class="auto internal xref">13.2.1</a>.  <a href="#name-registry-contents-2" class="internal xref">Registry Contents</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#section-13.3" class="auto internal xref">13.3</a>.  <a href="#name-media-type-registration" class="internal xref">Media Type Registration</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="auto internal xref">14.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-14.2" class="auto internal xref">14.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-notices" class="internal xref">Notices</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-document-history" class="internal xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">OpenID Connect 1.0 is a widely adopted identity protocol that enables client applications, known as relying parties (RPs), to verify the identity of end-users based on authentication performed by a trusted service, the OpenID Provider (OP). OpenID Connect also provides mechanisms for securely obtaining identity attributes, or Claims, about the end-user, which helps RPs tailor experiences and manage access with confidence.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">OpenID Connect not only allows an end-user to log in and authorize access to resources at an RP but may also be
used to implicitly or explicitly create an Account at the RP. However, Account creation is only the beginning of an Account's lifecycle. Throughout the lifecycle, various actions may be required to ensure data integrity, security, and regulatory compliance.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">For example, many jurisdictions grant end-users the "right to be forgotten", enabling them to request the deletion of their Accounts and associated data. When such requests arise, OPs may need to notify RPs to fully delete the end-user's Account and remove all related data, respecting both regulatory obligations and end-user privacy preferences.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">In scenarios where malicious activity is detected or suspected, OPs play a vital role in protecting end-users. They may need to instruct RPs to revoke authorization or delete Accounts created by malicious actors. This helps contain the impact of unauthorized actions and prevent further misuse of compromised Accounts.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">In enterprise environments, where organizations centrally manage workforce access, OPs need to establish control over existing employee accounts at RPs. First, the OP must establish a bidirectional mapping between its account identifiers and the RP's internal identifiers through account resolution, enabling both parties to refer to the same specific account. Once this identifier resolution is complete, enterprises can migrate authentication responsibility for accounts their employees may have previously created using RP-managed credentials or other authentication methods. With authentication control and identifier mapping established, the OP can then handle essential Account operations across various stages of the lifecycle, including activating, maintaining, suspending, reactivating, archiving, restoring, and deleting Accounts to maintain security and compliance.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">OpenID Provider Commands are a remote procedure call from the OP to the RP that enables OPs to manage the Account lifecycle, building upon the existing OP / RP relationship to cover the full spectrum of Account management requirements.<a href="#section-1-6" class="pilcrow">¶</a></p>
<div id="requirements-notation-and-conventions">
<section id="section-1.1">
        <h3 id="name-requirements-notation-and-c">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-notation-and-c" class="section-name selfRef">Requirements Notation and Conventions</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in {{RFC2119}}.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">The key word "PROHIBITED" is to be interpreted as "MUST NOT".<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">In the .txt version of this specification,
values are quoted to indicate that they are to be taken literally.
When using these values in protocol messages,
the quotes MUST NOT be used as part of the value.
In the HTML version of this specification,
values to be taken literally are indicated by
the use of <em>this fixed-width font</em>.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-1.2">
        <h3 id="name-terminology">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.2-1">This specification defines the following terms:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-2.1">
            <p id="section-1.2-2.1.1"><strong>Account</strong>: The Claims about a user in the RPs identity register.<a href="#section-1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-2.2">
            <p id="section-1.2-2.2.1"><strong>Command</strong>: An instruction from an OP to an RP. It is a synchronous request and response.<a href="#section-1.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-2.3">
            <p id="section-1.2-2.3.1"><strong>Synchronous Command</strong>: A Command where the response from the RP is provided synchronously to the OP with an HTTP 200 Success response.<a href="#section-1.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-2.4">
            <p id="section-1.2-2.4.1"><strong>Asynchronous Command</strong>: A Command where the response from the RP is provided asynchronously to the OP with an initial HTTP 202 Accepted response. The RP sends the final response of an Asynchronous Command to the OP <strong>callback_endpoint</strong>. Command identifiers for Asynchronous Commands end with the string <code>_async</code>.<a href="#section-1.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-2.5">
            <p id="section-1.2-2.5.1"><strong>Command Token</strong>: A JSON Web Token (JWT) signed by the OP that contains Claims about the Command being issued.<a href="#section-1.2-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-2.6">
            <p id="section-1.2-2.6.1"><strong>Command Endpoint</strong>: The URL at the RP where OPs post Command Tokens.<a href="#section-1.2-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-2.7">
            <p id="section-1.2-2.7.1"><strong>Tenant</strong>: A logically isolated entity within an OP that represents a distinct organizational or administrative boundary. An OP may have a single Tenant, or multiple Tenants. The Tenant may contain Accounts managed by individuals, or may contain Accounts managed by an organization.<a href="#section-1.2-2.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="protocol-overview">
<section id="section-1.3">
        <h3 id="name-protocol-overview">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
        </h3>
<p id="section-1.3-1">This specification defines a Command Request containing a Command Token sent from the OP to the RP, and a Command Response returned from the RP to the OP.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-1.3-2">
<pre>+------+  Command request       +------+
|      |---- Command Token ----&gt;|      |
|  OP  |                        |  RP  |
|      |&lt;-----------------------|      |
+------+      Command response  +------+
</pre><a href="#section-1.3-2" class="pilcrow">¶</a>
</div>
<p id="section-1.3-3">The OP may provide a callback endpoint and a callback token for the RP to request a command be sent by the OP such as a metadata or audit_tenant command, or to send the results of an asynchronous command.<a href="#section-1.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-1.3-4">
<pre>+------+             Callback   +------+
|      |&lt;--- Callback Token ----|      |
|  OP  |                        |  RP  |
|      |-----------------------&gt;|      |
+------+  204 or error response +------+
</pre><a href="#section-1.3-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="command-use-cases">
<section id="section-1.4">
        <h3 id="name-command-use-cases">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-command-use-cases" class="section-name selfRef">Command Use Cases</a>
        </h3>
<p id="section-1.4-1">OpenID Provider Commands support several distinct use cases, each with different command sequences and requirements. Understanding these use cases helps implementers determine which commands to support and how to sequence them effectively.<a href="#section-1.4-1" class="pilcrow">¶</a></p>
<div id="personal-applications">
<section id="section-1.4.1">
          <h4 id="name-personal-applications">
<a href="#section-1.4.1" class="section-number selfRef">1.4.1. </a><a href="#name-personal-applications" class="section-name selfRef">Personal Applications</a>
          </h4>
<p id="section-1.4.1-1">Personal applications serve individual users who manage their own accounts. In this scenario, accounts are created and managed by end-users rather than organizations.<a href="#section-1.4.1-1" class="pilcrow">¶</a></p>
<p id="section-1.4.1-2"><strong>Supported Commands</strong>: Metadata, Invalidate, Delete<a href="#section-1.4.1-2" class="pilcrow">¶</a></p>
<p id="section-1.4.1-3"><strong>Typical Command Sequence</strong>:
1. <strong>Metadata Command</strong> - Establish capabilities between OP and RP
2. <strong>Invalidate Command</strong> - Invalidate all sessions and tokens if account compromise is suspected<br>
3. <strong>Delete Command</strong> - Remove account and data upon user request (e.g., "right to be forgotten")<a href="#section-1.4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="enterprise-application-migration">
<section id="section-1.4.2">
          <h4 id="name-enterprise-application-migr">
<a href="#section-1.4.2" class="section-number selfRef">1.4.2. </a><a href="#name-enterprise-application-migr" class="section-name selfRef">Enterprise Application Migration</a>
          </h4>
<p id="section-1.4.2-1">When organizations implement new identity providers or undergo mergers/acquisitions, they need to migrate authentication responsibility for existing accounts. This commonly occurs when individual users initially create accounts with RP-managed credentials, and organizations later need to centralize authentication under their corporate identity provider.<a href="#section-1.4.2-1" class="pilcrow">¶</a></p>
<p id="section-1.4.2-2"><strong>Migration from RP-managed to OP-managed Authentication</strong>:
1. <strong>Metadata Command</strong> - Establish OP capabilities with target RP
2. <strong>Audit Tenant Command</strong> - Identify accounts requiring migration and establish account resolution
3. <strong>Migrate Command</strong> - Assume authentication responsibility for existing RP-managed accounts
4. <strong>Account Lifecycle Commands</strong> - Manage migrated accounts through their lifecycle<a href="#section-1.4.2-2" class="pilcrow">¶</a></p>
<p id="section-1.4.2-3"><strong>Account Resolution in Migration</strong>: Account Resolution is the process by which an OP and RP establish a bidirectional mapping between their respective account identifiers. When an OP receives an <code>aud_sub</code> value from an RP in response to commands such as Audit, the OP learns the RP's internal identifier for that account. This enables the OP to include the <code>aud_sub</code> claim in subsequent Command Tokens, allowing the RP to execute commands using its own identifiers rather than maintaining foreign key relationships based on the OP's <code>iss</code> and <code>sub</code> values. This simplifies RP implementation by eliminating the need to store and manage external identifiers, while still maintaining the ability to correlate accounts across systems.<a href="#section-1.4.2-3" class="pilcrow">¶</a></p>
<p id="section-1.4.2-4"><strong>Authentication Migration Process</strong>: Authentication Migration enables an OP to become the authentication provider for existing accounts through the Migrate Command. This process is essential during organizational migrations, acquisitions, or when implementing centralized identity governance policies. Account Resolution facilitates an OP becoming the authentication provider for an account with the Migrate Command.<a href="#section-1.4.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="enterprise-application-integration">
<section id="section-1.4.3">
          <h4 id="name-enterprise-application-inte">
<a href="#section-1.4.3" class="section-number selfRef">1.4.3. </a><a href="#name-enterprise-application-inte" class="section-name selfRef">Enterprise Application Integration</a>
          </h4>
<p id="section-1.4.3-1">Enterprise applications that are integrated with organizational identity providers need ongoing account management as employees join, change roles, or leave the organization.<a href="#section-1.4.3-1" class="pilcrow">¶</a></p>
<p id="section-1.4.3-2"><strong>Supported Commands</strong>: Metadata, Audit Tenant, Account Lifecycle Commands (Activate, Maintain, Suspend, Reactivate, Archive, Restore, Delete), Invalidate, Migrate<a href="#section-1.4.3-2" class="pilcrow">¶</a></p>
<p id="section-1.4.3-3"><strong>Typical Command Sequence</strong>:
1. <strong>Metadata Command</strong> - Exchange capabilities and establish relationship
2. <strong>Audit Tenant Command</strong> - Discover existing accounts and establish account resolution
3. <strong>Account Lifecycle Commands</strong> - Synchronize account states between OP and RP
4. <strong>Periodic Audit Commands</strong> - Maintain synchronization and correct drift<a href="#section-1.4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="compliance-auditing">
<section id="section-1.4.4">
          <h4 id="name-compliance-auditing">
<a href="#section-1.4.4" class="section-number selfRef">1.4.4. </a><a href="#name-compliance-auditing" class="section-name selfRef">Compliance Auditing</a>
          </h4>
<p id="section-1.4.4-1">Compliance scenarios involve OPs auditing RPs to verify proper account management and regulatory compliance without taking over account management responsibilities.<a href="#section-1.4.4-1" class="pilcrow">¶</a></p>
<p id="section-1.4.4-2"><strong>Audit-Only Sequence</strong>:
1. <strong>Metadata Command</strong> - Establish audit capabilities
2. <strong>Audit Tenant Command</strong> - Review account states and compliance posture
3. <strong>Periodic Audit Commands</strong> - Ongoing compliance monitoring<a href="#section-1.4.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-incident-response">
<section id="section-1.4.5">
          <h4 id="name-security-incident-response">
<a href="#section-1.4.5" class="section-number selfRef">1.4.5. </a><a href="#name-security-incident-response" class="section-name selfRef">Security Incident Response</a>
          </h4>
<p id="section-1.4.5-1">When security incidents occur, OPs may need to rapidly revoke access across multiple RPs to contain potential breaches.<a href="#section-1.4.5-1" class="pilcrow">¶</a></p>
<p id="section-1.4.5-2"><strong>Incident Response</strong>:
1. <strong>Invalidate Command</strong> - Immediately invalidate all sessions and tokens for a compromised account
2. <strong>Suspend/Archive Commands</strong> - Temporarily or permanently disable an affected account<a href="#section-1.4.5-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="claims-and-properties">
<section id="section-2">
      <h2 id="name-claims-and-properties">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-claims-and-properties" class="section-name selfRef">Claims and Properties</a>
      </h2>
<p id="section-2-1">This section defines all claims and properties used in this specification.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="claims-in-command-tokens">
<section id="section-2.1">
        <h3 id="name-claims-in-command-tokens">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-claims-in-command-tokens" class="section-name selfRef">Claims in Command Tokens</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-2.1-1.1">
            <p id="section-2.1-1.1.1"><strong><code>aud_sub</code></strong>: The RP’s internal identifier for the Account (learned via account resolution). Enables the RP to use its native identifier rather than the (<code>iss</code>,<code>sub</code>) pair for lookups.<a href="#section-2.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-1.2">
            <p id="section-2.1-1.2.1"><strong><code>aud</code></strong>: Audience for the token; the RP Command Endpoint URL.<a href="#section-2.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-1.3">
            <p id="section-2.1-1.3.1"><strong><code>authentication_provider</code></strong>: A string indicating which party can authenticate the user. Values include:<a href="#section-2.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-1.3.2.1">
                <p id="section-2.1-1.3.2.1.1"><code>rp</code>: Only the RP authenticates<a href="#section-2.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-1.3.2.2">
                <p id="section-2.1-1.3.2.2.1"><code>op</code>: Only the OP authenticates<a href="#section-2.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-1.3.2.3">
                <p id="section-2.1-1.3.2.3.1"><code>op_migration</code>: Both RP and OP can authenticate (temporary migration state)<a href="#section-2.1-1.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-1.3.2.4">
                <p id="section-2.1-1.3.2.4.1"><code>external</code>: Authentication is by an external provider<a href="#section-2.1-1.3.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-1.3.2.5">
                <p id="section-2.1-1.3.2.5.1"><code>unknown</code>: Authentication provider is unknown or undisclosed<a href="#section-2.1-1.3.2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-2.1-1.4">
            <p id="section-2.1-1.4.1"><strong><code>callback_token</code></strong>: An OP-generated, opaque token used by the RP when sending asynchronous results or requesting a metadata refresh.<a href="#section-2.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-1.5">
            <p id="section-2.1-1.5.1"><strong><code>client_id</code></strong>: The client identifier for the RP.<a href="#section-2.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-1.6">
            <p id="section-2.1-1.6.1"><strong><code>command</code></strong>: The command name for the RP to execute. Standard values are defined in <a href="#account-commands">Account Commands</a> and <a href="#tenant-commands">Tenant Commands</a>. Additional values may be defined via <a href="#defining-new-commands">Extensibility</a>.<a href="#section-2.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-1.7">
            <p id="section-2.1-1.7.1"><strong><code>exp</code></strong>: Expiration time (NumericDate, per RFC 7519).<a href="#section-2.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-1.8">
            <p id="section-2.1-1.8.1"><strong><code>iat</code></strong>: Issued at time (NumericDate, per RFC 7519).<a href="#section-2.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-1.9">
            <p id="section-2.1-1.9.1"><strong><code>iss</code></strong>: Issuer Identifier for the OP (see OpenID Connect Core, Section 2).<a href="#section-2.1-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-1.10">
            <p id="section-2.1-1.10.1"><strong><code>jti</code></strong>: Unique identifier for the token (per OpenID Connect Core Section 9).<a href="#section-2.1-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-1.11">
            <p id="section-2.1-1.11.1"><strong><code>metadata</code></strong>: A JSON object conveying OP-provided metadata to the RP in the Metadata Command. See <a href="#op-metadata-object">OP Metadata Object</a> for the normative schema.<a href="#section-2.1-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-1.12">
            <p id="section-2.1-1.12.1"><strong><code>sub</code></strong>: Subject Identifier for the Account (see OpenID Connect Core, Section 2).<a href="#section-2.1-1.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-1.13">
            <p id="section-2.1-1.13.1"><strong><code>tenant</code></strong>: Identifier of the Tenant within the OP. Values include <code>personal</code>, <code>organization</code>, or an OP-unique stable identifier for multi-tenant OPs. The combination of <code>iss</code> and <code>tenant</code> identifies a Tenant.<a href="#section-2.1-1.13.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="properties-in-responses">
<section id="section-2.2">
        <h3 id="name-properties-in-responses">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-properties-in-responses" class="section-name selfRef">Properties in Responses</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-2.2-1.1">
            <p id="section-2.2-1.1.1"><strong><code>account_state</code></strong>: The Account’s state after processing. Supported states include <code>unknown</code>, <code>active</code>, <code>suspended</code>, and <code>archived</code>.<a href="#section-2.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-1.2">
            <p id="section-2.2-1.2.1"><strong><code>aud_sub_required</code></strong>: Boolean indicating if the RP requires <code>aud_sub</code> in Account Commands.<a href="#section-2.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-1.3">
            <p id="section-2.2-1.3.1"><strong><code>aud_sub</code></strong>: See definition under <a href="#claims-in-command-tokens">Claims in Command Tokens</a>.<a href="#section-2.2-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-1.4">
            <p id="section-2.2-1.4.1"><strong><code>authentication_provider</code></strong>: See definition and allowed values under <a href="#claims-in-command-tokens">Claims in Command Tokens</a>.<a href="#section-2.2-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-1.5">
            <p id="section-2.2-1.5.1"><strong><code>client_id</code></strong>: See definition under <a href="#claims-in-command-tokens">Claims in Command Tokens</a>.<a href="#section-2.2-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-1.6">
            <p id="section-2.2-1.6.1"><strong><code>command_endpoint</code></strong>: The RP’s Command Endpoint URL.<a href="#section-2.2-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-1.7">
            <p id="section-2.2-1.7.1"><strong><code>commands_supported</code></strong>: Array of command names supported by the RP.<a href="#section-2.2-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-1.8">
            <p id="section-2.2-1.8.1"><strong><code>context</code></strong>: A JSON object containing contextual values for the response (e.g., <code>iss</code>, <code>tenant</code>).<a href="#section-2.2-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-1.9">
            <p id="section-2.2-1.9.1"><strong><code>error_description</code></strong>: Human-readable description of the error.<a href="#section-2.2-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-1.10">
            <p id="section-2.2-1.10.1"><strong><code>error</code></strong>: Error code indicating the type of error encountered.<a href="#section-2.2-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-1.11">
            <p id="section-2.2-1.11.1"><strong><code>last_access</code></strong>: NumericDate of last account access (seconds since 1970-01-01T00:00:00Z UTC).<a href="#section-2.2-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-1.12">
            <p id="section-2.2-1.12.1"><strong><code>roles</code></strong>: Array of role objects with:<a href="#section-2.2-1.12.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-1.12.2.1">
                <p id="section-2.2-1.12.2.1.1"><code>id</code>: RP-unique role identifier<a href="#section-2.2-1.12.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2-1.12.2.2">
                <p id="section-2.2-1.12.2.2.1"><code>display</code>: Human-readable role name<a href="#section-2.2-1.12.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2-1.12.2.3">
                <p id="section-2.2-1.12.2.3.1"><code>description</code> (optional): Role description<a href="#section-2.2-1.12.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-2.2-1.13">
            <p id="section-2.2-1.13.1"><strong><code>sub</code></strong>: See definition under <a href="#claims-in-command-tokens">Claims in Command Tokens</a>.<a href="#section-2.2-1.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-1.14">
            <p id="section-2.2-1.14.1"><strong><code>total_accounts</code></strong>: Total number of <code>account-state</code> events sent in a streaming response.<a href="#section-2.2-1.14.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.2-2">For requirement levels for each claim/property in a specific command or response, see the corresponding sections in this specification.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="command-request">
<section id="section-3">
      <h2 id="name-command-request">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-command-request" class="section-name selfRef">Command Request</a>
      </h2>
<p id="section-3-1">The OP uses an HTTP POST to the registered Command Endpoint
to send Account Commands to the RP. The POST body uses the
<code>application/x-www-form-urlencoded</code> encoding
and must include a <code>command_token</code> parameter
containing a Command Token from the OP for the RP.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The POST body MAY contain other values in addition to
<code>command_token</code>.
Values that are not understood by the implementation MUST be ignored.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">The following is a non-normative example of such a Command request
(with most of the Command Token contents omitted for brevity):<a href="#section-3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3-4">
<pre>POST /commands HTTP/1.1
Host: rp.example.net
Content-Type: application/x-www-form-urlencoded

command_token=eyJhbGci ... .eyJpc3Mi ... .T3BlbklE ...
</pre><a href="#section-3-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="command-response">
<section id="section-4">
      <h2 id="name-command-response">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-command-response" class="section-name selfRef">Command Response</a>
      </h2>
<p id="section-4-1">If the Command succeeded, the RP MUST respond with HTTP 200 OK.
However, note that some Web frameworks will substitute an HTTP 204 No Content response
for an HTTP 200 OK when the HTTP body is empty.
Therefore, OPs should be prepared to also process an HTTP 204 No Content response as a successful response.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">The RP's response MUST include the Cache-Control HTTP response header field with a no-store value, keeping the response from being cached to prevent cached responses from interfering with future Command requests. An example of this is:<a href="#section-4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-3">
<pre>Cache-Control: no-store
</pre><a href="#section-4-3" class="pilcrow">¶</a>
</div>
<p id="section-4-4">If there is a response body, it MUST be JSON and use the <code>application/json</code> media type.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">If the request is not valid, the RP MUST return an <code>error</code> parameter, and may include a <code>error_description</code> parameter.
Note that the information conveyed in an error response is intended to help debug deployments;
it is not intended that implementations use different <code>error</code> values
to trigger different runtime behaviors.<a href="#section-4-5" class="pilcrow">¶</a></p>
<div id="invalid-request-error">
<section id="section-4.1">
        <h3 id="name-invalid-request-error">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-invalid-request-error" class="section-name selfRef">Invalid Request Error</a>
        </h3>
<p id="section-4.1-1">If there was a problem with the syntax of the Command request, or the Command Token was invalid, the RP MUST return an HTTP 400 Bad Request and include the <code>error</code> parameter with a value of <code>invalid_request</code>.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="unrecognized-provider-error">
<section id="section-4.2">
        <h3 id="name-unrecognized-provider-error">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-unrecognized-provider-error" class="section-name selfRef">Unrecognized Provider Error</a>
        </h3>
<p id="section-4.2-1">If the RP does not recognize the OP identified by the <code>iss</code> value in the Command token, the RP MUST return an HTTP 401 Unauthorized response and include the <code>error</code> parameter with the value of <code>unrecognized_provider</code>.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="unsupported-command-error">
<section id="section-4.3">
        <h3 id="name-unsupported-command-error">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-unsupported-command-error" class="section-name selfRef">Unsupported Command Error</a>
        </h3>
<p id="section-4.3-1">If the RP does not support the Command requested, the RP MUST return an HTTP 400 Bad Request and include the <code>error</code> parameter with the value of <code>unsupported_command</code>.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">Note that the RP may support Commands for some OPs, and not others, and for some Tenants, and not others.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-error">
<section id="section-4.4">
        <h3 id="name-server-error">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-server-error" class="section-name selfRef">Server Error</a>
        </h3>
<p id="section-4.4-1">If the RP is unable to process a valid request, the RP MUST respond with a 5xx Server Error status code as defined in RFC 9110 section 15.6.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="command-token">
<section id="section-5">
      <h2 id="name-command-token">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-command-token" class="section-name selfRef">Command Token</a>
      </h2>
<p id="section-5-1">OPs issue Commands by sending a JSON Web Token (JWT), the Command Token, to the RP. It is analogous to an OpenID Connect ID Token (see Section 2 of {{OpenID.Core}}) but carries command semantics instead of an authentication assertion.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">All claims that can appear in a Command Token are defined once in the <a href="#claims-and-properties">Claims and Properties</a> section; that section is normative for their definitions. Each command section in this specification normatively states which of those claims are REQUIRED, OPTIONAL, or PROHIBITED for that command. This section therefore only defines the baseline claim groupings used as shorthand elsewhere.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3"><strong>Prohibition of nonce:</strong> A <code>nonce</code> Claim MUST NOT be present in a Command Token to prevent cross-JWT confusion. See <a href="#cross-jwt-confusion">Cross-JWT Confusion</a>.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">Baseline claim sets (only the listed claims may appear unless a command explicitly allows additional ones):<a href="#section-5-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-5.1">
          <p id="section-5-5.1.1">Account Command baseline claims:<a href="#section-5-5.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-5.1.2.1">
              <p id="section-5-5.1.2.1.1">REQUIRED: <code>iss</code>, <code>aud</code> (Command Endpoint), <code>client_id</code>, <code>iat</code>, <code>exp</code>, <code>jti</code>, <code>command</code>, <code>tenant</code>, <code>sub</code><a href="#section-5-5.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5-5.1.2.2">
              <p id="section-5-5.1.2.2.1">OPTIONAL: <code>aud_sub</code><a href="#section-5-5.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5-5.1.2.3">
              <p id="section-5-5.1.2.3.1">OPTIONAL: <code>callback_token</code> — only for commands whose identifier ends with <code>_async</code><a href="#section-5-5.1.2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="section-5-5.2">
          <p id="section-5-5.2.1">Tenant Command baseline claims:<a href="#section-5-5.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-5.2.2.1">
              <p id="section-5-5.2.2.1.1">REQUIRED: <code>iss</code>, <code>aud</code> (Command Endpoint), <code>client_id</code>, <code>iat</code>, <code>exp</code>, <code>jti</code>, <code>command</code>, <code>tenant</code><a href="#section-5-5.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5-5.2.2.2">
              <p id="section-5-5.2.2.2.1">PROHIBITED: <code>sub</code>, <code>aud_sub</code><a href="#section-5-5.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5-5.2.2.3">
              <p id="section-5-5.2.2.3.1">OPTIONAL: <code>callback_token</code> — only where explicitly specified by the command<a href="#section-5-5.2.2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
      </ul>
<p id="section-5-6">Command-specific additions referenced later in this document include (non-exhaustive examples):
- <code>metadata</code> — REQUIRED in the Metadata Command; PROHIBITED otherwise
- <code>authentication_provider</code> — REQUIRED in the Migrate Command; PROHIBITED otherwise<a href="#section-5-6" class="pilcrow">¶</a></p>
<p id="section-5-7">A Command Token MUST be signed. The same signing keys the OP uses for ID Tokens are used, enabling key discovery via the normal OpenID Connect mechanisms.<a href="#section-5-7" class="pilcrow">¶</a></p>
<p id="section-5-8">Command Tokens MUST be explicitly typed by including a <code>typ</code> (type) JWS Header Parameter with the exact value <code>command+jwt</code>. See <a href="#security-considerations">Security Considerations</a> for rationale.<a href="#section-5-8" class="pilcrow">¶</a></p>
<p id="section-5-9">Example JWS header (non-normative):<a href="#section-5-9" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-5-10">
<pre>{
  "alg": "RS256",
  "kid": "2019-07-01-key",
  "typ": "command+jwt"
}
</pre><a href="#section-5-10" class="pilcrow">¶</a>
</div>
<p id="section-5-11">A non-normative example JWT Claims Set for the Command Token for an Activate Command follows:<a href="#section-5-11" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-5-12">
<pre>{
  "iss": "https://op.example.org",
  "aud": "https://rp.example.net/command",
  "client_id": "s6BhdRkqt3",
  "iat": 1734003000,
  "exp": 1734003060,
  "jti": "bWJq",
  "command": "activate",
  "sub": "248289761001",
  "given_name": "Jane",
  "family_name": "Smith",
  "email": "jane.smith@example.org",
  "email_verified": true,
  "groups": [
    "b0f4861d",
    "88799417"
  ]
}
</pre><a href="#section-5-12" class="pilcrow">¶</a>
</div>
<p id="section-5-13">A non-normative example JWT Claims Set for the Command Token for an Invalidate Command follows:<a href="#section-5-13" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-5-14">
<pre>{
  "iss": "https://op.example.org",
  "aud": "https://rp.example.net/command",
  "client_id": "s6BhdRkqt3",
  "iat": 1734004000,
  "exp": 1734004060,
  "jti": "bWJr",
  "command": "invalidate",
  "sub": "248289761001"
}
</pre><a href="#section-5-14" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="account-commands">
<section id="section-6">
      <h2 id="name-account-commands">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-account-commands" class="section-name selfRef">Account Commands</a>
      </h2>
<p id="section-6-1">Account Commands operate on an Account. Support for any Account Command is OPTIONAL. Account Commands are executed on an RP Account identified in a Command Token by the <code>aud_sub</code> claim if provided by the RP during account resolution, or the <code>iss</code> and <code>sub</code> claims. Account Commands include Lifecycle Commands, the Invalidate Command, and the Migrate Command.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">For each Account Command, the Command Token MUST include the Account Command baseline claims defined in <a href="#command-token">Command Token</a>. Each command section below lists only command-specific additions or exceptions. Only the claims listed as REQUIRED or OPTIONAL for a command may be present; all others are PROHIBITED unless otherwise specified.<a href="#section-6-2" class="pilcrow">¶</a></p>
<div id="account-lifecycle-states">
<section id="section-6.1">
        <h3 id="name-account-lifecycle-states">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-account-lifecycle-states" class="section-name selfRef">Account Lifecycle States</a>
        </h3>
<p id="section-6.1-1">Lifecycle Commands are defined for each transition defined in ISO 24760-1 (2019-05 edition), Section 7.2 for Accounts in an RP's identity register as defined in Section 3.4.5.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">Lifecycle Commands transition the Account between the following states:<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-3.1">
            <p id="section-6.1-3.1.1"><strong>unknown</strong><a href="#section-6.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-3.2">
            <p id="section-6.1-3.2.1"><strong>active</strong><a href="#section-6.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-3.3">
            <p id="section-6.1-3.3.1"><strong>suspended</strong><a href="#section-6.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-3.4">
            <p id="section-6.1-3.4.1"><strong>archived</strong><a href="#section-6.1-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.1-4">Following are the potential state transitions:<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<div class="lang-text sourcecode" id="section-6.1-5">
<pre>                      +--------------------------------------- reactivate ---+
                      |  +--- maintain --+                                   |
                      |  |               |                                   |
+---------+           |  |   +--------+  |                    +-----------+  |
|         |           |  +-&gt; |        | -+                    |           | -+
| unknown |           + ---&gt; | active | -------- suspend ---&gt; | suspended | --------+
|         | --- activate --&gt; |        | ----+                 |           | -+      |
+---------+              +-&gt; |        | -+  |                 +-----------+  |      |
  ^  ^  ^                |   +--------+  |  |                                |      |
  |  |  |                |               |  |            +------ archive† ---+      |
  |  |  |                |               |  |            |                          |
  |  |  |                |               |  |            |     +-----------+        |
  |  |  |                |               |  |            +---&gt; |           | ----+  |
  |  |  |                |               |  +--- archive ----&gt; | archived  | -+  |  |
  |  |  |                |               |                     |           |  |  |  |
  |  |  |                |               |                     +-----------+  |  |  |
  |  |  |                |               |                                    |  |  |
  |  |  |                +---------------|----------------------- restore ----+  |  |
  |  |  |                                |                                       |  |
  |  |  +--------------------- delete ---+                                       |  |
  |  +------------------------ delete -------------------------------------------+  |
  +--------------------------- delete ----------------------------------------------+
</pre><a href="#section-6.1-5" class="pilcrow">¶</a>
</div>
<p id="section-6.1-6">†The transition from <strong>suspended</strong> to <strong>archived</strong> is an extension to the ISO standard.<a href="#section-6.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="success-response">
<section id="section-6.2">
        <h3 id="name-success-response">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-success-response" class="section-name selfRef">Success Response</a>
        </h3>
<p id="section-6.2-1">When an RP successfully processes an Account Command, the RP returns an <code>HTTP 200 OK</code> response and a JSON object containing the following properties:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-2.1">
            <p id="section-6.2-2.1.1"><code>sub</code> — REQUIRED — the <code>sub</code> provided in the request<a href="#section-6.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-2.2">
            <p id="section-6.2-2.2.1"><code>account_state</code> — REQUIRED — the state of the Account after processing<a href="#section-6.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-2.3">
            <p id="section-6.2-2.3.1"><code>aud_sub</code> — OPTIONAL — included if the RP has set <code>aud_sub_required</code> in its metadata<a href="#section-6.2-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.2-3">Following is a non-normative response body to a successful Activate Command:<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-6.2-4">
<pre>{
  "account_state": "active",
  "sub": "248289761001"
}
</pre><a href="#section-6.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="incompatible-state-response">
<section id="section-6.3">
        <h3 id="name-incompatible-state-response">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-incompatible-state-response" class="section-name selfRef">Incompatible State Response</a>
        </h3>
<p id="section-6.3-1">If the Account is in an incompatible state in the identity register for the Account Command, the RP returns an HTTP 409 Conflict and a JSON object containing:<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-2.1">
            <p id="section-6.3-2.1.1"><code>account_state</code> — REQUIRED — the current state of the Account in the identity register<a href="#section-6.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.3-2.2">
            <p id="section-6.3-2.2.1"><code>error</code> — REQUIRED — set to the value <code>incompatible_state</code><a href="#section-6.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.3-2.3">
            <p id="section-6.3-2.3.1"><code>sub</code> — REQUIRED — the <code>sub</code> provided in the request<a href="#section-6.3-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.3-3">Following is a non-normative response to an unsuccessful Restore Command where the Account was in the <strong>suspended</strong> state:<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-6.3-4">
<pre>{
  "account_state": "suspended",
  "error": "incompatible_state",
  "sub": "248289761001"
}
</pre><a href="#section-6.3-4" class="pilcrow">¶</a>
</div>
<p id="section-6.3-5">Note that if an Activate Command is sent for an Account that exists, or one of the other Commands are sent for an Account that does not exist,
the Account is incompatible state.<a href="#section-6.3-5" class="pilcrow">¶</a></p>
<p id="section-6.3-6">Following is a non-normative response to an unsuccessful Activate Command for an existing Account in the <strong>active</strong> state:<a href="#section-6.3-6" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-6.3-7">
<pre>{
  "account_state": "active",
  "error": "incompatible_state",
  "sub": "248289761001"
}
</pre><a href="#section-6.3-7" class="pilcrow">¶</a>
</div>
<p id="section-6.3-8">Following is a non-normative response to an unsuccessful Maintain Command for a non-existing Account:<a href="#section-6.3-8" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-6.3-9">
<pre>{
  "account_state": "unknown",
  "error": "incompatible_state",
  "sub": "248289761001"
}
</pre><a href="#section-6.3-9" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="asynchronous-response">
<section id="section-6.4">
        <h3 id="name-asynchronous-response">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-asynchronous-response" class="section-name selfRef">Asynchronous Response</a>
        </h3>
<p id="section-6.4-1">When an RP is provided with a valid Asynchronous Command, and the account is in a compatible state to execute that command, the RP returns an HTTP 202 Accepted response. When the Asynchronous Command has completed processing, and if the OP provided a <code>callback_endpoint</code> in its metadata and a <code>callback_token</code> in the command, the RP MUST do an HTTP POST of the result of processing to the <code>callback_endpoint</code> and include the <code>callback_token</code> as a Bearer token in the HTTP <code>Authorize</code> header.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">The response body MUST include the properties as specified for a Success Response above.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.4-3">
<pre>POST /callback HTTP/1.1
Host: op.example.org
Authorization: Bearer eyjesudyxhjsjshjedshjdsaajhdsa
Content-Type: application/json
Accept: application/json
Cache-Control: no-cache

{
  "account_state": "active",
  "sub": "248289761001"
}
</pre><a href="#section-6.4-3" class="pilcrow">¶</a>
</div>
<p id="section-6.4-4">If the request is invalid or the <code>callback_token</code> is invalid, the OP MUST respond with an error per <a href="#RFC6750">RFC6750</a>.<a href="#section-6.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="activate-command">
<section id="section-6.5">
        <h3 id="name-activate-command">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-activate-command" class="section-name selfRef">Activate Command</a>
        </h3>
<p id="section-6.5-1">Identified by the <code>activate</code> or <code>activate_async</code> value in the <code>command</code> Claim in a Command Token.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">The RP MUST create an Account with the included Claims in the identity register. The Account MUST be in the <strong>unknown</strong> state. The Account is in the <strong>active</strong> state after successful processing.<a href="#section-6.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="maintain-command">
<section id="section-6.6">
        <h3 id="name-maintain-command">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-maintain-command" class="section-name selfRef">Maintain Command</a>
        </h3>
<p id="section-6.6-1">Identified by the <code>maintain</code> or <code>maintain_async</code> value in the <code>command</code> Claim in a Command Token.<a href="#section-6.6-1" class="pilcrow">¶</a></p>
<p id="section-6.6-2">The RP MUST update an existing Account in the identity register with the included Claims. The Account MUST be in the <strong>active</strong> state. The Account remains in the <strong>active</strong> state after successful processing.<a href="#section-6.6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="suspend-command">
<section id="section-6.7">
        <h3 id="name-suspend-command">
<a href="#section-6.7" class="section-number selfRef">6.7. </a><a href="#name-suspend-command" class="section-name selfRef">Suspend Command</a>
        </h3>
<p id="section-6.7-1">Identified by the <code>suspend</code> or <code>suspend_async</code> value in the <code>command</code> Claim in a Command Token.<a href="#section-6.7-1" class="pilcrow">¶</a></p>
<p id="section-6.7-2">The RP MUST perform the <a href="#invalidate-functionality">Invalidate Functionality</a> on the Account and mark the Account as being temporarily unavailable in the identity register. The Account MUST be in the <strong>active</strong> state. The Account is in the <strong>suspended</strong> state after successful processing.<a href="#section-6.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reactivate-command">
<section id="section-6.8">
        <h3 id="name-reactivate-command">
<a href="#section-6.8" class="section-number selfRef">6.8. </a><a href="#name-reactivate-command" class="section-name selfRef">Reactivate Command</a>
        </h3>
<p id="section-6.8-1">Identified by the <code>reactivate</code> or <code>reactivate_async</code> value in the <code>command</code> Claim in a Command Token.<a href="#section-6.8-1" class="pilcrow">¶</a></p>
<p id="section-6.8-2">The RP MUST mark a suspended Account as being active in the identity register. The Account MUST be in the <strong>suspended</strong> state. The Account is in the <strong>active</strong> state after successful processing. The RP SHOULD support the Reactivate Command if it supports the Suspend Command.<a href="#section-6.8-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="archive-command">
<section id="section-6.9">
        <h3 id="name-archive-command">
<a href="#section-6.9" class="section-number selfRef">6.9. </a><a href="#name-archive-command" class="section-name selfRef">Archive Command</a>
        </h3>
<p id="section-6.9-1">Identified by the <code>archive</code> or <code>archive_async</code> value in the <code>command</code> Claim in a Command Token.<a href="#section-6.9-1" class="pilcrow">¶</a></p>
<p id="section-6.9-2">The RP MUST perform the <a href="#invalidate-functionality">Invalidate Functionality</a> on the Account and remove the Account from the identity register. The Account MUST be in either the <strong>active</strong> or <strong>suspended</strong> state. The Account is in the <strong>archived</strong> state after successful processing.<a href="#section-6.9-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="restore-command">
<section id="section-6.10">
        <h3 id="name-restore-command">
<a href="#section-6.10" class="section-number selfRef">6.10. </a><a href="#name-restore-command" class="section-name selfRef">Restore Command</a>
        </h3>
<p id="section-6.10-1">Identified by the <code>restore</code> or <code>restore_async</code> value in the <code>command</code> Claim in a Command Token.<a href="#section-6.10-1" class="pilcrow">¶</a></p>
<p id="section-6.10-2">The RP MUST restore an archived Account to the identity register and mark it as being active. The Account MUST be in the <strong>archived</strong> state. The Account is in the <strong>active</strong> state after successful processing. The RP SHOULD support the Restore Command if it supports the Archive Command.<a href="#section-6.10-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="delete-command">
<section id="section-6.11">
        <h3 id="name-delete-command">
<a href="#section-6.11" class="section-number selfRef">6.11. </a><a href="#name-delete-command" class="section-name selfRef">Delete Command</a>
        </h3>
<p id="section-6.11-1">Identified by the <code>delete</code> or <code>delete_async</code> value in the <code>command</code> Claim in a Command Token.<a href="#section-6.11-1" class="pilcrow">¶</a></p>
<p id="section-6.11-2">The RP MUST perform the <a href="#invalidate-functionality">Invalidate Functionality</a> on the Account, and delete all data associated with an Account. The Account can be in any state except <strong>unknown</strong>. The Account is in the <strong>unknown</strong> state after successful processing.<a href="#section-6.11-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="audit-command">
<section id="section-6.12">
        <h3 id="name-audit-command">
<a href="#section-6.12" class="section-number selfRef">6.12. </a><a href="#name-audit-command" class="section-name selfRef">Audit Command</a>
        </h3>
<p id="section-6.12-1">Identified by the <code>audit</code> or <code>audit_async</code> value in the <code>command</code> Claim of a Command Token.<a href="#section-6.12-1" class="pilcrow">¶</a></p>
<p id="section-6.12-2">The RP MUST include the state of the Account and any Claims for an Account that the RP has retained that were provided by the OP. If the Account is not found, the RP returns <code>unknown</code> state.<a href="#section-6.12-2" class="pilcrow">¶</a></p>
<p id="section-6.12-3">The response MAY also include:
- <code>last_access</code> — OPTIONAL
- <code>authentication_provider</code> — OPTIONAL<a href="#section-6.12-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="invalidate-command">
<section id="section-6.13">
        <h3 id="name-invalidate-command">
<a href="#section-6.13" class="section-number selfRef">6.13. </a><a href="#name-invalidate-command" class="section-name selfRef">Invalidate Command</a>
        </h3>
<p id="section-6.13-1">Identified by the <code>invalidate</code> or <code>invalidate_async</code> value in the <code>command</code> Claim in a Command Token.<a href="#section-6.13-1" class="pilcrow">¶</a></p>
<p id="section-6.13-2">The RP MUST perform the <a href="#invalidate-functionality">Invalidate Functionality</a> on the Account.
The OP MAY send this Command when it suspects a previous OpenID Connect ID Token issued by the OP was granted to a malicious actor, if the user's device was compromised, or any other security related concern about the account.<a href="#section-6.13-2" class="pilcrow">¶</a></p>
<p id="section-6.13-3">The Account MUST be in the <strong>active</strong> state, and remains in the <strong>active</strong> state after executing the Command. If the Account is in any other state, the RP MUST return an <a href="#incompatible-state-response">Incompatible State Response</a>.<a href="#section-6.13-3" class="pilcrow">¶</a></p>
<p id="section-6.13-4">The functionality of the Invalidate Command is also performed by Suspend, Archive, and Delete Commands to ensure an Account in the <strong>suspended</strong>, <strong>archived</strong>, and <strong>unknown</strong> state no longer has access to resources.<a href="#section-6.13-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="invalidate-functionality">
<section id="section-6.14">
        <h3 id="name-invalidate-functionality">
<a href="#section-6.14" class="section-number selfRef">6.14. </a><a href="#name-invalidate-functionality" class="section-name selfRef">Invalidate Functionality</a>
        </h3>
<p id="section-6.14-1">The RP MUST revoke all sessions and tokens including authorization that may have been granted to applications, including <code>offline_access</code>, for Account resources identified by the <code>sub</code>.<a href="#section-6.14-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="migrate-command">
<section id="section-6.15">
        <h3 id="name-migrate-command">
<a href="#section-6.15" class="section-number selfRef">6.15. </a><a href="#name-migrate-command" class="section-name selfRef">Migrate Command</a>
        </h3>
<p id="section-6.15-1">Identified by the <code>migrate</code> or <code>migrate_async</code> value in the <code>command</code> claim in a Command Token.<a href="#section-6.15-1" class="pilcrow">¶</a></p>
<p id="section-6.15-2">The OP sends this Command to request to become the authentication provider for an existing Account. The Command Token MUST include the following additional claim:<a href="#section-6.15-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.15-3.1">
            <p id="section-6.15-3.1.1"><strong>authentication_provider</strong><br>
REQUIRED.<br>
A JSON string indicating the requested authentication provider status. MUST be set to <code>op</code> if the OP wants to become the sole authentication provider for the Account, or <code>op_migration</code> if the OP wants to enable dual authentication where both the OP and existing authentication methods remain valid.<a href="#section-6.15-3.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.15-4">The RP processes the Migrate Command based on the current authentication provider status of the Account and organizational policies:<a href="#section-6.15-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.15-5.1">
            <p id="section-6.15-5.1.1">If <code>authentication_provider</code> is <code>op</code> and the RP allows the migration, the RP updates the Account's authentication provider status to <code>op</code>, disabling other authentication methods.<a href="#section-6.15-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.15-5.2">
            <p id="section-6.15-5.2.1">If <code>authentication_provider</code> is <code>op_migration</code> and the RP supports dual authentication, the RP adds the OP as an additional authentication provider while maintaining existing authentication methods. Dual authentication with <code>op_migration</code> SHOULD be a temporary state used to provide a seamless migration from RP to OP as the authentication provider.<a href="#section-6.15-5.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="access-denied-error">
<section id="section-6.15.1">
          <h4 id="name-access-denied-error">
<a href="#section-6.15.1" class="section-number selfRef">6.15.1. </a><a href="#name-access-denied-error" class="section-name selfRef">Access Denied Error</a>
          </h4>
<p id="section-6.15.1-1">If the RP does not allow the OP to migrate authentication for the Account, the RP MUST return an HTTP 403 Forbidden response and include the <code>error</code> parameter with the value of <code>access_denied</code>.<a href="#section-6.15.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication-not-transferable-error">
<section id="section-6.15.2">
          <h4 id="name-authentication-not-transfer">
<a href="#section-6.15.2" class="section-number selfRef">6.15.2. </a><a href="#name-authentication-not-transfer" class="section-name selfRef">Authentication Not Transferable Error</a>
          </h4>
<p id="section-6.15.2-1">If the Account's current authentication provider does not allow changes in authentication responsibility (e.g., managed by a different OP or external system with non-transferable policies), the RP MUST return an HTTP 409 Conflict response and include the <code>error</code> parameter with the value of <code>authentication_not_transferable</code>.<a href="#section-6.15.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="tenant-commands">
<section id="section-7">
      <h2 id="name-tenant-commands">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-tenant-commands" class="section-name selfRef">Tenant Commands</a>
      </h2>
<p id="section-7-1">Tenant Commands are executed in the context of a Tenant. The RP MUST support the Metadata Command. Support for other Tenant Commands is optional. Command Tokens for Tenant Commands MUST contain the <code>tenant</code> claim, and are PROHIBITED from containing the <code>sub</code> claim. See <a href="#claims-and-properties">Claims and Properties</a> for definitions.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">Note that no Asynchronous Commands are defined to execute in the context of a Tenant.<a href="#section-7-2" class="pilcrow">¶</a></p>
<div id="metadata-command">
<section id="section-7.1">
        <h3 id="name-metadata-command">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-metadata-command" class="section-name selfRef">Metadata Command</a>
        </h3>
<p id="section-7.1-1">Identified by the <code>metadata</code> value in the <code>command</code> claim in a Command Token.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">Additional Command Token claims:
- <code>metadata</code> — REQUIRED — OP-provided metadata object
- <code>callback_token</code> — OPTIONAL<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">The OP sends this Command to exchange metadata with the RP. The OP sends its metadata in the Command Request, and the RP sends its metadata in the Command Response. A Metadata Command replaces any previous metadata provided by the OP to the RP in the Command Request, and any metadata provided by the RP to the OP in the Command Response.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<div id="op-metadata-object">
<section id="section-7.1.1">
          <h4 id="name-op-metadata-object">
<a href="#section-7.1.1" class="section-number selfRef">7.1.1. </a><a href="#name-op-metadata-object" class="section-name selfRef">OP Metadata Object</a>
          </h4>
<p id="section-7.1.1-1">The <code>metadata</code> claim in the Metadata Command contains a JSON object with the following fields:<a href="#section-7.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1.1-2.1">
              <p id="section-7.1.1-2.1.1"><code>callback_endpoint</code> — OPTIONAL — HTTPS URL for the OP callback endpoint that RPs can use to request a new command (for example, metadata or audit_tenant) or to deliver async results.<a href="#section-7.1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.1.1-2.2">
              <p id="section-7.1.1-2.2.1"><code>domains</code> — OPTIONAL — Array of strings. Email or DNS domains associated with the Tenant (for discovery, correlation, or scoping at the RP).<a href="#section-7.1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.1.1-2.3">
              <p id="section-7.1.1-2.3.1"><code>claims_supported</code> — OPTIONAL — Array of strings. Claim names the OP may include in Account Commands or expect back in responses.<a href="#section-7.1.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.1.1-2.4">
              <p id="section-7.1.1-2.4.1"><code>groups</code> — OPTIONAL — Array of group objects. Each object has:<a href="#section-7.1.1-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1.1-2.4.2.1">
                  <p id="section-7.1.1-2.4.2.1.1"><code>id</code> — REQUIRED — OP-unique group identifier<a href="#section-7.1.1-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-7.1.1-2.4.2.2">
                  <p id="section-7.1.1-2.4.2.2.1"><code>display</code> — REQUIRED — Human-readable group name<a href="#section-7.1.1-2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-7.1.1-2.4.2.3">
                  <p id="section-7.1.1-2.4.2.3.1"><code>description</code> — OPTIONAL — Group description<a href="#section-7.1.1-2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-7.1.1-3">Additional fields MAY be included, including those defined in OAuth 2.0 Authorization Server Metadata <a href="#RFC8414">RFC8414</a>. Unknown fields MUST be ignored by recipients.<a href="#section-7.1.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1.1-4">Following is a non-normative example of a Claim set in a Command Token for the Metadata Command:<a href="#section-7.1.1-4" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-7.1.1-5">
<pre>{
  "iss": "https://op.example.org",
  "aud": "https://rp.example.net/command",
  "client_id": "s6BhdRkqt3",
  "iat": 1734006000,
  "exp": 1734006060,
  "jti": "bWJt",
  "command": "metadata",
  "tenant": "ff6e7c96",
  "callback_token": "eyhwixm236djs9shne9sjdnjs9dhbsk",
  "metadata": {
    "callback_endpoint": "https://op.example.org/callback",
    "groups": [
      {
        "id": "b0f4861d",
        "display": "Administrators",
        "description": "Application administrators"
      },
      {
        "id": "88799417",
        "display": "Finance",
        "description": "Everyone in corporate finance"
      }
    ],
    "domains": ["example.com"],
    "claims_supported": [
      "sub",
      "email",
      "email_verified",
      "name",
      "given_name",
      "family_name",
      "groups"
    ]
  }
}
</pre><a href="#section-7.1.1-5" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="metadata-response">
<section id="section-7.2">
        <h3 id="name-metadata-response">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-metadata-response" class="section-name selfRef">Metadata Response</a>
        </h3>
<p id="section-7.2-1">If the Command Token is valid, the RP responds with an <code>application/json</code> media type that MUST include:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-2.1">
            <p id="section-7.2-2.1.1"><code>context</code> (REQUIRED): A JSON object containing <code>iss</code> and <code>tenant</code> values from the Command Token.<a href="#section-7.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-2.2">
            <p id="section-7.2-2.2.1"><code>commands_supported</code> (REQUIRED): A JSON array of Commands the RP supports. The <code>metadata</code> value MUST be included.<a href="#section-7.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-2.3">
            <p id="section-7.2-2.3.1"><code>command_endpoint</code> (REQUIRED): The RP's Command Endpoint. This is the URL the Command Token was sent to.<a href="#section-7.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-2.4">
            <p id="section-7.2-2.4.1"><code>client_id</code> (REQUIRED): The <code>client_id</code> for the RP.<a href="#section-7.2-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.2-3">The response MAY also include:
- <code>aud_sub_required</code> (OPTIONAL): Indicates the RP requires its <code>aud_sub</code> value be provided in account commands.
- <code>roles</code> (OPTIONAL): A JSON array of objects describing roles supported by the RP.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<p id="section-7.2-4">The response MAY also include any OAuth Dynamic Client Registration Metadata <em>TBD <a href="https://www.iana.org/assignments/oauth-parameters/oauth-parameters.xhtml#client-metadata">IANA reference</a></em><a href="#section-7.2-4" class="pilcrow">¶</a></p>
<p id="section-7.2-5">The RP MAY provide a different response for different <code>iss</code> or <code>tenant</code> values.<a href="#section-7.2-5" class="pilcrow">¶</a></p>
<p id="section-7.2-6">Following is a non-normative example of Command Response for a Metadata Command:<a href="#section-7.2-6" class="pilcrow">¶</a></p>
<blockquote id="section-7.2-7">
          <p id="section-7.2-7.1">NOTE: we want to include the <code>iss</code> and <code>tenant</code> from the Metadata Command in the Command Response so the OP knows the response from the RP
is really for the correct <code>iss</code> and <code>tenant</code>. We don't want the OP <code>iss</code> at the top level as that would
cause confusion if the Command Response is signed in the future since the <code>iss</code> then would be the RP<a href="#section-7.2-7.1" class="pilcrow">¶</a></p>
</blockquote>
<div class="lang-json sourcecode" id="section-7.2-8">
<pre>{
  "context": {
    "iss": "https://op.example.org",
    "tenant":"73849284748493"
  },
  "command_endpoint": "https://rp.example.net/command",
  "commands_supported":[
    "audit_tenant",
    "unauthorize",
    "suspend",
    "reactivate",
    "delete",
    "audit"
  ],
  "claims_supported": [
    "sub",
    "email",
    "email_verified",
    "name",
    "roles"
  ],
  "roles": [
          {
        "id": "00001",
        "display": "Admins",
        "description": "All administrative"
      },
      {
        "id": "00002",
        "display": "Editors",
        "description": "Create, read, update, delete posts"
      },
      {
        "id": "00003",
        "display": "Reader",
        "description": "Read posts"
      }
  ],
  "client_id": "s6BhdRkqt3",
  "client_name": "Example RP",
  "logo_uri": "https://rp.example.net/logo.png",
  "policy_uri": "https://rp.example.net/privacy-policy.html",
  "tos_uri": "https://rp.example.net/terms-of-service.html",
  "jwks_uri": "https://rp.example.net/jwks",
  "initiate_login_uri": "https://rp.example.net/initiate-login",
  "redirect_uris": [
    "https://rp.example.net/response"
  ]
}
</pre><a href="#section-7.2-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="metadata-refresh-request">
<section id="section-7.3">
        <h3 id="name-metadata-refresh-request">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-metadata-refresh-request" class="section-name selfRef">Metadata Refresh Request</a>
        </h3>
<p id="section-7.3-1">If the OP provided a <code>callback_endpoint</code> and <code>callback_token</code> in its last <code>metadata</code> Command, the RP may request the the OP to perform a new <code>metadata</code> command. One motivation for the RP to make this request is if it's metadata has changed.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">The RP does an HTTP POST to the <strong>callback_endpoint</strong> passing the <code>callback_token</code> as a bearer token in the HTTP <code>Authorize</code> header with a <code>content-type</code> of <code>application/json</code> and a JSON string with <code>command_requested</code> set to <code>metadata</code>.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">Following is a non-normative example:<a href="#section-7.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3-4">
<pre>POST /callback HTTP/1.1
Host: op.example.org
Authorization: Bearer eyhwixm236djs9shne9sjdnjs9dhbsk
Content-Type: application/json
Accept: application/json
Cache-Control: no-cache

{
  "command_requested": "metadata"
}
</pre><a href="#section-7.3-4" class="pilcrow">¶</a>
</div>
<p id="section-7.3-5">If the <code>callback_token</code> is valid, the OP MUST respond with an HTTP 204 No Content response.<a href="#section-7.3-5" class="pilcrow">¶</a></p>
<p id="section-7.3-6">If the <code>callback_token</code> is not valid, or the content of the request body is not valid, the OP MUST respond with an error per <a href="#RFC6750">RFC6750</a>.<a href="#section-7.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="streaming-request">
<section id="section-7.4">
        <h3 id="name-streaming-request">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-streaming-request" class="section-name selfRef">Streaming Request</a>
        </h3>
<p id="section-7.4-1">All Tenant Commands besides the Metadata Command use <a href="https://html.spec.whatwg.org/multipage/server-sent-events.html#server-sent-events">Server-Sent Events</a> (SSE) for the RP to transfer the Command Response. When performing a Streaming Request, the OP MUST include the following HTTP headers when sending the Command Request:<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4-2.1">
            <p id="section-7.4-2.1.1"><code>Accept</code> with the value of <code>text/event-stream</code> to indicate support for Server-Sent Events.<a href="#section-7.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-2.2">
            <p id="section-7.4-2.2.1"><code>Cache-Control</code> with the value of <code>no-cache</code> to signal to intermediaries to not cache the response.<a href="#section-7.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-2.3">
            <p id="section-7.4-2.3.1"><code>Connection</code> with the value of <code>keep-alive</code> to keep the connection open.<a href="#section-7.4-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.4-3">It is RECOMMENDED the OP accept compression of the response by sending the <code>Accept-Encoding</code> HTTP header with the value of <code>gzip</code>, or <code>gzip, br</code>.<a href="#section-7.4-3" class="pilcrow">¶</a></p>
<p id="section-7.4-4">The following is a non-normative example of a Streaming Request:
(with most of the Command Token contents omitted for brevity):<a href="#section-7.4-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.4-5">
<pre>POST /commands HTTP/1.1
Host: rp.example.net
Content-Type: application/x-www-form-urlencoded
Accept: text/event-stream
Cache-Control: no-cache
Connection: keep-alive
Accept-Encoding: gzip, br

command_token=eyJhbGci ... .eyJpc3Mi ... .T3BlbklE ...
</pre><a href="#section-7.4-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="streaming-response">
<section id="section-7.5">
        <h3 id="name-streaming-response">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-streaming-response" class="section-name selfRef">Streaming Response</a>
        </h3>
<p id="section-7.5-1">The RP sends a Streaming Response to a Streaming Request. In a Streaming Response, the RP uses SSE to stream the Command Response as a sequence of events. If the RP receives a valid Command, it MUST sent the <code>HTTP 200 OK</code> response, followed by the following headers:<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.5-2.1">
            <p id="section-7.5-2.1.1"><code>Content-Type</code> with the <code>text/event-stream</code> value<a href="#section-7.5-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.5-2.2">
            <p id="section-7.5-2.2.1"><code>Cache-Control</code> with the <code>no-cache</code> value<a href="#section-7.5-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.5-2.3">
            <p id="section-7.5-2.3.1"><code>Connection</code> with the <code>keep-alive</code> value<a href="#section-7.5-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.5-3">If the OP sent a <code>Content-Encoding</code> header in the request with a compression the RP understands, the RP MAY include a <code>Content-Encoding</code> header with one of the OP provided values.<a href="#section-7.5-3" class="pilcrow">¶</a></p>
<p id="section-7.5-4">Per SSE, the body of the response is a series of events. In addition to the required field name <code>data</code>, each event MUST include the <code>id</code> field with a unique value for each event, and the <code>event</code> field with a value of either <code>account-state</code>, <code>command-complete</code>, or <code>error</code>. The RP sends an <code>account-state</code> event for each Account at the RP for the <code>iss</code>, and <code>org</code> if sent, in the Audit Tenant Command. When all <code>account-state</code> events have been sent, the RP sends a <code>command-complete</code> event. If an unrecoverable error occurs during processing, the RP SHOULD send an <code>error</code> event where the <code>data</code> field is JSON with the JSON string property <code>error_description</code> set to a value determined by the RP.<a href="#section-7.5-4" class="pilcrow">¶</a></p>
<p id="section-7.5-5">The <code>data</code> parameter of the <code>account-state</code> event MUST contain: <code>sub</code>, <code>account_state</code>.<a href="#section-7.5-5" class="pilcrow">¶</a></p>
<p id="section-7.5-6">The <code>data</code> parameter MAY include other Claims as defined by the Tenant Command.<a href="#section-7.5-6" class="pilcrow">¶</a></p>
<p id="section-7.5-7">The <code>data</code> parameter of the <code>command-complete</code> event MUST include <code>total_accounts</code> with the total number of <code>account-state</code> events the RP has sent.<a href="#section-7.5-7" class="pilcrow">¶</a></p>
<p id="section-7.5-8">If there are no Accounts for the Tenant at the RP, the RP responds with only the <code>command-complete</code> event with <code>total-accounts</code> having a value of <code>0</code>.<a href="#section-7.5-8" class="pilcrow">¶</a></p>
<p id="section-7.5-9">The following is a non-normative example of a Streaming Response for an Audit Tenant Command:<a href="#section-7.5-9" class="pilcrow">¶</a></p>
<div class="lang-bash sourcecode" id="section-7.5-10">
<pre>  HTTP/1.1 200 OK
  Content-Type: text/event-stream
  Cache-Control: no-cache
  Connection: keep-alive
  Content-Encoding: gzip

  id: 1
  event: account-state
  data: {
    "sub": "248289761001",
    "email": "janes.smith@example.com",
    "given_name": "Jane",
    "family_name": "Smith",
    "groups": [
      "b0f4861d-f3d6-4f76-be2f-e467daddc6f6",
      "88799417-c72f-48fc-9e63-f012d8822ad1"
    ],
    "account_state": "active",
    "last_access": 1746792000,
  }

  id: 2
  event: account-state
  data: {
    "sub": "98765412345",
    "email": "john.doe@example.com",
    "given_name": "John",
    "family_name": "Doe",
    "groups": [
      "88799417-c72f-48fc-9e63-f012d8822ad1"
    ],
    "account_state": "suspended"
  }

  id: 3
  event: command-complete
  data: {
    "total_accounts": 2
  }
</pre><a href="#section-7.5-10" class="pilcrow">¶</a>
</div>
<p id="section-7.5-11">If the connection is lost during a Streaming Response, The OP SHOULD generate a new Command Token and send a Streaming Request including the HTTP header <code>Last-Event-Id</code> with the last event <code>id</code> property received per SSE.<a href="#section-7.5-11" class="pilcrow">¶</a></p>
<p id="section-7.5-12">Following is a non-normative example of a Streaming Request sent after a connection was lost:<a href="#section-7.5-12" class="pilcrow">¶</a></p>
<div class="lang-bash sourcecode" id="section-7.5-13">
<pre>POST /commands HTTP/1.1
Host: rp.example.net
Content-Type: application/x-www-form-urlencoded
Accept: text/event-stream
Cache-Control: no-cache
Connection: keep-alive
Accept-Encoding: gzip, br
Last-Event-Id: 3

command_token=eyJhbGci ... .eyJpc3Mi ... .T3BlbklE ...
</pre><a href="#section-7.5-13" class="pilcrow">¶</a>
</div>
<p id="section-7.5-14">If the RP is unable to resume a Streaming Response when provided a <code>Last-Event-Id</code> HTTP header, it MUST respond with an HTTP 404 Not Found and include the <code>error</code> parameter of <code>last-event-id-unavailable</code>.<a href="#section-7.5-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="audit-tenant-command">
<section id="section-7.6">
        <h3 id="name-audit-tenant-command">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-audit-tenant-command" class="section-name selfRef">Audit Tenant Command</a>
        </h3>
<p id="section-7.6-1">Sent in a Streaming Request and identified by the <code>audit_tenant</code> value in the <code>command</code> Claim in a Command Token.<a href="#section-7.6-1" class="pilcrow">¶</a></p>
<p id="section-7.6-2">The OP sends the Audit Tenant Command to learn the state of Accounts for a Tenant at an RP.
Additional Command Token claims:
- <code>callback_token</code> — OPTIONAL<a href="#section-7.6-2" class="pilcrow">¶</a></p>
<p id="section-7.6-3">The following is a non-normative example of the Claims Set in the Command Token of an Audit Tenant Command:<a href="#section-7.6-3" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-7.6-4">
<pre>{
  "iss": "https://op.example.org",
  "aud": "https://rp.example.net/command",
  "client_id": "s6BhdRkqt3",
  "iat": 1734003000,
  "exp": 1734003060,
  "jti": "bWJz",
  "command": "audit_tenant",
  "callback_token": "eyhwixm236djs9shne9sjdnjs9dhbsk"
}
</pre><a href="#section-7.6-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="audit-tenant-response">
<section id="section-7.7">
        <h3 id="name-audit-tenant-response">
<a href="#section-7.7" class="section-number selfRef">7.7. </a><a href="#name-audit-tenant-response" class="section-name selfRef">Audit Tenant Response</a>
        </h3>
<p id="section-7.7-1">The RP sends a Streaming Response if it received a valid Audit Tenant Command.<a href="#section-7.7-1" class="pilcrow">¶</a></p>
<p id="section-7.7-2">The RP MUST include any Claims for an Account that the RP has retained that were provided by the OP in the event <code>data</code> parameter JSON string. If the Claim values have been modified at the RP, the modified values should be returned.<a href="#section-7.7-2" class="pilcrow">¶</a></p>
<p id="section-7.7-3">The RP MAY include a <code>last_access</code> claim, a NumericDate, representing the number of seconds from 1970-01-01T00:00:00Z UTC. The value MUST be an integer and is equivalent to the iat and exp claims as defined in <a href="#RFC7519">RFC7519</a>.<a href="#section-7.7-3" class="pilcrow">¶</a></p>
<p id="section-7.7-4">Streaming Response Events:
- <code>account-state</code> events MUST include: <code>sub</code> (REQUIRED), <code>account_state</code> (REQUIRED)
- <code>account-state</code> events MAY include: <code>last_access</code>, <code>authentication_provider</code>, other retained Claims
- A final <code>command-complete</code> event MUST include: <code>total_accounts</code> (REQUIRED)<a href="#section-7.7-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="audit-tenant-refresh-request">
<section id="section-7.8">
        <h3 id="name-audit-tenant-refresh-reques">
<a href="#section-7.8" class="section-number selfRef">7.8. </a><a href="#name-audit-tenant-refresh-reques" class="section-name selfRef">Audit Tenant Refresh Request</a>
        </h3>
<p id="section-7.8-1">If the OP provided a <code>callback_endpoint</code> and a <code>callback_token</code> in its last <code>audit_tenant</code> Command, the RP may request the the OP to perform a new <code>audit_tenant</code> command. One motivation for the RP to make this request is there have been changes to accounts.<a href="#section-7.8-1" class="pilcrow">¶</a></p>
<p id="section-7.8-2">The RP does an HTTP POST to the <strong>callback_endpoint</strong> passing the <code>callback_token</code> as a bearer token in the HTTP <code>Authorize</code> header with a <code>content-type</code> of <code>application/json</code> and a JSON string with <code>command_requested</code> set to <code>audit_tenant</code>.<a href="#section-7.8-2" class="pilcrow">¶</a></p>
<p id="section-7.8-3">Following is a non-normative example:<a href="#section-7.8-3" class="pilcrow">¶</a></p>
<div class="lang-bash sourcecode" id="section-7.8-4">
<pre>POST /callback HTTP/1.1
Host: op.example.org
Authorization: Bearer eyhwixm236djs9shne9sjdnjs9dhbsk
Content-Type: application/json
Accept: application/json
Cache-Control: no-cache

{
  "command_requested": "audit_tenant"
}
</pre><a href="#section-7.8-4" class="pilcrow">¶</a>
</div>
<p id="section-7.8-5">If the <code>callback_token</code> is valid, the OP MUST respond with an HTTP 204 No Content response.<a href="#section-7.8-5" class="pilcrow">¶</a></p>
<p id="section-7.8-6">If the <code>callback_token</code> is not valid, or the content of the request body is not valid, the OP MUST respond with an error per <a href="#RFC6750">RFC6750</a>.<a href="#section-7.8-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="suspend-tenant-command">
<section id="section-7.9">
        <h3 id="name-suspend-tenant-command">
<a href="#section-7.9" class="section-number selfRef">7.9. </a><a href="#name-suspend-tenant-command" class="section-name selfRef">Suspend Tenant Command</a>
        </h3>
<p id="section-7.9-1">Sent in a Streaming Request and identified by the <code>suspend_tenant</code> value in the <code>command</code> Claim in a Command Token.
Upon receiving this Command, the RP MUST suspend all Accounts in the active state for the Tenant identified by the <code>tenant</code> Claim in the Command Token.<a href="#section-7.9-1" class="pilcrow">¶</a></p>
<p id="section-7.9-2">The RP sends a Streaming Response if it received a valid Suspend Tenant Command.<a href="#section-7.9-2" class="pilcrow">¶</a></p>
<p id="section-7.9-3">Streaming Response Events:
- <code>account-state</code> events MUST include: <code>sub</code> (REQUIRED), <code>account_state</code> (value <code>suspended</code>)
- A final <code>command-complete</code> event MUST include: <code>total_accounts</code> (REQUIRED)<a href="#section-7.9-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="archive-tenant-command">
<section id="section-7.10">
        <h3 id="name-archive-tenant-command">
<a href="#section-7.10" class="section-number selfRef">7.10. </a><a href="#name-archive-tenant-command" class="section-name selfRef">Archive Tenant Command</a>
        </h3>
<p id="section-7.10-1">Sent in a Streaming Request and identified by the <code>archive_tenant</code> value in the <code>command</code> Claim in a Command Token.
Upon receiving this Command, the RP MUST suspend all Accounts in the active and suspended state for the Tenant identified by the <code>tenant</code> Claim in the Command Token.<a href="#section-7.10-1" class="pilcrow">¶</a></p>
<p id="section-7.10-2">The RP sends a Streaming Response if it received a valid Archive Tenant Command.<a href="#section-7.10-2" class="pilcrow">¶</a></p>
<p id="section-7.10-3">Streaming Response Events:
- <code>account-state</code> events MUST include: <code>sub</code> (REQUIRED), <code>account_state</code> (value <code>archived</code>)
- A final <code>command-complete</code> event MUST include: <code>total_accounts</code> (REQUIRED)<a href="#section-7.10-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="delete-tenant-command">
<section id="section-7.11">
        <h3 id="name-delete-tenant-command">
<a href="#section-7.11" class="section-number selfRef">7.11. </a><a href="#name-delete-tenant-command" class="section-name selfRef">Delete Tenant Command</a>
        </h3>
<p id="section-7.11-1">Sent in a Streaming Request and identified by the <code>delete_tenant</code> value in the <code>command</code> Claim in a Command Token.
Upon receiving this Command, the RP MUST delete all Accounts for the Tenant identified by the <code>tenant</code> Claim in the Command Token.<a href="#section-7.11-1" class="pilcrow">¶</a></p>
<p id="section-7.11-2">The RP sends a Streaming Response if it received a valid Delete Tenant Command. If the Delete Tenant Command was successful, the RP will send only a <code>command-complete</code> event with a <code>data</code> parameter containing the JSON string <code>{"total_accounts":0}</code>.<a href="#section-7.11-2" class="pilcrow">¶</a></p>
<p id="section-7.11-3">Streaming Response Events:
- A final <code>command-complete</code> event MUST include: <code>total_accounts</code> (REQUIRED). No <code>account-state</code> events are sent upon successful deletion of all Accounts.<a href="#section-7.11-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="invalidate-tenant-command">
<section id="section-7.12">
        <h3 id="name-invalidate-tenant-command">
<a href="#section-7.12" class="section-number selfRef">7.12. </a><a href="#name-invalidate-tenant-command" class="section-name selfRef">Invalidate Tenant Command</a>
        </h3>
<p id="section-7.12-1">Sent in a Streaming Request and identified by the <code>invalidate_tenant</code> value in the <code>command</code> Claim in a Command Token.
Upon receiving this Command, the RP MUST perform the <a href="#invalidate-functionality">Invalidate Functionality</a> on all Accounts in the <strong>active</strong> state for the Tenant identified by the <code>tenant</code> Claim in the Command Token.<a href="#section-7.12-1" class="pilcrow">¶</a></p>
<p id="section-7.12-2">The RP sends a Streaming Response if it received a valid Invalidate Tenant Command.<a href="#section-7.12-2" class="pilcrow">¶</a></p>
<p id="section-7.12-3">Streaming Response Events:
- <code>account-state</code> events MUST include: <code>sub</code> (REQUIRED), <code>account_state</code> (value <code>active</code>)
- A final <code>command-complete</code> event MUST include: <code>total_accounts</code> (REQUIRED)<a href="#section-7.12-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="extensibility">
<section id="section-8">
      <h2 id="name-extensibility">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-extensibility" class="section-name selfRef">Extensibility</a>
      </h2>
<div id="defining-new-commands">
<section id="section-8.1">
        <h3 id="name-defining-new-commands">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-defining-new-commands" class="section-name selfRef">Defining New Commands</a>
        </h3>
<p id="section-8.1-1">New Commands can be defined in one of two ways: registered in the OpenID Provider Commands
registry, or by using a unique absolute URI as its name.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">Types utilizing a URI name SHOULD be limited to vendor-specific
implementations that are not commonly applicable, and are specific to
the implementation details of the resource server where they are
used.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="defining-new-tenant-metadata">
<section id="section-8.2">
        <h3 id="name-defining-new-tenant-metadat">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-defining-new-tenant-metadat" class="section-name selfRef">Defining New Tenant Metadata</a>
        </h3>
<p id="section-8.2-1"><em>To be completed.</em><a href="#section-8.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="defining-new-relying-party-metadata">
<section id="section-8.3">
        <h3 id="name-defining-new-relying-party-">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-defining-new-relying-party-" class="section-name selfRef">Defining New Relying Party Metadata</a>
        </h3>
<p id="section-8.3-1"><em>To be completed.</em><a href="#section-8.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="openid-provider-command-support">
<section id="section-9">
      <h2 id="name-openid-provider-command-sup">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-openid-provider-command-sup" class="section-name selfRef">OpenID Provider Command Support</a>
      </h2>
<p id="section-9-1">Relying Parties supporting OpenID Provider Commands register a Command Endpoint with the OP as part of their client registration.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">The Command Endpoint MUST be an absolute URI as defined by
Section 4.3 of {{RFC3986}}.
The Command Endpoint MAY include an
<code>application/x-www-form-urlencoded</code> formatted
query component, per Section 3.4 of {{RFC3986}}.
The Command Endpoint MUST NOT include a fragment component.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">If the RP supports
<a href="#OpenID.Registration">OpenID Connect Dynamic Client Registration 1.0</a>,
it uses this metadata value to register the OpenID Provider Command Endpoint:<a href="#section-9-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-4.1">
          <p id="section-9-4.1.1"><strong>command_endpoint</strong><br>
OPTIONAL.<br>
RP URL that will receive OpenID Provider Commands from the OP.
This URL MUST use the <code>https</code> scheme
and MAY contain path, and query parameter components.<a href="#section-9-4.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="implementation-considerations">
<section id="section-10">
      <h2 id="name-implementation-consideratio">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-implementation-consideratio" class="section-name selfRef">Implementation Considerations</a>
      </h2>
<p id="section-10-1">This specification defines features used by both Relying Parties and
OpenID Providers that choose to implement OpenID Provider Commands.
All of these Relying Parties and OpenID Providers
MUST implement the features that are listed
in this specification as being "REQUIRED" or are described with a "MUST".
No other implementation considerations for implementations of
OpenID Provider Commands are defined by this specification.<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-11">
      <h2 id="name-security-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-11-1">The signed Command Token is required in the Command Request to prevent
denial of service attacks by enabling the RP to verify that
the Command Request is coming from a legitimate party.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">OPs are encouraged to use short expiration times in Command Tokens,
preferably at most two minutes in the future,
to prevent captured Command Tokens from being replayed.<a href="#section-11-2" class="pilcrow">¶</a></p>
<div id="cross-jwt-confusion">
<section id="section-11.1">
        <h3 id="name-cross-jwt-confusion">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-cross-jwt-confusion" class="section-name selfRef">Cross-JWT Confusion</a>
        </h3>
<p id="section-11.1-1">As described in Section 2.8 of {{RFC8725}},
attackers may attempt to use a JWT issued for one purpose in a context that it was not intended for.
The mitigations described for these attacks can be applied to Command Tokens.<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<p id="section-11.1-2">One way that an attacker might attempt to repurpose a Command Token
is to try to use it as an ID Token.
As described in <a href="#command-token">Command Token</a>,
inclusion of a <code>nonce</code> Claim in a Command Token
is prohibited to prevent its misuse as an ID Token.<a href="#section-11.1-2" class="pilcrow">¶</a></p>
<p id="section-11.1-3">Another way to prevent cross-JWT confusion is to use explicit typing,
as described in Section 3.11 of {{!RFC8725}} and as required in [#command-token].<a href="#section-11.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-12">
      <h2 id="name-privacy-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-12-1"><em>To be completed.</em><a href="#section-12-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-13">
      <h2 id="name-iana-considerations">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-13-1"><em>Not all entries have been added.</em><a href="#section-13-1" class="pilcrow">¶</a></p>
<div id="json-web-token-claims">
<section id="section-13.1">
        <h3 id="name-json-web-token-claims">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-json-web-token-claims" class="section-name selfRef">JSON Web Token Claims</a>
        </h3>
<p id="section-13.1-1">This specification registers the following JSON web token claim definitions
in the IANA "JSON Web Token Claims" registry
established by <a href="#RFC7519">RFC7519</a>.<a href="#section-13.1-1" class="pilcrow">¶</a></p>
<div id="registry-contents">
<section id="section-13.1.1">
          <h4 id="name-registry-contents">
<a href="#section-13.1.1" class="section-number selfRef">13.1.1. </a><a href="#name-registry-contents" class="section-name selfRef">Registry Contents</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-13.1.1-1.1">
              <p id="section-13.1.1-1.1.1"><strong>Claim Name:</strong> <code>command</code><a href="#section-13.1.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-13.1.1-2"><strong>Claim Description:</strong>
  An instruction from the <code>iss</code> to the <code>aud</code> of a token.<a href="#section-13.1.1-2" class="pilcrow">¶</a></p>
<p id="section-13.1.1-3"><strong>Change Controller:</strong> OpenID Foundation<a href="#section-13.1.1-3" class="pilcrow">¶</a></p>
<p id="section-13.1.1-4"><strong>Specification Document(s):</strong> This document<a href="#section-13.1.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.1.1-5.1">
              <p id="section-13.1.1-5.1.1"><strong>Claim Name:</strong> <code>tenant</code><a href="#section-13.1.1-5.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-13.1.1-6"><strong>Claim Description:</strong>
  A logically isolated entity within the party identified by the <code>iss</code> of the token.<a href="#section-13.1.1-6" class="pilcrow">¶</a></p>
<p id="section-13.1.1-7"><strong>Change Controller:</strong> OpenID Foundation<a href="#section-13.1.1-7" class="pilcrow">¶</a></p>
<p id="section-13.1.1-8"><strong>Specification Document(s):</strong> This document<a href="#section-13.1.1-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.1.1-9.1">
              <p id="section-13.1.1-9.1.1"><strong>Claim Name:</strong> <code>metadata</code><a href="#section-13.1.1-9.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-13.1.1-10"><strong>Claim Description:</strong>
  Metadata about the party identified by the <code>iss</code> of the token.<a href="#section-13.1.1-10" class="pilcrow">¶</a></p>
<p id="section-13.1.1-11"><strong>Change Controller:</strong> OpenID Foundation<a href="#section-13.1.1-11" class="pilcrow">¶</a></p>
<p id="section-13.1.1-12"><strong>Specification Document(s):</strong> This document<a href="#section-13.1.1-12" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="oauth-dynamic-client-registration-metadata-registration">
<section id="section-13.2">
        <h3 id="name-oauth-dynamic-client-regist">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-oauth-dynamic-client-regist" class="section-name selfRef">OAuth Dynamic Client Registration Metadata Registration</a>
        </h3>
<p id="section-13.2-1">This specification registers the following client metadata definitions
in the IANA "OAuth Dynamic Client Registration Metadata" registry
<a href="#IANA.OAuth.Parameters">IANA OAuth Parameters</a>
established by <a href="#RFC7591">RFC7591</a>.<a href="#section-13.2-1" class="pilcrow">¶</a></p>
<div id="registry-contents-1">
<section id="section-13.2.1">
          <h4 id="name-registry-contents-2">
<a href="#section-13.2.1" class="section-number selfRef">13.2.1. </a><a href="#name-registry-contents-2" class="section-name selfRef">Registry Contents</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-13.2.1-1.1">
              <p id="section-13.2.1-1.1.1"><strong>Client Metadata Name:</strong> <code>command_endpoint</code><a href="#section-13.2.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-13.2.1-2"><strong>Client Metadata Description:</strong>
  RP URL that will receive OpenID Provider Commands from the OP<a href="#section-13.2.1-2" class="pilcrow">¶</a></p>
<p id="section-13.2.1-3"><strong>Change Controller:</strong> OpenID Foundation<a href="#section-13.2.1-3" class="pilcrow">¶</a></p>
<p id="section-13.2.1-4"><strong>Specification Document(s):</strong> This document<a href="#section-13.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="media-type-registration">
<section id="section-13.3">
        <h3 id="name-media-type-registration">
<a href="#section-13.3" class="section-number selfRef">13.3. </a><a href="#name-media-type-registration" class="section-name selfRef">Media Type Registration</a>
        </h3>
<p id="section-13.3-1">This specification registers the <code>application/command+jwt</code> media type as per {{!RFC6838}}.<a href="#section-13.3-1" class="pilcrow">¶</a></p>
<p id="section-13.3-2"><em>To be completed.</em><a href="#section-13.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="references">
<section id="section-14">
      <h2 id="name-references">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="normative-references">
<section id="section-14.1">
        <h3 id="name-normative-references">
<a href="#section-14.1" class="section-number selfRef">14.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-14.1-1.1">
            <p id="section-14.1-1.1.1"><strong>[RFC2119]</strong> Bradner, S. “Key words for use in RFCs to Indicate Requirement Levels,” <em>RFC 2119</em>, March 1997.<a href="#section-14.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.1-1.2">
            <p id="section-14.1-1.2.1"><strong>[RFC3986]</strong> Berners-Lee, T., Fielding, R., and Masinter, L. “Uniform Resource Identifier (URI): Generic Syntax,” <em>RFC 3986</em>, January 2005.<a href="#section-14.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.1-1.3">
            <p id="section-14.1-1.3.1"><strong>[RFC6750]</strong> Jones, M., and Hardt, D., “The OAuth 2.0 Authorization Framework: Bearer Token Usage,” <em>RFC 6750</em>, October 2012<a href="#section-14.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.1-1.4">
            <p id="section-14.1-1.4.1"><strong>[RFC7519]</strong> Jones, M., Bradley, J., and Sakimura, N. “JSON Web Token (JWT),” <em>RFC 7519</em>, May 2015.<a href="#section-14.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.1-1.5">
            <p id="section-14.1-1.5.1"><strong>[RFC7591]</strong> Jones, M., Bradley, J., and Sakimura, N. “OAuth 2.0 Dynamic Client Registration Protocol,” <em>RFC 7591</em>, March 2015.<a href="#section-14.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.1-1.6">
            <p id="section-14.1-1.6.1"><strong>[RFC8414]</strong> Jones, M., and Sakimura, N., “OAuth 2.0 Authorization Server Metadata,” <em>RFC 8414</em>, June 2018.<a href="#section-14.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.1-1.7">
            <p id="section-14.1-1.7.1"><strong>[RFC9110]</strong> Fielding, R. “HTTP Semantics,” <em>RFC 9110</em>, June 2022.<a href="#section-14.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.1-1.8">
            <p id="section-14.1-1.8.1"><strong>[RFC8725]</strong> Bromberg, L. “Security Considerations for JSON Web Tokens,” <em>RFC 8725</em>, June 2020.<a href="#section-14.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.1-1.9">
            <p id="section-14.1-1.9.1"><strong>[RFC6838]</strong> IANA. “Media Types,” <em>RFC 6838</em>, June 2013.<a href="#section-14.1-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.1-1.10">
            <p id="section-14.1-1.10.1"><strong>ISO/IEC 24760-1:2019</strong>, “IT Security – A framework for identity management – Part 1: Terminology and concepts.”<a href="#section-14.1-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.1-1.11">
            <p id="section-14.1-1.11.1"><strong>OpenID.Core</strong> – “OpenID Connect Core 1.0 incorporating errata set 2,” available at <a href="https://openid.net/specs/openid-connect-core-1_0.html">https://openid.net/specs/openid-connect-core-1_0.html</a>.<a href="#section-14.1-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.1-1.12">
            <p id="section-14.1-1.12.1"><strong>OpenID.Enterprise</strong> – "OpenID Connect Enterprise Extensions 1.0," available at <a href="https://openid.net/specs/openid-connect-enterprise-extensions-1_0.html">https://openid.net/specs/openid-connect-enterprise-extensions-1_0.html</a>.<a href="#section-14.1-1.12.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="informative-references">
<section id="section-14.2">
        <h3 id="name-informative-references">
<a href="#section-14.2" class="section-number selfRef">14.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-14.2-1.1">
            <p id="section-14.2-1.1.1"><strong>IANA JSON Web Token Claims Registry</strong>, available at <a href="https://www.iana.org/assignments/jwt/jwt.xhtml">https://www.iana.org/assignments/jwt/jwt.xhtml</a>.<a href="#section-14.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.2-1.2">
            <p id="section-14.2-1.2.1"><strong>IANA OAuth Parameters</strong>, available at <a href="https://www.iana.org/assignments/oauth-parameters/oauth-parameters.xhtml#client-metadata">https://www.iana.org/assignments/oauth-parameters/oauth-parameters.xhtml#client-metadata</a>.<a href="#section-14.2-1.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-A">
      <h2 id="name-acknowledgements">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-A-1">The authors would like to thank early feedback provided by Tim Cappalli, Andrii Deinega, Pam Dingle, George Fletcher, Michael Jones, Jeff Lombardo, Aaron Parecki, Nat Sakimura, Dean Saxe, and Rifaat Shekh-Yusef.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2"><em>To be updated.</em><a href="#appendix-A-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="notices">
<section id="appendix-B">
      <h2 id="name-notices">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-notices" class="section-name selfRef">Notices</a>
      </h2>
<p id="appendix-B-1">Copyright (c) 2025 The OpenID Foundation.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">The OpenID Foundation (OIDF) grants to any Contributor, developer,
implementer, or other interested party a non-exclusive, royalty free,
worldwide copyright license to reproduce, prepare derivative works from,
distribute, perform and display, this Implementers Draft, Final
Specification, or Final Specification Incorporating Errata Corrections
solely for the purposes of (i) developing specifications,
and (ii) implementing Implementers Drafts, Final Specifications,
and Final Specification Incorporating Errata Corrections based
on such documents, provided that attribution be made to the OIDF as the
source of the material, but that such attribution does not indicate an
endorsement by the OIDF.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<p id="appendix-B-3">The technology described in this specification was made available
from contributions from various sources, including members of the OpenID
Foundation and others. Although the OpenID Foundation has taken steps to
help ensure that the technology is available for distribution, it takes
no position regarding the validity or scope of any intellectual property
or other rights that might be claimed to pertain to the implementation
or use of the technology described in this specification or the extent
to which any license under such rights might or might not be available;
neither does it represent that it has made any independent effort to
identify any such rights. The OpenID Foundation and the contributors to
this specification make no (and hereby expressly disclaim any)
warranties (express, implied, or otherwise), including implied
warranties of merchantability, non-infringement, fitness for a
particular purpose, or title, related to this specification, and the
entire risk as to implementing this specification is assumed by the
implementer. The OpenID Intellectual Property Rights policy
(found at openid.net) requires
contributors to offer a patent promise not to assert certain patent
claims against other contributors and against implementers.
OpenID invites any interested party to bring to its attention any
copyrights, patents, patent applications, or other proprietary rights
that may cover technology that may be required to practice this
specification.<a href="#appendix-B-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="appendix-C">
      <h2 id="name-document-history">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-C-1">[[ To be removed from the final specification ]]<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">-00<a href="#appendix-C-2" class="pilcrow">¶</a></p>
<p id="appendix-C-3">initial draft<a href="#appendix-C-3" class="pilcrow">¶</a></p>
<p id="appendix-C-4">-01<a href="#appendix-C-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-5.1">
          <p id="appendix-C-5.1.1">rename <code>commands_uri</code> to <code>commands_endpoint</code><a href="#appendix-C-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-5.2">
          <p id="appendix-C-5.2.1">added <code>audit</code> account command<a href="#appendix-C-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-5.3">
          <p id="appendix-C-5.3.1">change <code>aud</code> to be the <code>commands_endpoint</code> and add <code>client_id</code> as a separate claim<a href="#appendix-C-5.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-5.4">
          <p id="appendix-C-5.4.1">add <code>error</code> as another event type in tenant SSE response<a href="#appendix-C-5.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-5.5">
          <p id="appendix-C-5.5.1">add async commands, <code>callback_endpoint</code> to OP metadata, and <code>callback_token</code> for async response and <code>metadata</code> request<a href="#appendix-C-5.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-5.6">
          <p id="appendix-C-5.6.1">add error messages for restarting a stream that cannot be restarted<a href="#appendix-C-5.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-5.7">
          <p id="appendix-C-5.7.1">add <code>roles</code> claims and <code>roles</code> metadata<a href="#appendix-C-5.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-5.8">
          <p id="appendix-C-5.8.1">add <code>last_access</code> claim for RP to communicate last time user accessed the resource off_line<a href="#appendix-C-5.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-5.9">
          <p id="appendix-C-5.9.1">minor edits and structural cleanup<a href="#appendix-C-5.9.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-6">-02<a href="#appendix-C-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-7.1">
          <p id="appendix-C-7.1.1">added <code>aud_sub</code> as claim in commands and property from RP in audit reponses<a href="#appendix-C-7.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-7.2">
          <p id="appendix-C-7.2.1">Metadata Response: Added <code>aud_sub_required</code> response property (OPTIONAL) normatively indicating RP requirement to receive <code>aud_sub</code> in subsequent Account Commands.<a href="#appendix-C-7.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-7.3">
          <p id="appendix-C-7.3.1">collected all normative claims and properties into new "Claims and Properties" section centralizing definitions of all Command Token claims and response properties<a href="#appendix-C-7.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-7.4">
          <p id="appendix-C-7.4.1">Command Token: Introduced normative baseline claim sets for Account vs Tenant Commands; clarified that only listed claims plus command-specific additions may appear (tightening allowed claims surface).<a href="#appendix-C-7.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dick Hardt</span></div>
<div dir="auto" class="left"><span class="org">Hellō</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dick.hardt@gmail.com" class="email">dick.hardt@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Karl McGuinness</span></div>
<div dir="auto" class="left"><span class="org">Independent</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:me@karlmcguinness.com" class="email">me@karlmcguinness.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>

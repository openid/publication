<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>OpenID Federation 1.1 - draft 01</title>
<meta content="Roland Hedberg" name="author">
<meta content="Michael B. Jones" name="author">
<meta content="Giuseppe De Marco" name="author">
<meta content="Andreas Åkre Solberg" name="author">
<meta content="John Bradley" name="author">
<meta content="Vladimir Dzhuvinov" name="author">
<meta content="
       
        A federation can be expressed as an agreement between parties that trust each other.
        In bilateral federations, direct trust can be established between
        two organizations belonging to the same federation.
        In a multilateral federation, bilateral agreements might not be practical,
        in which case, trust can be mediated by a third party.
        That is the model used in this specification.
       
       
        An Entity in the federation must be able to trust that other Entities
        it interacts with belong to the same federation.
        It must also be able to trust that the information the other Entities
        publish about themselves has not been tampered with during transport
        and that it adheres to the federation's policies.
       
       
 This specification contains the protocol-independent functionality defined in OpenID Federation 1.0.
 This includes Entity Statements, Trust Chains, Metadata, Policies, Trust Marks, and Federation Endpoints.
 These can be used in multilateral federations for the purpose of establishing trust,
 in combination with the protocol-specific functionality defined by specifications such as OpenID Federation for OpenID Connect 1.1.
 This specification introduces no new functionality not present in OpenID Federation 1.0.
       
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="OpenID" name="keyword">
<meta content="OpenID Connect" name="keyword">
<meta content="Federation" name="keyword">
<meta content="Multilateral Federation" name="keyword">
<meta content="Federation Entity" name="keyword">
<meta content="Federation Operator" name="keyword">
<meta content="Trust Anchor" name="keyword">
<meta content="Trust Chain" name="keyword">
<meta content="Trust Establishment" name="keyword">
<meta content="Trust Mark" name="keyword">
<meta content="openid-federation-1_1" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.3
    ConfigArgParse 1.7.1
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 6.0.2
    platformdirs 4.5.1
    pycountry 24.6.1
    PyYAML 6.0.3
    requests 2.32.5
    wcwidth 0.2.14
    weasyprint 65.0
-->
<link href="openid-federation-1_1.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://static.ietf.org/fonts/noto-sans/import.css'); /* Sans-serif */
@import url('https://static.ietf.org/fonts/noto-serif/import.css'); /* Serif (print) */
@import url('https://static.ietf.org/fonts/roboto-mono/import.css'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
@media print {
  svg {
    max-height: 850px;
    max-width: 660px;
  }
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    max-width: 100%;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > blockquote:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left"></td>
<td class="center">OpenID Federation 1.1</td>
<td class="right">January 2026</td>
</tr></thead>
<tfoot><tr>
<td class="left">Hedberg, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">OpenID Connect Working Group</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2026-01-20" class="published">20 January 2026</time>
    </dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">R. Hedberg</div>
<div class="org">independent</div>
</div>
<div class="author">
      <div class="author-name">M.B. Jones, <span class="editor">Ed.</span>
</div>
<div class="org">Self-Issued Consulting</div>
</div>
<div class="author">
      <div class="author-name">G. De Marco</div>
<div class="org">independent</div>
</div>
<div class="author">
      <div class="author-name">A.Å. Solberg</div>
<div class="org">Sikt</div>
</div>
<div class="author">
      <div class="author-name">J. Bradley</div>
<div class="org">Yubico</div>
</div>
<div class="author">
      <div class="author-name">V. Dzhuvinov</div>
<div class="org">Connect2id</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">OpenID Federation 1.1 - draft 01</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
        A federation can be expressed as an agreement between parties that trust each other.
        In bilateral federations, direct trust can be established between
        two organizations belonging to the same federation.
        In a multilateral federation, bilateral agreements might not be practical,
        in which case, trust can be mediated by a third party.
        That is the model used in this specification.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">
        An Entity in the federation must be able to trust that other Entities
        it interacts with belong to the same federation.
        It must also be able to trust that the information the other Entities
        publish about themselves has not been tampered with during transport
        and that it adheres to the federation's policies.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">
 This specification contains the protocol-independent functionality defined in OpenID Federation 1.0.
 This includes Entity Statements, Trust Chains, Metadata, Policies, Trust Marks, and Federation Endpoints.
 These can be used in multilateral federations for the purpose of establishing trust,
 in combination with the protocol-specific functionality defined by specifications such as OpenID Federation for OpenID Connect 1.1.
 This specification introduces no new functionality not present in OpenID Federation 1.0.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-requirements-notation-and-c" class="internal xref">Requirements Notation and Conventions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-overall-architecture" class="internal xref">Overall Architecture</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-cryptographic-trust-mechani" class="internal xref">Cryptographic Trust Mechanism</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-entity-statement" class="internal xref">Entity Statement</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-entity-statement-claims" class="internal xref">Entity Statement Claims</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="auto internal xref">3.1.1</a>.  <a href="#name-claims-that-must-or-may-app" class="internal xref">Claims that MUST or MAY Appear in both Entity Configurations and Subordinate Statements</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="auto internal xref">3.1.2</a>.  <a href="#name-claims-that-must-or-may-appe" class="internal xref">Claims that MUST or MAY Appear in Entity Configurations but Not in Subordinate Statements</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a href="#section-3.1.3" class="auto internal xref">3.1.3</a>.  <a href="#name-claims-that-must-or-may-appea" class="internal xref">Claims that MUST or MAY Appear in Subordinate Statements but Not in Entity Configurations</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-entity-statement-validation" class="internal xref">Entity Statement Validation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-entity-statement-example" class="internal xref">Entity Statement Example</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-trust-chain" class="internal xref">Trust Chain</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-beginning-and-ending-trust-" class="internal xref">Beginning and Ending Trust Chains</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-trust-chain-example" class="internal xref">Trust Chain Example</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-trust-chain-header-paramete" class="internal xref">Trust Chain Header Parameter</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-peer-trust-chain-header-par" class="internal xref">Peer Trust Chain Header Parameter</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-metadata" class="internal xref">Metadata</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-entity-type-identifiers" class="internal xref">Entity Type Identifiers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-federation-entity" class="internal xref">Federation Entity</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-common-metadata-parameters" class="internal xref">Common Metadata Parameters</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-parameters-for-jwk-sets-in-" class="internal xref">Parameters for JWK Sets in Entity Metadata</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1.2.1">
                        <p id="section-toc.1-1.5.2.2.2.1.2.1.1"><a href="#section-5.2.1.1" class="auto internal xref">5.2.1.1</a>.  <a href="#name-usage-of-jwks-jwks_uri-and-" class="internal xref">Usage of jwks, jwks_uri, and signed_jwks_uri in Entity Metadata</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-informational-metadata-para" class="internal xref">Informational Metadata Parameters</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-federation-policy" class="internal xref">Federation Policy</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-metadata-policy" class="internal xref">Metadata Policy</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="auto internal xref">6.1.1</a>.  <a href="#name-principles" class="internal xref">Principles</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="auto internal xref">6.1.2</a>.  <a href="#name-structure" class="internal xref">Structure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.3">
                    <p id="section-toc.1-1.6.2.1.2.3.1"><a href="#section-6.1.3" class="auto internal xref">6.1.3</a>.  <a href="#name-operators" class="internal xref">Operators</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.3.2.1">
                        <p id="section-toc.1-1.6.2.1.2.3.2.1.1"><a href="#section-6.1.3.1" class="auto internal xref">6.1.3.1</a>.  <a href="#name-standard-operators" class="internal xref">Standard Operators</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.3.2.1.2.1">
                            <p id="section-toc.1-1.6.2.1.2.3.2.1.2.1.1"><a href="#section-6.1.3.1.1" class="auto internal xref">6.1.3.1.1</a>.  <a href="#name-value" class="internal xref">value</a></p>
</li>
                          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.3.2.1.2.2">
                            <p id="section-toc.1-1.6.2.1.2.3.2.1.2.2.1"><a href="#section-6.1.3.1.2" class="auto internal xref">6.1.3.1.2</a>.  <a href="#name-add" class="internal xref">add</a></p>
</li>
                          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.3.2.1.2.3">
                            <p id="section-toc.1-1.6.2.1.2.3.2.1.2.3.1"><a href="#section-6.1.3.1.3" class="auto internal xref">6.1.3.1.3</a>.  <a href="#name-default" class="internal xref">default</a></p>
</li>
                          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.3.2.1.2.4">
                            <p id="section-toc.1-1.6.2.1.2.3.2.1.2.4.1"><a href="#section-6.1.3.1.4" class="auto internal xref">6.1.3.1.4</a>.  <a href="#name-one_of" class="internal xref">one_of</a></p>
</li>
                          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.3.2.1.2.5">
                            <p id="section-toc.1-1.6.2.1.2.3.2.1.2.5.1"><a href="#section-6.1.3.1.5" class="auto internal xref">6.1.3.1.5</a>.  <a href="#name-subset_of" class="internal xref">subset_of</a></p>
</li>
                          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.3.2.1.2.6">
                            <p id="section-toc.1-1.6.2.1.2.3.2.1.2.6.1"><a href="#section-6.1.3.1.6" class="auto internal xref">6.1.3.1.6</a>.  <a href="#name-superset_of" class="internal xref">superset_of</a></p>
</li>
                          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.3.2.1.2.7">
                            <p id="section-toc.1-1.6.2.1.2.3.2.1.2.7.1"><a href="#section-6.1.3.1.7" class="auto internal xref">6.1.3.1.7</a>.  <a href="#name-essential" class="internal xref">essential</a></p>
</li>
                          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.3.2.1.2.8">
                            <p id="section-toc.1-1.6.2.1.2.3.2.1.2.8.1"><a href="#section-6.1.3.1.8" class="auto internal xref">6.1.3.1.8</a>.  <a href="#name-notes-on-operators" class="internal xref">Notes on Operators</a></p>
</li>
                        </ul>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.3.2.2">
                        <p id="section-toc.1-1.6.2.1.2.3.2.2.1"><a href="#section-6.1.3.2" class="auto internal xref">6.1.3.2</a>.  <a href="#name-additional-operators" class="internal xref">Additional Operators</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.4">
                    <p id="section-toc.1-1.6.2.1.2.4.1"><a href="#section-6.1.4" class="auto internal xref">6.1.4</a>.  <a href="#name-enforcement" class="internal xref">Enforcement</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.4.2.1">
                        <p id="section-toc.1-1.6.2.1.2.4.2.1.1"><a href="#section-6.1.4.1" class="auto internal xref">6.1.4.1</a>.  <a href="#name-resolution" class="internal xref">Resolution</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.4.2.2">
                        <p id="section-toc.1-1.6.2.1.2.4.2.2.1"><a href="#section-6.1.4.2" class="auto internal xref">6.1.4.2</a>.  <a href="#name-application" class="internal xref">Application</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.5">
                    <p id="section-toc.1-1.6.2.1.2.5.1"><a href="#section-6.1.5" class="auto internal xref">6.1.5</a>.  <a href="#name-metadata-policy-example" class="internal xref">Metadata Policy Example</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-constraints" class="internal xref">Constraints</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="auto internal xref">6.2.1</a>.  <a href="#name-max-path-length-constraint" class="internal xref">Max Path Length Constraint</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="auto internal xref">6.2.2</a>.  <a href="#name-naming-constraints" class="internal xref">Naming Constraints</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.3">
                    <p id="section-toc.1-1.6.2.2.2.3.1"><a href="#section-6.2.3" class="auto internal xref">6.2.3</a>.  <a href="#name-entity-type-constraints" class="internal xref">Entity Type Constraints</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-trust-marks" class="internal xref">Trust Marks</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-trust-mark-claims" class="internal xref">Trust Mark Claims</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-trust-mark-delegation" class="internal xref">Trust Mark Delegation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a href="#section-7.2.1" class="auto internal xref">7.2.1</a>.  <a href="#name-trust-mark-delegation-jwt" class="internal xref">Trust Mark Delegation JWT</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.2">
                    <p id="section-toc.1-1.7.2.2.2.2.1"><a href="#section-7.2.2" class="auto internal xref">7.2.2</a>.  <a href="#name-validating-a-trust-mark-del" class="internal xref">Validating a Trust Mark Delegation</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-validating-a-trust-mark" class="internal xref">Validating a Trust Mark</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-trust-mark-examples" class="internal xref">Trust Mark Examples</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-trust-mark-delegation-examp" class="internal xref">Trust Mark Delegation Example</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-federation-endpoints" class="internal xref">Federation Endpoints</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-fetching-a-subordinate-stat" class="internal xref">Fetching a Subordinate Statement</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.1">
                    <p id="section-toc.1-1.8.2.1.2.1.1"><a href="#section-8.1.1" class="auto internal xref">8.1.1</a>.  <a href="#name-fetch-subordinate-statement" class="internal xref">Fetch Subordinate Statement Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.2">
                    <p id="section-toc.1-1.8.2.1.2.2.1"><a href="#section-8.1.2" class="auto internal xref">8.1.2</a>.  <a href="#name-fetch-subordinate-statement-" class="internal xref">Fetch Subordinate Statement Response</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-subordinate-listing" class="internal xref">Subordinate Listing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.1">
                    <p id="section-toc.1-1.8.2.2.2.1.1"><a href="#section-8.2.1" class="auto internal xref">8.2.1</a>.  <a href="#name-subordinate-listing-request" class="internal xref">Subordinate Listing Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.2">
                    <p id="section-toc.1-1.8.2.2.2.2.1"><a href="#section-8.2.2" class="auto internal xref">8.2.2</a>.  <a href="#name-subordinate-listing-respons" class="internal xref">Subordinate Listing Response</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-resolve-entity" class="internal xref">Resolve Entity</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.1">
                    <p id="section-toc.1-1.8.2.3.2.1.1"><a href="#section-8.3.1" class="auto internal xref">8.3.1</a>.  <a href="#name-resolve-request" class="internal xref">Resolve Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.2">
                    <p id="section-toc.1-1.8.2.3.2.2.1"><a href="#section-8.3.2" class="auto internal xref">8.3.2</a>.  <a href="#name-resolve-response" class="internal xref">Resolve Response</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.3">
                    <p id="section-toc.1-1.8.2.3.2.3.1"><a href="#section-8.3.3" class="auto internal xref">8.3.3</a>.  <a href="#name-trust-considerations" class="internal xref">Trust Considerations</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-trust-mark-status" class="internal xref">Trust Mark Status</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.1">
                    <p id="section-toc.1-1.8.2.4.2.1.1"><a href="#section-8.4.1" class="auto internal xref">8.4.1</a>.  <a href="#name-trust-mark-status-request" class="internal xref">Trust Mark Status Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.2">
                    <p id="section-toc.1-1.8.2.4.2.2.1"><a href="#section-8.4.2" class="auto internal xref">8.4.2</a>.  <a href="#name-trust-mark-status-response" class="internal xref">Trust Mark Status Response</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="auto internal xref">8.5</a>.  <a href="#name-trust-marked-entities-listi" class="internal xref">Trust Marked Entities Listing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5.2.1">
                    <p id="section-toc.1-1.8.2.5.2.1.1"><a href="#section-8.5.1" class="auto internal xref">8.5.1</a>.  <a href="#name-trust-marked-entities-listin" class="internal xref">Trust Marked Entities Listing Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5.2.2">
                    <p id="section-toc.1-1.8.2.5.2.2.1"><a href="#section-8.5.2" class="auto internal xref">8.5.2</a>.  <a href="#name-trust-marked-entities-listing-" class="internal xref">Trust Marked Entities Listing Response</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.6">
                <p id="section-toc.1-1.8.2.6.1"><a href="#section-8.6" class="auto internal xref">8.6</a>.  <a href="#name-trust-mark-endpoint" class="internal xref">Trust Mark Endpoint</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.6.2.1">
                    <p id="section-toc.1-1.8.2.6.2.1.1"><a href="#section-8.6.1" class="auto internal xref">8.6.1</a>.  <a href="#name-trust-mark-request" class="internal xref">Trust Mark Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.6.2.2">
                    <p id="section-toc.1-1.8.2.6.2.2.1"><a href="#section-8.6.2" class="auto internal xref">8.6.2</a>.  <a href="#name-trust-mark-response" class="internal xref">Trust Mark Response</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.7">
                <p id="section-toc.1-1.8.2.7.1"><a href="#section-8.7" class="auto internal xref">8.7</a>.  <a href="#name-federation-historical-keys-" class="internal xref">Federation Historical Keys Endpoint</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.7.2.1">
                    <p id="section-toc.1-1.8.2.7.2.1.1"><a href="#section-8.7.1" class="auto internal xref">8.7.1</a>.  <a href="#name-federation-historical-keys-r" class="internal xref">Federation Historical Keys Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.7.2.2">
                    <p id="section-toc.1-1.8.2.7.2.2.1"><a href="#section-8.7.2" class="auto internal xref">8.7.2</a>.  <a href="#name-federation-historical-keys-res" class="internal xref">Federation Historical Keys Response</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.7.2.3">
                    <p id="section-toc.1-1.8.2.7.2.3.1"><a href="#section-8.7.3" class="auto internal xref">8.7.3</a>.  <a href="#name-federation-historical-keys-rev" class="internal xref">Federation Historical Keys Revocation Reasons</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.7.2.4">
                    <p id="section-toc.1-1.8.2.7.2.4.1"><a href="#section-8.7.4" class="auto internal xref">8.7.4</a>.  <a href="#name-rationale-for-the-federatio" class="internal xref">Rationale for the Federation Historical Keys Endpoint</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.8">
                <p id="section-toc.1-1.8.2.8.1"><a href="#section-8.8" class="auto internal xref">8.8</a>.  <a href="#name-client-authentication-at-fe" class="internal xref">Client Authentication at Federation Endpoints</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.8.2.1">
                    <p id="section-toc.1-1.8.2.8.2.1.1"><a href="#section-8.8.1" class="auto internal xref">8.8.1</a>.  <a href="#name-client-authentication-metad" class="internal xref">Client Authentication Metadata for Federation Endpoints</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.9">
                <p id="section-toc.1-1.8.2.9.1"><a href="#section-8.9" class="auto internal xref">8.9</a>.  <a href="#name-error-responses" class="internal xref">Error Responses</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-obtaining-federation-entity" class="internal xref">Obtaining Federation Entity Configuration Information</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-federation-entity-configura" class="internal xref">Federation Entity Configuration Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-federation-entity-configurat" class="internal xref">Federation Entity Configuration Response</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-resolving-the-trust-chain-a" class="internal xref">Resolving the Trust Chain and Metadata</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-fetching-entity-statements-" class="internal xref">Fetching Entity Statements to Establish a Trust Chain</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-validating-a-trust-chain" class="internal xref">Validating a Trust Chain</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="auto internal xref">10.3</a>.  <a href="#name-choosing-one-of-the-valid-t" class="internal xref">Choosing One of the Valid Trust Chains</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#section-10.4" class="auto internal xref">10.4</a>.  <a href="#name-calculating-the-expiration-" class="internal xref">Calculating the Expiration Time of a Trust Chain</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a href="#section-10.5" class="auto internal xref">10.5</a>.  <a href="#name-transient-trust-chain-valid" class="internal xref">Transient Trust Chain Validation Errors</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.6">
                <p id="section-toc.1-1.10.2.6.1"><a href="#section-10.6" class="auto internal xref">10.6</a>.  <a href="#name-resolving-the-trust-chain-an" class="internal xref">Resolving the Trust Chain and Metadata with a Resolver</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-updating-metadata-key-rollo" class="internal xref">Updating Metadata, Key Rollover, and Revocation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-federation-key-rollover" class="internal xref">Federation Key Rollover</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-key-rollover-for-a-trust-an" class="internal xref">Key Rollover for a Trust Anchor</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="auto internal xref">11.3</a>.  <a href="#name-redundant-retrieval-of-trus" class="internal xref">Redundant Retrieval of Trust Anchor Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#section-11.4" class="auto internal xref">11.4</a>.  <a href="#name-revocation" class="internal xref">Revocation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-openid-connect-client-regis" class="internal xref">OpenID Connect Client Registration</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-general-purpose-jwt-claims" class="internal xref">General-Purpose JWT Claims</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-jwks-json-web-key-set-claim" class="internal xref">"jwks" (JSON Web Key Set) Claim</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-metadata-claim" class="internal xref">"metadata" Claim</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#section-13.3" class="auto internal xref">13.3</a>.  <a href="#name-constraints-claim" class="internal xref">"constraints" Claim</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.4">
                <p id="section-toc.1-1.13.2.4.1"><a href="#section-13.4" class="auto internal xref">13.4</a>.  <a href="#name-crit-critical-claim" class="internal xref">"crit" (Critical) Claim</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.5">
                <p id="section-toc.1-1.13.2.5.1"><a href="#section-13.5" class="auto internal xref">13.5</a>.  <a href="#name-ref-reference-claim" class="internal xref">"ref" (Reference) Claim</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.6">
                <p id="section-toc.1-1.13.2.6.1"><a href="#section-13.6" class="auto internal xref">13.6</a>.  <a href="#name-delegation-claim" class="internal xref">"delegation" Claim</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.7">
                <p id="section-toc.1-1.13.2.7.1"><a href="#section-13.7" class="auto internal xref">13.7</a>.  <a href="#name-logo_uri-logo-uri-claim" class="internal xref">"logo_uri" (Logo URI) Claim</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-claims-languages-and-script" class="internal xref">Claims Languages and Scripts</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="auto internal xref">15</a>. <a href="#name-media-types" class="internal xref">Media Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-15.1" class="auto internal xref">15.1</a>.  <a href="#name-application-entity-statemen" class="internal xref">"application/entity-statement+jwt" Media Type</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-15.2" class="auto internal xref">15.2</a>.  <a href="#name-application-trust-markjwt-m" class="internal xref">"application/trust-mark+jwt" Media Type</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a href="#section-15.3" class="auto internal xref">15.3</a>.  <a href="#name-application-resolve-respons" class="internal xref">"application/resolve-response+jwt" Media Type</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.4">
                <p id="section-toc.1-1.15.2.4.1"><a href="#section-15.4" class="auto internal xref">15.4</a>.  <a href="#name-application-trust-chainjson" class="internal xref">"application/trust-chain+json" Media Type</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.5">
                <p id="section-toc.1-1.15.2.5.1"><a href="#section-15.5" class="auto internal xref">15.5</a>.  <a href="#name-application-trust-mark-dele" class="internal xref">"application/trust-mark-delegation+jwt" Media Type</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.6">
                <p id="section-toc.1-1.15.2.6.1"><a href="#section-15.6" class="auto internal xref">15.6</a>.  <a href="#name-application-jwk-setjwt-medi" class="internal xref">"application/jwk-set+jwt" Media Type</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.7">
                <p id="section-toc.1-1.15.2.7.1"><a href="#section-15.7" class="auto internal xref">15.7</a>.  <a href="#name-application-trust-mark-stat" class="internal xref">"application/trust-mark-status-response+jwt" Media Type</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-16" class="auto internal xref">16</a>. <a href="#name-string-operations" class="internal xref">String Operations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-17" class="auto internal xref">17</a>. <a href="#name-implementation-consideratio" class="internal xref">Implementation Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1">
                <p id="section-toc.1-1.17.2.1.1"><a href="#section-17.1" class="auto internal xref">17.1</a>.  <a href="#name-federation-topologies" class="internal xref">Federation Topologies</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2">
                <p id="section-toc.1-1.17.2.2.1"><a href="#section-17.2" class="auto internal xref">17.2</a>.  <a href="#name-federation-discovery-and-tr" class="internal xref">Federation Discovery and Trust Chain Resolution Patterns</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2.2.1">
                    <p id="section-toc.1-1.17.2.2.2.1.1"><a href="#section-17.2.1" class="auto internal xref">17.2.1</a>.  <a href="#name-bottom-up-trust-chain-resol" class="internal xref">Bottom-Up Trust Chain Resolution</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2.2.2">
                    <p id="section-toc.1-1.17.2.2.2.2.1"><a href="#section-17.2.2" class="auto internal xref">17.2.2</a>.  <a href="#name-top-down-discovery" class="internal xref">Top-Down Discovery</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2.2.3">
                    <p id="section-toc.1-1.17.2.2.2.3.1"><a href="#section-17.2.3" class="auto internal xref">17.2.3</a>.  <a href="#name-single-point-of-trust-resol" class="internal xref">Single Point of Trust Resolution</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.3">
                <p id="section-toc.1-1.17.2.3.1"><a href="#section-17.3" class="auto internal xref">17.3</a>.  <a href="#name-trust-anchors-and-resolvers" class="internal xref">Trust Anchors and Resolvers Go Together</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.4">
                <p id="section-toc.1-1.17.2.4.1"><a href="#section-17.4" class="auto internal xref">17.4</a>.  <a href="#name-one-entity-one-service" class="internal xref">One Entity, One Service</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.5">
                <p id="section-toc.1-1.17.2.5.1"><a href="#section-17.5" class="auto internal xref">17.5</a>.  <a href="#name-trust-mark-policies" class="internal xref">Trust Mark Policies</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#section-18" class="auto internal xref">18</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.1">
                <p id="section-toc.1-1.18.2.1.1"><a href="#section-18.1" class="auto internal xref">18.1</a>.  <a href="#name-denial-of-service-attack-pr" class="internal xref">Denial-of-Service Attack Prevention</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.2">
                <p id="section-toc.1-1.18.2.2.1"><a href="#section-18.2" class="auto internal xref">18.2</a>.  <a href="#name-unsigned-error-messages" class="internal xref">Unsigned Error Messages</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#section-19" class="auto internal xref">19</a>. <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.1">
                <p id="section-toc.1-1.19.2.1.1"><a href="#section-19.1" class="auto internal xref">19.1</a>.  <a href="#name-entity-statement-privacy-co" class="internal xref">Entity Statement Privacy Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.2">
                <p id="section-toc.1-1.19.2.2.1"><a href="#section-19.2" class="auto internal xref">19.2</a>.  <a href="#name-trust-mark-status-privacy-c" class="internal xref">Trust Mark Status Privacy Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.3">
                <p id="section-toc.1-1.19.2.3.1"><a href="#section-19.3" class="auto internal xref">19.3</a>.  <a href="#name-fetch-endpoint-privacy-cons" class="internal xref">Fetch Endpoint Privacy Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#section-20" class="auto internal xref">20</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21">
            <p id="section-toc.1-1.21.1"><a href="#section-21" class="auto internal xref">21</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.1">
                <p id="section-toc.1-1.21.2.1.1"><a href="#section-21.1" class="auto internal xref">21.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.2">
                <p id="section-toc.1-1.21.2.2.1"><a href="#section-21.2" class="auto internal xref">21.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22">
            <p id="section-toc.1-1.22.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-examples-building-and-using" class="internal xref">Examples Building and Using Trust Chains</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.23">
            <p id="section-toc.1-1.23.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-notices" class="internal xref">Notices</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24">
            <p id="section-toc.1-1.24.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-document-history" class="internal xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25">
            <p id="section-toc.1-1.25.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.1">
                <p id="section-toc.1-1.25.2.1.1"><a href="#appendix-D.1" class="auto internal xref"></a><a href="#name-openid-federation-11-acknow" class="internal xref">OpenID Federation 1.1 Acknowledgements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.2">
                <p id="section-toc.1-1.25.2.2.1"><a href="#appendix-D.2" class="auto internal xref"></a><a href="#name-openid-federation-10-acknow" class="internal xref">OpenID Federation 1.0 Acknowledgements</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.26">
            <p id="section-toc.1-1.26.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="Introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
        This specification describes how two Entities that would like to
        interact can establish trust between them by means of a trusted third party
        called a Trust Anchor.
        A Trust Anchor is an Entity whose main purpose is to issue statements
        about Entities.
        An identity federation can be realized using this specification using
        one or more levels of authorities.
        Examples of authorities are federation operators, organizations,
        departments within organizations, and individual sites.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
        This
        specification provides the basic technical trust infrastructure building
        blocks needed to create a dynamic and distributed trust network, such as a
        federation.
 This trust infrastructure can be used with any application protocol.
 Protocol-specific bindings to the functionality defined by this specification
 are defined in other specifications, such as the
 <span><a href="#OpenID.Federation.Connect-1.1" class="internal xref">OpenID Federation for OpenID Connect 1.1</a> [<a href="#OpenID.Federation.Connect-1.1" class="cite xref">OpenID.Federation.Connect-1.1</a>]</span>
 specification, which defines protocol-specific functionality for use with
 <span><a href="#OpenID.Core" class="internal xref">OpenID Connect Core 1.0</a> [<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span> and
 <span><a href="#RFC6749" class="internal xref">OAuth 2.0</a> [<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> deployments.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">
        Note that this specification only concerns itself with how Entities
        in a federation get to know about each other. An organization MAY
        be represented by more than one Entity in a federation. An Entity
        MAY also belong to more than one federation. Determining that two
        Entities belong to the same federation is the basis for
        establishing trust between them in this specification.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">
        Of course, the word "trust" is also used in the vernacular to
        encompass confidence in the security, reliability, and integrity of entities
        and their actions. This kind trust is often established through
        empirical proof, such as past performance, security certifications,
        or transparent operational practices, which demonstrate a track
        record of adherence to security standards and ethical conduct.
        To be clear, this broader meaning of trust, while important,
        is largely beyond the scope of what this specification accomplishes.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5" class="keepWithNext">
   Below is an example of two federations rooted at two different
   Trust Anchors with some members in common.
   Every Entity is able to establish mutual trust with any
   other Entity by means of having at least one
   common Trust Anchor between them.
   These abbreviations are used in the diagram:
   OpenID Provider (OP),
   Relying Party (RP),
   Resource Server (RS),
   and
   Authorization Server (AS).<a href="#section-1-5" class="pilcrow">¶</a></p>
<span id="name-two-coexisting-federations-"></span><figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-1-6.1">
<pre>
.-----------------.            .-----------------.
|  Trust Anchor A |            |  Trust Anchor B |
'------.--.-------'            '----.--.--.------'
       |  |                         |  |  |
    .--'  '---. .-------------------'  |  |
    |         | |                      |  |
.---v.  .-----v-v------.   .-----------'  |
| OP |  | Intermediate |   |              |
'----'  '--.--.--.-----'   |    .---------v----.
           |  |  |         |    | Intermediate |
   .-------'  |  '------.  |    '---.--.--.----'
   |          |         |  |        |  |  |
.--v-.      .-v--.     .v--v.   .---'  |  '----.
| RP |      | RS |     | OP |   |      |       |
'----'      '----'     '----'   |   .--v-.   .-v--.
                                |   | RP |   | RP |
                                |   '----'   '----'
                                |
                        .-------v------.
                        | Intermediate |
                        '----.--.--.---'
                             |  |  |
                       .-----'  |  '----.
                       |        |       |
                    .--v-.   .--v-.   .-v--.
                    | OP |   | RP |   | AS |
                    '----'   '----'   '----'

</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-two-coexisting-federations-" class="selfRef">Two Coexisting Federations with Some Members in Common</a>
        </figcaption></figure>
<div id="requirements-language">
<section id="section-1.1">
        <h3 id="name-requirements-notation-and-c">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-notation-and-c" class="section-name selfRef">Requirements Notation and Conventions</a>
        </h3>
<p id="section-1.1-1">
          The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
          "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL"
          in this document are to be interpreted as described in
          BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span>
   when, and only when, they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">
   All uses of JSON Web Signature (JWS) <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>
   and JSON Web Encryption (JWE) <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>
   data structures in this specification utilize
   the JWS Compact Serialization or the JWE Compact Serialization;
   the JWS JSON Serialization and the JWE JSON Serialization are not used.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Terminology">
<section id="section-1.2">
        <h3 id="name-terminology">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.2-1">
          This specification uses the terms "Claim",
          "Claim Name", "Claim Value", "JSON Web Token (JWT)", and "JWT Claims Set"
          defined by <span><a href="#RFC7519" class="internal xref">JSON Web Token (JWT)</a> [<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>,
          the terms "OpenID Provider (OP)" and "Relying Party (RP)" defined
          by <span><a href="#OpenID.Core" class="internal xref">OpenID Connect Core 1.0</a> [<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>, and
   the terms "Authorization Endpoint", "Authorization Server (AS)",
   "Client", "Client Authentication", "Client Identifier", "Client Secret",
   "Grant Type", "Protected Resource", "Redirection URI", "Refresh Token",
   "Resource Server (RS)", and "Token Endpoint"
   defined by <span><a href="#RFC6749" class="internal xref">OAuth 2.0</a> [<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">
          This specification also defines the following terms:<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-1.2-3">
          <dt id="section-1.2-3.1">Entity</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.2">
              Something that has a separate and distinct existence and that can
              be identified in a context.<a href="#section-1.2-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.3">Entity Identifier</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.4">
              A globally unique string identifier that is bound to one Entity.
       All Entity Identifiers defined by this specification are
       URLs that use the <code>https</code> scheme,
       have a host component, and MAY contain port and path components.
       It MUST NOT contain query parameter or fragment components.
       Profiles of this specification MAY define other kinds of
       Entity Identifiers and processing rules that accompany them.<a href="#section-1.2-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.5">Trust Anchor</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.6">
              An Entity that represents a trusted third party.<a href="#section-1.2-3.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.7">Federation Entity</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.8">
              An Entity for which it is possible to construct a Trust Chain
              from the Entity to a Trust Anchor.<a href="#section-1.2-3.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.9">Entity Statement</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.10">
              A signed JWT that contains the information needed
              for an Entity to participate in federation(s),
              including metadata about itself
              and policies that apply to other Entities for which it is authoritative.<a href="#section-1.2-3.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.11">Entity Configuration</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.12">
              An Entity Statement issued by an Entity about itself. It contains
              the Entity's signing keys and further data used to control the
              Trust Chain resolution process, such as authority hints.<a href="#section-1.2-3.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.13">Subordinate Statement</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.14">
              An Entity Statement issued by a Superior Entity about
       an Entity that is its Immediate Subordinate.<a href="#section-1.2-3.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.15">Entity Type</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.16">
              A role and function that an Entity plays
              within a federation. An Entity MUST be of at
              least one type and MAY be of many types.
              For example, an Entity can be both an OpenID Provider
              and Relying Party at the same time.<a href="#section-1.2-3.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.17">Entity Type Identifier</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.18">
              String identifier for an Entity Type.<a href="#section-1.2-3.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.19">Federation Operator</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.20">
              An organization that is authoritative for a federation.
              A federation operator administers the Trust Anchor(s) for Entities in its federation.<a href="#section-1.2-3.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.21">Intermediate Entity</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.22">
              An Entity that issues
              an Entity Statement appearing somewhere in between those
              issued by the Trust Anchor and the subject of a Trust Chain
       (which is typically a Leaf Entity).
              The terms Intermediate Entity and Intermediate are used
              interchangeably in this specification.<a href="#section-1.2-3.22" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.23">Leaf Entity</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.24">
       An Entity with no Subordinate Entities.
       Leaf Entities typically play a protocol role,
       such as an OpenID Connect Relying Party or OpenID Provider.
       The terms Leaf Entity and Leaf
       are used interchangeably in this specification.<a href="#section-1.2-3.24" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.25">Subordinate Entity</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.26">
       An Entity that is somewhere below a Superior Entity
       (a Trust Anchor or Intermediate) in the trust hierarchy,
       possibly with Intermediates between them.
       The terms Subordinate Entity and Subordinate
       are used interchangeably in this specification.<a href="#section-1.2-3.26" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.27">Superior Entity</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.28">
       An Entity that is somewhere above one or more Entities
       (a Leaf or Intermediate) in the trust hierarchy,
       possibly with Intermediates between them.
       The terms Superior Entity and Superior
       are used interchangeably in this specification.<a href="#section-1.2-3.28" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.29">Immediate Subordinate Entity</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.30">
       An Entity that is immediately below a Superior Entity
       in the trust hierarchy, with no Intermediates between them.
       The terms Immediate Subordinate Entity and Immediate Subordinate
       are used interchangeably in this specification.<a href="#section-1.2-3.30" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.31">Immediate Superior Entity</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.32">
       An Entity that is immediately above one or more Subordinate Entities
       in the trust hierarchy, with no Intermediates between them.
       The terms Immediate Superior Entity and Immediate Superior
       are used interchangeably in this specification.<a href="#section-1.2-3.32" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.33">Federation Entity Discovery</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.34">
              A process that starts with the Entity Identifier
       for the subject of the Trust Chain and collects
              Entity Statements until the chosen Trust Anchor is reached.
              From the collected Entity Statements, a Trust Chain
              is constructed and verified.
              The result of the Federation Entity Discovery is that the
              metadata for the Trust Chain subject is constructed from the Trust Chain.<a href="#section-1.2-3.34" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.35">Trust Chain</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.36">
              A sequence of Entity Statements that represents a chain
              starting at an Entity Configuration that is the subject of the chain
       (typically of a Leaf Entity) and ending in a Trust Anchor.<a href="#section-1.2-3.36" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.37">Trust Mark</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.38">
              Statement of conformance to a
              well-scoped set of trust and/or interoperability requirements
              as determined by an accreditation authority.
              Each Trust Mark has a Trust Mark type identifier.<a href="#section-1.2-3.38" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.39">Trust Mark Issuer</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.40">
              A Federation Entity that issues Trust Marks.<a href="#section-1.2-3.40" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.41">Trust Mark Owner</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.42">
              An Entity that owns the right to a Trust Mark type identifier.<a href="#section-1.2-3.42" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.43">Federation Entity Keys</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.44">
              Keys used for the cryptographic signatures required by
              the trust mechanisms defined in this specification.
              Every participant in a Federation publishes its public
              Federation Entity Keys in its Entity Configuration.<a href="#section-1.2-3.44" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.45">Resolved Metadata</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.46">
              The metadata that results from applying the metadata policy
              in the Trust Chain to the metadata in the Entity Configuration
              for the subject of the Trust Chain. The Resolved Metadata
              is the metadata that is used when interacting with
              the Entity.<a href="#section-1.2-3.46" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="architecture">
<section id="section-2">
      <h2 id="name-overall-architecture">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-overall-architecture" class="section-name selfRef">Overall Architecture</a>
      </h2>
<p id="section-2-1">
        The basic component is the Entity Statement, which is a cryptographically
        signed <span><a href="#RFC7519" class="internal xref">JSON Web Token (JWT)</a> [<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.
        A set of Entity Statements can form a path from an Entity
 (typically a Leaf Entity) to
        a Trust Anchor. Entity Configurations
        issued by Entities about themselves control the Trust Chain
        resolution process.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">
        The Entity Configuration of a Leaf or Intermediate Entity contains one or more
        references to its Immediate Superiors in the
 <code>authority_hints</code> parameter
 described in <a href="#authority_hints" class="auto internal xref">Section 3.1.2</a>.
        These references can be used to download the Entity Configuration of each Immediate Superior.
        One or more Entity Configurations are traversed during the Federation Entity Discovery
        until the Trust Anchor is reached.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">
        The Trust Anchor and its Intermediates issue Entity Statements
        about their Immediate Subordinate Entities called Subordinate Statements.
 The sequence of Entity Configurations
        and Subordinate Statements that validate the relationship between
        a Superior and a Subordinate, along a path towards the Trust Anchor,
        forms the proof that the subject of Trust Chain
 (typically a Leaf Entity) is a member of
        the federation rooted at the Trust Anchor.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">
        The Trust Chain that links the Entity Configurations to one another
 is verified with the signature of each Entity Configuration,
 as described in <a href="#trust_chain" class="auto internal xref">Section 4</a>.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">
        Once there is a verified Trust Chain, the federation policy is applied
        and the metadata for the Trust Chain subject
 within the Federation is derived,
        as described in <a href="#federation_policy" class="auto internal xref">Section 6</a>.<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">
        This specification deals with trust operations;
        it does not cover or touch operations of specific protocols
 using the trust operations,
        other than enabling metadata derivation and exchange for use by those protocols.<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7">
        OpenID Connect constructs are used in many of the examples in this
        specification, however this does not mean that this specification can only be used
        with OpenID Connect. On the contrary, it can also be
        used to build federations for other protocols.<a href="#section-2-7" class="pilcrow">¶</a></p>
<div id="CryptographicTrustMechanism">
<section id="section-2.1">
        <h3 id="name-cryptographic-trust-mechani">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-cryptographic-trust-mechani" class="section-name selfRef">Cryptographic Trust Mechanism</a>
        </h3>
<p id="section-2.1-1">
   The objects defined by this specification
   that are used to establish cryptographic trust between participants
   are secured as signed JWTs using public key cryptography.
   In particular, the keys used for securing these objects are managed by
   the Entities controlling those objects, with the public keys securing them
   being distributed through those objects themselves.
   This kind of trust mechanism has been utilized by
   research and academic federations for over a decade.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">
   Note that this cryptographic trust mechanism intentionally does not rely on
   Web PKI / TLS <span>[<a href="#RFC9525" class="cite xref">RFC9525</a>]</span> certificates for signing keys.
   Which TLS certificates are considered trusted can vary considerably between systems
   depending upon which certificate authorities are considered trusted
   and there have been notable examples of ostensibly trusted certificates being compromised.
   For those reasons, this specification explicitly eschews reliance on Web PKI
   in favor of self-managed public keys, in this case,
   keys represented as JSON Web Keys (JWKs) <span>[<a href="#RFC7517" class="cite xref">RFC7517</a>]</span>.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="entity-statement">
<section id="section-3">
      <h2 id="name-entity-statement">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-entity-statement" class="section-name selfRef">Entity Statement</a>
      </h2>
<p id="section-3-1">
          An Entity Statement contains the information needed for the Entity
          that is the subject of the Entity Statement to participate in federation(s).
          An Entity Statement is a signed JWT.
          The subject of the JWT is the Entity itself.
          The issuer of the JWT is the party that issued the Entity Statement.
          All Entities in a federation publish an Entity Statement about themselves
          called an Entity Configuration.
          Superior Entities in a federation publish Entity Statements about
          their Immediate Subordinate Entities called Subordinate Statements.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">
          Entity Statement JWTs MUST be explicitly typed, by setting the
          <code>typ</code> header parameter to
          <code>entity-statement+jwt</code> to prevent
          cross-JWT confusion, per Section 3.11 of <span>[<a href="#RFC8725" class="cite xref">RFC8725</a>]</span>.
          Entity Statements without a <code>typ</code> header parameter
          or with a different <code>typ</code> value MUST be rejected.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">
          The Entity Statement is signed using one of the private keys of the issuer
          Entity in the form of a <span><a href="#RFC7515" class="internal xref">JSON Web Signature
          (JWS)</a> [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.
          Implementations SHOULD support signature verification with
          the RSA SHA-256 algorithm because OpenID Connect Core
          requires support for it (<code>alg</code>
          value of <code>RS256</code>).
          Federations MAY also specify different mandatory-to-implement algorithms.
          Note that a Trust Chain can contain Entity Statements signed using different
          signing algorithms, as long as each signature uses a signature algorithm
          supported by the trust framework and implementations in use.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">
   Entity Statement JWTs MUST include the
   <code>kid</code> (Key ID) header parameter
   with its value being the Key ID of the signing key used.<a href="#section-3-4" class="pilcrow">¶</a></p>
<div id="ESClaims">
<section id="section-3.1">
        <h3 id="name-entity-statement-claims">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-entity-statement-claims" class="section-name selfRef">Entity Statement Claims</a>
        </h3>
<p id="section-3.1-1">
          The Claims in an Entity Statement are listed below.
          Applications and protocols utilizing Entity Statements MAY specify
          and use additional Claims.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div id="common-claims">
<section id="section-3.1.1">
          <h4 id="name-claims-that-must-or-may-app">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-claims-that-must-or-may-app" class="section-name selfRef">Claims that MUST or MAY Appear in both Entity Configurations and Subordinate Statements</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-3.1.1-1">
            <dt id="section-3.1.1-1.1">iss</dt>
            <dd style="margin-left: 1.5em" id="section-3.1.1-1.2">
              REQUIRED. The Entity Identifier of the issuer of
              the Entity Statement.
       If the <code>iss</code> and
              the <code>sub</code> are identical,
       the issuer is making an Entity Statement about itself
       called an Entity Configuration.<a href="#section-3.1.1-1.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.1.1-1.3">sub</dt>
            <dd style="margin-left: 1.5em" id="section-3.1.1-1.4">
              REQUIRED. The Entity Identifier of the subject.<a href="#section-3.1.1-1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.1.1-1.5">iat</dt>
            <dd style="margin-left: 1.5em" id="section-3.1.1-1.6">
              REQUIRED. Number. Time when this statement was issued.
                This is expressed as Seconds Since the Epoch, per
                <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-3.1.1-1.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.1.1-1.7">exp</dt>
            <dd style="margin-left: 1.5em" id="section-3.1.1-1.8">
              REQUIRED. Number.
              Expiration time after which the statement MUST NOT be
              accepted for processing. This is expressed as Seconds
              Since the Epoch, per <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-3.1.1-1.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.1.1-1.9">jwks</dt>
            <dd style="margin-left: 1.5em" id="section-3.1.1-1.10">
              <p id="section-3.1.1-1.10.1">
       REQUIRED for all Subordinate Statements,
       REQUIRED for all Entity Configurations of Trust Anchors and Intermediate Entities,
       and also REQUIRED for all Entity Configurations of Leaf Entities
       not using a profile permitting it to be absent.
       Its value is a <span><a href="#RFC7517" class="internal xref">JSON Web Key Set (JWKS)</a> [<a href="#RFC7517" class="cite xref">RFC7517</a>]</span>
              representing the public part of the subject's Federation Entity
              signing keys. The corresponding private key is
              used by the Entity to sign the Entity Configuration about itself,
              by Trust Anchors and Intermediate Entities
       to sign Subordinate Statements about their Immediate Subordinates,
       and for other signatures made by Federation Entities,
       such as Trust Mark signatures.
              Every JWK in the JWK Set MUST have a unique <code>kid</code> (Key ID) value.
              It is RECOMMENDED that the Key ID be the JWK Thumbprint <span>[<a href="#RFC7638" class="cite xref">RFC7638</a>]</span>
              using the SHA-256 hash function of the key.<a href="#section-3.1.1-1.10.1" class="pilcrow">¶</a></p>
<p id="section-3.1.1-1.10.2">
       These Federation Entity Keys SHOULD NOT be used in other protocols.
       (Keys to be used in other protocols, such as OpenID Connect,
       are conveyed in the <code>metadata</code> elements
       for the protocol's Entity Type Identifiers,
       such as the metadata under the
       <code>openid_provider</code> and
       <code>openid_relying_party</code>
       Entity Type Identifiers,
       which are defined in <span>[<a href="#OpenID.Federation.Connect-1.1" class="cite xref">OpenID.Federation.Connect-1.1</a>]</span>.)<a href="#section-3.1.1-1.10.2" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.1.1-1.11">metadata</dt>
            <dd style="margin-left: 1.5em" id="section-3.1.1-1.12">
              <p id="section-3.1.1-1.12.1">
              OPTIONAL.
              JSON object that declares roles that the Entity plays -
              its Entity Types - and that contains metadata for those Entity Types.
              Each member name of the JSON
              object is an Entity Type Identifier, and each value MUST be a JSON
              object containing metadata parameters according to the metadata
              schema of the Entity Type.<a href="#section-3.1.1-1.12.1" class="pilcrow">¶</a></p>
<p id="section-3.1.1-1.12.2">
              When an Entity participates in a federation or federations with
              one or more Entity Types, its Entity Configuration MUST contain a
              <code>metadata</code> Claim with JSON object values
              for each of the corresponding Entity Type Identifiers, even if the
              values are the empty JSON object <code>{}</code>
              (when the Entity Type has no associated metadata or Immediate
              Superiors supply any needed metadata).<a href="#section-3.1.1-1.12.2" class="pilcrow">¶</a></p>
<p id="section-3.1.1-1.12.3">
              An Immediate Superior MAY provide selected or all metadata
              parameters for an Immediate Subordinate, by using the
              <code>metadata</code> Claim in a Subordinate
              Statement. When <code>metadata</code> is used in a
              Subordinate Statement, it applies only to those Entity Types that
              are present in the subject's Entity Configuration. Furthermore,
              the metadata applies only to the subject of the Subordinate
              Statement and has no effect on the subject's Subordinates.
              Metadata parameters in a Subordinate Statement have precedence and
              override identically named parameters under the same Entity Type
              in the subject's Entity Configuration. If both
              <code>metadata</code> and
              <code>metadata_policy</code> appear in a
              Subordinate Statement, then the stated
              <code>metadata</code> MUST be applied before the
              <code>metadata_policy</code>, as described in
              <a href="#metadata_policy_application" class="auto internal xref">Section 6.1.4.2</a>.<a href="#section-3.1.1-1.12.3" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.1.1-1.13">crit</dt>
            <dd style="margin-left: 1.5em" id="section-3.1.1-1.14">
              OPTIONAL.
       Entity Statements require that
       the <code>crit</code> (critical) Claim
       defined in <a href="#critClaim" class="auto internal xref">Section 13.4</a> be understood and processed.
       Claims in the Entity Statement whose Claim Names are in the array
       that is the value of this Claim MUST be understood and processed.
       Claims specified for use in Entity Statements by this specification
       MUST NOT be included in the list.<a href="#section-3.1.1-1.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="ec-specific">
<section id="section-3.1.2">
          <h4 id="name-claims-that-must-or-may-appe">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-claims-that-must-or-may-appe" class="section-name selfRef">Claims that MUST or MAY Appear in Entity Configurations but Not in Subordinate Statements</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-3.1.2-1">
            <dt id="section-3.1.2-1.1">authority_hints</dt>
            <dd id="section-3.1.2-1.2" style="margin-left: 1.5em">
<div id="authority_hints">
              OPTIONAL. An array of strings representing
              the Entity Identifiers of Intermediate Entities or Trust Anchors
              that are Immediate Superiors of the Entity.
              This Claim is REQUIRED in Entity Configurations of
              the Entities that have at least one Superior above them,
              such as Leaf and Intermediate Entities.
              Its value MUST contain the Entity Identifiers of
       its Immediate Superiors and
       MUST NOT be the empty array
              <code>[]</code>.
              This Claim MUST NOT be present in Entity Configurations
              of Trust Anchors with no Superiors.<a href="#authority_hints" class="pilcrow">¶</a>
</div>
            </dd>
<dd class="break"></dd>
<dt id="section-3.1.2-1.3">trust_anchor_hints</dt>
            <dd id="section-3.1.2-1.4" style="margin-left: 1.5em">
<div id="trust_anchor_hints">
              OPTIONAL. An array of strings representing
              the Entity Identifiers of Trust Anchors
              trusted by the Entity.
              Its value MUST NOT be the empty array
              <code>[]</code>.
              This Claim MUST NOT be present in Entity Configurations
              of Trust Anchors with no Superiors.<a href="#trust_anchor_hints" class="pilcrow">¶</a>
</div>
            </dd>
<dd class="break"></dd>
<dt id="section-3.1.2-1.5">trust_marks</dt>
            <dd style="margin-left: 1.5em" id="section-3.1.2-1.6">
              <p id="section-3.1.2-1.6.1">
              OPTIONAL. An array of JSON objects, each representing
              a Trust Mark.<a href="#section-3.1.2-1.6.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.1.2-1.6.2">
                <dt id="section-3.1.2-1.6.2.1">trust_mark_type</dt>
                <dd style="margin-left: 1.5em" id="section-3.1.2-1.6.2.2">
                  REQUIRED. Identifier for the type of the Trust Mark.
                  The value of this Claim MUST be the same as the value of the
                  <code>trust_mark_type</code>
                  Claim contained in the Trust Mark JWT that is the value of the
               <code>trust_mark</code> Claim in this object.<a href="#section-3.1.2-1.6.2.2" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-3.1.2-1.6.2.3">trust_mark</dt>
                <dd style="margin-left: 1.5em" id="section-3.1.2-1.6.2.4">
                  REQUIRED. A signed JSON Web Token that represents a Trust Mark.<a href="#section-3.1.2-1.6.2.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
<p id="section-3.1.2-1.6.3">
              Trust Marks are described in <a href="#trust_marks" class="auto internal xref">Section 7</a>.<a href="#section-3.1.2-1.6.3" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.1.2-1.7">trust_mark_issuers</dt>
            <dd style="margin-left: 1.5em" id="section-3.1.2-1.8">
              OPTIONAL.
              A Trust Anchor MAY use this Claim to tell which combination of
              Trust Mark type identifiers and issuers are trusted by the federation.
              This Claim MUST be ignored if present in an Entity Configuration
              for an Entity that is not a Trust Anchor.
              It is a JSON object with member names that are Trust Mark type identifiers and
              each corresponding value being an array of Entity Identifiers
              that are trusted to represent the accreditation authority
              for Trust Marks with that identifier.
              If the array following a Trust Mark type identifier is empty,
              anyone MAY issue Trust Marks with that identifier.
              Trust Marks are described in <a href="#trust_marks" class="auto internal xref">Section 7</a>.<a href="#section-3.1.2-1.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.1.2-1.9">trust_mark_owners</dt>
            <dd style="margin-left: 1.5em" id="section-3.1.2-1.10">
              <p id="section-3.1.2-1.10.1">
              OPTIONAL.
              If a Federation Operator knows that a Trust Mark type identifier is owned
              by an Entity different from the Trust Mark Issuer, then that
              knowledge MUST be expressed in this Claim.
              This Claim MUST be ignored if present in an Entity Configuration
              for an Entity that is not a Trust Anchor.
              It is a JSON object with member names that are Trust Mark type identifiers and
              each corresponding value being a JSON object with these members:<a href="#section-3.1.2-1.10.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.1.2-1.10.2">
                <dt id="section-3.1.2-1.10.2.1">sub</dt>
                <dd style="margin-left: 1.5em" id="section-3.1.2-1.10.2.2">
                  REQUIRED
                  Identifier of the Trust Mark Owner.<a href="#section-3.1.2-1.10.2.2" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-3.1.2-1.10.2.3">jwks</dt>
                <dd style="margin-left: 1.5em" id="section-3.1.2-1.10.2.4">
                  REQUIRED
                  <span><a href="#RFC7517" class="internal xref">JSON Web Key Set (JWKS)</a> [<a href="#RFC7517" class="cite xref">RFC7517</a>]</span>
                  containing the owner's Federation Entity Keys used for signing.<a href="#section-3.1.2-1.10.2.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
<p id="section-3.1.2-1.10.3">
       Other members MAY also be defined and used.<a href="#section-3.1.2-1.10.3" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="ss-specific">
<section id="section-3.1.3">
          <h4 id="name-claims-that-must-or-may-appea">
<a href="#section-3.1.3" class="section-number selfRef">3.1.3. </a><a href="#name-claims-that-must-or-may-appea" class="section-name selfRef">Claims that MUST or MAY Appear in Subordinate Statements but Not in Entity Configurations</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-3.1.3-1">
            <dt id="section-3.1.3-1.1">constraints</dt>
            <dd style="margin-left: 1.5em" id="section-3.1.3-1.2">
              OPTIONAL. JSON object that defines Trust Chain constraints, as
              described in <a href="#chain_constraints" class="auto internal xref">Section 6.2</a>. The constraints apply to the
              Entity that is the subject of this Subordinate Statement as well
              as to all Entities that are Subordinate to it.<a href="#section-3.1.3-1.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.1.3-1.3">metadata_policy</dt>
            <dd style="margin-left: 1.5em" id="section-3.1.3-1.4">
              OPTIONAL. JSON object that defines a metadata policy, as described
              in <a href="#metadata_policy" class="auto internal xref">Section 6.1</a>. The metadata policy applies to the Entity
              that is the subject of this Subordinate Statement as well as to
              all Entities that are Subordinate to it. Applying to Subordinate
              Entities distinguishes <code>metadata_policy</code>
              from <code>metadata</code>, which only applies to
              the subject itself.<a href="#section-3.1.3-1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.1.3-1.5">metadata_policy_crit</dt>
            <dd style="margin-left: 1.5em" id="section-3.1.3-1.6">
              OPTIONAL.
              Array of strings specifying critical metadata policy operators
              other than the standard ones defined in
              <a href="#standard_metadata_policy_operators" class="auto internal xref">Section 6.1.3.1</a> that MUST be
              understood and processed. When included its value MUST NOT be the empty array
              <code>[]</code>. If any of the listed policy
              operators are not understood and supported, then the Subordinate
              Statement and thus the Trust Chain that includes it MUST be
              considered invalid.<a href="#section-3.1.3-1.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.1.3-1.7">source_endpoint</dt>
            <dd style="margin-left: 1.5em" id="section-3.1.3-1.8">
              OPTIONAL. String containing the fetch endpoint URL
              from which the Entity Statement was issued,
              as specified in <a href="#fetch_endpoint" class="auto internal xref">Section 8.1</a>.
              This parameter enables an optimized refresh of the Subordinate Statements
       and hence the Trust Chain, by skipping the
              request to the Entity Configuration
              that is normally required to discover the
              <code>federation_fetch_endpoint</code>
              of the issuing authority.
              If an Entity Statement cannot be retrieved from the
       <code>source_endpoint</code>,
       which can occur if the endpoint URL has changed,
       the current <code>federation_fetch_endpoint</code>
       location can be determined by retrieving
       the Entity Configuration of the issuer.<a href="#section-3.1.3-1.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="ESValidation">
<section id="section-3.2">
        <h3 id="name-entity-statement-validation">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-entity-statement-validation" class="section-name selfRef">Entity Statement Validation</a>
        </h3>
<p id="section-3.2-1">
     Entity Statements MUST be validated in the following manner.
     These steps MAY be performed in a different order, provided that
     the result - accepting or rejecting the Entity Statement - is the same.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2-2">
<li id="section-3.2-2.1">
            <p id="section-3.2-2.1.1">
 The Entity Statement MUST be a signed JWT.<a href="#section-3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.2">
            <p id="section-3.2-2.2.1">
 The Entity Statement MUST have a
 <code>typ</code> header parameter with the value
 <code>entity-statement+jwt</code>.<a href="#section-3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.3">
            <p id="section-3.2-2.3.1">
 The Entity Statement MUST have an
 <code>alg</code> (algorithm) header parameter
 with a value that is an acceptable JWS signing algorithm;
 it MUST NOT be <code>none</code>.<a href="#section-3.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.4">
            <p id="section-3.2-2.4.1">
 The Entity Identifier of the Entity to which the Entity Statement refers
 MUST match the value of the
 <code>sub</code> (subject) Claim.<a href="#section-3.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.5">
            <p id="section-3.2-2.5.1">
 The Entity Statement MUST have an
 <code>iss</code> (issuer) Claim
 with a value that is a valid Entity Identifier.<a href="#section-3.2-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.6">
            <p id="section-3.2-2.6.1">
 When the <code>iss</code> (issuer) Claim Value
 matches the <code>sub</code> (subject) Claim Value,
 then the Entity Statement is this Entity's Entity Configuration.
 When they do not match, the Entity Statement is a Subordinate Statement.
 When the Entity Statement is a Subordinate Statement,
 the <code>iss</code> Claim Value MUST match
 one of the values in the
 <code>authority_hints</code> array
 in the Entity Configuration for the Entity whose Entity Identifier
 is the value of the <code>sub</code> Claim;
 otherwise, the Federation graph is not well-formed.<a href="#section-3.2-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.7">
            <p id="section-3.2-2.7.1">
 The current time MUST be after the time represented by the
 <code>iat</code> (issued at) Claim
 (possibly allowing for some small leeway to account for clock skew).<a href="#section-3.2-2.7.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.8">
            <p id="section-3.2-2.8.1">
 The current time MUST be before the time represented by the
 <code>exp</code> (expiration) Claim
 (possibly allowing for some small leeway to account for clock skew).<a href="#section-3.2-2.8.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.9">
            <p id="section-3.2-2.9.1">
 The <code>jwks</code> (JWK Set) Claim
 MUST be present, with a value that is a valid
 JWK Set <span>[<a href="#RFC7517" class="cite xref">RFC7517</a>]</span>.<a href="#section-3.2-2.9.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.10">
            <p id="section-3.2-2.10.1">
 Obtain the Entity Configuration for the issuing Entity -
 the Entity with the Issuer Identifier found in the Entity Statement's
 <code>iss</code> (issuer) Claim.
 When the <code>iss</code> and
 <code>sub</code> Claim Values match, this is
 the Entity Statement being validated itself.
 Otherwise, this can be obtained either from a Trust Chain or
 by retrieving it as described in
 <a href="#federation_configuration" class="auto internal xref">Section 9</a>.<a href="#section-3.2-2.10.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.11">
            <p id="section-3.2-2.11.1">
 The Entity Statement's
 <code>kid</code> (Key ID) header parameter value
 MUST be a non-zero length string and
 MUST exactly match the <code>kid</code> value
 for a key in the <code>jwks</code> (JWK Set) Claim
 of the Entity Configuration of the issuing Entity.<a href="#section-3.2-2.11.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.12">
            <p id="section-3.2-2.12.1">
 The Entity Statement's signature MUST validate using
 the issuing Entity's key identified by the
 <code>kid</code> value.<a href="#section-3.2-2.12.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.13">
            <p id="section-3.2-2.13.1">
 If the <code>crit</code> Claim is present,
 then each array element in this Claim's value
 MUST be a string representing an Entity Statement Claim
 that is not defined by this specification
 and that Claim MUST be understood
 and be able to be processed by the implementation.<a href="#section-3.2-2.13.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.14">
            <p id="section-3.2-2.14.1">
 If the <code>authority_hints</code> Claim is present,
 the Entity Statement MUST be an Entity Configuration.
 Verify that its value is syntactically correct,
 as specified in <a href="#authority_hints" class="auto internal xref">Section 3.1.2</a>.
 Implementations MAY also validate that the Entity is a Subordinate
 of each Entity whose Entity Identifier is listed in the
 <code>authority_hints</code> array.<a href="#section-3.2-2.14.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.15">
            <p id="section-3.2-2.15.1">
 If the <code>trust_anchor_hints</code> Claim is present,
 the Entity Statement MUST be an Entity Configuration.
 Verify that its value is syntactically correct,
 as specified in <a href="#trust_anchor_hints" class="auto internal xref">Section 3.1.2</a>.<a href="#section-3.2-2.15.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.16">
            <p id="section-3.2-2.16.1">
 If the <code>metadata</code> Claim is present,
 verify that its value is syntactically correct,
 not using <code>null</code> as metadata values,
 as specified in <a href="#metadata" class="auto internal xref">Section 5</a>.<a href="#section-3.2-2.16.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.17">
            <p id="section-3.2-2.17.1">
 If the <code>metadata_policy</code> Claim is present,
 the Entity Statement MUST be a Subordinate Statement.
 Verify that its value is syntactically correct,
 as specified in <a href="#metadata_policy" class="auto internal xref">Section 6.1</a>.<a href="#section-3.2-2.17.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.18">
            <p id="section-3.2-2.18.1">
 If the <code>metadata_policy_crit</code> Claim is present,
 the Entity Statement MUST be a Subordinate Statement.
 Each array element in this Claim's value
 MUST be a string representing a Metadata Policy operator
 that is not defined by this specification
 and that operator MUST be understood
 and be able to be processed by the implementation.<a href="#section-3.2-2.18.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.19">
            <p id="section-3.2-2.19.1">
 If the <code>constraints</code> Claim is present,
 the Entity Statement MUST be a Subordinate Statement.
 Verify that its value is syntactically correct,
 as specified in <a href="#chain_constraints" class="auto internal xref">Section 6.2</a>.<a href="#section-3.2-2.19.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.20">
            <p id="section-3.2-2.20.1">
 If the <code>trust_marks</code> Claim is present,
 the Entity Statement MUST be an Entity Configuration.
 Validate that the syntax of this Claim Value conforms to the
 Claim definition.
 In particular, for each element of the array that is the Claim Value,
 validate that there is a <code>trust_mark_type</code>
 member whose value matches the
 <code>trust_mark_type</code> Claim Value in the
 Trust Mark JWT that is the value of the
 <code>trust_mark</code> member.
 Validating the syntax is separate from evaluating whether particular
 Trust Marks are issued by a trusted party and are trusted;
 that process is described in <a href="#trust-mark-validation" class="auto internal xref">Section 7.3</a>
 and MAY be performed as a separate step from syntactic validation.<a href="#section-3.2-2.20.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.21">
            <p id="section-3.2-2.21.1">
 If the <code>trust_mark_issuers</code> Claim is present,
 the Entity Statement MUST be an Entity Configuration.
 Validate that its Claim Value is a JSON object with
 Trust Mark type identifiers as the member names and
 arrays of Entity Identifiers as the values.<a href="#section-3.2-2.21.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.22">
            <p id="section-3.2-2.22.1">
 If the <code>trust_mark_owners</code> Claim is present,
 the Entity Statement MUST be an Entity Configuration.
 Validate that its Claim Value is a JSON object with
 Trust Mark type identifiers as the member names and
 values that are JSON objects containing
 a <code>sub</code> member with a value that is
 an Entity Identifier and
 a <code>jwks</code> member with a value that is
 a JSON Web Key Set.<a href="#section-3.2-2.22.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.23">
            <p id="section-3.2-2.23.1">
 If the <code>source_endpoint</code> Claim is present,
 the Entity Statement MUST be a Subordinate Statement.
 Validate that its Claim Value is a URL.
 Implementations MAY also make a fetch call to the URL
 to validate that this is the fetch endpoint
 from which the Entity Statement was issued.<a href="#section-3.2-2.23.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.24">
            <p id="section-3.2-2.24.1">
 If the <code>trust_chain</code> header parameter is present,
 validate that its value is a syntactically valid Trust Chain,
 as specified in <a href="#trust_chain" class="auto internal xref">Section 4</a>.
 The first entry in the Trust Chain
 MUST be an Entity Configuration for this Entity.
 Implementations SHOULD validate that the Entity Identifier
 for the Trust Anchor at the end of the Trust Chain matches
 one of the Trust Anchors configured for the deployment.<a href="#section-3.2-2.24.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.25">
            <p id="section-3.2-2.25.1">
 If the <code>peer_trust_chain</code> header parameter is present,
 validate that its value is a syntactically valid Trust Chain,
 as specified in <a href="#trust_chain" class="auto internal xref">Section 4</a>.
 Implementations SHOULD validate that the Entity Identifier
 for the Trust Anchor at the end of the Trust Chain matches
 one of the Trust Anchors configured for the deployment.<a href="#section-3.2-2.25.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-3.2-3">
     If any of these validation steps fail,
     the Entity Statement MUST be rejected.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="es_example">
<section id="section-3.3">
        <h3 id="name-entity-statement-example">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-entity-statement-example" class="section-name selfRef">Entity Statement Example</a>
        </h3>
<p id="section-3.3-1" class="keepWithNext">
            The following is a non-normative example of the JWT Claims Set for an Entity Statement.
            The example contains
            a critical extension <code>jti</code> (JWT ID) to the
            Entity Statement and one critical extension to the policy language
            <code>regexp</code>
            (Regular expression).<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<span id="name-example-entity-statement-jw"></span><figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-3.3-2.1">
<pre>
{
  "iss": "https://feide.no",
  "sub": "https://ntnu.no",
  "iat": 1516239022,
  "exp": 1516843822,
  "jwks": {
    "keys": [
      {
        "kty": "RSA",
        "alg": "RS256",
        "use": "sig",
        "kid": "NzbLsXh8uDCcd-6MNwXF4W_7noWXFZAfHkxZsRGC9Xs",
        "n": "vHOJrp-zLST7FwvzAwelR9Vo...",
        "e": "AQAB"
      }
    ]
  },
  "metadata": {
    "openid_provider": {
      "issuer": "https://ntnu.no",
      "organization_name": "NTNU"
    },
    "oauth_client": {
      "organization_name": "NTNU"
    }
  },
  "metadata_policy": {
    "openid_provider": {
      "id_token_signing_alg_values_supported":
        {"subset_of": ["RS256", "RS384", "RS512"]},
      "op_policy_uri": {
        "regexp":
          "^https:\/\/[\\w-]+\\.example\\.com\/[\\w-]+\\.html"}
    },
    "oauth_client": {
      "grant_types": {
        "one_of": ["authorization_code", "client_credentials"]
      }
    }
  },
  "constraints": {
    "max_path_length": 2
  },
  "crit": ["jti"],
  "metadata_policy_crit": ["regexp"],
  "source_endpoint": "https://feide.no/federation_api/fetch",
  "jti": "7l2lncFdY6SlhNia"
}
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-example-entity-statement-jw" class="selfRef">Example Entity Statement JWT Claims Set</a>
          </figcaption></figure>
</section>
</div>
</section>
</div>
<div id="trust_chain">
<section id="section-4">
      <h2 id="name-trust-chain">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-trust-chain" class="section-name selfRef">Trust Chain</a>
      </h2>
<p id="section-4-1">
          Entities whose statements build a Trust Chain are categorized as:<a href="#section-4-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4-2">
        <dt id="section-4-2.1">Trust Anchor</dt>
        <dd style="margin-left: 1.5em" id="section-4-2.2">
              An Entity that represents a trusted third party.<a href="#section-4-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-2.3">Leaf</dt>
        <dd style="margin-left: 1.5em" id="section-4-2.4">
              In an OpenID Connect identity federation, an RP or an OP,
       or in an OAuth 2.0 federation, a Client, Authorization Server, or Protected Resource.<a href="#section-4-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-2.5">Intermediate</dt>
        <dd style="margin-left: 1.5em" id="section-4-2.6">
              Neither a Leaf Entity nor a Trust Anchor.<a href="#section-4-2.6" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-4-3">
          A Trust Chain begins with an Entity Configuration
   that is the subject of the Trust Chain,
   which is typically a Leaf Entity.
          The Trust Chain has zero or more Subordinate Statements
          issued by Intermediates about their Immediate Subordinates,
          and includes the Subordinate Statement issued by the
          Trust Anchor about the top-most Intermediate
          (if there are Intermediates) or the Trust Chain subject
          (if there are no Intermediates).
          The Trust Chain logically always ends with the
          Entity Configuration of the Trust Anchor,
   even though it MAY be omitted from
   the JSON array representing the Trust Chain in some cases.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">
   The Trust Chain contains the configuration of the federation
   as it applies to the Trust Chain subject
          at the time of the evaluation of the chain.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">
          A simple example: If we have an RP that belongs to Organization A
          that is a member of Federation F, the Trust Chain for such a setup
          will contain the following Entity Statements:<a href="#section-4-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4-6">
<li id="section-4-6.1">
          <p id="section-4-6.1.1">
              an Entity Configuration about the RP published by itself,<a href="#section-4-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-6.2">
          <p id="section-4-6.2.1">
              a Subordinate Statement about the RP published by Organization A,<a href="#section-4-6.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-6.3">
          <p id="section-4-6.3.1">
              a Subordinate Statement about Organization A published by the Trust Anchor for F,<a href="#section-4-6.3.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-6.4">
          <p id="section-4-6.4.1">
       an Entity Configuration about the Trust Anchor for F published by itself.<a href="#section-4-6.4.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-4-7">
   Let us refer to the Entity Statements in the Trust Chain as
   ES[j], where j = 0,...,i,
   with 0 being the index of the first Entity Statement
   and i being the zero-based index of the last.
   Then:<a href="#section-4-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-8.1">
          <p id="section-4-8.1.1">
       ES[0] (the Entity Configuration of the Trust Chain subject)
       is signed using a key in ES[0]["jwks"].<a href="#section-4-8.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-8.2">
          <p id="section-4-8.2.1">
       The <code>iss</code> Claim in an Entity Statement
       is equal to the <code>sub</code> Claim in the next.
       Restating this symbolically,
       for each j = 0,...,i-1,
       ES[j]["iss"] == ES[j+1]["sub"].<a href="#section-4-8.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-8.3">
          <p id="section-4-8.3.1">
       An Entity Statement is signed using a key from
       the <code>jwks</code> Claim in the next.
       Restating this symbolically,
       for each j = 0,...,i-1,
       ES[j] is signed by a key in ES[j+1]["jwks"].<a href="#section-4-8.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-8.4">
          <p id="section-4-8.4.1">
       ES[i] (the Trust Anchor's Entity Configuration in the Trust Chain)
       is signed using a key in ES[i]["jwks"].<a href="#section-4-8.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-9">
   The Trust Anchor's public keys are used to verify the signatures on
   ES[i] (the Trust Anchor's Entity Configuration) and
   ES[i-1] (the Trust Anchor's Subordinate Statement about its
   Immediate Subordinate in the Trust Chain).
   The Trust Anchor's public keys are distributed
   to Entities that need to verify a
          Trust Chain in some secure out-of-band way not described in this
          document.<a href="#section-4-9" class="pilcrow">¶</a></p>
<div id="trust-chain-ends">
<section id="section-4.1">
        <h3 id="name-beginning-and-ending-trust-">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-beginning-and-ending-trust-" class="section-name selfRef">Beginning and Ending Trust Chains</a>
        </h3>
<p id="section-4.1-1">
     A Trust Chain begins with the Entity Configuration of an Entity
     for which trust is being established.
     This is the subject of the Trust Chain.
     This Entity typically plays a protocol role,
     such as being an OpenID Provider or OpenID Relying Party.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">
     While such Entities are typically Leaf Entities,
     other topologies are possible.
     For instance, an Entity might simultaneously be an OpenID Provider
     and an Intermediate Entity, with OpenID Relying Parties
     and/or other Intermediates being Subordinate to it.
     This is a case in which the subject of a Trust Chain
     would not be a Leaf Entity.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">
     A Trust Chain ends with the Entity Configuration of a Trust Anchor.
     While Trust Anchors typically have no Superiors,
     a Trust Anchor will have a Superior when the Trust Anchor
     also acts as an Intermediate Entity in another federation.
     This will be the case when there is a hierarchy of federations.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">
     Thus, while it is typical for a Trust Chain to end with
     a Trust Anchor with no Superiors,
     there are situations in which the Trust Chain will end with
     a Trust Anchor that nonetheless has Superior Entities.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trust-chain-example">
<section id="section-4.2">
        <h3 id="name-trust-chain-example">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-trust-chain-example" class="section-name selfRef">Trust Chain Example</a>
        </h3>
<p id="section-4.2-1" class="keepWithNext">
            The following is an example of a Trust Chain consisting of
            a Leaf's Entity Configuration and Subordinate Statements issued
            by an Intermediate Entity and a Trust Anchor. It shows
            the relationship between the three Entities,
     their Entity Configurations, and their Subordinate Statements.
     The Subordinate Statements are obtained from the
            <code>federation_fetch_endpoint</code> of
            the subject's Immediate Superior. The URL of the
            <code>federation_fetch_endpoint</code> is
            discovered in the Immediate Superior's Entity Configuration.
            Note that the first member of the Trust Chain (the Leaf)
            is depicted at the bottom of the diagram and that the last
            member (the Trust Anchor) is depicted at the top.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<span id="name-relationships-between-feder"></span><figure id="figure-3">
          <div class="alignLeft art-text artwork" id="section-4.2-2.1">
<pre>
.----------------.  .---------------------------.         .---------------------------.
| Role           |  | .well-known/              |         | Trust Chain               |
|                |  | openid-federation         |         |                           |
.----------------.  .---------------------------.         .---------------------------.
| .------------. |  | .-----------------------. |         | .-----------------------. |
| |            | |  | | Entity Configuration  | |         | | Entity Configuration  | |
| |Trust Anchor+-+--+-&gt;                       +-+---------+-&gt;                       | |
| |            | |  | | Federation Entity Keys| |         | | Federation Entity Keys| |
| '-----.------' |  | | Metadata              | |         | | Metadata              | |
|       |        |  | | Trust Mark Issuers    | |         | | Trust Mark Issuers    | |
|       |        |  | |                       | |         | |                       | |
|       |        |  | '-----------------------' |         | '-----------------------' |
|       |        |  |                           |         |                           |
|       |        |  |                           |Fetch    | .-----------------------. |
|       |        |  |                           |Endpoint | | Subordinate Statement | |
|       +--------+--+---------------------------+---------+-&gt;                       | |
|                |  |                           |         | | Federation Entity Keys| |
|                |  |                           |         | | Metadata Policy       | |
|                |  |                           |         | | Metadata              | |
|                |  |                           |         | | Constraints           | |
|                |  |                           |         | |                       | |
|                |  |                           |         | '-----------.-----------' |
| .------------. |  | .-----------------------. |         |             |             |
| |            | |  | | Entity Configuration  | |         |             |             |
| |Intermediate+-+--+-&gt;                       | |         |             |sub and key  |
| |            | |  | | Federation Entity Keys| |         |             | binding     |
| '------.-----' |  | | Metadata              | |         | .-----------v-----------. |
|        |       |  | | Trust Marks           | |         | | Subordinate Statement | |
|        |       |  | |                       | |         | |                       | |
|        |       |  | |                       | |         | | Federation Entity Keys| |
|        |       |  | '-----------------------' |Fetch    | | Metadata Policy       | |
|        |       |  |                           |Endpoint | | Metadata              | |
|        +-------+--+---------------------------+---------+-&gt;                       | |
|                |  |                           |         | '-----------.-----------' |
|                |  |                           |         |             |sub and key  |
|                |  |                           |         |             | binding     |
| .------------. |  | .-----------------------. |         | .-----------v-----------. |
| |            | |  | | Entity Configuration  | |         | | Entity Configuration  | |
| | Leaf       +-+--+-&gt;                       +-+---------+-&gt;                       | |
| |            | |  | | Federation Entity Keys| |         | | Federation Entity Keys| |
| '------------' |  | | Metadata              | |         | | Metadata              | |
|                |  | | Trust Marks           | |         | | Trust Marks           | |
|                |  | |                       | |         | |                       | |
|                |  | |                       | |         | |                       | |
|                |  | '-----------------------' |         | '-----------------------' |
'----------------'  '---------------------------'         '---------------------------'

</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-relationships-between-feder" class="selfRef">Relationships between Federation Entities and Statements Issued in a Trust Chain</a>
          </figcaption></figure>
</section>
</div>
<div id="trust_chain_head_param">
<section id="section-4.3">
        <h3 id="name-trust-chain-header-paramete">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-trust-chain-header-paramete" class="section-name selfRef">Trust Chain Header Parameter</a>
        </h3>
<p id="section-4.3-1">
          The <code>trust_chain</code> JWS header parameter is a
          JSON array containing the sequence of Entity Statements
   that comprise the Trust Chain between
   an Entity and the selected Trust Anchor.
   The Trust Chain typically begins with the Entity Configuration
   of the subject of the JWT in which this header parameter occurs;
   however, in some cases, the Trust Chain will begin with
   the Entity Configuration of a different Entity,
   such as the issuer, which is the case for
   the Resolve Response defined in <a href="#resolve-response" class="auto internal xref">Section 8.3.2</a>.
          The issuer of the JWT SHOULD select a Trust Anchor
   that the Entity at the beginning of the Trust Chain
   has in common with the audience of the JWT.
   Otherwise, the issuer is free to select the Trust Anchor to use.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">
          Most signed JWTs MAY include the
          <code>trust_chain</code> JWS header parameter,
          with a few exceptions.
          Entity Configurations and Subordinate Statements MUST NOT
          contain the <code>trust_chain</code> header parameter,
          as they are integral components of a Trust Chain.
          Use of this header parameter is OPTIONAL.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3" class="keepWithNext">
       The following is a non-normative example of a JWS header with
       the <code>trust_chain</code> parameter.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<span id="name-example-jws-header-with-a-t"></span><figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-4.3-4.1">
<pre>
{
  "typ": "...",
  "alg": "RS256",
  "kid": "SUdtUndEWVY2cUFDeDV5NVlBWDhvOXJodVl2am1mNGNtR0pmd",
  "trust_chain": [
    "eyJ0eXAiOiJlbnRpdHktc3RhdGVtZW50K2p3dCIsImFsZyI6IlJTMjU2Iiwia2lkIjoiWjBWRVdtUTRVVFJWZFhNeGRFVnRMVUl3VldWSVRVZDRhekpEVTBrdE5DMXdaWGR2TVRoWWJrTTRUUSJ9.eyJtZXRhZGF0YSI6IHsib3BlbmlkX2NyZWRlbnRpYWxfaXNzdWVyIjogeyJqd2tzIjogeyJrZXlzIjogW3sia3R5IjogIlJTQSIsICJraWQiOiAiUjJSelJYQTBSVkJ5ZHpGT1ZHMWZkV1JUTVRaM1lUUm1ObkUxVjNGZk1FMW9NVVpMZWtsaVkxTllPQSIsICJlIjogIkFRQUIiLCAibiI6ICI1SF9YaDd4Z0RXVHhRVmJKcW1PR3Vyb2tFOGtyMmUxS2dNV2NZT0E3NE9fMVBYZDJ1Z2p5SXE5dDFtVlBTdXd4LXR5U2syUEtwanAtLVdySG4zQTRVS0prdVIxMXpobWRMQnNVOFRPQkJ1NU1aOGF0RHVqZlJ3SUxYZEtzRVhrbHZhQjZQTFQ0emRab2RnQ3MwNUt5MmU1c2I1ejZfQ2lEcWdVVm5XUG1KTE1rZ3BCdFota01kX2xiOVNvb1psbGZVR2xUa3NhdUoyX2dWUS1WcEZVTVhZam9Kak54OTdldWthWW5SRW9DQzNUYV8tOGJjUm9zbHgyeHJJYnVfVUdWcWlwZU4zTlAtbWVmZjlWVFpXWU0zZ21vbHd1cG5NQ1hYaWlrY1I1VVNMVmcwZV9nejZPZm9SVkdLQVdJcFJSTFR6MmFpcXVrVkhaZFpYOXRObXowbXcifV19fSwgImZlZGVyYXRpb25fZW50aXR5IjogeyJvcmdhbml6YXRpb25fbmFtZSI6ICJPcGVuSUQgQ3JlZGVudGlhbCBJc3N1ZXIgZXhhbXBsZSIsICJvcmdhbml6YXRpb25fdXJpIjogImh0dHBzOi8vY3JlZGVudGlhbF9pc3N1ZXIuZXhhbXBsZS5vcmcvaG9tZSIsICJwb2xpY3lfdXJpIjogImh0dHBzOi8vY3JlZGVudGlhbF9pc3N1ZXIuZXhhbXBsZS5vcmcvcG9saWN5IiwgImxvZ29fdXJpIjogImh0dHBzOi8vY3JlZGVudGlhbF9pc3N1ZXIuZXhhbXBsZS5vcmcvc3RhdGljL2xvZ28uc3ZnIiwgImNvbnRhY3RzIjogWyJ0ZWNoQGNyZWRlbnRpYWxfaXNzdWVyLmV4YW1wbGUub3JnIl19fSwgImF1dGhvcml0eV9oaW50cyI6IFsiaHR0cHM6Ly9pbnRlcm1lZGlhdGUuZWlkYXMuZXhhbXBsZS5vcmciXSwgImp3a3MiOiB7ImtleXMiOiBbeyJrdHkiOiAiUlNBIiwgImtpZCI6ICJaMFZFV21RNFVUUlZkWE14ZEVWdExVSXdWV1ZJVFVkNGF6SkRVMGt0TkMxd1pYZHZNVGhZYmtNNFRRIiwgIm4iOiAib0FBcU9wcHc2U3drZzNMZTJESlIzMHh0ZzBuOENrNmtiTDhxMzViZFVGdVBrMDBZaUNLZE9sN2JHQzVGdlBuMnIyZ2lfQkZ3djhscHdreU1ObnJYMHczd0hXTUtVMmdwWEpxLVNnZGVyQXVQZmxHQzgxY04tTGhJM04tQmQwcjF1YThCVktGeXFWdkNpcms3YWNGeVdQa2ZPcGstbTRlVG4tcmtNMzREMUZ1VFdOUDctZXp6T1g3OWx2YXJBVGl5S1Jva205WGRYN05pQ1hPNnkzSDhjRV9BUVE5a2JvSmxkNklHb3gwUFY3dVFvczlkWURlLTFaWDFzWDhKaklMT2IwTDVBeC1VOHI5V3lIX0VkUXVEVW9QMzZMdFN1YlBYaGo5NVpUa0ZrZnhZd3NHUWxmMjJRVmFQWVh1VnVlSmJtejZ1Zk5NSXBpNG1LaDU3Q2JtcmN3IiwgImUiOiAiQVFBQiJ9XX0sICJzdWIiOiAiaHR0cHM6Ly9jcmVkZW50aWFsX2lzc3Vlci5leGFtcGxlLm9yZyIsICJpc3MiOiAiaHR0cHM6Ly9jcmVkZW50aWFsX2lzc3Vlci5leGFtcGxlLm9yZyIsICJpYXQiOiAxNzY3NzEwOTg0LCAiZXhwIjogMTc2ODAxMDk4NH0.KmJD9GmgRppKSX9kqoDVrZHb4nD7W0wvPJru3Iz4U6y-o5IMqlOxtq4LGDYRi2s7qsSCBn8qz1NIADuLnkc9IWAP5CUPXrnhAmqNBI05KqMdVIb_y0RtDwY7YK0fpBubxCcCiwaZBlTPHGBY72oRnUq3ZU4bOZ9LKNvqBxe9zINMUzCIykh7JUaeMCPP3RW0jBYSjkJwFu-uDKTztVRYTpzmblxTOXGO8djsjruIsNoRiM5uaiUL_JLiaJPZdQWorKa-PH9RRjTtB88hDSbL7We9oKlRLnOLCG4r6OJoJ1mqDRpbraYz_RsFqT9IXy5y5hmVcHS0Gc94BSfcgxVxDg",
    "eyJ0eXAiOiJlbnRpdHktc3RhdGVtZW50K2p3dCIsImFsZyI6IlJTMjU2Iiwia2lkIjoiYTB0cmVuUmhMWEV5ZUROWmFEa3lXRzQxTmtFMFUyWlNTVWxTUTA0M05rRm5NVkJsWVhWQ1FqVlhhdyJ9.eyJzdWIiOiAiaHR0cHM6Ly9jcmVkZW50aWFsX2lzc3Vlci5leGFtcGxlLm9yZyIsICJqd2tzIjogeyJrZXlzIjogW3sia3R5IjogIlJTQSIsICJraWQiOiAiWjBWRVdtUTRVVFJWZFhNeGRFVnRMVUl3VldWSVRVZDRhekpEVTBrdE5DMXdaWGR2TVRoWWJrTTRUUSIsICJuIjogIm9BQXFPcHB3NlN3a2czTGUyREpSMzB4dGcwbjhDazZrYkw4cTM1YmRVRnVQazAwWWlDS2RPbDdiR0M1RnZQbjJyMmdpX0JGd3Y4bHB3a3lNTm5yWDB3M3dIV01LVTJncFhKcS1TZ2RlckF1UGZsR0M4MWNOLUxoSTNOLUJkMHIxdWE4QlZLRnlxVnZDaXJrN2FjRnlXUGtmT3BrLW00ZVRuLXJrTTM0RDFGdVRXTlA3LWV6ek9YNzlsdmFyQVRpeUtSb2ttOVhkWDdOaUNYTzZ5M0g4Y0VfQVFROWtib0psZDZJR294MFBWN3VRb3M5ZFlEZS0xWlgxc1g4SmpJTE9iMEw1QXgtVThyOVd5SF9FZFF1RFVvUDM2THRTdWJQWGhqOTVaVGtGa2Z4WXdzR1FsZjIyUVZhUFlYdVZ1ZUpibXo2dWZOTUlwaTRtS2g1N0NibXJjdyIsICJlIjogIkFRQUIifV19LCAiaXNzIjogImh0dHBzOi8vaW50ZXJtZWRpYXRlLmVpZGFzLmV4YW1wbGUub3JnIiwgImlhdCI6IDE3Njc3MTA5ODQsICJleHAiOiAxNzY4MDEwOTg0fQ.fUcQI29xFaxfvhOAZINWz3V9J1p-Ju6yyfyVQUmYpOc2j5VKz-jn1CG106gnyYzEPS5D3LMkwvuW1QADmFezgQj9iPpYpCIXn3gVdZbAHUP8RsseTQhm5EGiC11X-7zCA4RqQTuqQTh27fYYYoKkxcmkWeWteqzrFD4Tjw-Ryk0Eey7u9SFErZcZG8pNdpvopSUcUbWg14KG58DU64ssR4KJsZwPRZPfC_xr5CK4oQeyZF2ds8N-5cGAPRRuN68wlCT4IeYRByxmBZDxhX4e81qJT7eiIB95h-Ka6nY-R63A38IMBSN68MlX1Bt8gE_rfinTJhL6Y20LWKmeDyhWFg",
    "eyJ0eXAiOiJlbnRpdHktc3RhdGVtZW50K2p3dCIsImFsZyI6IlJTMjU2Iiwia2lkIjoiT1ZwU2JHUnVlWE5UWmtrek5FNUJjVkF6TFRsRFVIZHBka05CZVZZM2NYbzNhV1paTm00NFJUZGFXUSJ9.eyJzdWIiOiAiaHR0cHM6Ly9pbnRlcm1lZGlhdGUuZWlkYXMuZXhhbXBsZS5vcmciLCAiandrcyI6IHsia2V5cyI6IFt7Imt0eSI6ICJSU0EiLCAia2lkIjogImEwdHJlblJoTFhFeWVETlphRGt5V0c0MU5rRTBVMlpTU1VsU1EwNDNOa0ZuTVZCbFlYVkNRalZYYXciLCAibiI6ICJ6RmpzV3hBbE1ORFkzZUlqT2djaHVhX2ZRb3ZKeUNxbTM4M3dBV2Q5SDV0YU95QW5XbGx0UlJCV18zOHRycUZTWjl6UW0zdHdvZHllcHM2ZnFSNTdKMHF1NzVPWmdseXAyNUloMnBPWlBOWU5GSEFqSXRhbnNqWHI0RjRtakNfVVBMWmpRc3lHNjA1eGtrWUR4MjlqRF9pa0REN0lwUlA1Yk01ZU5vQVF1d1NMbktSWk43d0lMRjU3eDlSZVZZYnp1TEVUVzZOdzU0Y1Q3aDNMb3ljZ2dxQXdoR0dSR09QUEFlOEFsYjhtUDJBeGE4TWdNLUhhUENISHMwamswVy1zOUNDQ0djdzBfWmV5OWQ3eHFzT21KNnQ0QWUxWnhBTlJ1LU9FanhDSVd2WDl6aEJkeXNtVmp4RWVFY2xYSVltajFsd0JtZ0s0U1VmcVBMUGdYUGc5aVEiLCAiZSI6ICJBUUFCIn1dfSwgImlzcyI6ICJodHRwczovL3RydXN0LWFuY2hvci5leGFtcGxlLm9yZyIsICJpYXQiOiAxNzY3NzEwOTg0LCAiZXhwIjogMTc2ODAxMDk4NH0.IHTiWH2H2n2fVtkn7K_4GcP-VoSmuz4BWqOn6CtUNaLxUgIWR6FVeaKHdxdabkkMd_zQk6bG_K5adF2H45ojoJIFVY8uuwJCOfakfsYbOnKRmsWD4qiINXjFPLg8jVutg0lTNGjxjJRm6I-7bs5hGRJUAwhOGGrfdtnO7qtlBfg6ciHCuyr8Jq0tmYooKrvpbmObxQ7-cPqqnHy0J3My2TDlxtbMarqpSfXHEavjCEV0dXz00JXAuu0Iop2XfrMvZJaQXeLWtZM_CsBv1-FhVpslLYvlbktwCnV55nnEa06BItcW2ZdpVEVC-GrBcYc2wXIBXLxKjThZ67Z3SMdqpg",
    "eyJ0eXAiOiJlbnRpdHktc3RhdGVtZW50K2p3dCIsImFsZyI6IlJTMjU2Iiwia2lkIjoiT1ZwU2JHUnVlWE5UWmtrek5FNUJjVkF6TFRsRFVIZHBka05CZVZZM2NYbzNhV1paTm00NFJUZGFXUSJ9.eyJtZXRhZGF0YSI6IHsiZmVkZXJhdGlvbl9lbnRpdHkiOiB7ImZlZGVyYXRpb25fZmV0Y2hfZW5kcG9pbnQiOiAiaHR0cHM6Ly90cnVzdC1hbmNob3IuZXhhbXBsZS5vcmcvZmV0Y2giLCAiZmVkZXJhdGlvbl9yZXNvbHZlX2VuZHBvaW50IjogImh0dHBzOi8vdHJ1c3QtYW5jaG9yLmV4YW1wbGUub3JnL3Jlc29sdmUiLCAiZmVkZXJhdGlvbl9saXN0X2VuZHBvaW50IjogImh0dHBzOi8vdHJ1c3QtYW5jaG9yLmV4YW1wbGUub3JnL2xpc3QiLCAib3JnYW5pemF0aW9uX25hbWUiOiAiVEEgZXhhbXBsZSIsICJvcmdhbml6YXRpb25fdXJpIjogImh0dHBzOi8vdHJ1c3QtYW5jaG9yLmV4YW1wbGUub3JnL2hvbWUiLCAicG9saWN5X3VyaSI6ICJodHRwczovL3RydXN0LWFuY2hvci5leGFtcGxlLm9yZy9wb2xpY3kiLCAibG9nb191cmkiOiAiaHR0cHM6Ly90cnVzdC1hbmNob3IuZXhhbXBsZS5vcmcvc3RhdGljL2xvZ28uc3ZnIiwgImNvbnRhY3RzIjogWyJ0ZWNoQHRydXN0LWFuY2hvci5leGFtcGxlLm9yZyJdfX0sICJqd2tzIjogeyJrZXlzIjogW3sia3R5IjogIlJTQSIsICJraWQiOiAiT1ZwU2JHUnVlWE5UWmtrek5FNUJjVkF6TFRsRFVIZHBka05CZVZZM2NYbzNhV1paTm00NFJUZGFXUSIsICJuIjogInhDOXBkUHJwMURHNzlQb0wyTmsybGpoTVpnc3dyMUFqTFprcC1KZHN2MTVHYTY3S0FhMUNId0RMQ0JrblZKcHZNb2g0dnFyM0RzYlh1NEFobThFUzY3RlEwUmpUeUNTZXBvREVoNXVtd0dSakQxblhEMTI2dTlGQi10S0xqUFpTaFl5aW5Kd1BaSGp0ekF0U2xjalNfcFg3WjRDQUh1OEhkeHpZb0JDODhOUEszZjBhZmRBY3JxcnM3LVVFWlphODhycVpGZjRYemVZMGdZUVc4cG5TN0h6cU9aNEhLaU1Ld0ZXUnE1WXFVQ2stVkUyZlpsdjIzR3pxd3VyenllaTd2cVZwWXhodFRlTnBmMjZqSWV5T2JhWm5QYTMzUmFVVDNCd2p2bXBROGJEZ0EzUlF3UFhXMFIzTlpzTElfd0Nqc095TVdkMVh6MlJHellRcjVVV2psUSIsICJlIjogIkFRQUIifV19LCAic3ViIjogImh0dHBzOi8vdHJ1c3QtYW5jaG9yLmV4YW1wbGUub3JnIiwgImlzcyI6ICJodHRwczovL3RydXN0LWFuY2hvci5leGFtcGxlLm9yZyIsICJpYXQiOiAxNzY3NzEwOTg0LCAiZXhwIjogMTc2ODAxMDk4NH0.gbpT-NSUz4Psl3wysrNqXXLZ5sYFnH8yB7Mtb6x5Vbwqre5UsHzyS7S9F86hWSfPQT19jofWT4uLFC_R_Ct4xa3OZvGSfVEtv9rYtJ8Q2tCM2JYZO1hFCaV6BM9pa5yU93H5SoOVLuK4YxQzmGE7cuHsjOXHbGCexJ0rcC1CTOwK3q1o8YEOa_0X2KbkEmeQKR1P50oN8c_GK0NkxT3XLCxb-cVwlG4nsHDe28KBwxjX2DObXXgh5SXj1Mz7dXuv-AtfKcHQ9i479mWVJn86rE4IjHRSp5IIEMsZ5Pn72QVWHGxkwno0TOFTBLtUp9FN9Y36gXiZpfMq9RdyvYbl2w"
  ]
}

</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-example-jws-header-with-a-t" class="selfRef">Example JWS Header with a <code>trust_chain</code> Parameter</a>
          </figcaption></figure>
</section>
</div>
<div id="peer_trust_chain_head_param">
<section id="section-4.4">
        <h3 id="name-peer-trust-chain-header-par">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-peer-trust-chain-header-par" class="section-name selfRef">Peer Trust Chain Header Parameter</a>
        </h3>
<p id="section-4.4-1">
     The <code>peer_trust_chain</code> JWS header parameter is a
     JSON array containing the sequence of Entity Statements
     that comprise the Trust Chain between
     an Entity that this Entity is establishing trust with
     and the selected Trust Anchor.
     If the <code>trust_chain</code> header parameter
     is also present,
     the Trust Anchor for both Trust Chains SHOULD be the same.
     Inclusion of both Trust Chains enables achieving
     the Federation Integrity and Metadata Integrity properties,
     as defined in <span>[<a href="#App-Fed-Linkage" class="cite xref">App-Fed-Linkage</a>]</span>.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">
     Entity Configurations and Subordinate Statements MUST NOT
     contain the <code>peer_trust_chain</code> header parameter,
     as they are integral components of a Trust Chain.
     Use of this header parameter is OPTIONAL.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="metadata">
<section id="section-5">
      <h2 id="name-metadata">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-metadata" class="section-name selfRef">Metadata</a>
      </h2>
<p id="section-5-1">
 This section defines how to represent and use metadata about Entities.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">
 As described in <a href="#common-claims" class="auto internal xref">Section 3.1.1</a>,
 Entity metadata is located in the <code>metadata</code>
 Claim of an Entity Statement, whose value is a JSON object.
 The member names of this object are Entity Type Identifiers,
 as specified in <a href="#entity_types" class="auto internal xref">Section 5.1</a>.
 The metadata data structure following each Entity Type Identifier is a JSON object;
 it MAY be the empty JSON object <code>{}</code>,
 which may be the case when Superiors supply any needed metadata values.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">
 Top-level JSON object members in the metadata data structures MAY use
 any JSON value other than <code>null</code>;
 the use of <code>null</code> is prohibited to prevent likely
 implementation errors caused by confusing members having
 <code>null</code> values with omitted members.<a href="#section-5-3" class="pilcrow">¶</a></p>
<div id="entity_types">
<section id="section-5.1">
        <h3 id="name-entity-type-identifiers">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-entity-type-identifiers" class="section-name selfRef">Entity Type Identifiers</a>
        </h3>
<p id="section-5.1-1">
      The Entity Type Identifier uniquely identifies the Entity Type of a
      federation participant and the metadata format for that Entity Type. This
      section defines the <code>federation_entity</code> Entity
      Type Identifier, which is protocol-independent.
      Use of metadata for OpenID Connect and OAuth 2.0
      Federation Entities is defined in
      <span><a href="https://openid.net/specs/openid-federation-connect-1_1.html#metadata" class="relref">Section 5</a> of [<a href="#OpenID.Federation.Connect-1.1" class="cite xref">OpenID.Federation.Connect-1.1</a>]</span>.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">
   Additional Entity Type Identifiers MAY be defined to
   support use cases for other protocols.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<div id="federation_entity">
<section id="section-5.1.1">
          <h4 id="name-federation-entity">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-federation-entity" class="section-name selfRef">Federation Entity</a>
          </h4>
<p id="section-5.1.1-1">
          The Entity Type Identifier is
          <code>federation_entity</code>.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2">
          The Entities that contain any of Federation Entity properties defined below
          MUST use this Entity Type.
          The following Federation Entity properties are defined:<a href="#section-5.1.1-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-5.1.1-3">
            <dt id="section-5.1.1-3.1">federation_fetch_endpoint</dt>
            <dd style="margin-left: 1.5em" id="section-5.1.1-3.2">
              OPTIONAL.
              The fetch endpoint described in
              <a href="#fetch_endpoint" class="auto internal xref">Section 8.1</a>.
              This URL MUST use the <code>https</code>
              scheme and MAY contain port,
              path, and query parameter components;
              it MUST NOT contain a fragment component.
              Intermediate Entities and
              Trust Anchors MUST publish a
              <code>federation_fetch_endpoint</code>.
              Leaf Entities MUST NOT.<a href="#section-5.1.1-3.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-3.3">federation_list_endpoint</dt>
            <dd style="margin-left: 1.5em" id="section-5.1.1-3.4">
              OPTIONAL.
              The list endpoint described in
              <a href="#entity_listing" class="auto internal xref">Section 8.2</a>.
              This URL MUST use the <code>https</code>
              scheme and MAY contain port,
              path, and query parameter components;
              it MUST NOT contain a fragment component.
              Intermediate Entities and
              Trust Anchors MUST publish a
              <code>federation_list_endpoint</code>.
              Leaf Entities MUST NOT.<a href="#section-5.1.1-3.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-3.5">federation_resolve_endpoint</dt>
            <dd style="margin-left: 1.5em" id="section-5.1.1-3.6">
              OPTIONAL.
              The resolve endpoint described in
              <a href="#resolve" class="auto internal xref">Section 8.3</a>.
              This URL MUST use the <code>https</code>
              scheme and MAY contain port,
              path, and query parameter components;
              it MUST NOT contain a fragment component.
              Any Federation Entity MAY publish a
              <code>federation_resolve_endpoint</code>.<a href="#section-5.1.1-3.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-3.7">federation_trust_mark_status_endpoint</dt>
            <dd style="margin-left: 1.5em" id="section-5.1.1-3.8">
              OPTIONAL.
              The Trust Mark Status endpoint described in
              <a href="#status_endpoint" class="auto internal xref">Section 8.4</a>. Trust Mark Issuers SHOULD
              publish a
              <code>federation_trust_mark_status_endpoint</code>.
              This URL MUST use the <code>https</code>
              scheme and MAY contain port,
              path, and query parameter components;
              it MUST NOT contain a fragment component.<a href="#section-5.1.1-3.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-3.9">federation_trust_mark_list_endpoint</dt>
            <dd style="margin-left: 1.5em" id="section-5.1.1-3.10">
              OPTIONAL.
              The endpoint described in
              <a href="#tm_listing" class="auto internal xref">Section 8.5</a>.
              This URL MUST use the <code>https</code>
              scheme and MAY contain port,
              path, and query parameter components;
              it MUST NOT contain a fragment component.
              Trust Mark Issuers MAY publish a
              <code>federation_trust_mark_list_endpoint</code>.<a href="#section-5.1.1-3.10" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-3.11">federation_trust_mark_endpoint</dt>
            <dd style="margin-left: 1.5em" id="section-5.1.1-3.12">
              OPTIONAL.
              The endpoint described in
              <a href="#tm_endpoint" class="auto internal xref">Section 8.6</a>.
              This URL MUST use the <code>https</code>
              scheme and MAY contain port,
              path, and query parameter components;
              it MUST NOT contain a fragment component.
              Trust Mark Issuers MAY publish a
              <code>federation_trust_mark_endpoint</code>.<a href="#section-5.1.1-3.12" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-3.13">federation_historical_keys_endpoint</dt>
            <dd style="margin-left: 1.5em" id="section-5.1.1-3.14">
       OPTIONAL.
       The endpoint described in <a href="#historical_keys" class="auto internal xref">Section 8.7</a>.
       This URL MUST use the <code>https</code>
       scheme and MAY contain port,
       path, and query parameter components;
       it MUST NOT contain a fragment component.
          All Federation Entities MAY publish a
       <code>federation_historical_keys_endpoint</code>.<a href="#section-5.1.1-3.14" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-3.15">endpoint_auth_signing_alg_values_supported</dt>
            <dd style="margin-left: 1.5em" id="section-5.1.1-3.16">
              OPTIONAL.
              JSON array containing a list of the supported
              <span><a href="#RFC7515" class="internal xref">JWS</a> [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span> algorithms
              (<code>alg</code> values)
              for signing the <span><a href="#RFC7519" class="internal xref">JWT</a> [<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>
              used for <code>private_key_jwt</code>
       when authenticating to federation endpoints,
       as described in <a href="#ClientAuthentication" class="auto internal xref">Section 8.8</a>.
              No default algorithms are implied if this entry is omitted.
              Servers SHOULD support <code>RS256</code>.
              The value <code>none</code> MUST NOT be used.<a href="#section-5.1.1-3.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.1.1-4">
   Additional Federation Entity properties MAY be defined and used.<a href="#section-5.1.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1.1-5">
   It is RECOMMENDED that each Federation Entity contain
   an <code>organization_name</code> Claim,
   as defined in <a href="#informational_metadata" class="auto internal xref">Section 5.2.2</a>.<a href="#section-5.1.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1.1-6" class="keepWithNext">
     The following is a non-normative example of metadata for the <code>federation_entity</code> Entity Type:<a href="#section-5.1.1-6" class="pilcrow">¶</a></p>
<span id="name-example-of-federation_entit"></span><figure id="figure-5">
            <div class="alignLeft art-text artwork" id="section-5.1.1-7.1">
<pre>
"federation_entity": {
  "federation_fetch_endpoint":
    "https://amanita.caesarea.example.com/federation_fetch",
  "federation_list_endpoint":
    "https://amanita.caesarea.example.com/federation_list",
  "federation_trust_mark_status_endpoint": "https://amanita.caesarea.example.com/status",
  "federation_trust_mark_list_endpoint": "https://amanita.caesarea.example.com/trust_marked_list",
  "organization_name": "Ovulo Mushroom",
  "organization_uri": "https://amanita.caesarea.example.com"
}
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-example-of-federation_entit" class="selfRef">Example of <code>federation_entity</code> Entity Type</a>
            </figcaption></figure>
</section>
</div>
</section>
</div>
<div id="common_metadata">
<section id="section-5.2">
        <h3 id="name-common-metadata-parameters">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-common-metadata-parameters" class="section-name selfRef">Common Metadata Parameters</a>
        </h3>
<p id="section-5.2-1">
   This section defines additional metadata parameters
   that MAY be used with all the Entity Types above,
   with the exception for JWK Sets noted below.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div id="jwks_metadata">
<section id="section-5.2.1">
          <h4 id="name-parameters-for-jwk-sets-in-">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-parameters-for-jwk-sets-in-" class="section-name selfRef">Parameters for JWK Sets in Entity Metadata</a>
          </h4>
<p id="section-5.2.1-1">
     The following metadata parameters define ways of obtaining
     JWK Sets for an Entity Type of the Entity.
     Note that these keys are distinct from the Federation Entity Keys
     used to sign Entity Statements, which are in
     the <code>jwks</code> Claim of the Entity Statement,
     and not within the <code>metadata</code> Claim.
     These parameters for JWK Sets MUST NOT be used in
     <code>federation_entity</code> Entity Type metadata.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-5.2.1-2">
            <dt id="section-5.2.1-2.1">signed_jwks_uri</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-2.2">
 OPTIONAL. URL referencing a signed JWT having the Entity's
 JWK Set document for that Entity Type as its payload.
 This URL MUST use the <code>https</code> scheme.
 The JWT MUST be signed using a Federation Entity Key.
 A successful response from the URL MUST use the HTTP status code 200
 with the content type
 <code>application/jwk-set+jwt</code>.
 When both signing and encryption keys are present,
 a <code>use</code> (public key use) parameter
 value is REQUIRED for all keys in the referenced JWK Set
 to indicate each key's intended usage.<a href="#section-5.2.1-2.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-2.3"></dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-2.4">
 Signed JWK Set JWTs are explicitly typed by setting the
 <code>typ</code> header parameter to
 <code>jwk-set+jwt</code> to prevent
 cross-JWT confusion, per Section 3.11 of <span>[<a href="#RFC8725" class="cite xref">RFC8725</a>]</span>.
 Signed JWK Set JWTs without a <code>typ</code> header parameter
 or with a different <code>typ</code> value MUST be rejected.<a href="#section-5.2.1-2.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-2.5"></dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-2.6">
 Signed JWK Set JWTs MUST include the
 <code>kid</code> (Key ID) header parameter
 with its value being the Key ID of the signing key used.<a href="#section-5.2.1-2.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-2.7"></dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-2.8">
              <p id="section-5.2.1-2.8.1">
 The following Claims are specified for use in the payload,
 all of which except <code>keys</code>
 are defined in <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>:<a href="#section-5.2.1-2.8.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-5.2.1-2.8.2">
                <dt id="section-5.2.1-2.8.2.1">keys</dt>
                <dd style="margin-left: 1.5em" id="section-5.2.1-2.8.2.2">
     REQUIRED. Array of JWK values in the JWK Set,
     as specified in Section 5.1 of <span>[<a href="#RFC7517" class="cite xref">RFC7517</a>]</span>.<a href="#section-5.2.1-2.8.2.2" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-5.2.1-2.8.2.3">iss</dt>
                <dd style="margin-left: 1.5em" id="section-5.2.1-2.8.2.4">
     REQUIRED. The "iss" (issuer) Claim identifies the principal
     that issued the JWT.<a href="#section-5.2.1-2.8.2.4" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-5.2.1-2.8.2.5">sub</dt>
                <dd style="margin-left: 1.5em" id="section-5.2.1-2.8.2.6">
     REQUIRED. This Claim identifies the owner of the keys.
     It SHOULD be the same as the issuer.<a href="#section-5.2.1-2.8.2.6" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-5.2.1-2.8.2.7">iat</dt>
                <dd style="margin-left: 1.5em" id="section-5.2.1-2.8.2.8">
     OPTIONAL. Number. Time when this signed JWK Set was issued.
        This is expressed as Seconds Since the Epoch, per
        <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-5.2.1-2.8.2.8" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-5.2.1-2.8.2.9">exp</dt>
                <dd style="margin-left: 1.5em" id="section-5.2.1-2.8.2.10">
     OPTIONAL. Number. This Claim identifies the time when the JWT is
     no longer valid. This is expressed as Seconds
        Since the Epoch, per <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-5.2.1-2.8.2.10" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
<p id="section-5.2.1-2.8.3">
 More Claims are defined in <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>; of
 these, <code>aud</code> SHOULD NOT be used since
 the issuer cannot know who the audience is.
 <code>nbf</code> and <code>jti</code>
 are not particularly useful in this context and SHOULD be omitted.<a href="#section-5.2.1-2.8.3" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-2.9"></dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-2.10">
              <p id="section-5.2.1-2.10.1">
 Additional Claims MAY be defined and used in conjunction with the Claims above.<a href="#section-5.2.1-2.10.1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2.10.2" class="keepWithNext">
     The following is a non-normative example of the JWT Claims Set for a signed JWK Set.<a href="#section-5.2.1-2.10.2" class="pilcrow">¶</a></p>
<span id="name-example-jwt-claims-set-for-"></span><figure id="figure-6">
                <div class="alignLeft art-text artwork" id="section-5.2.1-2.10.3.1">
<pre>
    {
      "keys": [
        {
          "kty": "RSA",
          "kid": "SUdtUndEWVY2cUFDeDV5NVlBWDhvOXJodVl2am1mNGNtR0pmd",
          "n": "y_Zc8rByfeRIC9fFZrDZ2MGH2ZnxLrc0ZNNwkNet5rwCPYeRF3Sv
                5nihZA9NHkDTEX97dN8hG6ACfeSo6JB2P7heJtmzM8oOBZbmQ90n
                EA_JCHszkejHaOtDDfxPH6bQLrMlItF4JSUKua301uLB7C8nzTxm
                tF3eAhGCKn8LotEseccxsmzApKRNWhfKDLpKPe9i9PZQhhJaurwD
                kMwbWTAeZbqCScU1o09piuK1JDf2PaDFevioHncZcQO74Obe4nN3
                oNPNAxrMClkZ9s9GMEd5vMqOD4huXlRpHwm9V3oJ3LRutOTxqQLV
                yPucu7eHA7her4FOFAiUk-5SieXL9Q",
          "e": "AQAB"
        },
        {
          "kty": "EC",
          "kid": "MFYycG1raTI4SkZvVDBIMF9CNGw3VEZYUmxQLVN2T21nSWlkd3",
          "crv": "P-256",
          "x": "qAOdPQROkHfZY1daGofOmSNQWpYK8c9G2m2Rbkpbd4c",
          "y": "G_7fF-T8n2vONKM15Mzj4KR_shvHBxKGjMosF6FdoPY"
        }
      ],
      "iss": "https://example.org/op",
      "sub": "https://example.org/op",
      "iat": 1618410883
    }

</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-example-jwt-claims-set-for-" class="selfRef">Example JWT Claims Set for a Signed JWK Set</a>
                </figcaption></figure>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-2.11">jwks_uri</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-2.12">
 OPTIONAL.
 URL referencing a JWK Set document
 containing the Entity's keys for that Entity Type.
 This URL MUST use the <code>https</code> scheme.
 When both signing and encryption keys are present,
 a <code>use</code> (public key use) parameter
 value is REQUIRED for all keys in the referenced JWK Set
 to indicate each key's intended usage.<a href="#section-5.2.1-2.12" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-2.13">jwks</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-2.14">
 OPTIONAL.
 JSON Web Key Set document, passed by value,
 containing the Entity's keys for that Entity Type.
 When both signing and encryption keys are present,
 a <code>use</code> (public key use) parameter
 value is REQUIRED for all keys in the JWK Set
 to indicate each key's intended usage.
 This parameter is intended
 to be used by participants that, for some reason,
 cannot use the <code>signed_jwks_uri</code>
 parameter.
 An upside of using <code>jwks</code> is that
 the Entity's keys for the Entity Type are recorded in Trust Chains.<a href="#section-5.2.1-2.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<div id="jwks_usage">
<section id="section-5.2.1.1">
            <h5 id="name-usage-of-jwks-jwks_uri-and-">
<a href="#section-5.2.1.1" class="section-number selfRef">5.2.1.1. </a><a href="#name-usage-of-jwks-jwks_uri-and-" class="section-name selfRef">Usage of jwks, jwks_uri, and signed_jwks_uri in Entity Metadata</a>
            </h5>
<p id="section-5.2.1.1-1">
       It is RECOMMENDED that an Entity Configuration
       use only one of
       <code>jwks</code>,
       <code>jwks_uri</code>, and
       <code>signed_jwks_uri</code> in its OpenID Connect or OAuth 2.0 metadata.
       However, there may be circumstances in which it is desirable to use multiple
       JWK Set representations, such as when an Entity is in multiple federations and the
       federations have different policies about the JWK Set representation to be used.
       Also note that some implementations might not understand
       all these representations.  For instance, while
       <code>jwks_uri</code> will certainly be understood
       in OpenID Connect OP metadata,
       <code>signed_jwks_uri</code> might not be understood
       by all OpenID Connect implementations, and so
       a JWK Set representation that is understood also needs to be present.<a href="#section-5.2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1.1-2">
       When multiple JWK Set representations are used, the keys present in each
       representation SHOULD be the same.  Even if they are not completely the
       same at a given instant in time (which may be the case during key rollover operations),
       implementations MUST make them consistent in a timely manner.<a href="#section-5.2.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="informational_metadata">
<section id="section-5.2.2">
          <h4 id="name-informational-metadata-para">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-informational-metadata-para" class="section-name selfRef">Informational Metadata Parameters</a>
          </h4>
<p id="section-5.2.2-1">
     The following metadata parameters define ways of obtaining
     information about the Entity for an Entity Type.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-5.2.2-2">
            <dt id="section-5.2.2-2.1">organization_name</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.2-2.2">
              OPTIONAL. A human-readable
              name representing the organization owning this Entity.
              If the owner is a physical person,
              this MAY be, for example, the person's name. Note
              that this information will be publicly available.<a href="#section-5.2.2-2.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.2-2.3">display_name</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.2-2.4">
              OPTIONAL. A human-readable
              name of the Entity to be presented to the End-User.<a href="#section-5.2.2-2.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.2-2.5">description</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.2-2.6">
              OPTIONAL. A human-readable brief description of this Entity
              presentable to the End-User.<a href="#section-5.2.2-2.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.2-2.7">keywords</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.2-2.8">
              OPTIONAL. JSON array with one or more
              strings representing search keywords, tags, categories, or labels that apply to this Entity.<a href="#section-5.2.2-2.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.2-2.9">contacts</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.2-2.10">
              OPTIONAL. JSON array with one or more
              strings representing contact persons at the Entity.
              These MAY contain names, e-mail addresses, descriptions, phone
              numbers, etc.<a href="#section-5.2.2-2.10" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.2-2.11">logo_uri</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.2-2.12">
              OPTIONAL. String. A URL that points to the logo of this Entity.
              The file containing the logo SHOULD be published
              in a format that can be viewed via the web.<a href="#section-5.2.2-2.12" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.2-2.13">policy_uri</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.2-2.14">
              OPTIONAL. URL of the documentation of
              conditions and policies relevant to this Entity.<a href="#section-5.2.2-2.14" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.2-2.15">information_uri</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.2-2.16">
              OPTIONAL. URL for documentation of
              additional information about this Entity viewable by the End-User.<a href="#section-5.2.2-2.16" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.2-2.17">organization_uri</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.2-2.18">
              OPTIONAL. URL of a Web page for the organization owning this Entity.<a href="#section-5.2.2-2.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.2.2-3">
     These metadata parameters MAY be present in
     the Entity's metadata for any Entity Types that it uses.<a href="#section-5.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="federation_policy">
<section id="section-6">
      <h2 id="name-federation-policy">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-federation-policy" class="section-name selfRef">Federation Policy</a>
      </h2>
<div id="metadata_policy">
<section id="section-6.1">
        <h3 id="name-metadata-policy">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-metadata-policy" class="section-name selfRef">Metadata Policy</a>
        </h3>
<p id="section-6.1-1">
          Trust Anchors and Intermediate Entities MAY define policies that apply
          to the metadata of their Subordinates.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">
          A federation may utilize metadata policies to achieve specific
          objectives. For example, in a federation of
          <span><a href="#OpenID.Core" class="internal xref">OpenID Connect</a> [<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span> Entities, one
          objective may be to ensure the metadata published by OpenID Providers
          and Relying Parties are interoperable with one another. Another
          objective may be to ensure the Entity metadata complies with a
          security profile, for example, <span><a href="#FAPI" class="internal xref">FAPI</a> [<a href="#FAPI" class="cite xref">FAPI</a>]</span>.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">
          Note that the <code>metadata_policy</code> is not
          intended to check and validate the JSON value types of metadata
          parameters. Such checks SHOULD be performed at the application
          layer, after obtaining the Entity metadata from a successfully
          resolved Trust Chain.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<div id="metadata_policy_principles">
<section id="section-6.1.1">
          <h4 id="name-principles">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-principles" class="section-name selfRef">Principles</a>
          </h4>
<p id="section-6.1.1-1">
            OpenID Federation enables the definition of metadata policies with
            the following properties:<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-6.1.1-2">
            <dt id="section-6.1.1-2.1">Hierarchy</dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-2.2">
              <p id="section-6.1.1-2.2.1">
                Once applied to a metadata parameter, a metadata policy cannot be
                repealed or made more permissive by Intermediate Entities that are
                subordinate in the Trust Chain.<a href="#section-6.1.1-2.2.1" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2.2.2">
                The hierarchy of policies is preserved in nested federations where
                a Trust Anchor in one federation acts as an Intermediate Entity in
                another federation.<a href="#section-6.1.1-2.2.2" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-2.3">Equal Opportunity</dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-2.4">
 All Superior Entities in a Trust Chain can contribute metadata policies
 on an equal basis, provided their contributions result in a combined
        metadata policy that is logically sound.
 For instance, any Intermediate can further restrict the metadata
 of its Subordinates relative to what its Superiors specified.
        An Intermediate that introduces a conflict among the metadata policies
        causes the Trust Chain to be deemed invalid.<a href="#section-6.1.1-2.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-2.5">Specificity and Granularity</dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-2.6">
              <p id="section-6.1.1-2.6.1">
                Just like metadata, a metadata policy is bound to a specific
                Entity Type. This ensures policies for different Entity Types are
                independent and isolated from one another.<a href="#section-6.1.1-2.6.1" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2.6.2">
                Policies are expressed at the level of individual metadata
                parameters. The policies for a given Entity Type metadata
                parameter are thus independent and isolated from those for other
                parameters.<a href="#section-6.1.1-2.6.2" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2.6.3">
                When a Trust Anchor or an Intermediate Entity defines a metadata
                policy for an Entity Type, it applies to the metadata of all
                Subordinate Entities of that type in the Trust Chain.<a href="#section-6.1.1-2.6.3" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2.6.4">
                Because the place to define a policy is the Subordinate Statement
                and every Entity Statement is issued for a specific subject, a
                federation authority can choose to define a common Entity Type
                metadata policy for all its Subordinates, or specific Entity Type
                metadata policies for specific Subordinates.<a href="#section-6.1.1-2.6.4" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-2.7">Operation</dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-2.8">
                A policy operates by performing a check, a modification, or both
                on a given metadata parameter. This specification defines a set
                of standard operators, described in
                <a href="#standard_metadata_policy_operators" class="auto internal xref">Section 6.1.3.1</a>. A
                federation MAY specify and use additional operators, provided
                they comply with the principles laid out in this section and with
                <a href="#metadata_policy_operators" class="auto internal xref">Section 6.1.3</a> and
                <a href="#additional_metadata_policy_operators" class="auto internal xref">Section 6.1.3.2</a>.<a href="#section-6.1.1-2.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-2.9">Integral Metadata Enforcement</dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-2.10">
              <p id="section-6.1.1-2.10.1">
                The resolution and application of metadata policies is an integral
                part of the Trust Chain resolution process, as described in
                <a href="#resolving_trust" class="auto internal xref">Section 10</a>.<a href="#section-6.1.1-2.10.1" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2.10.2">
                This means:<a href="#section-6.1.1-2.10.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.1-2.10.3.1">
                  <p id="section-6.1.1-2.10.3.1.1">
                    A Trust Chain for which the metadata policy resolution fails
                    due to an error, for example, due to an Intermediate Entity's
                    policy conflicting with a Superior's policy, is deemed invalid.<a href="#section-6.1.1-2.10.3.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.1-2.10.3.2">
                  <p id="section-6.1.1-2.10.3.2.1">
                    A Trust Chain with Entity metadata that does not comply with
                    the Resolved Metadata policies is deemed invalid.<a href="#section-6.1.1-2.10.3.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-2.11">Determinism</dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-2.12">
                The resolution and application of metadata policies in a Trust Chain
                is deterministic. Trust Anchors and Intermediate Entities
                are thus able to formulate policies that exhibit predictable and
                reproducible outcomes.<a href="#section-6.1.1-2.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="metadata_policy_structure">
<section id="section-6.1.2">
          <h4 id="name-structure">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-structure" class="section-name selfRef">Structure</a>
          </h4>
<p id="section-6.1.2-1">
            Metadata policies are expressed in the
            <code>metadata_policy</code> Claim of a Subordinate
            Statement, as described in <a href="#ss-specific" class="auto internal xref">Section 3.1.3</a>. The
            Claim Value is a JSON object that has a data structure consisting of
            three levels:<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.1.2-2">
<li id="section-6.1.2-2.1">
              <p id="section-6.1.2-2.1.1">
                Metadata policies for Entity Types.<a href="#section-6.1.2-2.1.1" class="pilcrow">¶</a></p>
<p id="section-6.1.2-2.1.2">
                The top level contains one or more members, each representing
                the metadata policy for an Entity Type. Each member name is an
                Entity Type Identifier, as specified in
                <a href="#entity_types" class="auto internal xref">Section 5.1</a>, for example,
                <code>openid_relying_party</code>. The member
                value is a JSON object that contains metadata parameter
                policies.<a href="#section-6.1.2-2.1.2" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.1.2-2.2">
              <p id="section-6.1.2-2.2.1">
                Metadata parameter policies for the Entity Type.<a href="#section-6.1.2-2.2.1" class="pilcrow">¶</a></p>
<p id="section-6.1.2-2.2.2">
                The second level contains one or more members, each representing
                a policy for a metadata parameter for the Entity Type. Each
                member name is a metadata parameter name, for example
                <code>id_token_signed_response_alg</code>. The
                name MAY include a language tag, as described in
                <a href="#ClaimsLanguagesAndScripts" class="auto internal xref">Section 14</a>, in which case the
                metadata parameter policy applies only to the metadata parameter
                with the specified language tag. The member value is a JSON
                object that contains policy operators.<a href="#section-6.1.2-2.2.2" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.1.2-2.3">
              <p id="section-6.1.2-2.3.1">
                Operators for the metadata parameter policy for the Entity
                Type.<a href="#section-6.1.2-2.3.1" class="pilcrow">¶</a></p>
<p id="section-6.1.2-2.3.2">
                The third level contains one or more members, each representing
                an operator that checks or modifies the metadata parameter, as
                described in <a href="#metadata_policy_operators" class="auto internal xref">Section 6.1.3</a>.
 Only operators that are allowed to be combined with one another,
 as defined in the specifications for each operator,
 can be included together here.<a href="#section-6.1.2-2.3.2" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-6.1.2-3">
            Duplicate JSON object member names MUST NOT be present at any of
            the three levels of the <code>metadata_policy</code>
            Claim data structure.<a href="#section-6.1.2-3" class="pilcrow">¶</a></p>
<p id="section-6.1.2-4" class="keepWithNext">
                The following is a non-normative example of a metadata policy
                for an OpenID Relying Party that consists of a single policy for
                the <code>id_token_signed_response_alg</code>
                metadata parameter and uses two operators,
                <code>default</code> and
                <code>one_of</code>:<a href="#section-6.1.2-4" class="pilcrow">¶</a></p>
<span id="name-example-metadata_policy-cla"></span><figure id="figure-7">
            <div class="alignLeft art-text artwork" id="section-6.1.2-5.1">
<pre>
"metadata_policy" : {
  "openid_relying_party": {
    "id_token_signed_response_alg": {
      "default": "ES256",
      "one_of": ["ES256", "ES384", "ES512"]
    }
  }
}
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-example-metadata_policy-cla" class="selfRef">Example <code>metadata_policy</code> Claim</a>
            </figcaption></figure>
</section>
</div>
<div id="metadata_policy_operators">
<section id="section-6.1.3">
          <h4 id="name-operators">
<a href="#section-6.1.3" class="section-number selfRef">6.1.3. </a><a href="#name-operators" class="section-name selfRef">Operators</a>
          </h4>
<p id="section-6.1.3-1">
            A metadata policy operator:<a href="#section-6.1.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.3-2.1">
              <p id="section-6.1.3-2.1.1">
                Is identified by a unique case-sensitive name.<a href="#section-6.1.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.3-2.2">
              <p id="section-6.1.3-2.2.1">
                Acts on a single metadata parameter. The operator definition
                MUST specify the metadata parameter JSON value types that are
                mandatory to support, and MAY also specify JSON value types that
                are optional to support. When the metadata parameter has a JSON
                value type that is not supported, the operator MUST produce a
                policy error.<a href="#section-6.1.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.3-2.3">
              <p id="section-6.1.3-2.3.1">
                The action on the metadata parameter can be a value check, a
                value modification, or both. When the operator's action is a
                value modification, it MAY remove the metadata parameter.<a href="#section-6.1.3-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.3-2.4">
              <p id="section-6.1.3-2.4.1">
                The action of the operator is configured by a JSON value. The
                operator definition MUST specify the JSON value types that are
                mandatory to support, and MAY also specify JSON value types that
                are optional to support. When the operator is configured with a
                JSON value type that is not supported, the operator MUST produce
                a policy error.<a href="#section-6.1.3-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.3-2.5">
              <p id="section-6.1.3-2.5.1">
                MUST declare what other operators it may be combined with,
                which applies to both individual as well as merged metadata
                parameter policies, as described in
                <a href="#metadata_policy_structure" class="auto internal xref">Section 6.1.2</a> and
                <a href="#metadata_policy_enforcement" class="auto internal xref">Section 6.1.4</a>. A combination may
                be unconditional, or conditional, requiring the configured
                values of the two operators to meet certain criteria.
                Combinations that are not allowed MUST produce a policy error.<a href="#section-6.1.3-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.3-2.6">
              <p id="section-6.1.3-2.6.1">
                MUST declare in what order it is to be applied to a metadata
                parameter, absolute or relative to other operators in the
                metadata parameter policy. Value check operators SHOULD
                generally be applied after operators that perform value
                modifications.<a href="#section-6.1.3-2.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.3-2.7">
              <p id="section-6.1.3-2.7.1">
                MUST specify, when more than one Subordinate Statement in a
                Trust Chain has a policy for an Entity Type metadata parameter
                that uses the same operator, whether the operator values are
                allowed to be merged to produce an identical or more restrictive
                policy, and if so, under what conditions.
                  The order of the result of such an operator value merge is not defined.
                  If the operator does not allow such a merge, it MUST produce a policy error.<a href="#section-6.1.3-2.7.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.3-2.8">
              <p id="section-6.1.3-2.8.1">
                An operator MUST NOT output a metadata parameter with the
                <code>null</code> value.<a href="#section-6.1.3-2.8.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.1.3-3">
     Note that metadata parameters and policies that conform to
     the JSON grammar but do not represent interoperable uses of JSON,
     as per Sections 4 and 8 of <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span>,
     can cause unpredictable behaviors.<a href="#section-6.1.3-3" class="pilcrow">¶</a></p>
<div id="standard_metadata_policy_operators">
<section id="section-6.1.3.1">
            <h5 id="name-standard-operators">
<a href="#section-6.1.3.1" class="section-number selfRef">6.1.3.1. </a><a href="#name-standard-operators" class="section-name selfRef">Standard Operators</a>
            </h5>
<p id="section-6.1.3.1-1">This specification defines the following metadata policy
              operators:<a href="#section-6.1.3.1-1" class="pilcrow">¶</a></p>
<div id="value_operator">
<section id="section-6.1.3.1.1">
              <h6 id="name-value">
<a href="#section-6.1.3.1.1" class="section-number selfRef">6.1.3.1.1. </a><a href="#name-value" class="section-name selfRef">value</a>
              </h6>
<p id="section-6.1.3.1.1-1">
                Name: <code>value</code><a href="#section-6.1.3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1.3.1.1-2">
                Action: The metadata parameter MUST be assigned the value of the
                operator. When the value of the operator is
                <code>null</code>, the metadata parameter MUST be
                removed.<a href="#section-6.1.3.1.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1.3.1.1-3">
                Metadata parameter JSON values:<a href="#section-6.1.3.1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.3.1.1-4.1">
                  <p id="section-6.1.3.1.1-4.1.1">
                    Mandatory to support: string, number, boolean, array<a href="#section-6.1.3.1.1-4.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-6.1.3.1.1-5">
                Operator JSON values:<a href="#section-6.1.3.1.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.3.1.1-6.1">
                  <p id="section-6.1.3.1.1-6.1.1">
                    Mandatory to support: string, number, boolean, array, null<a href="#section-6.1.3.1.1-6.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-6.1.3.1.1-7">
                Combination with other operators in a metadata parameter policy:<a href="#section-6.1.3.1.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.3.1.1-8.1">
                  <p id="section-6.1.3.1.1-8.1.1">
                    MAY be combined with <code>add</code>,
                    in which case the values of <code>add</code>
                    MUST be a subset of the values of
                    <code>value</code>.<a href="#section-6.1.3.1.1-8.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.1-8.2">
                  <p id="section-6.1.3.1.1-8.2.1">
                    MAY be combined with <code>default</code>
                    if the value of <code>value</code> is not
                    <code>null</code>.<a href="#section-6.1.3.1.1-8.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.1-8.3">
                  <p id="section-6.1.3.1.1-8.3.1">
                    MAY be combined with <code>one_of</code>,
                    in which case the value of <code>value</code>
                    MUST be among the <code>one_of</code> values.<a href="#section-6.1.3.1.1-8.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.1-8.4">
                  <p id="section-6.1.3.1.1-8.4.1">
                    MAY be combined with <code>subset_of</code>,
                    in which case the values of <code>value</code>
                    MUST be a subset of the values of
                    <code>subset_of</code>.<a href="#section-6.1.3.1.1-8.4.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.1-8.5">
                  <p id="section-6.1.3.1.1-8.5.1">
                    MAY be combined with <code>superset_of</code>,
                    in which case the values of <code>value</code>
                    MUST be a superset of the values of
                    <code>superset_of</code>.<a href="#section-6.1.3.1.1-8.5.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.1-8.6">
                  <p id="section-6.1.3.1.1-8.6.1">
                    MAY be combined with <code>essential</code>,
                    except when <code>value</code> is <code>null</code> and
                    <code>essential</code> is true.<a href="#section-6.1.3.1.1-8.6.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-6.1.3.1.1-9">
                Order of application: First<a href="#section-6.1.3.1.1-9" class="pilcrow">¶</a></p>
<p id="section-6.1.3.1.1-10">
                Operator value merge: Allowed only when the operator values are
                equal. If not, this MUST produce a policy error.<a href="#section-6.1.3.1.1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="add_operator">
<section id="section-6.1.3.1.2">
              <h6 id="name-add">
<a href="#section-6.1.3.1.2" class="section-number selfRef">6.1.3.1.2. </a><a href="#name-add" class="section-name selfRef">add</a>
              </h6>
<p id="section-6.1.3.1.2-1">
                Name: <code>add</code><a href="#section-6.1.3.1.2-1" class="pilcrow">¶</a></p>
<p id="section-6.1.3.1.2-2">
                Action: The value or values of this operator MUST be added to
                the metadata parameter. Values that are already present in the
                metadata parameter MUST NOT be added another time. If the
                metadata parameter is absent, it MUST be initialized with the
                value of this operator.<a href="#section-6.1.3.1.2-2" class="pilcrow">¶</a></p>
<p id="section-6.1.3.1.2-3">
                Metadata parameter JSON values:<a href="#section-6.1.3.1.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.3.1.2-4.1">
                  <p id="section-6.1.3.1.2-4.1.1">
                    Mandatory to support: array of strings<a href="#section-6.1.3.1.2-4.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.2-4.2">
                  <p id="section-6.1.3.1.2-4.2.1">
                    Optional to support: array of objects, array of numbers<a href="#section-6.1.3.1.2-4.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-6.1.3.1.2-5">
                Operator JSON values:<a href="#section-6.1.3.1.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.3.1.2-6.1">
                  <p id="section-6.1.3.1.2-6.1.1">
                    Mandatory to support: array of strings<a href="#section-6.1.3.1.2-6.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.2-6.2">
                  <p id="section-6.1.3.1.2-6.2.1">
                    Optional to support: array of objects, array of numbers<a href="#section-6.1.3.1.2-6.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-6.1.3.1.2-7">
                Combination with other operators in a metadata parameter policy:<a href="#section-6.1.3.1.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.3.1.2-8.1">
                  <p id="section-6.1.3.1.2-8.1.1">
                    MAY be combined with <code>value</code>,
                    in which case the values of <code>add</code>
                    MUST be a subset of the values of
                    <code>value</code>.<a href="#section-6.1.3.1.2-8.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.2-8.2">
                  <p id="section-6.1.3.1.2-8.2.1">
                    MAY be combined with <code>default</code>.<a href="#section-6.1.3.1.2-8.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.2-8.3">
                  <p id="section-6.1.3.1.2-8.3.1">
                    MAY be combined with <code>subset_of</code>,
                    in which case the values of <code>add</code>
                    MUST be a subset of the values of
                    <code>subset_of</code>.<a href="#section-6.1.3.1.2-8.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.2-8.4">
                  <p id="section-6.1.3.1.2-8.4.1">
                    MAY be combined with <code>superset_of</code>.<a href="#section-6.1.3.1.2-8.4.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.2-8.5">
                  <p id="section-6.1.3.1.2-8.5.1">
                    MAY be combined with <code>essential</code>.<a href="#section-6.1.3.1.2-8.5.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-6.1.3.1.2-9">
                Order of application: After <code>value</code>.<a href="#section-6.1.3.1.2-9" class="pilcrow">¶</a></p>
<p id="section-6.1.3.1.2-10">
                Operator value merge: The result of merging the values of two
                <code>add</code> operators is the union of the
                values.<a href="#section-6.1.3.1.2-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="default_operator">
<section id="section-6.1.3.1.3">
              <h6 id="name-default">
<a href="#section-6.1.3.1.3" class="section-number selfRef">6.1.3.1.3. </a><a href="#name-default" class="section-name selfRef">default</a>
              </h6>
<p id="section-6.1.3.1.3-1">
                Name: <code>default</code><a href="#section-6.1.3.1.3-1" class="pilcrow">¶</a></p>
<p id="section-6.1.3.1.3-2">
                Action: If the metadata parameter is absent, it MUST be set to
                the value of the operator. If the metadata parameter is present,
                this operator has no effect.<a href="#section-6.1.3.1.3-2" class="pilcrow">¶</a></p>
<p id="section-6.1.3.1.3-3">
                Metadata parameter JSON values:<a href="#section-6.1.3.1.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.3.1.3-4.1">
                  <p id="section-6.1.3.1.3-4.1.1">
                    Mandatory to support: string, number, boolean, array<a href="#section-6.1.3.1.3-4.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-6.1.3.1.3-5">
                Operator JSON values:<a href="#section-6.1.3.1.3-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.3.1.3-6.1">
                  <p id="section-6.1.3.1.3-6.1.1">
                    Mandatory to support: string, number, boolean, array<a href="#section-6.1.3.1.3-6.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-6.1.3.1.3-7">
                Combination with other operators in a metadata parameter policy:<a href="#section-6.1.3.1.3-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.3.1.3-8.1">
                  <p id="section-6.1.3.1.3-8.1.1">
                    MAY be combined with <code>value</code>
                    if the value  of <code>value</code> is not
                    <code>null</code>.<a href="#section-6.1.3.1.3-8.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.3-8.2">
                  <p id="section-6.1.3.1.3-8.2.1">
                    MAY be combined with <code>add</code>.<a href="#section-6.1.3.1.3-8.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.3-8.3">
                  <p id="section-6.1.3.1.3-8.3.1">
                    MAY be combined with <code>one_of</code>.<a href="#section-6.1.3.1.3-8.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.3-8.4">
                  <p id="section-6.1.3.1.3-8.4.1">
                    MAY be combined with <code>subset_of</code>.<a href="#section-6.1.3.1.3-8.4.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.3-8.5">
                  <p id="section-6.1.3.1.3-8.5.1">
                    MAY be combined with <code>superset_of</code>.<a href="#section-6.1.3.1.3-8.5.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.3-8.6">
                  <p id="section-6.1.3.1.3-8.6.1">
                    MAY be combined with <code>essential</code>.<a href="#section-6.1.3.1.3-8.6.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-6.1.3.1.3-9">
                Order of application: After <code>add</code>.<a href="#section-6.1.3.1.3-9" class="pilcrow">¶</a></p>
<p id="section-6.1.3.1.3-10">
                Operator value merge: The operator values MUST be equal. If the
                values are not equal this MUST produce a policy error.<a href="#section-6.1.3.1.3-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="one_of_operator">
<section id="section-6.1.3.1.4">
              <h6 id="name-one_of">
<a href="#section-6.1.3.1.4" class="section-number selfRef">6.1.3.1.4. </a><a href="#name-one_of" class="section-name selfRef">one_of</a>
              </h6>
<p id="section-6.1.3.1.4-1">
                Name: <code>one_of</code><a href="#section-6.1.3.1.4-1" class="pilcrow">¶</a></p>
<p id="section-6.1.3.1.4-2">
                Action: If the metadata parameter is present, its value MUST be
                one of those listed in the operator value.<a href="#section-6.1.3.1.4-2" class="pilcrow">¶</a></p>
<p id="section-6.1.3.1.4-3">
                Metadata parameter JSON values:<a href="#section-6.1.3.1.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.3.1.4-4.1">
                  <p id="section-6.1.3.1.4-4.1.1">
                    Mandatory to support: string<a href="#section-6.1.3.1.4-4.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.4-4.2">
                  <p id="section-6.1.3.1.4-4.2.1">
                    Optional to support: object, number<a href="#section-6.1.3.1.4-4.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-6.1.3.1.4-5">
                Operator JSON values:<a href="#section-6.1.3.1.4-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.3.1.4-6.1">
                  <p id="section-6.1.3.1.4-6.1.1">
                    Mandatory to support: array of strings<a href="#section-6.1.3.1.4-6.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.4-6.2">
                  <p id="section-6.1.3.1.4-6.2.1">
                    Optional to support: array of objects, array of numbers<a href="#section-6.1.3.1.4-6.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-6.1.3.1.4-7">
                Combination with other operators in a metadata parameter policy:<a href="#section-6.1.3.1.4-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.3.1.4-8.1">
                  <p id="section-6.1.3.1.4-8.1.1">
                    MAY be combined with <code>value</code>,
                    in which case the value of <code>value</code>
                    MUST be among the <code>one_of</code> values.<a href="#section-6.1.3.1.4-8.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.4-8.2">
                  <p id="section-6.1.3.1.4-8.2.1">
                    MAY be combined with <code>default</code>.<a href="#section-6.1.3.1.4-8.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.4-8.3">
                  <p id="section-6.1.3.1.4-8.3.1">
                    MAY be combined with <code>essential</code>.<a href="#section-6.1.3.1.4-8.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-6.1.3.1.4-9">
                Order of application: After <code>default</code>.<a href="#section-6.1.3.1.4-9" class="pilcrow">¶</a></p>
<p id="section-6.1.3.1.4-10">
                Operator value merge: The result of merging the values of two
                <code>one_of</code> operators is the intersection
                of the operator values. If the intersection is empty, this MUST
                result in a policy error.<a href="#section-6.1.3.1.4-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="subset_of_operator">
<section id="section-6.1.3.1.5">
              <h6 id="name-subset_of">
<a href="#section-6.1.3.1.5" class="section-number selfRef">6.1.3.1.5. </a><a href="#name-subset_of" class="section-name selfRef">subset_of</a>
              </h6>
<p id="section-6.1.3.1.5-1">
                Name: <code>subset_of</code><a href="#section-6.1.3.1.5-1" class="pilcrow">¶</a></p>
<p id="section-6.1.3.1.5-2">
                Action: If the metadata parameter is present, it is assigned the
                intersection between the values of the operator and the
                metadata parameter. Note that the resulting intersection may
                thus be an empty array <code>[]</code>. Also note
                that <code>subset_of</code> is a potential value
                modifier in addition to it being a value check.<a href="#section-6.1.3.1.5-2" class="pilcrow">¶</a></p>
<p id="section-6.1.3.1.5-3">
                Metadata parameter JSON values:<a href="#section-6.1.3.1.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.3.1.5-4.1">
                  <p id="section-6.1.3.1.5-4.1.1">
                    Mandatory to support: array of strings<a href="#section-6.1.3.1.5-4.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.5-4.2">
                  <p id="section-6.1.3.1.5-4.2.1">
                    Optional to support: array of objects, array of numbers<a href="#section-6.1.3.1.5-4.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-6.1.3.1.5-5">
                Operator JSON values:<a href="#section-6.1.3.1.5-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.3.1.5-6.1">
                  <p id="section-6.1.3.1.5-6.1.1">
                    Mandatory to support: array of strings<a href="#section-6.1.3.1.5-6.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.5-6.2">
                  <p id="section-6.1.3.1.5-6.2.1">
                    Optional to support: array of objects, array of numbers<a href="#section-6.1.3.1.5-6.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-6.1.3.1.5-7">
                Combination with other operators in a metadata parameter policy:<a href="#section-6.1.3.1.5-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.3.1.5-8.1">
                  <p id="section-6.1.3.1.5-8.1.1">
                    MAY be combined with <code>value</code>,
                    in which case the values of <code>value</code>
                    MUST be a subset of the values of
                    <code>subset_of</code>.<a href="#section-6.1.3.1.5-8.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.5-8.2">
                  <p id="section-6.1.3.1.5-8.2.1">
                    MAY be combined with <code>add</code>, in
                    which case the values of <code>add</code>
                    MUST be a subset of the values of
                    <code>subset_of</code>.<a href="#section-6.1.3.1.5-8.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.5-8.3">
                  <p id="section-6.1.3.1.5-8.3.1">
                    MAY be combined with <code>default</code>.<a href="#section-6.1.3.1.5-8.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.5-8.4">
                  <p id="section-6.1.3.1.5-8.4.1">
                    MAY be combined with <code>superset_of</code>,
                    in which case the values of
                    <code>subset_of</code> MUST be a superset of
                    the values of <code>superset_of</code>.<a href="#section-6.1.3.1.5-8.4.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.5-8.5">
                  <p id="section-6.1.3.1.5-8.5.1">
                    MAY be combined with <code>essential</code>.<a href="#section-6.1.3.1.5-8.5.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-6.1.3.1.5-9">
                Order of application: After <code>one_of</code>.<a href="#section-6.1.3.1.5-9" class="pilcrow">¶</a></p>
<p id="section-6.1.3.1.5-10">
                Operator value merge: The result of merging the values of two
                <code>subset_of</code> operators is the
                intersection of the operator values. Note that the resulting
                intersection may thus be an empty array
                <code>[]</code>.<a href="#section-6.1.3.1.5-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="superset_of_operator">
<section id="section-6.1.3.1.6">
              <h6 id="name-superset_of">
<a href="#section-6.1.3.1.6" class="section-number selfRef">6.1.3.1.6. </a><a href="#name-superset_of" class="section-name selfRef">superset_of</a>
              </h6>
<p id="section-6.1.3.1.6-1">
                Name: <code>superset_of</code><a href="#section-6.1.3.1.6-1" class="pilcrow">¶</a></p>
<p id="section-6.1.3.1.6-2">
                Action: If the metadata parameter is present, its values MUST
                contain those specified in the operator value. By mathematically
                defining supersets, equality is included.<a href="#section-6.1.3.1.6-2" class="pilcrow">¶</a></p>
<p id="section-6.1.3.1.6-3">
                Metadata parameter JSON values:<a href="#section-6.1.3.1.6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.3.1.6-4.1">
                  <p id="section-6.1.3.1.6-4.1.1">
                    Mandatory to support: array of strings<a href="#section-6.1.3.1.6-4.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.6-4.2">
                  <p id="section-6.1.3.1.6-4.2.1">
                    Optional to support: array of objects, array of numbers<a href="#section-6.1.3.1.6-4.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-6.1.3.1.6-5">
                Operator JSON values:<a href="#section-6.1.3.1.6-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.3.1.6-6.1">
                  <p id="section-6.1.3.1.6-6.1.1">
                    Mandatory to support: array of strings<a href="#section-6.1.3.1.6-6.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.6-6.2">
                  <p id="section-6.1.3.1.6-6.2.1">
                    Optional to support: array of objects, array of numbers<a href="#section-6.1.3.1.6-6.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-6.1.3.1.6-7">
                Combination with other operators in a metadata parameter policy:<a href="#section-6.1.3.1.6-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.3.1.6-8.1">
                  <p id="section-6.1.3.1.6-8.1.1">
                    MAY be combined with <code>value</code>,
                    in which case the values of <code>value</code>
                    MUST be a superset of the values of
                    <code>superset_of</code>.<a href="#section-6.1.3.1.6-8.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.6-8.2">
                  <p id="section-6.1.3.1.6-8.2.1">
                    MAY be combined with <code>add</code>.<a href="#section-6.1.3.1.6-8.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.6-8.3">
                  <p id="section-6.1.3.1.6-8.3.1">
                    MAY be combined with <code>default</code>.<a href="#section-6.1.3.1.6-8.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.6-8.4">
                  <p id="section-6.1.3.1.6-8.4.1">
                    MAY be combined with <code>subset_of</code>,
                    in which case the values of
                    <code>subset_of</code> MUST be a superset of
                    the values of <code>superset_of</code>.<a href="#section-6.1.3.1.6-8.4.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.6-8.5">
                  <p id="section-6.1.3.1.6-8.5.1">
                    MAY be combined with <code>essential</code>.<a href="#section-6.1.3.1.6-8.5.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-6.1.3.1.6-9">
                Order of application: After <code>subset_of</code>.<a href="#section-6.1.3.1.6-9" class="pilcrow">¶</a></p>
<p id="section-6.1.3.1.6-10">
                Operator value merge: The result of merging the values of two
                <code>superset_of</code> operators is the union
                of the operator values.<a href="#section-6.1.3.1.6-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="essential_operator">
<section id="section-6.1.3.1.7">
              <h6 id="name-essential">
<a href="#section-6.1.3.1.7" class="section-number selfRef">6.1.3.1.7. </a><a href="#name-essential" class="section-name selfRef">essential</a>
              </h6>
<p id="section-6.1.3.1.7-1">
                Name: <code>essential</code><a href="#section-6.1.3.1.7-1" class="pilcrow">¶</a></p>
<p id="section-6.1.3.1.7-2">
                Action: If the value of this operator is
                <code>true</code>, then the metadata parameter
                MUST be present. If <code>false</code>, the
                metadata parameter is voluntary and may be absent. If the
                <code>essential</code> operator is omitted, this
                is equivalent to including it with a value of
                <code>false</code>.<a href="#section-6.1.3.1.7-2" class="pilcrow">¶</a></p>
<p id="section-6.1.3.1.7-3">
                Metadata parameter JSON values:<a href="#section-6.1.3.1.7-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.3.1.7-4.1">
                  <p id="section-6.1.3.1.7-4.1.1">
                    Mandatory to support: string, number, boolean, object, array<a href="#section-6.1.3.1.7-4.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-6.1.3.1.7-5">
                Operator JSON values:<a href="#section-6.1.3.1.7-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.3.1.7-6.1">
                  <p id="section-6.1.3.1.7-6.1.1">
                    Mandatory to support: boolean<a href="#section-6.1.3.1.7-6.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-6.1.3.1.7-7">
                Combination with other operators in a metadata parameter policy:<a href="#section-6.1.3.1.7-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.3.1.7-8.1">
                  <p id="section-6.1.3.1.7-8.1.1">
                    MAY be combined with <code>value</code>,
                    except when <code>value</code> is <code>null</code> and
                    <code>essential</code> is true.<a href="#section-6.1.3.1.7-8.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.3.1.7-8.2">
                  <p id="section-6.1.3.1.7-8.2.1">
                    MAY be combined with any other operator.<a href="#section-6.1.3.1.7-8.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-6.1.3.1.7-9">
                Order of application: Last<a href="#section-6.1.3.1.7-9" class="pilcrow">¶</a></p>
<p id="section-6.1.3.1.7-10">
                Operator value merge: The result of merging the values of two
                <code>essential</code> operators is the logical
                disjunction (<code>OR</code>) of the operator values.<a href="#section-6.1.3.1.7-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="standard_metadata_policy_operators_notes">
<section id="section-6.1.3.1.8">
              <h6 id="name-notes-on-operators">
<a href="#section-6.1.3.1.8" class="section-number selfRef">6.1.3.1.8. </a><a href="#name-notes-on-operators" class="section-name selfRef">Notes on Operators</a>
              </h6>
<p id="section-6.1.3.1.8-1">
                A "set equals" metadata parameter policy can be expressed by
                combining the operators <code>subset_of</code> and
                <code>superset_of</code> with identical array
                values.<a href="#section-6.1.3.1.8-1" class="pilcrow">¶</a></p>
<p id="section-6.1.3.1.8-2">
 Some JSON libraries may have issues comparing JSON objects.
 For this reason, support for applying metadata policy to
 metadata values that are JSON objects is mandatory only for the
 <code>essential</code>
 operator, which does not require comparison of values.
 It is OPTIONAL for the
 <code>add</code>,
 <code>one_of</code>,
 <code>subset_of</code>, and
 <code>superset_of</code>
 operators, which operate on JSON arrays
 and therefore require comparison of values.
 And it is OPTIONAL for the
 <code>value</code> and
 <code>default</code> operators,
 since merging values and defaults requires comparing
 the operators' values with existing ones.<a href="#section-6.1.3.1.8-2" class="pilcrow">¶</a></p>
<p id="section-6.1.3.1.8-3">
                The <code>scope</code> OAuth 2.0 client metadata
                parameter, defined in <span>[<a href="#RFC7591" class="cite xref">RFC7591</a>]</span> and represented by
                a string of space-separated string values, is to be regarded and
                processed as a string array by policy operators, such as the
                operators <code>default</code>,
                <code>subset_of</code> and
                <code>superset_of</code>. The resulting
                <code>scope</code> metadata parameter is a
                space-separated string of individual scope values, where the
                scope values present are taken from the array of values produced
                by applying the metadata operators to the
                <code>scope</code> parameter.<a href="#section-6.1.3.1.8-3" class="pilcrow">¶</a></p>
<p id="section-6.1.3.1.8-4" class="keepWithNext">
                  The following table is a map of the outputs produced by
                  combinations of the <code>essential</code> and
                  <code>subset_of</code> policy operators with
                  different input metadata parameter values.
                  Note, the <code>subset_of</code> check is skipped
                  when the metadata parameter is absent and designated as
                  voluntary, as shown in the last row.<a href="#section-6.1.3.1.8-4" class="pilcrow">¶</a></p>
<span id="name-examples-of-outputs-with-co"></span><table class="center" id="table-1">
                <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-examples-of-outputs-with-co" class="selfRef">Examples of Outputs with Combinations of
                  <code>essential</code> and
                  <code>subset_of</code> for Different Inputs</a>
                </caption>
<thead>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="2">Policy</td>
                    <td class="text-left" rowspan="1" colspan="2">Metadata Parameter</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="">essential</td>
                    <td class="text-left" rowspan="1" colspan="">subset_of</td>
                    <td class="text-left" rowspan="1" colspan="">input</td>
                    <td class="text-left" rowspan="1" colspan="">output</td>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">true</td>
                    <td class="text-left" rowspan="1" colspan="1">[a,b,c]</td>
                    <td class="text-left" rowspan="1" colspan="1">[a,e]</td>
                    <td class="text-left" rowspan="1" colspan="1">[a]</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">false</td>
                    <td class="text-left" rowspan="1" colspan="1">[a,b,c]</td>
                    <td class="text-left" rowspan="1" colspan="1">[a,e]</td>
                    <td class="text-left" rowspan="1" colspan="1">[a]</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">true</td>
                    <td class="text-left" rowspan="1" colspan="1">[a,b,c]</td>
                    <td class="text-left" rowspan="1" colspan="1">[d,e]</td>
                    <td class="text-left" rowspan="1" colspan="1">[]</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">false</td>
                    <td class="text-left" rowspan="1" colspan="1">[a,b,c]</td>
                    <td class="text-left" rowspan="1" colspan="1">[d,e]</td>
                    <td class="text-left" rowspan="1" colspan="1">[]</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">true</td>
                    <td class="text-left" rowspan="1" colspan="1">[a,b,c]</td>
                    <td class="text-left" rowspan="1" colspan="1">no parameter</td>
                    <td class="text-left" rowspan="1" colspan="1">error</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">false</td>
                    <td class="text-left" rowspan="1" colspan="1">[a,b,c]</td>
                    <td class="text-left" rowspan="1" colspan="1">no parameter</td>
                    <td class="text-left" rowspan="1" colspan="1">no parameter</td>
                  </tr>
                </tbody>
              </table>
</section>
</div>
</section>
</div>
<div id="additional_metadata_policy_operators">
<section id="section-6.1.3.2">
            <h5 id="name-additional-operators">
<a href="#section-6.1.3.2" class="section-number selfRef">6.1.3.2. </a><a href="#name-additional-operators" class="section-name selfRef">Additional Operators</a>
            </h5>
<p id="section-6.1.3.2-1">
              Federations MAY specify and use additional metadata policy
              operators that conform with the principles in
              <a href="#metadata_policy_principles" class="auto internal xref">Section 6.1.1</a> and in
              <a href="#metadata_policy_operators" class="auto internal xref">Section 6.1.3</a>.<a href="#section-6.1.3.2-1" class="pilcrow">¶</a></p>
<p id="section-6.1.3.2-2">
              Additional operators MUST observe the following rules in regard to
              the order of their application relative to the standard operators
              defined in <a href="#standard_metadata_policy_operators" class="auto internal xref">Section 6.1.3.1</a>:<a href="#section-6.1.3.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.3.2-3.1">
                <p id="section-6.1.3.2-3.1.1">
                    Additional operators that modify metadata parameters MUST be
                    applied after the <code>value</code> operator
                    that is specified in <a href="#value_operator" class="auto internal xref">Section 6.1.3.1.1</a>.<a href="#section-6.1.3.2-3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1.3.2-3.2">
                <p id="section-6.1.3.2-3.2.1">
                    Additional operators that check metadata parameters MUST be
                    applied before the <code>essential</code>
                    operator that is specified in
                    <a href="#essential_operator" class="auto internal xref">Section 6.1.3.1.7</a>.<a href="#section-6.1.3.2-3.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-6.1.3.2-4">
              Implementations MUST ignore additional operators that are not
              understood, unless the operator name is included in the
              <code>metadata_policy_crit</code> Subordinate
              Statement Claim, in which case the operator MUST be understood
              and processed. If an additional operator listed in
              <code>metadata_policy_crit</code> is not understood
              or cannot be processed, then this MUST produce a policy error and
              the Trust Chain MUST be considered invalid.<a href="#section-6.1.3.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="metadata_policy_enforcement">
<section id="section-6.1.4">
          <h4 id="name-enforcement">
<a href="#section-6.1.4" class="section-number selfRef">6.1.4. </a><a href="#name-enforcement" class="section-name selfRef">Enforcement</a>
          </h4>
<p id="section-6.1.4-1">
              This section describes the resolution of the metadata policy for a
              Trust Chain and its application to the metadata of the Federation
              Entity that is the Trust Chain subject.<a href="#section-6.1.4-1" class="pilcrow">¶</a></p>
<p id="section-6.1.4-2">
              If a policy error or another error is encountered during the
              metadata policy resolution or its application, the Trust Chain
              MUST be considered invalid.<a href="#section-6.1.4-2" class="pilcrow">¶</a></p>
<div id="metadata_policy_resolution">
<section id="section-6.1.4.1">
            <h5 id="name-resolution">
<a href="#section-6.1.4.1" class="section-number selfRef">6.1.4.1. </a><a href="#name-resolution" class="section-name selfRef">Resolution</a>
            </h5>
<p id="section-6.1.4.1-1">
                The metadata policy for a Trust Chain is determined by the
                sequence of the present <code>metadata_policy</code>
                Claims of the Subordinate Statements that make up the chain.<a href="#section-6.1.4.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1.4.1-2">
                The resolution process MUST first gather the names of all policy
                operators other than the standard ones defined in
                <a href="#standard_metadata_policy_operators" class="auto internal xref">Section 6.1.3.1</a> that are
                declared as critical. This is done by checking each Subordinate
                Statement in the Trust Chain for the optional
                <code>metadata_policy_crit</code> Claim,
                described in <a href="#ss-specific" class="auto internal xref">Section 3.1.3</a>, and collecting
                any operator names that are found in it.<a href="#section-6.1.4.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1.4.1-3">
                The resolution process proceeds by iterating through the
                Subordinate Statements. The sequence of this iteration is
                crucial - it MUST begin with the Subordinate Statement issued by
                the most Superior Entity and end with the Subordinate Statement
                issued by the Immediate Superior of the Trust Chain subject.<a href="#section-6.1.4.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1.4.1-4">
                An important task during the iteration is the
                <code>metadata_policy</code> validation. It MUST
                ensure the data structure is compliant and that every metadata
                parameter policy contains only allowed operator combinations, as
                described in <a href="#metadata_policy_operators" class="auto internal xref">Section 6.1.3</a>, and in
                accordance with the specifications of the operators. It MUST
                also be ensured that the <code>metadata_policy</code>
                contains no operators that cannot be understood and processed
                whose names are among the collected
                <code>metadata_policy_crit</code> values. An
                unsuccessful validation MUST produce a policy error.<a href="#section-6.1.4.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1.4.1-5">
                At each iteration step, the Subordinate Statement MUST be checked
                for the presence of a <code>metadata_policy</code>
                Claim. The first encountered
                <code>metadata_policy</code> MUST be validated as
                described above, after which it becomes the current metadata
                policy.<a href="#section-6.1.4.1-5" class="pilcrow">¶</a></p>
<p id="section-6.1.4.1-6">
                If the iteration yields a next subordinate
                <code>metadata_policy</code> Claim, it MUST be
                validated as described above, then merged into the current
                metadata policy.<a href="#section-6.1.4.1-6" class="pilcrow">¶</a></p>
<p id="section-6.1.4.1-7">
                The merge is performed at each of the three levels of the
                <code>metadata_policy</code> data structure
                described in <a href="#metadata_policy_structure" class="auto internal xref">Section 6.1.2</a>, by
                starting from the top level:<a href="#section-6.1.4.1-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.1.4.1-8">
<li id="section-6.1.4.1-8.1">
                <p id="section-6.1.4.1-8.1.1">
                      The metadata policies for Entity Types.<a href="#section-6.1.4.1-8.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-6.1.4.1-8.2">
                <p id="section-6.1.4.1-8.2.1">
                      The metadata parameter policies for an Entity Type.<a href="#section-6.1.4.1-8.2.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-6.1.4.1-8.3">
                <p id="section-6.1.4.1-8.3.1">
                      The operators for a metadata parameter policy for an
                      Entity Type.<a href="#section-6.1.4.1-8.3.1" class="pilcrow">¶</a></p>
</li>
            </ol>
<p id="section-6.1.4.1-9">
                At the level of metadata policies for Entity Types, the merge
                proceeds as follows:<a href="#section-6.1.4.1-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.4.1-10.1">
                <p id="section-6.1.4.1-10.1.1">
                      If the next subordinate
                      <code>metadata_policy</code> Claim contains
                      a metadata policy for an Entity Type that is already
                      present in the current metadata policy, it MUST be merged
                      according to the rules of the next lower level (the
                      metadata parameter policies).<a href="#section-6.1.4.1-10.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1.4.1-10.2">
                <p id="section-6.1.4.1-10.2.1">
                      Entity Type metadata policies in the next subordinate
                      <code>metadata_policy</code> Claim that are
                      not present in the current metadata policy MUST be copied
                      to it.<a href="#section-6.1.4.1-10.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-6.1.4.1-11">
                At the level of metadata parameter policies, the merge proceeds
                as follows:<a href="#section-6.1.4.1-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.4.1-12.1">
                <p id="section-6.1.4.1-12.1.1">
                      If a metadata parameter policy is already present in the
                      current Entity Type metadata policy, it MUST be merged
                      according to the rules of the next lower level (the
                      operators for the metadata parameter policy). If the
                      resulting metadata parameter policy contains combinations
                      that are not allowed, as described in
                      <a href="#metadata_policy_operators" class="auto internal xref">Section 6.1.3</a> and in
                      accordance with the specifications of the operators, this
                      MUST produce a policy error.<a href="#section-6.1.4.1-12.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1.4.1-12.2">
                <p id="section-6.1.4.1-12.2.1">
                      Subordinate metadata parameter policies that are not
                      present in the current Entity Type metadata policy MUST be
                      copied to it.<a href="#section-6.1.4.1-12.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-6.1.4.1-13">
                At the level of operators, the merge proceeds as follows:<a href="#section-6.1.4.1-13" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.4.1-14.1">
                <p id="section-6.1.4.1-14.1.1">
                      If an operator is already present in the current metadata
                      parameter policy, the values of the subordinate operator
                      MUST be merged, as described in
                      <a href="#metadata_policy_operators" class="auto internal xref">Section 6.1.3</a> and in
                      accordance with the operator specification. If an operator
                      value merge is not allowed or otherwise unsuccessful this
                      MUST produce a policy error.<a href="#section-6.1.4.1-14.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1.4.1-14.2">
                <p id="section-6.1.4.1-14.2.1">
                      Subordinate operators that are not present in the current
                      metadata parameter policy MUST be copied to it.<a href="#section-6.1.4.1-14.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-6.1.4.1-15">
                If no further Subordinate Statements with a
                <code>metadata_policy</code> Claim are found, the
                current metadata policy becomes the resolved one for the Trust Chain.<a href="#section-6.1.4.1-15" class="pilcrow">¶</a></p>
</section>
</div>
<div id="metadata_policy_application">
<section id="section-6.1.4.2">
            <h5 id="name-application">
<a href="#section-6.1.4.2" class="section-number selfRef">6.1.4.2. </a><a href="#name-application" class="section-name selfRef">Application</a>
            </h5>
<p id="section-6.1.4.2-1">
                If the Subordinate Statement about the Trust Chain subject
                contains a <code>metadata</code> Claim, this MUST
                first be applied, as described in the Claim definition in
                <a href="#common-claims" class="auto internal xref">Section 3.1.1</a>, and only then it can be
                proceeded with applying the Resolved Metadata policy.<a href="#section-6.1.4.2-1" class="pilcrow">¶</a></p>
<p id="section-6.1.4.2-2">
                If the process described in
                <a href="#metadata_policy_resolution" class="auto internal xref">Section 6.1.4.1</a> found no Subordinate
                Statements in the Trust Chain with a
                <code>metadata_policy</code> Claim, the metadata
                of the Trust Chain subject resolves simply to the
                <code>metadata</code> found in its Entity
                Configuration, with any <code>metadata</code>
                parameters provided by the Immediate Superior applied to it.<a href="#section-6.1.4.2-2" class="pilcrow">¶</a></p>
<p id="section-6.1.4.2-3">
                If a metadata policy was resolved for the Trust Chain, for every
                Entity Type metadata and metadata parameter for which a
                corresponding metadata parameter policy is present, the included
                policy operators MUST be applied as described in
                <a href="#metadata_policy_operators" class="auto internal xref">Section 6.1.3</a> and in accordance with
                the specifications of the operators. The operators MUST be
                applied to the metadata parameter in a sequence that is
                determined by the absolute or relative order specified for each
                operator.<a href="#section-6.1.4.2-3" class="pilcrow">¶</a></p>
<p id="section-6.1.4.2-4">
                If the application of metadata policies results in illegal or
                otherwise incorrect Resolved Metadata, then the metadata MUST be regarded
                as broken and MUST NOT be used.<a href="#section-6.1.4.2-4" class="pilcrow">¶</a></p>
<p id="section-6.1.4.2-5">
                The Trust Chain subject is responsible to verify that it is
                able to support and comply with the Resolved Metadata that results from
                the application of federation metadata policies. For instance,
                this may involve a check that cryptographic algorithms required
                by the resulting Resolved Metadata are supported.
 Likewise, the Trust Chain subject MUST verify that
 all the required metadata parameters for its Entity Types are present
 and all the metadata values in the Resolved Metadata are valid.
 When metadata policies
                change, Trust Chain subjects may need to reevaluate their
                support and compliance.<a href="#section-6.1.4.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="metadata-policy-example">
<section id="section-6.1.5">
          <h4 id="name-metadata-policy-example">
<a href="#section-6.1.5" class="section-number selfRef">6.1.5. </a><a href="#name-metadata-policy-example" class="section-name selfRef">Metadata Policy Example</a>
          </h4>
<p id="section-6.1.5-1">
            The following is a non-normative example of resolving and applying
            Trust Chain metadata policies for an OpenID relying party.<a href="#section-6.1.5-1" class="pilcrow">¶</a></p>
<p id="section-6.1.5-2" class="keepWithNext">
              We start with a federation Trust Anchor's
              <code>metadata_policy</code> for RPs:<a href="#section-6.1.5-2" class="pilcrow">¶</a></p>
<span id="name-example-metadata-policy-of-"></span><figure id="figure-8">
            <div class="alignLeft art-text artwork" id="section-6.1.5-3.1">
<pre>
"metadata_policy": {
  "openid_relying_party": {
    "grant_types": {
       "default": [
        "authorization_code"
      ],
      "subset_of": [
        "authorization_code",
        "refresh_token"
      ],
      "superset_of": [
        "authorization_code"
      ]
    },
    "token_endpoint_auth_method": {
      "one_of": [
        "private_key_jwt",
        "self_signed_tls_client_auth"
      ],
      "essential": true
    },
    "token_endpoint_auth_signing_alg" : {
      "one_of": [
        "PS256",
        "ES256"
      ]
    },
    "subject_type": {
      "value": "pairwise"
    },
    "contacts": {
      "add": [
        "helpdesk@federation.example.org"
      ]
    }
  }
}
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-example-metadata-policy-of-" class="selfRef">Example Metadata Policy of a Trust Anchor for RPs</a>
            </figcaption></figure>
<p id="section-6.1.5-4" class="keepWithNext">
              Next, we have an Intermediate organization's
              <code>metadata_policy</code> for Subordinate RPs
              together with <code>metadata</code> values for its
              Immediate Subordinate RPs:<a href="#section-6.1.5-4" class="pilcrow">¶</a></p>
<span id="name-example-metadata-policy-and"></span><figure id="figure-9">
            <div class="alignLeft art-text artwork" id="section-6.1.5-5.1">
<pre>
{
  "metadata_policy": {
    "openid_relying_party": {
      "grant_types": {
        "subset_of": [
          "authorization_code"
        ]
      },
      "token_endpoint_auth_method": {
        "one_of": [
          "self_signed_tls_client_auth"
        ]
      },
      "contacts": {
        "add": [
          "helpdesk@org.example.org"
        ]
      }
    }
  },
  "metadata": {
    "openid_relying_party": {
      "sector_identifier_uri": "https://org.example.org/sector-ids.json",
      "policy_uri": "https://org.example.org/policy.html"
    }
  }
}
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-example-metadata-policy-and" class="selfRef">Example Metadata Policy and Metadata Values of an Intermediate
              Entity for RPs</a>
            </figcaption></figure>
<p id="section-6.1.5-6" class="keepWithNext">
              Merging the example RP metadata policy of the Intermediate Entity
              into the RP metadata policy of the Trust Anchor produces the
              following policy for the Trust Chain:<a href="#section-6.1.5-6" class="pilcrow">¶</a></p>
<span id="name-example-merged-metadata-pol"></span><figure id="figure-10">
            <div class="alignLeft art-text artwork" id="section-6.1.5-7.1">
<pre>
{
  "grant_types": {
    "default": [
      "authorization_code"
    ],
    "superset_of": [
      "authorization_code"
    ],
    "subset_of": [
      "authorization_code"
    ]
  },
  "token_endpoint_auth_method": {
    "one_of": [
      "self_signed_tls_client_auth"
    ],
    "essential": true
  },
  "token_endpoint_auth_signing_alg": {
    "one_of": [
      "PS256",
      "ES256"
    ]
  },
  "subject_type": {
    "value": "pairwise"
  },
  "contacts": {
    "add": [
      "helpdesk@federation.example.org",
      "helpdesk@org.example.org"
    ]
  }
}
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-example-merged-metadata-pol" class="selfRef">Example Merged Metadata Policy for RPs</a>
            </figcaption></figure>
<p id="section-6.1.5-8" class="keepWithNext">
              The Trust Chain subject is a Leaf Entity, which publishes the
              following RP metadata in its Entity Configuration:<a href="#section-6.1.5-8" class="pilcrow">¶</a></p>
<span id="name-example-entity-configuratio"></span><figure id="figure-11">
            <div class="alignLeft art-text artwork" id="section-6.1.5-9.1">
<pre>
"metadata": {
  "openid_relying_party": {
    "redirect_uris": [
      "https://rp.example.org/callback"
    ],
    "response_types": [
      "code"
    ],
    "token_endpoint_auth_method": "self_signed_tls_client_auth",
    "contacts": [
      "rp_admins@rp.example.org"
    ]
  }
}
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-example-entity-configuratio" class="selfRef">Example Entity Configuration RP Metadata</a>
            </figcaption></figure>
<p id="section-6.1.5-10" class="keepWithNext">
              The <code>metadata</code> values specified by the
              Intermediate Entity for its Immediate Subordinates are applied to
              the Trust Chain subject <code>metadata</code>.
              After that, the merged metadata policy is applied, to produce the
              following resulting RP Resolved Metadata:<a href="#section-6.1.5-10" class="pilcrow">¶</a></p>
<span id="name-the-resulting-rp-resolved-m"></span><figure id="figure-12">
            <div class="alignLeft art-text artwork" id="section-6.1.5-11.1">
<pre>
{
  "redirect_uris": [
    "https://rp.example.org/callback"
  ],
  "grant_types": [
    "authorization_code"
  ],
  "response_types": [
    "code"
  ],
  "token_endpoint_auth_method": "self_signed_tls_client_auth",
  "subject_type": "pairwise",
  "sector_identifier_uri": "https://org.example.org/sector-ids.json",
  "policy_uri": "https://org.example.org/policy.html",
  "contacts": [
    "rp_admins@rp.example.org",
    "helpdesk@federation.example.org",
    "helpdesk@org.example.org"
  ]
}
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-the-resulting-rp-resolved-m" class="selfRef">The Resulting RP Resolved Metadata for the Trust Chain Subject</a>
            </figcaption></figure>
</section>
</div>
</section>
</div>
<div id="chain_constraints">
<section id="section-6.2">
        <h3 id="name-constraints">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-constraints" class="section-name selfRef">Constraints</a>
        </h3>
<p id="section-6.2-1">
      Trust Anchors and Intermediate Entities MAY define constraining criteria
      that apply to their Subordinates. They are expressed in the
      <code>constraints</code> Claim of a Subordinate Statement,
      as described in <a href="#ss-specific" class="auto internal xref">Section 3.1.3</a>.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">
   The following constraint parameters are defined:<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-6.2-3">
          <dt id="section-6.2-3.1">max_path_length</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-3.2">
              OPTIONAL. Integer specifying the maximum number of Intermediate
              Entities between the Entity setting the constraint and the Trust
              Chain subject.<a href="#section-6.2-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.3">naming_constraints</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-3.4">
              OPTIONAL. JSON object specifying restrictions on the URIs of the
           Entity Identifiers of Subordinate Entities. Restrictions are
              defined in terms of permitted and excluded URI name subtrees.<a href="#section-6.2-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.5">allowed_entity_types</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-3.6">
              OPTIONAL. Array of string Entity Type Identifiers.
              Entity Type Identifiers are defined in <a href="#entity_types" class="auto internal xref">Section 5.1</a>.
              This constraint specifies the Entity Types and hence the metadata
              that Subordinate Entities are allowed to have.<a href="#section-6.2-3.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.2-4">
   Additional constraint parameters MAY be defined and used.
   If they are not understood, they MUST be ignored.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<p id="section-6.2-5" class="keepWithNext">
     The following is a non-normative example of a set of constraints:<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<span id="name-example-set-of-constraints"></span><figure id="figure-13">
          <div class="alignLeft art-text artwork" id="section-6.2-6.1">
<pre>
{
  "max_path_length": 2,
  "naming_constraints": {
    "permitted": [
      ".example.com"
    ],
    "excluded": [
      "east.example.com"
    ]
  },
  "allowed_entity_types": [
    "openid_provider",
    "openid_relying_party"
  ]
}
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-example-set-of-constraints" class="selfRef">Example Set of Constraints</a>
          </figcaption></figure>
<p id="section-6.2-7">
          When resolving the Trust Chain for an Entity the
          <code>constraints</code> Claim in each Subordinate
          Statement MUST be independently applied, if present. If any of the
          <code>constraints</code> checks fails, the Trust Chain
          MUST be considered invalid.<a href="#section-6.2-7" class="pilcrow">¶</a></p>
<div id="max_path_length">
<section id="section-6.2.1">
          <h4 id="name-max-path-length-constraint">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-max-path-length-constraint" class="section-name selfRef">Max Path Length Constraint</a>
          </h4>
<p id="section-6.2.1-1">
            The <code>max_path_length</code> constraint specifies
            the maximum allowed number of Intermediate Entities in a Trust Chain
            between a Trust Anchor or Intermediate that sets the constraint and
            the Trust Chain subject.<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<p id="section-6.2.1-2">
            A <code>max_path_length</code> constraint of zero
            indicates that no Intermediates MAY appear between this Entity and
            the Trust Chain subject. The
            <code>max_path_length</code> constraint MUST have a
            value greater than or equal to zero.<a href="#section-6.2.1-2" class="pilcrow">¶</a></p>
<p id="section-6.2.1-3">
            Omitting the <code>max_path_length</code> constraint
            means that there are no additional constraints apart from those
            already in effect.<a href="#section-6.2.1-3" class="pilcrow">¶</a></p>
<p id="section-6.2.1-4">
            Assuming that we have a Trust Chain with four Entity Statements:<a href="#section-6.2.1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2.1-5">
<li id="section-6.2.1-5.1">
              <p id="section-6.2.1-5.1.1">Entity Configuration of a Leaf Entity (LE)<a href="#section-6.2.1-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.2.1-5.2">
              <p id="section-6.2.1-5.2.1">Subordinate Statement by an Intermediate 1 (I1) about LE<a href="#section-6.2.1-5.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.2.1-5.3">
              <p id="section-6.2.1-5.3.1">Subordinate Statement by an Intermediate 2 (I2) about I1<a href="#section-6.2.1-5.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.2.1-5.4">
              <p id="section-6.2.1-5.4.1">Subordinate Statement by a Trust Anchor (TA) about I2<a href="#section-6.2.1-5.4.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-6.2.1-6">
            Then the Trust Chain fulfills the constraints if, for instance:<a href="#section-6.2.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-7.1">
              <p id="section-6.2.1-7.1.1">
                The TA specifies a <code>max_path_length</code>
                that is greater than or equal to 2.<a href="#section-6.2.1-7.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-7.2">
              <p id="section-6.2.1-7.2.1">
                TA specifies a <code>max_path_length</code> of 2,
                I2 specifies a <code>max_path_length</code> of 1,
                and I1 omits the <code>max_path_length</code>
                constraint.<a href="#section-6.2.1-7.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-7.3">
              <p id="section-6.2.1-7.3.1">
                Neither TA nor I2 specifies any
                <code>max_path_length</code> constraint while I1
                sets <code>max_path_length</code> to 0.<a href="#section-6.2.1-7.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.2.1-8">
            The Trust Chain does not fulfill the constraints if, for instance,
            the:<a href="#section-6.2.1-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-9.1">
              <p id="section-6.2.1-9.1.1">
                The TA sets the <code>max_path_length</code> to 1.<a href="#section-6.2.1-9.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="naming_constraints">
<section id="section-6.2.2">
          <h4 id="name-naming-constraints">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-naming-constraints" class="section-name selfRef">Naming Constraints</a>
          </h4>
<p id="section-6.2.2-1">
            The <code>naming_constraints</code> member specifies
            a URI namespace within which the Entity Identifiers of Subordinate
            Entities in a Trust Chain MUST be located.<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2.2-2">
     Restrictions are defined in terms of URI name subtrees,
     using <code>permitted</code> and/or
     <code>excluded</code> members within the
     <code>naming_constraints</code> member,
     each of which contains an array of names to be permitted or excluded.
     Any name matching a restriction in the excluded list is invalid,
     regardless of the information appearing in the permitted list.<a href="#section-6.2.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2.2-3">
     This specification uses the syntax of domain name constraints
     specified in Section 4.2.1.10 of <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.
            As stated there, a domain name constraint MUST be specified as a fully qualified domain name
            and MAY specify a host or a domain. Examples are
            "host.example.com" and ".example.com". When the domain name constraint begins
            with a period, it MAY be expanded with one or more labels.
            That is, the domain name constraint ".example.com" is satisfied by both
            host.example.com and my.host.example.com. However, the domain name constraint
            ".example.com" is not satisfied by "example.com". When the
            domain name constraint does not begin with a period, it specifies a host.
     As in RFC 5280, domain name constraints apply to the host part of the URI.<a href="#section-6.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="entity_type_constraints">
<section id="section-6.2.3">
          <h4 id="name-entity-type-constraints">
<a href="#section-6.2.3" class="section-number selfRef">6.2.3. </a><a href="#name-entity-type-constraints" class="section-name selfRef">Entity Type Constraints</a>
          </h4>
<p id="section-6.2.3-1">
            The <code>allowed_entity_types</code> constraint
            specifies the acceptable metadata Entity Types of Subordinate Entities in a
            Trust Chain. If there is no
            <code>allowed_entity_types</code> constraint, it
            means that any Entity Type is allowed. The
            <code>federation_entity</code> Entity Type
            Identifier, specified in <a href="#federation_entity" class="auto internal xref">Section 5.1.1</a>, is
            always allowed and MUST NOT be included in the constraint. If the
            constraint is the empty array <code>[]</code>, it
            means that only the <code>federation_entity</code>
            Entity Type is allowed.<a href="#section-6.2.3-1" class="pilcrow">¶</a></p>
<p id="section-6.2.3-2">
                To apply the <code>allowed_entity_types</code> constraint during Trust Chain Resolution
                all Entity Types that are not listed in the <code>allowed_entity_types</code> constraint
                MUST be removed from the metadata Claim in the subject's Entity Configuration.
                The <code>federation_entity</code> Entity Type MUST NOT be removed.
                This MUST be done before applying Metadata Policies but after applying Metadata from a direct
                superior's Subordinate Statement.<a href="#section-6.2.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="trust_marks">
<section id="section-7">
      <h2 id="name-trust-marks">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-trust-marks" class="section-name selfRef">Trust Marks</a>
      </h2>
<p id="section-7-1">
   Per the definition in <a href="#Terminology" class="auto internal xref">Section 1.2</a>,
   Trust Marks are statements of conformance to sets of criteria
   determined by an accreditation authority.
   Trust Marks used by this specification are signed JWTs.
   Entity Statements MAY include Trust Marks,
   as described in the <code>trust_marks</code>
   Claim definition in <a href="#ec-specific" class="auto internal xref">Section 3.1.2</a>.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">
          Trust Marks are signed by a federation-accredited
          authority called a Trust Mark Issuer.
   All Trust Mark Issuers MUST be represented in the
          federation by an Entity. The fact that a Trust Mark Issuer is
          accepted by the federation is expressed in the
          <code>trust_mark_issuers</code> Claim of the
          Trust Anchor's Entity Configuration.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">
          The key used by the Trust Mark
          issuer to sign its Trust Marks MUST be one of the private keys
          in its set of
          Federation Entity Keys.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">
   Trust Mark JWTs MUST include the
   <code>kid</code> (Key ID) header parameter
   with its value being the Key ID of the signing key used.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5">
          Note that a federation MAY allow an Entity to self-sign
          Trust Marks.<a href="#section-7-5" class="pilcrow">¶</a></p>
<p id="section-7-6">
          Trust Mark JWTs MUST be explicitly typed by using the
          <code>typ</code> header parameter to prevent
          cross-JWT confusion, per Section 3.11 of <span>[<a href="#RFC8725" class="cite xref">RFC8725</a>]</span>.
          The <code>typ</code> header parameter value MUST be
          <code>trust-mark+jwt</code>
          unless the trust framework in use defines a more specific
          media type value for the particular kind of Trust Mark.
   Trust Marks without a <code>typ</code> header parameter
   or an unrecognized <code>typ</code> value MUST be rejected.<a href="#section-7-6" class="pilcrow">¶</a></p>
<p id="section-7-7" class="keepWithNext">
            The following is a non-normative example of
            a <code>trust_mark_issuers</code> Claim:<a href="#section-7-7" class="pilcrow">¶</a></p>
<span id="name-example-trust_mark_issuers-"></span><figure id="figure-14">
        <div class="alignLeft art-text artwork" id="section-7-8.1">
<pre>
"trust_mark_issuers":
{
  "https://openid.net/certification/op": [],
  "https://refeds.org/wp-content/uploads/2016/01/Sirtfi-1.0.pdf":
    ["https://swamid.se"]
}
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-example-trust_mark_issuers-" class="selfRef">Example <code>trust_mark_issuers</code> Claim</a>
        </figcaption></figure>
<div id="trust_mark_claims">
<section id="section-7.1">
        <h3 id="name-trust-mark-claims">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-trust-mark-claims" class="section-name selfRef">Trust Mark Claims</a>
        </h3>
<p id="section-7.1-1">
     The Claims in a Trust Mark are:<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-7.1-2">
          <dt id="section-7.1-2.1">iss</dt>
          <dd style="margin-left: 1.5em" id="section-7.1-2.2">
                REQUIRED. String. The Entity Identifier of the issuer of the Trust Mark.<a href="#section-7.1-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.1-2.3">sub</dt>
          <dd style="margin-left: 1.5em" id="section-7.1-2.4">
                REQUIRED. String. The Entity Identifier of the Entity this Trust Mark applies to.<a href="#section-7.1-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.1-2.5">trust_mark_type</dt>
          <dd style="margin-left: 1.5em" id="section-7.1-2.6">
 REQUIRED.
 The <code>trust_mark_type</code> Claim
 is used in Trust Marks
 to provide the identifier of the type of the Trust Mark.
                The Trust Mark type identifier
                MUST be collision-resistant
                across multiple federations.
                It is RECOMMENDED that the
 identifier
                value is built
                using a URL that uniquely identifies the federation
                or the trust framework
                within which it was issued. This is required to prevent
                Trust Marks issued in different federations
                from having colliding identifiers.<a href="#section-7.1-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.1-2.7">iat</dt>
          <dd style="margin-left: 1.5em" id="section-7.1-2.8">
                REQUIRED. Number. Time when this Trust Mark was issued.
                This is expressed as Seconds Since the Epoch, per
                <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-7.1-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.1-2.9">logo_uri</dt>
          <dd style="margin-left: 1.5em" id="section-7.1-2.10">
                OPTIONAL. String. URL that references a logo for the issued Trust Mark.
 The value of this field MUST point to a valid image file.<a href="#section-7.1-2.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.1-2.11">exp</dt>
          <dd style="margin-left: 1.5em" id="section-7.1-2.12">
                OPTIONAL. Number. Time when this Trust Mark is no longer valid.
                This is expressed as Seconds Since the Epoch, per <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.
                If not present, it means that the Trust Mark does not expire.<a href="#section-7.1-2.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.1-2.13">ref</dt>
          <dd style="margin-left: 1.5em" id="section-7.1-2.14">
 OPTIONAL.
 The <code>ref</code> (reference) Claim
 defined in <a href="#refClaim" class="auto internal xref">Section 13.5</a> is used in Trust Marks
 to provide a URL referring to human-readable information
 about the issuance of the Trust Mark.<a href="#section-7.1-2.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.1-2.15">delegation</dt>
          <dd style="margin-left: 1.5em" id="section-7.1-2.16">
 OPTIONAL.
 The <code>delegation</code> Claim
 defined in <a href="#delegationClaim" class="auto internal xref">Section 13.6</a> is used in Trust Marks
 to delegate the right to issue Trust Marks
 with a particular identifier.
 Its value is a Trust Mark delegation JWT,
 as defined in <a href="#delegation_jwt" class="auto internal xref">Section 7.2.1</a>.<a href="#section-7.1-2.16" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-7.1-3">
            Additional Claims MAY be defined and used in conjunction with the Claims above.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trust_mark_delegation">
<section id="section-7.2">
        <h3 id="name-trust-mark-delegation">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-trust-mark-delegation" class="section-name selfRef">Trust Mark Delegation</a>
        </h3>
<p id="section-7.2-1">
            There will be cases where the owner of a Trust Mark for some reason
            does not match the Trust Mark Issuer due to administrative or
            technical requirements. Take as an example vehicle
            inspection. Vehicle inspection is a procedure mandated by national
            or subnational governments in many countries, in which a vehicle is
            inspected to ensure that it conforms to regulations governing
            safety, emissions, or both. The body that mandates the inspections
            does not perform them; instead, there may be commercial companies
            performing the inspections, after which they issue the Trust Mark.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">
            The fact that a Trust Mark is issued by a Trust Mark Issuer that is
            not the owner of the Trust Mark is expressed by including
     a <code>delegation</code> Claim in the Trust Mark,
     whose value is a Trust Mark delegation JWT,
     as defined in <a href="#delegation_jwt" class="auto internal xref">Section 7.2.1</a>.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">
            If the Federation Operator knows that Trust Marks with a
            certain Trust Mark type identifier may legitimately be issued by Trust Mark Issuers
            that are not the owner of the Trust Mark type identifier, then information
            about the owner and the Trust Mark type identifier MUST be included in the
            <code>trust_mark_owners</code> Claim in
     the Trust Anchor's Entity Configuration.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<p id="section-7.2-4" class="keepWithNext">
            The following is a non-normative example of
            a <code>trust_mark_owners</code> Claim:<a href="#section-7.2-4" class="pilcrow">¶</a></p>
<span id="name-example-trust_mark_owners-c"></span><figure id="figure-15">
          <div class="alignLeft art-text artwork" id="section-7.2-5.1">
<pre>
"trust_mark_owners":
{
  "https://refeds.org/wp-content/uploads/2016/01/Sirtfi-1.0.pdf":
  {
    "sub": "https://refeds.org/sirtfi",
    "jwks" : {
      "keys": [
        {
          "alg": "RS256",
          "e": "AQAB",
          "kid": "Jlob6qNFuSHj3sfuntz9C_9s...",
          "kty": "RSA",
          "n": "_LioMsSeycE4pELlpPYgZluB...",
          "use": "sig"
        }
      ]
    }
  }
}
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-example-trust_mark_owners-c" class="selfRef">Example <code>trust_mark_owners</code> Claim</a>
          </figcaption></figure>
<div id="delegation_jwt">
<section id="section-7.2.1">
          <h4 id="name-trust-mark-delegation-jwt">
<a href="#section-7.2.1" class="section-number selfRef">7.2.1. </a><a href="#name-trust-mark-delegation-jwt" class="section-name selfRef">Trust Mark Delegation JWT</a>
          </h4>
<p id="section-7.2.1-1">
       A Trust Mark Delegation JWT is a signed JWT
       issued by a Trust Mark Owner
       that identifies a legitimate delegated issuer of Trust Marks
       with a particular identifier.<a href="#section-7.2.1-1" class="pilcrow">¶</a></p>
<p id="section-7.2.1-2">
            A Trust Mark delegation JWT MUST be explicitly typed, by setting the
            <code>typ</code> header parameter to
            <code>trust-mark-delegation+jwt</code> to prevent
            cross-JWT confusion, per Section 3.11 of <span>[<a href="#RFC8725" class="cite xref">RFC8725</a>]</span>.
     Trust Mark delegation JWTs without a <code>typ</code> header parameter
     or with a different <code>typ</code> value MUST be rejected.
     It is signed with a Federation Entity Key.<a href="#section-7.2.1-2" class="pilcrow">¶</a></p>
<p id="section-7.2.1-3">
     Trust Mark delegation JWTs MUST include the
     <code>kid</code> (Key ID) header parameter
     with its value being the Key ID of the signing key used.<a href="#section-7.2.1-3" class="pilcrow">¶</a></p>
<p id="section-7.2.1-4">
            The Claims in a Trust Mark delegation JWT are:<a href="#section-7.2.1-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-7.2.1-5">
            <dt id="section-7.2.1-5.1">iss</dt>
            <dd style="margin-left: 1.5em" id="section-7.2.1-5.2">
                REQUIRED. String. The owner of the Trust Mark.<a href="#section-7.2.1-5.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-7.2.1-5.3">sub</dt>
            <dd style="margin-left: 1.5em" id="section-7.2.1-5.4">
                REQUIRED. String. The Entity this delegation applies to.<a href="#section-7.2.1-5.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-7.2.1-5.5">trust_mark_type</dt>
            <dd style="margin-left: 1.5em" id="section-7.2.1-5.6">
                REQUIRED. String. The identifier for the type of the Trust Mark.<a href="#section-7.2.1-5.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-7.2.1-5.7">iat</dt>
            <dd style="margin-left: 1.5em" id="section-7.2.1-5.8">
                REQUIRED. Number. Time when this delegation was issued.
                This is expressed as Seconds Since the Epoch, per
                <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-7.2.1-5.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-7.2.1-5.9">exp</dt>
            <dd style="margin-left: 1.5em" id="section-7.2.1-5.10">
                OPTIONAL. Number. Time when this delegation stops being valid.
                This is expressed as Seconds Since the Epoch, per <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.
                If not present, it means that the delegation does not expire.<a href="#section-7.2.1-5.10" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-7.2.1-5.11">ref</dt>
            <dd style="margin-left: 1.5em" id="section-7.2.1-5.12">
                OPTIONAL. String. URL that points to human-readable information
                connected to the Trust Mark.<a href="#section-7.2.1-5.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-7.2.1-6">
     Additional Claims MAY be defined and used in conjunction with the Claims above.<a href="#section-7.2.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trust-mark-delegation-validation">
<section id="section-7.2.2">
          <h4 id="name-validating-a-trust-mark-del">
<a href="#section-7.2.2" class="section-number selfRef">7.2.2. </a><a href="#name-validating-a-trust-mark-del" class="section-name selfRef">Validating a Trust Mark Delegation</a>
          </h4>
<p id="section-7.2.2-1">
                    Validating a Trust Mark Delegation means validating a Trust Mark Delegation instance represented
                    by a specific signed JWT.<a href="#section-7.2.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2.2-2">Henceforth, "delegation" is used as a shorthand for a Trust Mark Delegation JWT.
                    The Trust Anchor referenced below is a Trust Anchor that has been successfully used when
                    establishing trust in the Trust Mark Issuer.<a href="#section-7.2.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2.2-3">
                    To validate a delegation, the following validation steps MUST be performed.
                    Please note that if any of these validation checks fail, the entire validation
                    process fails and the delegation is considered invalid.<a href="#section-7.2.2-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.2.2-4">
<li id="section-7.2.2-4.1">
              <p id="section-7.2.2-4.1.1">The delegation MUST be a signed JWT<a href="#section-7.2.2-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.2.2-4.2">
              <p id="section-7.2.2-4.2.1">The delegation MUST have a <code>typ</code> header with the value
                <code>trust-mark-delegation+jwt</code><a href="#section-7.2.2-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.2.2-4.3">
              <p id="section-7.2.2-4.3.1">The delegation MUST have an <code>alg</code> (algorithm) header parameter with a value
                that is an acceptable JWS signing algorithm; it MUST NOT be <code>none</code><a href="#section-7.2.2-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.2.2-4.4">
              <p id="section-7.2.2-4.4.1">The Entity Identifier of the Trust Mark Issuer MUST match the value of <code>sub</code>
                in the delegation<a href="#section-7.2.2-4.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.2.2-4.5">
              <p id="section-7.2.2-4.5.1">The Entity Identifier of the Trust Mark Owner MUST match the value of <code>iss</code>
                in the delegation.<a href="#section-7.2.2-4.5.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.2.2-4.6">
              <p id="section-7.2.2-4.6.1">The current time MUST be after the time represented by the iat (issued at) Claim in the delegation
                (possibly allowing for some small leeway to account for clock skew).<a href="#section-7.2.2-4.6.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.2.2-4.7">
              <p id="section-7.2.2-4.7.1">If the <code>exp</code> (expiration) Claim is present in the delegation,
                the current time MUST be before the time it represents
                (possibly allowing for some small leeway to account for clock skew).<a href="#section-7.2.2-4.7.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.2.2-4.8">
              <p id="section-7.2.2-4.8.1">
                The value of the Claim <code>trust_mark_type</code> in the delegation MUST be the same
                as the value of the Claim <code>trust_mark_type</code> in the Trust Mark.<a href="#section-7.2.2-4.8.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.2.2-4.9">
              <p id="section-7.2.2-4.9.1">The delegation's signature MUST validate using one of the Trust Mark Owner's keys
                identified by the value of the header parameter <code>kid</code>.
                The Trust Mark Owner's keys can be found in the <code>trust_mark_owners</code> Claim in
                the Trust Anchor's Entity Configuration.<a href="#section-7.2.2-4.9.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="trust-mark-validation">
<section id="section-7.3">
        <h3 id="name-validating-a-trust-mark">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-validating-a-trust-mark" class="section-name selfRef">Validating a Trust Mark</a>
        </h3>
<p id="section-7.3-1">
            Validating a Trust Mark means validating a Trust Mark instance
            represented by a specific signed JWT.
            It is NOT about validating whether a Trust Mark of a particular kind
            can exist or not.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">
     The trust in the Trust Mark Issuer comes before the trust in the trust mark.
              If the Trust Mark Issuer is not trusted then the trust mark cannot be trusted.
              An Entity MUST therefore establish trust in the Trust Mark Issuer by following the procedure defined in
              <a href="#resolving_trust" class="auto internal xref">Section 10</a> prior to starting the Trust Mark validation process defined below.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">
        Henceforth, "instance" is used as a shorthand for Trust Mark instance.
          The Trust Anchor referenced below is a Trust Anchor that
          has been successfully used when establishing trust in the Trust Mark Issuer.<a href="#section-7.3-3" class="pilcrow">¶</a></p>
<p id="section-7.3-4">
        To validate an instance, the following validation steps MUST be performed.
        Please note that if any of these validation checks fail, the entire validation
        process fails and the instance is considered invalid.<a href="#section-7.3-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.3-5">
<li id="section-7.3-5.1">
            <p id="section-7.3-5.1.1">The instance MUST be a signed JWT<a href="#section-7.3-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.3-5.2">
            <p id="section-7.3-5.2.1">The instance MUST have a <code>typ</code> header with the value
                <code>trust-mark+jwt</code><a href="#section-7.3-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.3-5.3">
            <p id="section-7.3-5.3.1">The instance MUST have an <code>alg</code> (algorithm) header parameter with a value
                that is an acceptable JWS signing algorithm; it MUST NOT be <code>none</code>.<a href="#section-7.3-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.3-5.4">
            <p id="section-7.3-5.4.1">The Entity Identifier of the Entity whose Entity Configuration contains the instance MUST
                match the value of the Claim <code>sub</code> in the Trust Mark.<a href="#section-7.3-5.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.3-5.5">
            <p id="section-7.3-5.5.1">The current time MUST be after the time represented by the <code>iat</code> (issued at) Claim
                (possibly allowing for some small leeway to account for clock skew).<a href="#section-7.3-5.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.3-5.6">
            <p id="section-7.3-5.6.1">The current time MUST be before the time represented by the <code>exp</code> (expiration) Claim
                (possibly allowing for some small leeway to account for clock skew).<a href="#section-7.3-5.6.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.3-5.7">
            <p id="section-7.3-5.7.1">The instance's signature MUST validate using the Trust Mark issuer's key
                identified by the <code>kid</code> value.<a href="#section-7.3-5.7.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.3-5.8">
            <p id="section-7.3-5.8.1">If the <code>trust_mark_type</code> of the instance appears in the
                <code>trust_mark_owners</code> Claim in the Trust Anchor's
                Entity Configuration, then the instance MUST contain a
                <code>delegation</code> Claim.<a href="#section-7.3-5.8.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.3-5.9">
            <p id="section-7.3-5.9.1">If there is a <code>delegation</code> Claim in the instance, the value of that
            Claim MUST be validated according to <a href="#trust-mark-delegation-validation" class="auto internal xref">Section 7.2.2</a>.<a href="#section-7.3-5.9.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-7.3-6">
     If Trust Marks are issued without an expiration time,
     it is RECOMMENDED that a mechanism be provided to validate them,
     such as the Trust Mark Status endpoint
     and/or the Trust Marked Entities Listing endpoint.<a href="#section-7.3-6" class="pilcrow">¶</a></p>
<p id="section-7.3-7">
     As an alternative to the above procedure for validating Trust Marks,
     implementations MAY use the Trust Mark Status endpoint to verify that the
     Trust Mark is valid and still active, as described in <a href="#status_endpoint" class="auto internal xref">Section 8.4</a>.<a href="#section-7.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trust_example">
<section id="section-7.4">
        <h3 id="name-trust-mark-examples">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-trust-mark-examples" class="section-name selfRef">Trust Mark Examples</a>
        </h3>
<p id="section-7.4-1" class="keepWithNext">
              A non-normative example of a <code>trust_marks</code>
       Claim in the JWT Claims Set for an Entity Configuration is:<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<span id="name-trust-mark-in-an-entity-con"></span><figure id="figure-16">
          <div class="alignLeft art-text artwork" id="section-7.4-2.1">
<pre>
{
  "iss": "https://rp.example.it/spid",
  "sub": "https://rp.example.it/spid",
  "iat": 1516239022,
  "exp": 1516843822,
  "trust_marks": [
    {
     "trust_mark_type": "https://www.spid.gov.it/certification/rp",
     "trust_mark":
       "eyJ0eXAiOiJ0cnVzdC1tYXJrK2p3dCIsImFsZyI6IlJTMjU2Iiwia2lkIjoia29
        zR20yd3VaaDlER21OeEF0a3VPNDBwUGpwTDMtakNmMU4tcVBPLVllVSJ9.
        eyJpc3MiOiJodHRwczovL3d3dy5hZ2lkLmdvdi5pdCIsInN1YiI6Imh0dHBzOi8
        vcnAuZXhhbXBsZS5pdC9zcGlkIiwiaWF0IjoxNTc5NjIxMTYwLCJ0cnVzdF9tYX
        JrX3R5cGUiOiJodHRwczovL3d3dy5zcGlkLmdvdi5pdC9jZXJ0aWZpY2F0aW9uL
        3JwIiwibG9nb191cmkiOiJodHRwczovL3d3dy5hZ2lkLmdvdi5pdC90aGVtZXMv
        Y3VzdG9tL2FnaWQvbG9nby5zdmciLCJyZWYiOiJodHRwczovL2RvY3MuaXRhbGl
        hLml0L2RvY3Mvc3BpZC1jaWUtb2lkYy1kb2NzL2l0L3ZlcnNpb25lLWNvcnJlbn
        RlLyJ9.
        L_pSh1InEiFAcs3E-1HBM7fNZYwF5ru3UGA_8yc80dGS3sszfA_sbj4AoW_zAJW
        QBdZpjxnHBBmybYXFrfZBcqxcedsrvUYrmbt1nPYxbUE54fRRoZK-sJmVqh1GzS
        an5nOmkxuAtMinU8k_-aWnPWj83sYe2AzT2mMgkXiz8zhda3jZm8hoxZ4jR6B0Y
        AvbMlq2pPWO5OWKdZhiFRMSprwh0GYluQkK0j1aLNMGXD3keMJd2zEoWX9D7w2f
        XShAA48W3cNhuXyBVnCoum1K4IWK3s_fx4nIkp6W-V4jCBOpxp7Yo8LZ30o_xpE
        OzGTIECGWVR86azOAlwVC8XSiAA"
    }
  ],
  "metadata": {
    "openid_relying_party": {
      "application_type": "web",
      "client_registration_types": ["automatic"],
      "client_name": "https://rp.example.it/spid",
      "contacts": [
        "ops@rp.example.it"
      ]
    }
  }
}
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-trust-mark-in-an-entity-con" class="selfRef">Trust Mark in an Entity Configuration JWT Claims Set</a>
          </figcaption></figure>
<p id="section-7.4-3" class="keepWithNext">
              An example of a decoded Trust Mark payload issued to an RP,
              attesting to conformance to a national
              public service profile:<a href="#section-7.4-3" class="pilcrow">¶</a></p>
<span id="name-trust-mark-for-a-national-p"></span><figure id="figure-17">
          <div class="alignLeft art-text artwork" id="section-7.4-4.1">
<pre>
{
  "trust_mark_type": "https://mushrooms.federation.example.com/openid_relying_party/public/",
  "iss": "https://epigeo.tm-issuer.example.it",
  "sub": "https://porcino.example.com/rp",
  "iat": 1579621160,
  "organization_name": "Porcino Mushrooms &amp; Co.",
  "policy_uri": "https://porcino.example.com/privacy_policy",
  "tos_uri": "https://porcino.example.com/info_policy",
  "service_documentation": "https://porcino.example.com/api/v1/get/services",
  "ref": "https://porcino.example.com/documentation/manuale_operativo.pdf"
}

</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-trust-mark-for-a-national-p" class="selfRef">Trust Mark for a National Profile</a>
          </figcaption></figure>
<p id="section-7.4-5" class="keepWithNext">
              An example of a decoded Trust Mark payload issued to an RP,
              attesting to its conformance to the rules for
              data management of underage users:<a href="#section-7.4-5" class="pilcrow">¶</a></p>
<span id="name-trust-mark-issued-to-an-rp"></span><figure id="figure-18">
          <div class="alignLeft art-text artwork" id="section-7.4-6.1">
<pre>
{
  "trust_mark_type": "https://mushrooms.federation.example.com/openid_relying_party/private/under-age",
  "iss": "https://trustissuer.pinarolo.example.it",
  "sub": "https://vavuso.example.com/rp",
  "iat": 1579621160,
  "organization_name": "Pinarolo Suillus luteus",
  "policy_uri": "https://vavuso.example.com/policy",
  "tos_uri": "https://vavuso.example.com/tos"
}

</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-trust-mark-issued-to-an-rp" class="selfRef">Trust Mark Issued to an RP</a>
          </figcaption></figure>
<p id="section-7.4-7" class="keepWithNext">
              An example of a decoded Trust Mark payload attesting a stipulation of an
              agreement between two organization's Entities:<a href="#section-7.4-7" class="pilcrow">¶</a></p>
<span id="name-trust-mark-attesting-to-an-"></span><figure id="figure-19">
          <div class="alignLeft art-text artwork" id="section-7.4-8.1">
<pre>
{
  "trust_mark_type": "https://mushrooms.federation.example.com/arrosto/agreements",
  "iss": "https://agaricaceae.example.it",
  "sub": "https://coppolino.example.com",
  "iat": 1579621160,
  "logo_uri": "https://coppolino.example.com/sgd-cmyk-150dpi-90mm.svg",
  "organization_type": "public",
  "id_code": "123456",
  "email": "info@coppolino.example.com",
  "organization_name#it": "Mazza di Tamburo",
  "policy_uri#it": "https://coppolino.example.com/privacy_policy",
  "tos_uri#it": "https://coppolino.example.com/info_policy",
  "service_documentation": "https://coppolino.example.com/api/v1/get/services",
  "ref": "https://agaricaceae.example.it/documentation/agaricaceae.pdf"
}
</pre>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a>:
<a href="#name-trust-mark-attesting-to-an-" class="selfRef">Trust Mark Attesting to an Agreement Between Entities</a>
          </figcaption></figure>
<p id="section-7.4-9" class="keepWithNext">
              An example of a decoded Trust Mark payload asserting
              conformance to a security profile:<a href="#section-7.4-9" class="pilcrow">¶</a></p>
<span id="name-trust-mark-asserting-confor"></span><figure id="figure-20">
          <div class="alignLeft art-text artwork" id="section-7.4-10.1">
<pre>
{
  "trust_mark_type": "https://mushrooms.federation.example.com/ottimo/commestibile",
  "iss": "https://cantharellus.cibarius.example.org",
  "sub": "https://gallinaccio.example.com/op",
  "iat": 1579621160,
  "logo_uri": "https://cantharellus.cibarius/static/images/cantharellus-cibarius.svg",
  "ref": "https://cantharellus.cibarius/cantharellus/cibarius"
}
</pre>
</div>
<figcaption><a href="#figure-20" class="selfRef">Figure 20</a>:
<a href="#name-trust-mark-asserting-confor" class="selfRef">Trust Mark Asserting Conformance to a Security Profile</a>
          </figcaption></figure>
<p id="section-7.4-11" class="keepWithNext">An example of a decoded self-signed Trust Mark:<a href="#section-7.4-11" class="pilcrow">¶</a></p>
<span id="name-self-signed-trust-mark"></span><figure id="figure-21">
          <div class="alignLeft art-text artwork" id="section-7.4-12.1">
<pre>
{
  "trust_mark_type": "https://mushrooms.federation.example.com/trust-marks/self-signed",
  "iss": "https://amanita.muscaria.example.com",
  "sub": "https://amanita.muscaria.example.com",
  "iat": 1579621160,
  "logo_uri": "https://amanita.muscaria.example.com/img/amanita-mus.svg",
  "ref": "https://amanita.muscaria.example.com/uploads/cookbook.zip"
}
</pre>
</div>
<figcaption><a href="#figure-21" class="selfRef">Figure 21</a>:
<a href="#name-self-signed-trust-mark" class="selfRef">Self-Signed Trust Mark</a>
          </figcaption></figure>
<p id="section-7.4-13" class="keepWithNext">
       An example of a third-party accreditation authority for Trust Marks:<a href="#section-7.4-13" class="pilcrow">¶</a></p>
<span id="name-third-party-accreditation-a"></span><figure id="figure-22">
          <div class="alignLeft art-text artwork" id="section-7.4-14.1">
<pre>
{
  "iss": "https://swamid.se",
  "sub": "https://umu.se/op",
  "iat": 1577833200,
  "exp": 1609369200,
  "trust_mark_type": "https://refeds.org/wp-content/uploads/2016/01/Sirtfi-1.0.pdf"
}
</pre>
</div>
<figcaption><a href="#figure-22" class="selfRef">Figure 22</a>:
<a href="#name-third-party-accreditation-a" class="selfRef">Third-Party Accreditation Authority for Trust Marks</a>
          </figcaption></figure>
</section>
</div>
<div id="trust_delegation_example">
<section id="section-7.5">
        <h3 id="name-trust-mark-delegation-examp">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-trust-mark-delegation-examp" class="section-name selfRef">Trust Mark Delegation Example</a>
        </h3>
<p id="section-7.5-1" class="keepWithNext">
              A non-normative example of a <code>trust_marks</code>
           Claim in the JWT Claims Set for an Entity Configuration in which the
              Trust Mark is issued by an Entity that issues Trust Marks on behalf of
              another Entity.
              The fact that a Trust Mark is issued by a Trust Mark Issuer that is not
              the owner of the Trust Mark is expressed by including a
              <code>delegation</code> Claim
              in the Trust Mark, whose value is a signed JWT.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<span id="name-example-jwt-claims-set-of-a"></span><figure id="figure-23">
          <div class="alignLeft art-text artwork" id="section-7.5-2.1">
<pre>
{
  "delegation":
    "eyJ0eXAiOiJ0cnVzdC1tYXJrLWRlbGVnYXRpb24rand0IiwiYWxnIjoiUl
    MyNTYiLCJraWQiOiJrb3NHbTJ3dVpoOURHbU54QXRrdU80MHBQanBMMy1qQ
    2YxTi1xUE8tWWVVIn0.
    eyJzdWIiOiJodHRwczovL3RtaS5leGFtcGxlLm9yZyIsInRydXN0X21hcmt
    fdHlwZSI6Imh0dHBzOi8vcmVmZWRzLm9yZy9zaXJ0ZmkiLCJpc3MiOiJodH
    RwczovL3RtX293bmVyLmV4YW1wbGUub3JnIiwiaWF0IjoxNzI1MTc2MzAyfQ.
    ao0rWGpVjEgpNyFxsKawps8q71eYnp78TzRdY4P52
    CT8QX6etXt-2L2Z1Vw5A6jx2mhjpPwWi_sOxfiOSA5TugJfN0Gbwj7teTzM
    0IMciuasCWgnLrKyLZjS147ZE50I9e9P8Ot8UQwhmXcLiuwsbDxSdqM4pVp
    75lfWnmzPH0L2pDZG5COFgIgSOAlK3TVMBOR8fziF-VmWNPzAfB0lSc-hjH
    -7q66GyT43o3Exnm6DsoLxyB8bxG99BQltLxURDT90CzM6szGcF3OG64Rbe
    0I4lT_LAOfvhlrRbT56eK4sJNCsbVbGnDBfFmyfB_HIeBMGP0L7T5JPMOUU
    9bjIlA",
  "iat": 1725176302,
  "trust_mark_type": "https://refeds.org/sirtfi",
  "sub": "https://entity.example.org",
  "exp": 1727768302,
  "iss": "https://tmi.example.org"
}
</pre>
</div>
<figcaption><a href="#figure-23" class="selfRef">Figure 23</a>:
<a href="#name-example-jwt-claims-set-of-a" class="selfRef">Example JWT Claims Set of a Trust Mark using Delegation</a>
          </figcaption></figure>
<p id="section-7.5-3" class="keepWithNext">
              JWS Header Parameters for the Trust Mark delegation JWT in
              the "delegation" Claim above:<a href="#section-7.5-3" class="pilcrow">¶</a></p>
<span id="name-trust-mark-delegation-jwt-j"></span><figure id="figure-24">
          <div class="alignLeft art-text artwork" id="section-7.5-4.1">
<pre>
{
  "typ": "trust-mark-delegation+jwt",
  "alg": "RS256",
  "kid": "kosGm2wuZh9DGmNxAtkuO40pPjpL3-jCf1N-qPO-YeU"
}
</pre>
</div>
<figcaption><a href="#figure-24" class="selfRef">Figure 24</a>:
<a href="#name-trust-mark-delegation-jwt-j" class="selfRef">Trust Mark Delegation JWT JWS Header Parameters</a>
          </figcaption></figure>
<p id="section-7.5-5" class="keepWithNext">
       JWT Claims Set of the Trust Mark delegation JWT in the "delegation" Claim above:<a href="#section-7.5-5" class="pilcrow">¶</a></p>
<span id="name-trust-mark-delegation-jwt-c"></span><figure id="figure-25">
          <div class="alignLeft art-text artwork" id="section-7.5-6.1">
<pre>
{
  "sub": "https://tmi.example.org",
  "trust_mark_type": "https://refeds.org/sirtfi",
  "iss": "https://tm_owner.example.org",
  "iat": 1725176302
}
</pre>
</div>
<figcaption><a href="#figure-25" class="selfRef">Figure 25</a>:
<a href="#name-trust-mark-delegation-jwt-c" class="selfRef">Trust Mark Delegation JWT Claim Set</a>
          </figcaption></figure>
</section>
</div>
</section>
</div>
<div id="federation_endpoints">
<section id="section-8">
      <h2 id="name-federation-endpoints">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-federation-endpoints" class="section-name selfRef">Federation Endpoints</a>
      </h2>
<p id="section-8-1">
        The federation endpoints of an Entity can be found in the
        configuration response as described in
        <a href="#federation_configuration" class="auto internal xref">Section 9</a>
        or by other means.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">
 For all federation endpoints, additional request parameters
 beyond those initially specified MAY be defined and used.
 If they are not understood, they MUST be ignored.<a href="#section-8-2" class="pilcrow">¶</a></p>
<div id="fetch_endpoint">
<section id="section-8.1">
        <h3 id="name-fetching-a-subordinate-stat">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-fetching-a-subordinate-stat" class="section-name selfRef">Fetching a Subordinate Statement</a>
        </h3>
<p id="section-8.1-1">
   The fetch endpoint is used to collect Subordinate Statements
          one-by-one when assembling Trust Chains.
   An Entity with Subordinates MUST expose a fetch endpoint.
   An Entity MUST publish Subordinate Statements about its
   Immediate Subordinates via its fetch endpoint.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">
   The fetch endpoint location is published in
   the Entity's <code>federation_entity</code> metadata
   in the <code>federation_fetch_endpoint</code> parameter
   defined in <a href="#federation_entity" class="auto internal xref">Section 5.1.1</a>.
   Since this endpoint is used when building and validating Trust Chains,
   its location MUST be available before metadata and metadata policies
   from Superiors can be applied.
   Therefore, this endpoint MUST be published directly in Entity Configuration
   metadata and not in Subordinate Statements.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">
          To fetch a Subordinate Statement, one needs to know the
          identifier of the Entity to ask (the issuer), the fetch
          endpoint of that Entity, and the Entity Identifier of the
          subject of the Subordinate Statement.
   The issuer is normally the Immediate Superior of the
          subject of the Subordinate Statement.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<div id="fetch_statement">
<section id="section-8.1.1">
          <h4 id="name-fetch-subordinate-statement">
<a href="#section-8.1.1" class="section-number selfRef">8.1.1. </a><a href="#name-fetch-subordinate-statement" class="section-name selfRef">Fetch Subordinate Statement Request</a>
          </h4>
<p id="section-8.1.1-1">
     When client authentication is not used,
            the request MUST be an HTTP request using the GET method
            to a fetch endpoint with the
            following query parameter, encoded in
            <code>application/x-www-form-urlencoded</code> format.
     The request is made to the fetch endpoint of the specified issuer.<a href="#section-8.1.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-8.1.1-2">
            <dt id="section-8.1.1-2.1">sub</dt>
            <dd style="margin-left: 1.5em" id="section-8.1.1-2.2">
                REQUIRED. The Entity Identifier of the subject
                for which the Subordinate Statement is being requested.<a href="#section-8.1.1-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-8.1.1-3">
     When client authentication is used,
     the request MUST be an HTTP request using the POST method,
     with the parameters passed in the POST body.<a href="#section-8.1.1-3" class="pilcrow">¶</a></p>
<p id="section-8.1.1-4" class="keepWithNext">
              The following is a non-normative example of an HTTP GET request for
       a Subordinate Statement from edugain.org about https://sunet.se:<a href="#section-8.1.1-4" class="pilcrow">¶</a></p>
<span id="name-api-request-for-a-subordina"></span><figure id="figure-26">
            <div class="alignLeft art-text artwork" id="section-8.1.1-5.1">
<pre>
GET /federation_fetch_endpoint?
sub=https%3A%2F%2Fsunet%2Ese HTTP/1.1
Host: edugain.org
</pre>
</div>
<figcaption><a href="#figure-26" class="selfRef">Figure 26</a>:
<a href="#name-api-request-for-a-subordina" class="selfRef">API Request for a Subordinate Statement</a>
            </figcaption></figure>
</section>
</div>
<div id="fetch-response">
<section id="section-8.1.2">
          <h4 id="name-fetch-subordinate-statement-">
<a href="#section-8.1.2" class="section-number selfRef">8.1.2. </a><a href="#name-fetch-subordinate-statement-" class="section-name selfRef">Fetch Subordinate Statement Response</a>
          </h4>
<p id="section-8.1.2-1">
            A successful response MUST use the HTTP status code 200
            with the content type
            <code>application/entity-statement+jwt</code>,
            to make it clear that the response contains an Entity Statement.
            If it is an error response, it will be a JSON object and the
            content type MUST be
            <code>application/json</code>.
     If the fetch endpoint cannot provide data for the requested
     <code>sub</code> parameter, returning the
     <code>not_found</code> error code is RECOMMENDED.
     If the <code>sub</code> parameter references the Entity
     Identifier of the Issuing Entity, returning the
     <code>invalid_request</code> error code is RECOMMENDED.
            See more about error responses in <a href="#error_response" class="auto internal xref">Section 8.9</a>.<a href="#section-8.1.2-1" class="pilcrow">¶</a></p>
<p id="section-8.1.2-2" class="keepWithNext">
              The following is a non-normative example of the JWT Claims Set for a fetch response:<a href="#section-8.1.2-2" class="pilcrow">¶</a></p>
<span id="name-fetch-response-jwt-claims-s"></span><figure id="figure-27">
            <div class="alignLeft art-text artwork" id="section-8.1.2-3.1">
<pre>
{
  "iss": "https://edugain.org",
  "sub": "https://sunet.se",
  "exp": 1568397247,
  "iat": 1568310847,
  "source_endpoint": "https://edugain.org/federation_fetch_endpoint",
  "jwks": {
    "keys": [
      {
        "e": "AQAB",
        "kid": "dEEtRjlzY3djcENuT01wOGxrZlkxb3RIQVJlMTY0...",
        "kty": "RSA",
        "n": "x97YKqc9Cs-DNtFrQ7_vhXoH9bwkDWW6En2jJ044yH..."
      }
    ]
  },
  "metadata":{
    "federation_entity": {
        "organization_name": "SUNET"
    }
  }
  "metadata_policy": {
    "openid_provider": {
      "subject_types_supported": {
        "value": [
          "pairwise"
        ]
      },
      "token_endpoint_auth_methods_supported": {
        "default": [
          "private_key_jwt"
        ],
        "subset_of": [
          "private_key_jwt",
          "client_secret_jwt"
        ],
        "superset_of": [
          "private_key_jwt"
        ]
      }
    }
  }
}
</pre>
</div>
<figcaption><a href="#figure-27" class="selfRef">Figure 27</a>:
<a href="#name-fetch-response-jwt-claims-s" class="selfRef">Fetch Response JWT Claims Set</a>
            </figcaption></figure>
</section>
</div>
</section>
</div>
<div id="entity_listing">
<section id="section-8.2">
        <h3 id="name-subordinate-listing">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-subordinate-listing" class="section-name selfRef">Subordinate Listing</a>
        </h3>
<p id="section-8.2-1">
   The listing endpoint is exposed by Federation Entities
   acting as a Trust Anchor, Intermediate, or Trust Mark Issuer.
   The endpoint lists the Immediate Subordinates about which
          the Trust Anchor, Intermediate, or Trust Mark Issuer
   issues Entity Statements.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">
   As a Trust Mark Issuer,
          the endpoint MAY list the Immediate Subordinates for which Trust Marks
          have been issued and are still valid, if the issuer
          exposing this endpoint supports Trust Mark filtering, as
          defined below.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">
          In both cases, the list contained in the result
          MAY be a very large list.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2-4">
   The list endpoint location is published in
   the Entity's <code>federation_entity</code> metadata
   in the <code>federation_list_endpoint</code> parameter
   defined in <a href="#federation_entity" class="auto internal xref">Section 5.1.1</a>.
   This endpoint MUST be published directly in Entity Configuration
   metadata and not in Subordinate Statements.<a href="#section-8.2-4" class="pilcrow">¶</a></p>
<p id="section-8.2-5" class="keepWithNext">
       The following example shows a tree of Entities belonging to the
          same federation including the Trust Anchor, Intermediate Entities,
          and Leaf Entities, discovered and collected through the Subordinate
          listing endpoints:<a href="#section-8.2-5" class="pilcrow">¶</a></p>
<span id="name-tree-of-entities-in-a-feder"></span><figure id="figure-28">
          <div class="alignLeft art-text artwork" id="section-8.2-6.1">
<pre>
                       +----------------------+
                       |    Trust Anchor      |
                       +----------------------+
       +---------------+ Subordinate Listing  +--------------+
       |               +----------+-----------+              |
       |                          |                          |
       |                          |                          |
       |                          |                          |
       |                          |                          |
       |                          |                          |
+------v-------+       +----------v-----------+       +------v-------+
|     Leaf     |       |     Intermediate     |       |     Leaf     |
+--------------+       +----------------------+       +--------------+
                  +----+ Subordinate Listing  |
                  |    +------------+---------+
                  |                 |
                  |                 |
                  |                 |
       +----------v-----------+     |
       |     Intermediate     |     |
       +----------------------+     |
       | Subordinate Listing  |     |
       +-+---------+----------+     |
         |         |                |
         |         |                |
 +-------v--+     +v--------+    +--v------+
 |  Leaf    |     |  Leaf   |    |  Leaf   |
 +----------+     +---------+    +---------+
</pre>
</div>
<figcaption><a href="#figure-28" class="selfRef">Figure 28</a>:
<a href="#name-tree-of-entities-in-a-feder" class="selfRef">Tree of Entities in a Federation Collected through
          Subordinate Listing Endpoints</a>
          </figcaption></figure>
<div id="subordinate-request">
<section id="section-8.2.1">
          <h4 id="name-subordinate-listing-request">
<a href="#section-8.2.1" class="section-number selfRef">8.2.1. </a><a href="#name-subordinate-listing-request" class="section-name selfRef">Subordinate Listing Request</a>
          </h4>
<p id="section-8.2.1-1">
     When client authentication is not used,
            the request MUST be an HTTP request using the GET method
            to a list endpoint with the
            following query parameters, encoded in
            <code>application/x-www-form-urlencoded</code> format.<a href="#section-8.2.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-8.2.1-2">
            <dt id="section-8.2.1-2.1">entity_type</dt>
            <dd style="margin-left: 1.5em" id="section-8.2.1-2.2">
                OPTIONAL. The value of this parameter is an Entity Type Identifier.
                If the responder knows the Entity Types of its Immediate Subordinates, the result MUST be
                filtered to include only those that include the specified Entity Type. When
                multiple <code>entity_type</code>
                parameters are present, for example
                <code>entity_type=openid_provider&amp;entity_type=openid_relying_party</code>,
                the result MUST be filtered to include all specified Entity Types.

                If the responder does not support this feature, it MUST
                use the HTTP status code 400 and the content type
                <code>application/json</code>, with
                the error code
                <code>unsupported_parameter</code>.<a href="#section-8.2.1-2.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-8.2.1-2.3">trust_marked</dt>
            <dd style="margin-left: 1.5em" id="section-8.2.1-2.4">
                OPTIONAL. Boolean.

                If the parameter
                <code>trust_marked</code> is present and
                set to <code>true</code>,
                the result contains only the Immediate Subordinates for which
                at least one Trust Mark has been issued and is still valid.

                If the responder does not support this feature, it MUST
                use the HTTP status code 400 and set the content type to
                <code>application/json</code>, with
                the error code
                <code>unsupported_parameter</code>.<a href="#section-8.2.1-2.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-8.2.1-2.5">trust_mark_type</dt>
            <dd style="margin-left: 1.5em" id="section-8.2.1-2.6">
                OPTIONAL. The value of this parameter is the identifier for the type of the Trust Mark.
 If the responder has issued Trust Marks with the
                specified Trust Mark type identifier,
                the list in the response is filtered to include only
                the Immediate Subordinates for which that Trust Mark type identifier has been
                issued and is still valid.
                If the responder does not support this feature, it MUST
                use the HTTP status code 400 and set the content type to
                <code>application/json</code>, with
                the error code
                <code>unsupported_parameter</code>.<a href="#section-8.2.1-2.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-8.2.1-2.7">intermediate</dt>
            <dd style="margin-left: 1.5em" id="section-8.2.1-2.8">
                OPTIONAL. Boolean. If the parameter
                <code>intermediate</code> is present and set to
                <code>true</code>, then if the responder knows
                whether its Immediate Subordinates are Intermediates or not,
                the result MUST be filtered accordingly.
                If the responder does not support this feature, it MUST
                use the HTTP status code 400 and the content type
                <code>application/json</code>, with
                the error code
                <code>unsupported_parameter</code>.<a href="#section-8.2.1-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-8.2.1-3">
     When client authentication is used,
     the request MUST be an HTTP request using the POST method,
     with the parameters passed in the POST body.<a href="#section-8.2.1-3" class="pilcrow">¶</a></p>
<p id="section-8.2.1-4" class="keepWithNext">
              The following is a non-normative example of an HTTP GET
              request for a list of Immediate Subordinates:<a href="#section-8.2.1-4" class="pilcrow">¶</a></p>
<span id="name-subordinate-listing-request-2"></span><figure id="figure-29">
            <div class="alignLeft art-text artwork" id="section-8.2.1-5.1">
<pre>
GET /list HTTP/1.1
Host: sunet.se
</pre>
</div>
<figcaption><a href="#figure-29" class="selfRef">Figure 29</a>:
<a href="#name-subordinate-listing-request-2" class="selfRef">Subordinate Listing Request</a>
            </figcaption></figure>
</section>
</div>
<div id="subordinate-response">
<section id="section-8.2.2">
          <h4 id="name-subordinate-listing-respons">
<a href="#section-8.2.2" class="section-number selfRef">8.2.2. </a><a href="#name-subordinate-listing-respons" class="section-name selfRef">Subordinate Listing Response</a>
          </h4>
<p id="section-8.2.2-1">
            A successful response MUST use the HTTP status code 200
            with the content type <code>application/json</code>,
            containing a JSON array with the known Entity Identifiers.<a href="#section-8.2.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2.2-2">
            An error response
            is as defined in
            <a href="#error_response" class="auto internal xref">Section 8.9</a>.<a href="#section-8.2.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2.2-3" class="keepWithNext">
              The following is a non-normative example of a response containing
              the Immediate Subordinate Entities:<a href="#section-8.2.2-3" class="pilcrow">¶</a></p>
<span id="name-subordinate-listing-response"></span><figure id="figure-30">
            <div class="alignLeft art-text artwork" id="section-8.2.2-4.1">
<pre>
200 OK
Content-Type: application/json

[
  "https://ntnu.andreas.labs.uninett.no",
  "https://blackboard.ntnu.no/openid/callback",
  "https://serviceprovider.andreas.labs.uninett.no/application17"
]
</pre>
</div>
<figcaption><a href="#figure-30" class="selfRef">Figure 30</a>:
<a href="#name-subordinate-listing-response" class="selfRef">Subordinate Listing Response</a>
            </figcaption></figure>
</section>
</div>
</section>
</div>
<div id="resolve">
<section id="section-8.3">
        <h3 id="name-resolve-entity">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-resolve-entity" class="section-name selfRef">Resolve Entity</a>
        </h3>
<p id="section-8.3-1">
          An Entity MAY use a resolve endpoint to fetch
          Resolved Metadata, the Trust Chain used, and Trust Marks for an Entity.
          The resolver fetches the subject's
          Entity Configuration, assembles a Trust Chain that starts
          with the subject's Entity Configuration and ends with the specified
          Trust Anchor's Entity Configuration, verifies the Trust Chain, and then applies all the
          policies present in the Trust Chain to the subject's
          metadata.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3-2">
   The resolver MUST verify that all present
          Trust Marks with identifiers recognized within
          the Federation are active.
          The response set MUST include only verified Trust Marks.<a href="#section-8.3-2" class="pilcrow">¶</a></p>
<p id="section-8.3-3">
   The resolve endpoint location is published in
   the Entity's <code>federation_entity</code> metadata
   in the <code>federation_resolve_endpoint</code> parameter
   defined in <a href="#federation_entity" class="auto internal xref">Section 5.1.1</a>.<a href="#section-8.3-3" class="pilcrow">¶</a></p>
<div id="resolve-request">
<section id="section-8.3.1">
          <h4 id="name-resolve-request">
<a href="#section-8.3.1" class="section-number selfRef">8.3.1. </a><a href="#name-resolve-request" class="section-name selfRef">Resolve Request</a>
          </h4>
<p id="section-8.3.1-1">
     When client authentication is not used,
            the request MUST be an HTTP request using the GET method
            to a resolve endpoint with the
            following query parameters, encoded in
            <code>application/x-www-form-urlencoded</code> format.<a href="#section-8.3.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-8.3.1-2">
            <dt id="section-8.3.1-2.1">sub</dt>
            <dd style="margin-left: 1.5em" id="section-8.3.1-2.2">
                REQUIRED. The Entity Identifier of the
                Entity whose resolved data is requested.<a href="#section-8.3.1-2.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-8.3.1-2.3">trust_anchor</dt>
            <dd style="margin-left: 1.5em" id="section-8.3.1-2.4">
              <p id="section-8.3.1-2.4.1">
                REQUIRED. The Trust Anchor that the resolve endpoint
                MUST use when resolving the metadata.
 The value is an Entity Identifier.<a href="#section-8.3.1-2.4.1" class="pilcrow">¶</a></p>
<p id="section-8.3.1-2.4.2">
 The <code>trust_anchor</code> request parameter
 MAY occur multiple times, in which case,
 the resolver MAY return a successful resolve response
 using any of the Trust Anchor values provided.<a href="#section-8.3.1-2.4.2" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.3.1-2.5">entity_type</dt>
            <dd style="margin-left: 1.5em" id="section-8.3.1-2.6">
              <p id="section-8.3.1-2.6.1">
                OPTIONAL. A specific Entity Type to resolve.
                Its value is an Entity Type Identifier, as specified in
                <a href="#entity_types" class="auto internal xref">Section 5.1</a>.
                If this parameter is not present, then all Entity Types are returned.<a href="#section-8.3.1-2.6.1" class="pilcrow">¶</a></p>
<p id="section-8.3.1-2.6.2">
 The <code>entity_type</code> request parameter
 MAY occur multiple times, in which case, data for each Entity Type
 whose Entity Type Identifier is in an <code>entity_type</code>
 parameter value is returned.<a href="#section-8.3.1-2.6.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-8.3.1-3">
     When client authentication is used,
     the request MUST be an HTTP request using the POST method,
     with the parameters passed in the POST body.<a href="#section-8.3.1-3" class="pilcrow">¶</a></p>
<p id="section-8.3.1-4" class="keepWithNext">
              The following is a non-normative example of a Resolve Request:<a href="#section-8.3.1-4" class="pilcrow">¶</a></p>
<span id="name-resolve-request-2"></span><figure id="figure-31">
            <div class="alignLeft art-text artwork" id="section-8.3.1-5.1">
<pre>
GET /resolve?
sub=https%3A%2F%2Fop.example.it%2Fspid&amp;
entity_type=openid_provider&amp;
trust_anchor=https%3A%2F%2Fswamid.se HTTP/1.1
Host: sunet.se
</pre>
</div>
<figcaption><a href="#figure-31" class="selfRef">Figure 31</a>:
<a href="#name-resolve-request-2" class="selfRef">Resolve Request</a>
            </figcaption></figure>
</section>
</div>
<div id="resolve-response">
<section id="section-8.3.2">
          <h4 id="name-resolve-response">
<a href="#section-8.3.2" class="section-number selfRef">8.3.2. </a><a href="#name-resolve-response" class="section-name selfRef">Resolve Response</a>
          </h4>
<p id="section-8.3.2-1">
            A successful response MUST use the HTTP status code 200
            with the content type
            <code>application/resolve-response+jwt</code>,
            containing Resolved Metadata and
            verified Trust Marks.<a href="#section-8.3.2-1" class="pilcrow">¶</a></p>
<p id="section-8.3.2-2">
            The response is a signed JWT that is explicitly typed by setting the
            <code>typ</code> header parameter to
            <code>resolve-response+jwt</code> to prevent
            cross-JWT confusion, per Section 3.11 of <span>[<a href="#RFC8725" class="cite xref">RFC8725</a>]</span>.
     Resolve responses without a <code>typ</code> header parameter
     or with a different <code>typ</code> value MUST be rejected.
     It is signed with a Federation Entity Key.<a href="#section-8.3.2-2" class="pilcrow">¶</a></p>
<p id="section-8.3.2-3">
     The resolve response JWT MUST include the
     <code>kid</code> (Key ID) header parameter
     with its value being the Key ID of the signing key used.<a href="#section-8.3.2-3" class="pilcrow">¶</a></p>
<p id="section-8.3.2-4">
            The resolve response JWT MUST return the Trust Chain
     from the subject to the Trust Anchor
     in its <code>trust_chain</code> parameter.<a href="#section-8.3.2-4" class="pilcrow">¶</a></p>
<p id="section-8.3.2-5">
            The resolve response MAY also return the Trust Chain
            from its issuer to the Trust Anchor
            in the <code>trust_chain</code> JWS header parameter,
            as specified in <a href="#trust_chain_head_param" class="auto internal xref">Section 4.3</a>.
            When this is present, the Trust Anchor in the Trust Chain
            MUST match the Trust Anchor requested in the
            related request in the <code>trust_anchor</code> parameter.<a href="#section-8.3.2-5" class="pilcrow">¶</a></p>
<p id="section-8.3.2-6">
            An issuer that provides its Trust Chain within the resolve
            response makes it evident that it is part of the same
            federation as the subject of the response. Thus,
            when the Trust Chains of both the issuer and the subject
            are available and the Federation Historical Keys endpoint is
            provided by the Trust Anchor, the resolve response becomes a long-lived
            attestation; it can be always verified, even
            when the Federation Keys change in the future.<a href="#section-8.3.2-6" class="pilcrow">¶</a></p>
<p id="section-8.3.2-7">
            The response SHOULD contain the
            <code>aud</code> Claim only
            if the requesting party is authenticated
     as described in <a href="#ClientAuthentication" class="auto internal xref">Section 8.8</a>,
     in which case, the value MUST be the Entity Identifier
     of the requesting party
     and MUST NOT include any other values.<a href="#section-8.3.2-7" class="pilcrow">¶</a></p>
<p id="section-8.3.2-8">
     The Claims in a resolve response are:<a href="#section-8.3.2-8" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-8.3.2-9">
            <dt id="section-8.3.2-9.1">iss</dt>
            <dd style="margin-left: 1.5em" id="section-8.3.2-9.2">
                REQUIRED. String.
                Entity Identifier
                of the issuer of the resolve response.<a href="#section-8.3.2-9.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-8.3.2-9.3">sub</dt>
            <dd style="margin-left: 1.5em" id="section-8.3.2-9.4">
                REQUIRED. String.
                Entity Identifier
                of the subject of the resolve response.<a href="#section-8.3.2-9.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-8.3.2-9.5">iat</dt>
            <dd style="margin-left: 1.5em" id="section-8.3.2-9.6">
                REQUIRED. Number. Time when this resolution was issued.
                This is expressed as Seconds Since the Epoch, per
                <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-8.3.2-9.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-8.3.2-9.7">exp</dt>
            <dd style="margin-left: 1.5em" id="section-8.3.2-9.8">
                REQUIRED. Number. Time when this resolution is no longer valid.
                This is expressed as Seconds Since the Epoch, per <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.
                It MUST be the minimum of the <code>exp</code> value of
                the Trust Chain from which the resolve response was derived,
                as well as any Trust Mark included in the response.<a href="#section-8.3.2-9.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-8.3.2-9.9">metadata</dt>
            <dd style="margin-left: 1.5em" id="section-8.3.2-9.10">
                REQUIRED. JSON object containing the subject's Resolved Metadata,
                according to the requested <code>type</code>
                and expressed in the <code>metadata</code> format
                defined in <a href="#common-claims" class="auto internal xref">Section 3.1.1</a>.<a href="#section-8.3.2-9.10" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-8.3.2-9.11">trust_chain</dt>
            <dd style="margin-left: 1.5em" id="section-8.3.2-9.12">
                REQUIRED. Array containing the sequence of Entity Statements
                that compose the Trust Chain, starting with the subject and
                ending with the selected Trust Anchor.<a href="#section-8.3.2-9.12" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-8.3.2-9.13">trust_marks</dt>
            <dd style="margin-left: 1.5em" id="section-8.3.2-9.14">
                OPTIONAL. Array of objects, each representing a Trust Mark,
                as defined in <a href="#ec-specific" class="auto internal xref">Section 3.1.2</a>.
 Only valid Trust Marks that have been issued by Trust Mark
                issuers trusted by the Trust Anchor to issue such Trust Marks
 MAY appear in the resolver response.<a href="#section-8.3.2-9.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-8.3.2-10">
            Additional Claims MAY be defined and used in conjunction with the Claims above.<a href="#section-8.3.2-10" class="pilcrow">¶</a></p>
<p id="section-8.3.2-11">
            An error response
            is as defined in
            <a href="#error_response" class="auto internal xref">Section 8.9</a>.<a href="#section-8.3.2-11" class="pilcrow">¶</a></p>
<p id="section-8.3.2-12" class="keepWithNext">
              The following is a non-normative example of the JWT Claims Set for a resolve response:<a href="#section-8.3.2-12" class="pilcrow">¶</a></p>
<span id="name-resolve-response-jwt-claims"></span><figure id="figure-32">
            <div class="alignLeft art-text artwork" id="section-8.3.2-13.1">
<pre>
{
  "iss": "https://resolver.spid.gov.it",
  "sub": "https://op.example.it/spid",
  "iat": 1516239022,
  "exp": 1516843822,
  "metadata": {
    "openid_provider": {
      "contacts": ["legal@example.it", "technical@example.it"],
      "logo_uri":
        "https://op.example.it/static/img/op-logo.svg",
      "op_policy_uri":
        "https://op.example.it/en/about-the-website/legal-information",
      "federation_registration_endpoint": "https://op.example.it/spid/fedreg",
      "authorization_endpoint":
        "https://op.example.it/spid/authorization",
      "token_endpoint": "https://op.example.it/spid/token",
      "response_types_supported": [
        "code",
        "code id_token",
        "token"
      ],
      "grant_types_supported": [
        "authorization_code",
        "urn:ietf:params:oauth:grant-type:jwt-bearer"
      ],
      "subject_types_supported": ["pairwise"],
      "id_token_signing_alg_values_supported": ["RS256"],
      "issuer": "https://op.example.it/spid",
      "jwks": {
        "keys": [
          {
            "kty": "RSA",
            "use": "sig",
            "n": "1Ta-sE ...",
            "e": "AQAB",
            "kid": "FANFS3YnC9tjiCaivhWLVUJ3AxwGGz_98uRFaqMEEs"
          }
        ]
      }
    }
  },
  "trust_marks": [
    {"trust_mark_type": "https://www.spid.gov.it/certification/op/",
     "trust_mark":
       "eyJ0eXAiOiJ0cnVzdC1tYXJrK2p3dCIsImFsZyI6IlJTMjU2Iiwia2lkIjoiOH
        hzdUtXaVZmd1NnSG9mMVRlNE9VZGN5NHE3ZEpyS2ZGUmxPNXhoSElhMCJ9.
        eyJpc3MiOiJodHRwczovL3d3dy5hZ2lkLmdvdi5pdCIsInN1YiI6Imh0dHBzOi
        8vb3AuZXhhbXBsZS5pdC9zcGlkIiwiaWF0IjoxNTc5NjIxMTYwLCJ0cnVzdF9t
        YXJrX3R5cGUiOiJodHRwczovL3d3dy5zcGlkLmdvdi5pdC9jZXJ0aWZpY2F0aW
        9uL29wLyIsImxvZ29fdXJpIjoiaHR0cHM6Ly93d3cuYWdpZC5nb3YuaXQvdGhl
        bWVzL2N1c3RvbS9hZ2lkL2xvZ28uc3ZnIiwicmVmIjoiaHR0cHM6Ly9kb2NzLm
        l0YWxpYS5pdC9pdGFsaWEvc3BpZC9zcGlkLXJlZ29sZS10ZWNuaWNoZS1vaWRj
        L2l0L3N0YWJpbGUvaW5kZXguaHRtbCJ9.
        xyz-PDQ_..."
    }
  ],
  "trust_chain" : [
    "eyJhbGciOiJSUzI1NiIsImtpZCI6Ims1NEhRdERpYnlHY3M5WldWTWZ2aUhm ...",
    "eyJhbGciOiJSUzI1NiIsImtpZCI6IkJYdmZybG5oQU11SFIwN2FqVW1BY0JS ...",
    "eyJhbGciOiJSUzI1NiIsImtpZCI6IkJYdmZybG5oQU11SFIwN2FqVW1BY0JS ..."
  ]
}
</pre>
</div>
<figcaption><a href="#figure-32" class="selfRef">Figure 32</a>:
<a href="#name-resolve-response-jwt-claims" class="selfRef">Resolve Response JWT Claims Set</a>
            </figcaption></figure>
</section>
</div>
<div id="trust-considerations">
<section id="section-8.3.3">
          <h4 id="name-trust-considerations">
<a href="#section-8.3.3" class="section-number selfRef">8.3.3. </a><a href="#name-trust-considerations" class="section-name selfRef">Trust Considerations</a>
          </h4>
<p id="section-8.3.3-1">
            The basic assumption of this specification is that an Entity
            should have direct trust in no party except the Trust Anchor
            and its own capabilities.
            However, Entities MAY establish a kind of
            transitive trust in other Entities. For example, the
            Trust Anchor states who its Immediate Subordinates are,
            and Entities MAY choose to trust them.
            If a party uses the resolve service of another Entity
            to obtain federation data, it is trusting
            the resolver to perform validation of the cryptographically
            protected metadata correctly and to provide it with authentic results.<a href="#section-8.3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="status_endpoint">
<section id="section-8.4">
        <h3 id="name-trust-mark-status">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-trust-mark-status" class="section-name selfRef">Trust Mark Status</a>
        </h3>
<p id="section-8.4-1">
          This enables determining whether a Trust Mark Instance that has been issued to
          an Entity is still active. The query MUST be sent to the Trust Mark Issuer.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<p id="section-8.4-2">
   The Trust Mark Status endpoint location is published in
   the Entity's <code>federation_entity</code> metadata
   in the <code>federation_trust_mark_status_endpoint</code> parameter
   defined in <a href="#federation_entity" class="auto internal xref">Section 5.1.1</a>.
   This endpoint MUST be published directly in Entity Configuration
   metadata and not in Subordinate Statements.<a href="#section-8.4-2" class="pilcrow">¶</a></p>
<div id="tm-status-request">
<section id="section-8.4.1">
          <h4 id="name-trust-mark-status-request">
<a href="#section-8.4.1" class="section-number selfRef">8.4.1. </a><a href="#name-trust-mark-status-request" class="section-name selfRef">Trust Mark Status Request</a>
          </h4>
<p id="section-8.4.1-1">
            The request MUST be an HTTP request using the POST method
            to a Trust Mark Status endpoint
            with the following parameter, encoded in
            <code>application/x-www-form-urlencoded</code> format.<a href="#section-8.4.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-8.4.1-2">
            <dt id="section-8.4.1-2.1">trust_mark</dt>
            <dd style="margin-left: 1.5em" id="section-8.4.1-2.2">
                REQUIRED. The Trust Mark to be validated.<a href="#section-8.4.1-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-8.4.1-3">
     When client authentication is used,
     the request MUST be an HTTP request using the POST method,
     with the parameters passed in the POST body.<a href="#section-8.4.1-3" class="pilcrow">¶</a></p>
<p id="section-8.4.1-4" class="keepWithNext">
                The following is a non-normative example of a Trust Mark Status request:<a href="#section-8.4.1-4" class="pilcrow">¶</a></p>
<span id="name-trust-mark-status-request-2"></span><figure id="figure-33">
            <div class="alignLeft art-text artwork" id="section-8.4.1-5.1">
<pre>
POST /federation_trust_mark_status_endpoint HTTP/1.1
Host: op.example.org
Content-Type: application/x-www-form-urlencoded

trust_mark=eyJ0eXAiOiJ0cnVzdC1tYXJrK2p3dCIsImFsZyI6 ...
</pre>
</div>
<figcaption><a href="#figure-33" class="selfRef">Figure 33</a>:
<a href="#name-trust-mark-status-request-2" class="selfRef">Trust Mark Status Request</a>
            </figcaption></figure>
</section>
</div>
<div id="tm-status-response">
<section id="section-8.4.2">
          <h4 id="name-trust-mark-status-response">
<a href="#section-8.4.2" class="section-number selfRef">8.4.2. </a><a href="#name-trust-mark-status-response" class="section-name selfRef">Trust Mark Status Response</a>
          </h4>
<p id="section-8.4.2-1">
            A successful response MUST use the HTTP status code 200
            with the content type
            <code>application/trust-mark-status-response+jwt</code>,
     containing a signed JWT that is a Trust Mark Status Response.<a href="#section-8.4.2-1" class="pilcrow">¶</a></p>
<p id="section-8.4.2-2">
            The Trust Mark Status Response is a signed JWT that is explicitly typed by setting the
            <code>typ</code> header parameter to
            <code>trust-mark-status-response+jwt</code> to prevent
            cross-JWT confusion, per Section 3.11 of <span>[<a href="#RFC8725" class="cite xref">RFC8725</a>]</span>.
     Trust Mark Status Responses without a <code>typ</code> header parameter
     or with a different <code>typ</code> value MUST be rejected.
     It is signed with a Federation Entity Key.<a href="#section-8.4.2-2" class="pilcrow">¶</a></p>
<p id="section-8.4.2-3">
     The Trust Mark Status Response JWT MUST include the
     <code>kid</code> (Key ID) header parameter
     with its value being the Key ID of the signing key used.<a href="#section-8.4.2-3" class="pilcrow">¶</a></p>
<p id="section-8.4.2-4">
     The JWT Claims Set of the Trust Mark Status JWT
     is a JSON object containing the following Claims:<a href="#section-8.4.2-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-8.4.2-5">
            <dt id="section-8.4.2-5.1">iss</dt>
            <dd style="margin-left: 1.5em" id="section-8.4.2-5.2">
                REQUIRED. String.
                Entity Identifier of the issuer of the Trust Mark Status JWT.<a href="#section-8.4.2-5.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-8.4.2-5.3">iat</dt>
            <dd style="margin-left: 1.5em" id="section-8.4.2-5.4">
                REQUIRED. Number. Time when this Trust Mark Status JWT was issued.
                This is expressed as Seconds Since the Epoch, per
                <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-8.4.2-5.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-8.4.2-5.5">trust_mark</dt>
            <dd style="margin-left: 1.5em" id="section-8.4.2-5.6">
                REQUIRED. String.
                The Trust Mark JWT that this status response is about.<a href="#section-8.4.2-5.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-8.4.2-5.7">status</dt>
            <dd style="margin-left: 1.5em" id="section-8.4.2-5.8">
              <p id="section-8.4.2-5.8.1">
                REQUIRED. Case-sensitive string value indicating the status of the Trust Mark.
 Values defined by this specification are:<a href="#section-8.4.2-5.8.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-8.4.2-5.8.2">
                <dt id="section-8.4.2-5.8.2.1">active</dt>
                <dd style="margin-left: 1.5em" id="section-8.4.2-5.8.2.2">
     The Trust Mark is active<a href="#section-8.4.2-5.8.2.2" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-8.4.2-5.8.2.3">expired</dt>
                <dd style="margin-left: 1.5em" id="section-8.4.2-5.8.2.4">
     The Trust Mark has expired<a href="#section-8.4.2-5.8.2.4" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-8.4.2-5.8.2.5">revoked</dt>
                <dd style="margin-left: 1.5em" id="section-8.4.2-5.8.2.6">
     The Trust Mark was revoked<a href="#section-8.4.2-5.8.2.6" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-8.4.2-5.8.2.7">invalid</dt>
                <dd style="margin-left: 1.5em" id="section-8.4.2-5.8.2.8">
     Signature validation failed or another error was detected<a href="#section-8.4.2-5.8.2.8" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-8.4.2-5.9"></dt>
            <dd style="margin-left: 1.5em" id="section-8.4.2-5.10">
 Additional status values MAY be defined and used
 in addition to those above.<a href="#section-8.4.2-5.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-8.4.2-6">
     Additional Trust Mark Status JWT Claims MAY be defined and used
     in addition to those listed above.<a href="#section-8.4.2-6" class="pilcrow">¶</a></p>
<p id="section-8.4.2-7" class="keepWithNext">
                The following is a non-normative example of the JWT Claims Set for
 a response with the status <code>active</code>:<a href="#section-8.4.2-7" class="pilcrow">¶</a></p>
<span id="name-active-trust-mark-status-re"></span><figure id="figure-34">
            <div class="alignLeft art-text artwork" id="section-8.4.2-8.1">
<pre>
{
  "iss": "https://www.agid.gov.it",
  "trust_mark": "eyJ0eXAiOiJ0cnVzdC1tYXJrK2p3dCIsImFsZyI6IlJTMjU2Iiwia2
    lkIjoia29zR20yd3VaaDlER21OeEF0a3VPNDBwUGpwTDMtakNmMU4tcVBPLVllVSJ9.
    eyJpc3MiOiJodHRwczovL3d3dy5hZ2lkLmdvdi5pdCIsInN1YiI6Imh0dHBzOi8
    vcnAuZXhhbXBsZS5pdC9zcGlkIiwiaWF0IjoxNTc5NjIxMTYwLCJ0cnVzdF9tYX
    JrX3R5cGUiOiJodHRwczovL3d3dy5zcGlkLmdvdi5pdC9jZXJ0aWZpY2F0aW9uL
    3JwIiwibG9nb191cmkiOiJodHRwczovL3d3dy5hZ2lkLmdvdi5pdC90aGVtZXMv
    Y3VzdG9tL2FnaWQvbG9nby5zdmciLCJyZWYiOiJodHRwczovL2RvY3MuaXRhbGl
    hLml0L2RvY3Mvc3BpZC1jaWUtb2lkYy1kb2NzL2l0L3ZlcnNpb25lLWNvcnJlbn
    RlLyJ9.
    L_pSh1InEiFAcs3E-1HBM7fNZYwF5ru3UGA_8yc80dGS3sszfA_sbj4AoW_zAJW
    QBdZpjxnHBBmybYXFrfZBcqxcedsrvUYrmbt1nPYxbUE54fRRoZK-sJmVqh1GzS
    an5nOmkxuAtMinU8k_-aWnPWj83sYe2AzT2mMgkXiz8zhda3jZm8hoxZ4jR6B0Y
    AvbMlq2pPWO5OWKdZhiFRMSprwh0GYluQkK0j1aLNMGXD3keMJd2zEoWX9D7w2f
    XShAA48W3cNhuXyBVnCoum1K4IWK3s_fx4nIkp6W-V4jCBOpxp7Yo8LZ30o_xpE
    OzGTIECGWVR86azOAlwVC8XSiAA",
  "iat": 1759897995,
  "status": "active"
}
</pre>
</div>
<figcaption><a href="#figure-34" class="selfRef">Figure 34</a>:
<a href="#name-active-trust-mark-status-re" class="selfRef">Active Trust Mark Status Response JWT Claims Set</a>
            </figcaption></figure>
<p id="section-8.4.2-9" class="keepWithNext">
                The following is a non-normative example of the JWT Claims Set for
 a response with the status <code>revoked</code>:<a href="#section-8.4.2-9" class="pilcrow">¶</a></p>
<span id="name-revoked-trust-mark-status-r"></span><figure id="figure-35">
            <div class="alignLeft art-text artwork" id="section-8.4.2-10.1">
<pre>
{
  "iss": "https://www.agid.gov.it",
  "trust_mark": "eyJ0eXAiOiJ0cnVzdC1tYXJrK2p3dCIsImFsZyI6IlJTMjU2Iiwia2
    lkIjoia29zR20yd3VaaDlER21OeEF0a3VPNDBwUGpwTDMtakNmMU4tcVBPLVllVSJ9.
    eyJpc3MiOiJodHRwczovL3d3dy5hZ2lkLmdvdi5pdCIsInN1YiI6Imh0dHBzOi8
    vcnAuZXhhbXBsZS5pdC9zcGlkIiwiaWF0IjoxNTc5NjIxMTYwLCJ0cnVzdF9tYX
    JrX3R5cGUiOiJodHRwczovL3d3dy5zcGlkLmdvdi5pdC9jZXJ0aWZpY2F0aW9uL
    3JwIiwibG9nb191cmkiOiJodHRwczovL3d3dy5hZ2lkLmdvdi5pdC90aGVtZXMv
    Y3VzdG9tL2FnaWQvbG9nby5zdmciLCJyZWYiOiJodHRwczovL2RvY3MuaXRhbGl
    hLml0L2RvY3Mvc3BpZC1jaWUtb2lkYy1kb2NzL2l0L3ZlcnNpb25lLWNvcnJlbn
    RlLyJ9.
    L_pSh1InEiFAcs3E-1HBM7fNZYwF5ru3UGA_8yc80dGS3sszfA_sbj4AoW_zAJW
    QBdZpjxnHBBmybYXFrfZBcqxcedsrvUYrmbt1nPYxbUE54fRRoZK-sJmVqh1GzS
    an5nOmkxuAtMinU8k_-aWnPWj83sYe2AzT2mMgkXiz8zhda3jZm8hoxZ4jR6B0Y
    AvbMlq2pPWO5OWKdZhiFRMSprwh0GYluQkK0j1aLNMGXD3keMJd2zEoWX9D7w2f
    XShAA48W3cNhuXyBVnCoum1K4IWK3s_fx4nIkp6W-V4jCBOpxp7Yo8LZ30o_xpE
    OzGTIECGWVR86azOAlwVC8XSiAA",
  "iat": 1759898057,
  "status": "revoked"
}
</pre>
</div>
<figcaption><a href="#figure-35" class="selfRef">Figure 35</a>:
<a href="#name-revoked-trust-mark-status-r" class="selfRef">Revoked Trust Mark Status Response JWT Claims Set</a>
            </figcaption></figure>
<p id="section-8.4.2-11">
            An error response to a Trust Mark Status request
            is as defined in
            <a href="#error_response" class="auto internal xref">Section 8.9</a>.<a href="#section-8.4.2-11" class="pilcrow">¶</a></p>
<p id="section-8.4.2-12">
     If the Trust Mark Issuer receives a request about the status of an unknown Trust Mark, something it did not issue or is not aware of,
     it MUST respond with an HTTP status code 404 (Not found).<a href="#section-8.4.2-12" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="tm_listing">
<section id="section-8.5">
        <h3 id="name-trust-marked-entities-listi">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-trust-marked-entities-listi" class="section-name selfRef">Trust Marked Entities Listing</a>
        </h3>
<p id="section-8.5-1">
   The Trust Marked Entities Listing endpoint is exposed by
          Trust Mark Issuers
          and lists all the Entities for which Trust Marks
          have been issued and are still valid.<a href="#section-8.5-1" class="pilcrow">¶</a></p>
<p id="section-8.5-2">
   The Trust Marked Entities Listing endpoint location is published in
   the Entity's <code>federation_entity</code> metadata
   in the <code>federation_trust_mark_list_endpoint</code> parameter
   defined in <a href="#federation_entity" class="auto internal xref">Section 5.1.1</a>.<a href="#section-8.5-2" class="pilcrow">¶</a></p>
<div id="tm-listing-request">
<section id="section-8.5.1">
          <h4 id="name-trust-marked-entities-listin">
<a href="#section-8.5.1" class="section-number selfRef">8.5.1. </a><a href="#name-trust-marked-entities-listin" class="section-name selfRef">Trust Marked Entities Listing Request</a>
          </h4>
<p id="section-8.5.1-1">
     When client authentication is not used,
            the request MUST be an HTTP request using the GET method
            to a list endpoint with the
            following query parameters, encoded in
            <code>application/x-www-form-urlencoded</code> format.<a href="#section-8.5.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-8.5.1-2">
            <dt id="section-8.5.1-2.1">trust_mark_type</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.1-2.2">
                REQUIRED. Identifier for the type of the Trust Mark.
                If the responder has issued Trust Marks with the
                specified Trust Mark type identifier,
                the list in the response is filtered to include only
                the Entities for which that Trust Mark type identifier has been
                issued and is still valid.<a href="#section-8.5.1-2.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.1-2.3">sub</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.1-2.4">
                OPTIONAL. The Entity Identifier of the Entity to which the Trust Mark
                was issued. The list obtained in the response MUST be filtered to only
                the Entity matching this value.<a href="#section-8.5.1-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-8.5.1-3">
     When client authentication is used,
     the request MUST be an HTTP request using the POST method,
     with the parameters passed in the POST body.<a href="#section-8.5.1-3" class="pilcrow">¶</a></p>
<p id="section-8.5.1-4" class="keepWithNext">
              The following is a non-normative example of an HTTP GET
              request for a list of Trust Marked Entities:<a href="#section-8.5.1-4" class="pilcrow">¶</a></p>
<span id="name-trust-marked-entities-listing"></span><figure id="figure-36">
            <div class="alignLeft art-text artwork" id="section-8.5.1-5.1">
<pre>
GET /trust_marked_list?trust_mark_type=https%3A%2F%2Ffederation.example.org%2Fopenid_relying_party%2Fprivate%2Funder-age HTTP/1.1
Host: trust-mark-issuer.example.org
</pre>
</div>
<figcaption><a href="#figure-36" class="selfRef">Figure 36</a>:
<a href="#name-trust-marked-entities-listing" class="selfRef">Trust Marked Entities Listing Request</a>
            </figcaption></figure>
</section>
</div>
<div id="tm-listing-response">
<section id="section-8.5.2">
          <h4 id="name-trust-marked-entities-listing-">
<a href="#section-8.5.2" class="section-number selfRef">8.5.2. </a><a href="#name-trust-marked-entities-listing-" class="section-name selfRef">Trust Marked Entities Listing Response</a>
          </h4>
<p id="section-8.5.2-1">
            A successful response MUST use the HTTP status code 200
            with the content type <code>application/json</code>,
            containing a JSON array with Entity Identifiers.<a href="#section-8.5.2-1" class="pilcrow">¶</a></p>
<p id="section-8.5.2-2">
            An error response
            is as defined in
            <a href="#error_response" class="auto internal xref">Section 8.9</a>.<a href="#section-8.5.2-2" class="pilcrow">¶</a></p>
<p id="section-8.5.2-3" class="keepWithNext">
              The following is a non-normative example of a response, containing
              the Trust Marked Entities:<a href="#section-8.5.2-3" class="pilcrow">¶</a></p>
<span id="name-trust-marked-entities-listing-r"></span><figure id="figure-37">
            <div class="alignLeft art-text artwork" id="section-8.5.2-4.1">
<pre>
200 OK
Content-Type: application/json

[
  "https://blackboard.ntnu.no/openid/rp",
  "https://that-rp.example.org"
]
</pre>
</div>
<figcaption><a href="#figure-37" class="selfRef">Figure 37</a>:
<a href="#name-trust-marked-entities-listing-r" class="selfRef">Trust Marked Entities Listing Response</a>
            </figcaption></figure>
</section>
</div>
</section>
</div>
<div id="tm_endpoint">
<section id="section-8.6">
        <h3 id="name-trust-mark-endpoint">
<a href="#section-8.6" class="section-number selfRef">8.6. </a><a href="#name-trust-mark-endpoint" class="section-name selfRef">Trust Mark Endpoint</a>
        </h3>
<p id="section-8.6-1">
          The Trust Mark endpoint is
          exposed by a Trust Mark Issuer
          to provide Trust Marks to subjects.<a href="#section-8.6-1" class="pilcrow">¶</a></p>
<p id="section-8.6-2">
   The Trust Mark endpoint location is published in
   the Entity's <code>federation_entity</code> metadata
   in the <code>federation_trust_mark_endpoint</code> parameter
   defined in <a href="#federation_entity" class="auto internal xref">Section 5.1.1</a>.<a href="#section-8.6-2" class="pilcrow">¶</a></p>
<div id="tm-request">
<section id="section-8.6.1">
          <h4 id="name-trust-mark-request">
<a href="#section-8.6.1" class="section-number selfRef">8.6.1. </a><a href="#name-trust-mark-request" class="section-name selfRef">Trust Mark Request</a>
          </h4>
<p id="section-8.6.1-1">
     When client authentication is not used,
            the request MUST be an HTTP request using the GET method
            with the following query parameters, encoded in
            <code>application/x-www-form-urlencoded</code> format.<a href="#section-8.6.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-8.6.1-2">
            <dt id="section-8.6.1-2.1">trust_mark_type</dt>
            <dd style="margin-left: 1.5em" id="section-8.6.1-2.2">
                REQUIRED. Identifier for the type of the Trust Mark.<a href="#section-8.6.1-2.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-8.6.1-2.3">sub</dt>
            <dd style="margin-left: 1.5em" id="section-8.6.1-2.4">
                REQUIRED. The Entity Identifier of the Entity to which the
                Trust Mark is issued.<a href="#section-8.6.1-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-8.6.1-3">
     When client authentication is used,
     the request MUST be an HTTP request using the POST method,
     with the parameters passed in the POST body.
        The Trust Mark endpoint MAY choose to allow authenticated requests from
        clients that are not the Trust Mark subject, as indicated by the
        <code>sub</code> parameter. An example use case is to
        let a Federation Entity retrieve the Trust Mark for another Entity.<a href="#section-8.6.1-3" class="pilcrow">¶</a></p>
<p id="section-8.6.1-4" class="keepWithNext">
              The following is a non-normative example of an HTTP
              request for a Trust Mark with a specific Trust Mark type identifier and subject:<a href="#section-8.6.1-4" class="pilcrow">¶</a></p>
<span id="name-trust-mark-request-2"></span><figure id="figure-38">
            <div class="alignLeft art-text artwork" id="section-8.6.1-5.1">
<pre>
GET /trust_mark?trust_mark_type=https%3A%2F%2Fwww.spid.gov.it%2Fcertification%2Frp&amp;sub=https%3A%2F%2Frp.example.it%2Fspid HTTP/1.1
Host: tuber.cert.example.org
</pre>
</div>
<figcaption><a href="#figure-38" class="selfRef">Figure 38</a>:
<a href="#name-trust-mark-request-2" class="selfRef">Trust Mark Request</a>
            </figcaption></figure>
</section>
</div>
<div id="tm-response">
<section id="section-8.6.2">
          <h4 id="name-trust-mark-response">
<a href="#section-8.6.2" class="section-number selfRef">8.6.2. </a><a href="#name-trust-mark-response" class="section-name selfRef">Trust Mark Response</a>
          </h4>
<p id="section-8.6.2-1">
            A successful response MUST use the HTTP status code 200
            with the content type
            <code>application/trust-mark+jwt</code>,
            containing the Trust Mark.<a href="#section-8.6.2-1" class="pilcrow">¶</a></p>
<p id="section-8.6.2-2">
            If the specified Entity does not have
            the specified Trust Mark, the
            response is an error response and
            MUST use the HTTP status code 404.<a href="#section-8.6.2-2" class="pilcrow">¶</a></p>
<p id="section-8.6.2-3" class="keepWithNext">
              The following is a non-normative example of a response, containing
              the Trust Mark for the specified Entity
       (with line wraps within values for display purposes only):<a href="#section-8.6.2-3" class="pilcrow">¶</a></p>
<span id="name-trust-mark-response-2"></span><figure id="figure-39">
            <div class="alignLeft art-text artwork" id="section-8.6.2-4.1">
<pre>
200 OK
Content-Type: application/trust-mark+jwt

eyJ0eXAiOiJ0cnVzdC1tYXJrK2p3dCIsImFsZyI6IlJTMjU2Iiwia2lkIjoia29zR20yd3Va
aDlER21OeEF0a3VPNDBwUGpwTDMtakNmMU4tcVBPLVllVSJ9.
eyJpc3MiOiJodHRwczovL3d3dy5hZ2lkLmdvdi5pdCIsInN1YiI6Imh0dHBzOi8vcnAuZXhh
bXBsZS5pdC9zcGlkIiwiaWF0IjoxNTc5NjIxMTYwLCJ0cnVzdF9tYXJrX3R5cGUiOiJodHRw
czovL3d3dy5zcGlkLmdvdi5pdC9jZXJ0aWZpY2F0aW9uL3JwIiwibG9nb191cmkiOiJodHRw
czovL3d3dy5hZ2lkLmdvdi5pdC90aGVtZXMvY3VzdG9tL2FnaWQvbG9nby5zdmciLCJyZWYi
OiJodHRwczovL2RvY3MuaXRhbGlhLml0L2RvY3Mvc3BpZC1jaWUtb2lkYy1kb2NzL2l0L3Zl
cnNpb25lLWNvcnJlbnRlLyJ9.
L_pSh1InEiFAcs3E-1HBM7fNZYwF5ru3UGA_8yc80dGS3sszfA_sbj4AoW_zAJWQBdZpjxnH
BBmybYXFrfZBcqxcedsrvUYrmbt1nPYxbUE54fRRoZK-sJmVqh1GzSan5nOmkxuAtMinU8k_
-aWnPWj83sYe2AzT2mMgkXiz8zhda3jZm8hoxZ4jR6B0YAvbMlq2pPWO5OWKdZhiFRMSprwh
0GYluQkK0j1aLNMGXD3keMJd2zEoWX9D7w2fXShAA48W3cNhuXyBVnCoum1K4IWK3s_fx4nI
kp6W-V4jCBOpxp7Yo8LZ30o_xpEOzGTIECGWVR86azOAlwVC8XSiAA
</pre>
</div>
<figcaption><a href="#figure-39" class="selfRef">Figure 39</a>:
<a href="#name-trust-mark-response-2" class="selfRef">Trust Mark Response</a>
            </figcaption></figure>
</section>
</div>
</section>
</div>
<div id="historical_keys">
<section id="section-8.7">
        <h3 id="name-federation-historical-keys-">
<a href="#section-8.7" class="section-number selfRef">8.7. </a><a href="#name-federation-historical-keys-" class="section-name selfRef">Federation Historical Keys Endpoint</a>
        </h3>
<p id="section-8.7-1">
          Each Federation Entity MAY publish its previously used
   Federation Entity Keys at the historical keys endpoint
   defined in <a href="#federation_entity" class="auto internal xref">Section 5.1.1</a>.
          The purpose of this endpoint is to provide
          the list of keys previously used by the Federation Entity
          to provide non-repudiation of statements signed by
          it after key rotation. This endpoint also discloses the
          reason for the retraction of the keys and whether they were
          expired or revoked, including the reason for the revocation.<a href="#section-8.7-1" class="pilcrow">¶</a></p>
<p id="section-8.7-2">
          Note that an expired key can be later additionally marked as
          revoked, to indicate a key compromise event discovered
          after the expiration of the key.<a href="#section-8.7-2" class="pilcrow">¶</a></p>
<p id="section-8.7-3">
          The publishing of the historical keys guarantees that Trust Chains
          will remain verifiable and usable as inputs to trust decisions
          after the key expiration, unless the key becomes revoked
          for a security reason.<a href="#section-8.7-3" class="pilcrow">¶</a></p>
<div id="hist-keys-request">
<section id="section-8.7.1">
          <h4 id="name-federation-historical-keys-r">
<a href="#section-8.7.1" class="section-number selfRef">8.7.1. </a><a href="#name-federation-historical-keys-r" class="section-name selfRef">Federation Historical Keys Request</a>
          </h4>
<p id="section-8.7.1-1">
     When client authentication is not used,
            the request MUST be an HTTP request using the GET method to
     the federation historical keys endpoint.<a href="#section-8.7.1-1" class="pilcrow">¶</a></p>
<p id="section-8.7.1-2">
     When client authentication is used,
     the request MUST be an HTTP request using the POST method,
     with the client authentication parameters passed in the POST body.<a href="#section-8.7.1-2" class="pilcrow">¶</a></p>
<p id="section-8.7.1-3" class="keepWithNext">
              The following is a non-normative example of a
              historical keys request:<a href="#section-8.7.1-3" class="pilcrow">¶</a></p>
<span id="name-federation-historical-keys-re"></span><figure id="figure-40">
            <div class="alignLeft art-text artwork" id="section-8.7.1-4.1">
<pre>
GET /federation_historical_keys HTTP/1.1
Host: trust-anchor.example.com
</pre>
</div>
<figcaption><a href="#figure-40" class="selfRef">Figure 40</a>:
<a href="#name-federation-historical-keys-re" class="selfRef">Federation Historical Keys Request</a>
            </figcaption></figure>
</section>
</div>
<div id="HistKeysResp">
<section id="section-8.7.2">
          <h4 id="name-federation-historical-keys-res">
<a href="#section-8.7.2" class="section-number selfRef">8.7.2. </a><a href="#name-federation-historical-keys-res" class="section-name selfRef">Federation Historical Keys Response</a>
          </h4>
<p id="section-8.7.2-1">
     The response is a signed JWK Set containing the historical keys.
     It is signed with a Federation Entity Key.
     A signed JWK Set is a signed JWT with a
     JWK Set <span>[<a href="#RFC7517" class="cite xref">RFC7517</a>]</span> as its payload.
            A successful response MUST use the HTTP status code 200
            with the content type
            <code>application/jwk-set+jwt</code>.<a href="#section-8.7.2-1" class="pilcrow">¶</a></p>
<p id="section-8.7.2-2">
     Historical keys JWTs are explicitly typed by setting the
            <code>typ</code> header parameter to
            <code>jwk-set+jwt</code> to prevent
            cross-JWT confusion, per Section 3.11 of <span>[<a href="#RFC8725" class="cite xref">RFC8725</a>]</span>.
     Historical keys JWTs without a <code>typ</code> header parameter
     or with a different <code>typ</code> value MUST be rejected.<a href="#section-8.7.2-2" class="pilcrow">¶</a></p>
<p id="section-8.7.2-3">
     Historical keys JWTs MUST include the
     <code>kid</code> (Key ID) header parameter
     with its value being the Key ID of the signing key used.<a href="#section-8.7.2-3" class="pilcrow">¶</a></p>
<p id="section-8.7.2-4">
            The Claims in a historical keys JWT are:<a href="#section-8.7.2-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-8.7.2-5">
            <dt id="section-8.7.2-5.1">iss</dt>
            <dd style="margin-left: 1.5em" id="section-8.7.2-5.2">
                REQUIRED. String.
                The Entity's Entity Identifier.<a href="#section-8.7.2-5.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-8.7.2-5.3">iat</dt>
            <dd style="margin-left: 1.5em" id="section-8.7.2-5.4">
                REQUIRED. Number. Time when this historical keys JWT was issued.
                This is expressed as Seconds Since the Epoch, per
                <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-8.7.2-5.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-8.7.2-5.5">keys</dt>
            <dd style="margin-left: 1.5em" id="section-8.7.2-5.6">
              <p id="section-8.7.2-5.6.1">
                REQUIRED. Array of JSON objects
                containing the signing keys for the Entity in JWK format.<a href="#section-8.7.2-5.6.1" class="pilcrow">¶</a></p>
<p id="section-8.7.2-5.6.2">
                  JWKs in the <code>keys</code>
                  Claim use the following parameters:<a href="#section-8.7.2-5.6.2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-8.7.2-5.6.3">
                <dt id="section-8.7.2-5.6.3.1">kid</dt>
                <dd style="margin-left: 1.5em" id="section-8.7.2-5.6.3.2">
                      REQUIRED. Parameter used to match a specific key.
                      It is RECOMMENDED that the Key ID be the
                      JWK Thumbprint <span>[<a href="#RFC7638" class="cite xref">RFC7638</a>]</span> of the key
       using the SHA-256 hash function.<a href="#section-8.7.2-5.6.3.2" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-8.7.2-5.6.3.3">iat</dt>
                <dd style="margin-left: 1.5em" id="section-8.7.2-5.6.3.4">
                      OPTIONAL. Number. Time when this key was issued.
                      This is expressed as Seconds Since the Epoch, per
                      <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-8.7.2-5.6.3.4" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-8.7.2-5.6.3.5">exp</dt>
                <dd style="margin-left: 1.5em" id="section-8.7.2-5.6.3.6">
                      REQUIRED. Number. Expiration time for the key.
                      This is expressed as Seconds Since the Epoch, per
                      <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>,
                      After this time the key MUST NOT be considered valid.<a href="#section-8.7.2-5.6.3.6" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-8.7.2-5.6.3.7">revoked</dt>
                <dd style="margin-left: 1.5em" id="section-8.7.2-5.6.3.8">
                  <p id="section-8.7.2-5.6.3.8.1">
                      OPTIONAL. JSON object that contains the
                      properties of the revocation, as defined below:<a href="#section-8.7.2-5.6.3.8.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-8.7.2-5.6.3.8.2">
                    <dt id="section-8.7.2-5.6.3.8.2.1">revoked_at</dt>
                    <dd style="margin-left: 1.5em" id="section-8.7.2-5.6.3.8.2.2">
                          REQUIRED. Time when the key was revoked
                          or must be considered revoked,
                          using the time format defined for the
                          <code>iat</code> Claim in
                      <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-8.7.2-5.6.3.8.2.2" class="pilcrow">¶</a>
</dd>
                    <dd class="break"></dd>
<dt id="section-8.7.2-5.6.3.8.2.3">reason</dt>
                    <dd style="margin-left: 1.5em" id="section-8.7.2-5.6.3.8.2.4">
                          OPTIONAL. String
                          that identifies the reason
                          for the key revocation, as defined in
                          <a href="#hist-keys-reasons" class="auto internal xref">Section 8.7.3</a>.<a href="#section-8.7.2-5.6.3.8.2.4" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
</dl>
<p id="section-8.7.2-5.6.3.8.3">
                        Additional members of the <code>revoked</code>
                        object MAY be defined and used.<a href="#section-8.7.2-5.6.3.8.3" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-8.7.2-6">
     Additional Claims MAY be defined and used in conjunction with the Claims above.<a href="#section-8.7.2-6" class="pilcrow">¶</a></p>
<p id="section-8.7.2-7">
     JWKs in the <code>keys</code> Claim MAY also contain the
     <code>nbf</code> parameter.  For use in Historical Keys,
     <code>iat</code> and <code>exp</code>
     are sufficient to establish the key lifetime,
     making <code>nbf</code> typically superfluous;
     however, it is registered for use by profiles that may choose to
     issue keys that do not immediately become valid at the time of issuance.
     Its definition is:<a href="#section-8.7.2-7" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-8.7.2-8">
            <dt id="section-8.7.2-8.1">nbf</dt>
            <dd style="margin-left: 1.5em" id="section-8.7.2-8.2">
 OPTIONAL. Time before which the key is not valid,
 using the time format defined for the
 <code>nbf</code> Claim in
 <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-8.7.2-8.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-8.7.2-9" class="keepWithNext">
              The following is a non-normative example of the JWT Claims Set for a historical keys response:<a href="#section-8.7.2-9" class="pilcrow">¶</a></p>
<span id="name-federation-historical-keys-resp"></span><figure id="figure-41">
            <div class="alignLeft art-text artwork" id="section-8.7.2-10.1">
<pre>
{
    "iss": "https://trust-anchor.federation.example.com",
    "iat": 1666335600,
    "keys":
        [
            {
                "kty": "RSA",
                "n": "5s4qi ...",
                "e": "AQAB",
                "kid": "2HnoFS3YnC9tjiCaivhWLVUJ3AxwGGz_98uRFaqMEEs",
                "iat": 1661151600,
                "exp": 1677052800
            },
            {
                "kty": "RSA",
                "n": "ng5jr ...",
                "e": "AQAB",
                "kid": "8KnoFS3YnC9tjiCaivhWLVUJ3AxwGGz_98uRFaqMJJr",
                "iat": 1647932400,
                "exp": 1663830000,
                "revoked": {
                  "revoked_at": 1661151600,
                  "reason": "compromised",
                }
            }
        ]
}
</pre>
</div>
<figcaption><a href="#figure-41" class="selfRef">Figure 41</a>:
<a href="#name-federation-historical-keys-resp" class="selfRef">Federation Historical Keys Response JWT Claims Set</a>
            </figcaption></figure>
</section>
</div>
<div id="hist-keys-reasons">
<section id="section-8.7.3">
          <h4 id="name-federation-historical-keys-rev">
<a href="#section-8.7.3" class="section-number selfRef">8.7.3. </a><a href="#name-federation-historical-keys-rev" class="section-name selfRef">Federation Historical Keys Revocation Reasons</a>
          </h4>
<p id="section-8.7.3-1">
            Federation Entities are strongly encouraged to use a meaningful
            <code>reason</code> value when indicating the revocation reason
            for a Federation Entity Key. The <code>reason</code>
            MAY be omitted
            instead of using the <code>unspecified</code> value.<a href="#section-8.7.3-1" class="pilcrow">¶</a></p>
<p id="section-8.7.3-2">
            Below is the definition of the reason values.<a href="#section-8.7.3-2" class="pilcrow">¶</a></p>
<p id="section-8.7.3-3" class="keepWithNext">
            The following table defines Federation Entity Keys revocation reasons.
            These reasons are inspired by Section 5.3.1 of <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.<a href="#section-8.7.3-3" class="pilcrow">¶</a></p>
<span id="name-federation-entity-keys-revo"></span><table class="center" id="table-2">
            <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-federation-entity-keys-revo" class="selfRef">Federation Entity Keys Revocation Reasons.</a>
            </caption>
<thead>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Reason</td>
                <td class="text-left" rowspan="1" colspan="1">Description</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">unspecified</td>
                <td class="text-left" rowspan="1" colspan="1">General or unspecified reason for the JWK status change.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">compromised</td>
                <td class="text-left" rowspan="1" colspan="1">The private key is believed to have been compromised.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">superseded</td>
                <td class="text-left" rowspan="1" colspan="1">The JWK is no longer active.</td>
              </tr>
            </tbody>
          </table>
<p id="section-8.7.3-5">
                A federation MAY specify and utilize additional reasons depending
                on the trust or security framework in use.<a href="#section-8.7.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="hist-keys-rationale">
<section id="section-8.7.4">
          <h4 id="name-rationale-for-the-federatio">
<a href="#section-8.7.4" class="section-number selfRef">8.7.4. </a><a href="#name-rationale-for-the-federatio" class="section-name selfRef">Rationale for the Federation Historical Keys Endpoint</a>
          </h4>
<p id="section-8.7.4-1">
            The Federation Historical Keys endpoint
            solves the problem of verifying historical
            Trust Chains when the Federation Entity Keys
            have changed, either due to expiration or revocation.<a href="#section-8.7.4-1" class="pilcrow">¶</a></p>
<p id="section-8.7.4-2">
            The Federation Historical Keys endpoint
            publishes the list of public keys used in the past by the Entity.
            These keys are needed
            to verify Trust Chains created in the past with
            Entity keys no longer published in the Entity's
            Entity Configuration.<a href="#section-8.7.4-2" class="pilcrow">¶</a></p>
<p id="section-8.7.4-3">
            The Federation Historical Keys endpoint response contains a signed JWT
            that attests to all the expired and revoked Entity keys.<a href="#section-8.7.4-3" class="pilcrow">¶</a></p>
<p id="section-8.7.4-4">
            Based on the attributes contained in the Entity Statements
            that form a Trust Chain, it MAY also be possible to verify
            the non-federation public keys used in the past by Leaf Entities for
            signature operations for OpenID Connect
            requests and responses.
            For example, an Entity Statement issued for a Leaf
            MAY also include the
            <code>jwks</code> Claim for the Leaf's Entity Types,
     in its
            <code>metadata</code> or
            <code>metadata_policy</code> Claims.<a href="#section-8.7.4-4" class="pilcrow">¶</a></p>
<p id="section-8.7.4-5">
              A simple example: In the following Trust Chain, the
              Federation Intermediate attests to the Leaf's OpenID Connect RP
       <code>jwks</code>
              in the Subordinate Statement issued about the Leaf. The result is
              a Trust Chain that contains the Leaf's OpenID Connect RP JWK Set,
              needed to verify historical signature on
              Request Objects and any other signed JWT issued by the Leaf as an RP.
       This example Trust Chain contains:<a href="#section-8.7.4-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-8.7.4-6">
<li id="section-8.7.4-6.1">
              <p id="section-8.7.4-6.1.1">
                  an Entity Configuration about the RP published by the RP,<a href="#section-8.7.4-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-8.7.4-6.2">
              <p id="section-8.7.4-6.2.1">
                  a Subordinate Statement about the RP published by Organization A,
                  with the Claim <code>jwks</code> contained in
                  <code>metadata</code> or
                  <code>metadata_policy</code> attesting the
                  Leaf's OpenID Connect RP <code>jwks</code>, and<a href="#section-8.7.4-6.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-8.7.4-6.3">
              <p id="section-8.7.4-6.3.1">
                  a Subordinate Statement about Organization A published by Federation F.<a href="#section-8.7.4-6.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="ClientAuthentication">
<section id="section-8.8">
        <h3 id="name-client-authentication-at-fe">
<a href="#section-8.8" class="section-number selfRef">8.8. </a><a href="#name-client-authentication-at-fe" class="section-name selfRef">Client Authentication at Federation Endpoints</a>
        </h3>
<p id="section-8.8-1">
   Client authentication is not used at any of the federation endpoints,
   by default.
   Federations can choose to make client authentication OPTIONAL, REQUIRED,
   and/or not allowed at particular federation endpoints.<a href="#section-8.8-1" class="pilcrow">¶</a></p>
<p id="section-8.8-2">
   Client authentication with <code>private_key_jwt</code>
   is the default client authentication method to federation endpoints
   when client authentication is supported.
   This client authentication method is described in Section 9 of
   <span><a href="#OpenID.Core" class="internal xref">OpenID Connect Core 1.0</a> [<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>.
   The client authentication JWT MUST be signed with a Federation Entity Key.
   The audience of the JWT MUST be the Entity Identifier
   of the Entity whose federation endpoint is being authenticated to.
   The endpoint MUST NOT accept JWTs containing audience values
   other than its Entity Identifier.
   When client authentication is used,
   the request MUST be an HTTP request using the POST method,
   with the client authentication and endpoint request parameters passed in the POST body.
   Federations can choose to also use other client authentication methods.<a href="#section-8.8-2" class="pilcrow">¶</a></p>
<div id="ClientAuthenticationMetadata">
<section id="section-8.8.1">
          <h4 id="name-client-authentication-metad">
<a href="#section-8.8.1" class="section-number selfRef">8.8.1. </a><a href="#name-client-authentication-metad" class="section-name selfRef">Client Authentication Metadata for Federation Endpoints</a>
          </h4>
<p id="section-8.8.1-1">
     Like other OAuth and OpenID endpoints supporting client authentication,
     this specification defines metadata parameters saying which
     client authentication methods are supported for each endpoint.
     These largely parallel the
     <code>token_endpoint_auth_methods_supported</code>
     metadata value defined in Section 3 of
     <span><a href="#OpenID.Discovery" class="internal xref">OpenID Connect Discovery 1.0</a> [<a href="#OpenID.Discovery" class="cite xref">OpenID.Discovery</a>]</span>.<a href="#section-8.8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.8.1-2">
     Specifically, for each of the federation endpoints defined in
     <a href="#federation_entity" class="auto internal xref">Section 5.1.1</a>, parameters named
     <code>*_auth_methods</code>
     are defined, where the <code>*</code> represents the
     federation endpoint names
     <code>federation_fetch_endpoint</code>,
     <code>federation_list_endpoint</code>, ...,
     <code>federation_historical_keys_endpoint</code>.<a href="#section-8.8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.8.1-3">
     The <code>*_auth_methods</code>
     metadata parameters list supported client authentication methods
     for these endpoints, just as
     <code>token_endpoint_auth_methods_supported</code>
     does for the Token Endpoint.
     In addition, the value <code>none</code> MAY be used
     to indicate that client authentication is not required at the endpoint.<a href="#section-8.8.1-3" class="pilcrow">¶</a></p>
<p id="section-8.8.1-4" class="keepWithNext">
       So, for instance, this metadata declaration states that
       requests authenticated with
       <code>private_key_jwt</code>
       are REQUIRED at the
       <code>federation_trust_mark_endpoint</code>:<a href="#section-8.8.1-4" class="pilcrow">¶</a></p>
<span id="name-declaring-that-client-authe"></span><figure id="figure-42">
            <div class="alignLeft art-text artwork" id="section-8.8.1-5.1">
<pre>
"federation_trust_mark_endpoint_auth_methods": ["private_key_jwt"]
</pre>
</div>
<figcaption><a href="#figure-42" class="selfRef">Figure 42</a>:
<a href="#name-declaring-that-client-authe" class="selfRef">Declaring that Client Authentication is REQUIRED at an Endpoint</a>
            </figcaption></figure>
<p id="section-8.8.1-6">
     If omitted, the default value for these methods is
     <code>["none"]</code>,
     indicating that only unauthenticated requests are accepted.<a href="#section-8.8.1-6" class="pilcrow">¶</a></p>
<p id="section-8.8.1-7">
     The <code>endpoint_auth_signing_alg_values_supported</code>
     metadata parameter lists supported client authentication
     signing algorithms supported for these endpoints, just as
     <code>token_endpoint_auth_signing_alg_values_supported</code>
     does for the Token Endpoint.<a href="#section-8.8.1-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="error_response">
<section id="section-8.9">
        <h3 id="name-error-responses">
<a href="#section-8.9" class="section-number selfRef">8.9. </a><a href="#name-error-responses" class="section-name selfRef">Error Responses</a>
        </h3>
<p id="section-8.9-1">
          If the request was malformed or an error occurred during
          the processing of the request,
          the response body SHOULD be a JSON object with the content type
          <code>application/json</code>.
          In compliance with
          <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, the following
          standardized error format SHOULD be used:<a href="#section-8.9-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-8.9-2">
          <dt id="section-8.9-2.1">error</dt>
          <dd style="margin-left: 1.5em" id="section-8.9-2.2">
            <p id="section-8.9-2.2.1">
       REQUIRED.
       Error codes in the IANA "OAuth Extensions Error Registry"
       <span>[<a href="#IANA.OAuth.Parameters" class="cite xref">IANA.OAuth.Parameters</a>]</span> MAY be used.
       This specification also defines the following error codes:<a href="#section-8.9-2.2.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-8.9-2.2.2">
              <dt id="section-8.9-2.2.2.1">invalid_request</dt>
              <dd style="margin-left: 1.5em" id="section-8.9-2.2.2.2">
                  The request is incomplete or does
                  not comply with current specifications.
                  The HTTP response status code SHOULD be 400 (Bad Request).<a href="#section-8.9-2.2.2.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-8.9-2.2.2.3">invalid_client</dt>
              <dd style="margin-left: 1.5em" id="section-8.9-2.2.2.4">
                  The Client cannot be authorized or is not
                  a valid participant of the federation.
                  The HTTP response status code SHOULD be 401 (Unauthorized).<a href="#section-8.9-2.2.2.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-8.9-2.2.2.5">invalid_issuer</dt>
              <dd style="margin-left: 1.5em" id="section-8.9-2.2.2.6">
                  The endpoint cannot serve the requested issuer.
                  The HTTP response status code SHOULD be 404 (Not Found).<a href="#section-8.9-2.2.2.6" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-8.9-2.2.2.7">invalid_subject</dt>
              <dd style="margin-left: 1.5em" id="section-8.9-2.2.2.8">
   The endpoint cannot serve the requested subject.
   The HTTP response status code SHOULD be 404 (Not Found).<a href="#section-8.9-2.2.2.8" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-8.9-2.2.2.9">invalid_trust_anchor</dt>
              <dd style="margin-left: 1.5em" id="section-8.9-2.2.2.10">
   The Trust Anchor cannot be found or used.
   The HTTP response status code SHOULD be 404 (Not Found).<a href="#section-8.9-2.2.2.10" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-8.9-2.2.2.11">invalid_trust_chain</dt>
              <dd style="margin-left: 1.5em" id="section-8.9-2.2.2.12">
   The Trust Chain cannot be validated.
   The HTTP response status code SHOULD be 400 (Bad Request).<a href="#section-8.9-2.2.2.12" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-8.9-2.2.2.13">invalid_metadata</dt>
              <dd style="margin-left: 1.5em" id="section-8.9-2.2.2.14">
   Metadata or Metadata Policy values are invalid or conflict.
   The HTTP response status code SHOULD be 400 (Bad Request).<a href="#section-8.9-2.2.2.14" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-8.9-2.2.2.15">not_found</dt>
              <dd style="margin-left: 1.5em" id="section-8.9-2.2.2.16">
                  The requested Entity Identifier cannot be found.
                  The HTTP response status code SHOULD be 404 (Not Found).<a href="#section-8.9-2.2.2.16" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-8.9-2.2.2.17">server_error</dt>
              <dd style="margin-left: 1.5em" id="section-8.9-2.2.2.18">
                  The server encountered an unexpected
                  condition that prevented it from fulfilling the request.
                  The HTTP response status code SHOULD be one in the 5xx range,
                  like 500 (Internal Server Error).<a href="#section-8.9-2.2.2.18" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-8.9-2.2.2.19">temporarily_unavailable</dt>
              <dd style="margin-left: 1.5em" id="section-8.9-2.2.2.20">
                  The server hosting the federation endpoint
                  is currently unable to handle
                  the request due to temporary overloading or maintenance.
                  The HTTP response status code SHOULD be 503 (Service Unavailable).<a href="#section-8.9-2.2.2.20" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-8.9-2.2.2.21">unsupported_parameter</dt>
              <dd style="margin-left: 1.5em" id="section-8.9-2.2.2.22">
                  The server does not support the requested parameter.
                  The HTTP response status code SHOULD be 400 (Bad Request).<a href="#section-8.9-2.2.2.22" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-8.9-2.3">error_description</dt>
          <dd style="margin-left: 1.5em" id="section-8.9-2.4">
       REQUIRED. Human-readable text providing additional information
       used to assist the developer in understanding the error that occurred.<a href="#section-8.9-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-8.9-3" class="keepWithNext">
            The following is a non-normative example of an error response:<a href="#section-8.9-3" class="pilcrow">¶</a></p>
<span id="name-example-error-response"></span><figure id="figure-43">
          <div class="alignLeft art-text artwork" id="section-8.9-4.1">
<pre>
400 Bad request
Content-Type: application/json

{
  "error": "invalid_request",
  "error_description":
    "Required request parameter [sub] was missing."
}
</pre>
</div>
<figcaption><a href="#figure-43" class="selfRef">Figure 43</a>:
<a href="#name-example-error-response" class="selfRef">Example Error Response</a>
          </figcaption></figure>
</section>
</div>
</section>
</div>
<div id="federation_configuration">
<section id="section-9">
      <h2 id="name-obtaining-federation-entity">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-obtaining-federation-entity" class="section-name selfRef">Obtaining Federation Entity Configuration Information</a>
      </h2>
<p id="section-9-1">
 The Entity Configuration of all Trust Anchor and Intermediate
 Federation Entities MUST be published
 at their configuration endpoint
 and the Entity Configuration for Leaf Entities SHOULD be published there.
 Its location is determined by concatenating the string
 <code>/.well-known/openid-federation</code>
 to the Entity Identifier
 (which MUST use the <code>https</code> scheme and
 contain a host component
 and MAY also contain port and path components).
 For instance, the configuration endpoint for the Entity Identifier
 <code>https://entity.example</code> is the URL
 <code>https://entity.example/.well-known/openid-federation</code>.
 If the Entity Identifier contains a trailing "/" character,
 it MUST be removed before concatenating
 <code>/.well-known/openid-federation</code>.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">
 Furthermore, any Entity Configuration including the Entity Type Identifier
 <code>federation_entity</code> MUST be published
 at its configuration endpoint.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">
        While Leaf Federation Entities SHOULD make an Entity Configuration document
        available at their configuration endpoints,
 an exception to this requirement is that
 clients that use a client registration method that results in
 the server having the client's Entity Configuration
 MAY omit doing so.
 For instance, since an RP using Explicit Registration
 posts its Entity Configuration to the OP during client
        registration, the OP has everything it needs from the RP.
 Profiles of this specification MAY define other exceptions for Leaf Entities
 that do not use the Entity Type Identifier <code>federation_entity</code>
 and processing rules that accompany them.<a href="#section-9-3" class="pilcrow">¶</a></p>
<div id="ec-request">
<section id="section-9.1">
        <h3 id="name-federation-entity-configura">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-federation-entity-configura" class="section-name selfRef">Federation Entity Configuration Request</a>
        </h3>
<p id="section-9.1-1">
          An Entity Configuration document MUST be queried using an
          HTTP GET request at the previously specified path.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2" class="keepWithNext">
       In this example, the requesting party would make the following request to the Entity
       <code>https://op.sunet.se</code>
       to obtain its Entity Configuration:<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<span id="name-request-for-entity-configur"></span><figure id="figure-44">
          <div class="alignLeft art-text artwork" id="section-9.1-3.1">
<pre>
  GET /.well-known/openid-federation HTTP/1.1
  Host: op.sunet.se
</pre>
</div>
<figcaption><a href="#figure-44" class="selfRef">Figure 44</a>:
<a href="#name-request-for-entity-configur" class="selfRef">Request for Entity Configuration</a>
          </figcaption></figure>
</section>
</div>
<div id="ec-response">
<section id="section-9.2">
        <h3 id="name-federation-entity-configurat">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-federation-entity-configurat" class="section-name selfRef">Federation Entity Configuration Response</a>
        </h3>
<p id="section-9.2-1">
   The response is an Entity Configuration.
          If the Entity is an Intermediate Entity or a Trust Anchor, the
          response MUST contain metadata for a Federation Entity
          (<code>federation_entity</code>).<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">
          A successful response MUST use the HTTP status code 200
          with the content type
          <code>application/entity-statement+jwt</code>,
          to make it clear that the response contains an Entity Statement.
          In case of an error, the response
          is as defined in
          <a href="#error_response" class="auto internal xref">Section 8.9</a>.<a href="#section-9.2-2" class="pilcrow">¶</a></p>
<p id="section-9.2-3" class="keepWithNext">
       The following is a non-normative example JWT Claims Set for a response from an
       Intermediate Entity:<a href="#section-9.2-3" class="pilcrow">¶</a></p>
<span id="name-entity-configuration-respon"></span><figure id="figure-45">
          <div class="alignLeft art-text artwork" id="section-9.2-4.1">
<pre>
{
  "iss": "https://sunet.se",
  "sub": "https://sunet.se",
  "iat": 1516239022,
  "exp": 1516843822,
  "metadata": {
    "federation_entity": {
      "contacts": ["ops@sunet.se"],
      "federation_fetch_endpoint": "https://sunet.se/fetch",
      "organization_uri": "https://www.sunet.se",
      "organization_name": "SUNET"
    },
  "jwks": {
    "keys": [
      {
        "alg": "RS256",
        "e": "AQAB",
        "kid": "O-wFRGNsy0-4SR2jbXYwDHy6...",
        "kty": "RSA",
        "n": "Qo3n0N0Gv7L8T9I_2sAMc0I4...",
        "use": "sig"
      }
    ]
  },
  "authority_hints": [
    "https://edugain.org"
  ]
}
</pre>
</div>
<figcaption><a href="#figure-45" class="selfRef">Figure 45</a>:
<a href="#name-entity-configuration-respon" class="selfRef">Entity Configuration Response JWT Claims Set for an Intermediate</a>
          </figcaption></figure>
<p id="section-9.2-5" class="keepWithNext">
       The following is a non-normative example JWT Claims Set for a response from an
       OpenID Provider Entity:<a href="#section-9.2-5" class="pilcrow">¶</a></p>
<span id="name-entity-configuration-respons"></span><figure id="figure-46">
          <div class="alignLeft art-text artwork" id="section-9.2-6.1">
<pre>
{
  "iss": "https://op.sunet.se",
  "sub": "https://op.sunet.se",
  "iat": 1516239022,
  "exp": 1516843822,
  "metadata": {
    "openid_provider": {
      "issuer": "https://op.sunet.se",
      "signed_jwks_uri": "https://op.sunet.se/jwks.jose",
      "authorization_endpoint":
        "https://op.sunet.se/authorization",
      "client_registration_types_supported": [
        "automatic",
        "explicit"
      ],
      "grant_types_supported": [
        "authorization_code"
      ],
      "id_token_signing_alg_values_supported": [
        "ES256", "RS256"
      ],
      "contacts": ["ops@sunet.se"],
      "organization_uri": "https://www.sunet.se",
      "organization_name": "SUNET"
      "logo_uri":
        "https://www.sunet.se/sunet/images/32x32.png",
      "op_policy_uri":
        "https://www.sunet.se/en/website/legal-information/",
      "response_types_supported": [
        "code"
      ],
      "subject_types_supported": [
        "pairwise",
        "public"
      ],
      "token_endpoint": "https://op.sunet.se/token",
      "federation_registration_endpoint":
        "https://op.sunet.se/fedreg",
      "token_endpoint_auth_methods_supported": [
        "private_key_jwt"
      ]
    }
  },
  "jwks": {
    "keys": [
      {
        "alg": "RS256",
        "e": "AQAB",
        "kid": "yHozfrAd5G-pnmG4e1jCXpfc...",
        "kty": "RSA",
        "n": "HIoSq4wkZiEkJDTPHiv7torK...",
        "use": "sig"
      }
    ]
  },
  "authority_hints": [
    "https://sunet.se"
  ]
}
</pre>
</div>
<figcaption><a href="#figure-46" class="selfRef">Figure 46</a>:
<a href="#name-entity-configuration-respons" class="selfRef">Entity Configuration Response JWT Claims Set for an OP</a>
          </figcaption></figure>
</section>
</div>
</section>
</div>
<div id="resolving_trust">
<section id="section-10">
      <h2 id="name-resolving-the-trust-chain-a">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-resolving-the-trust-chain-a" class="section-name selfRef">Resolving the Trust Chain and Metadata</a>
      </h2>
<p id="section-10-1">
        An Entity (Party A) that wants to establish trust with
        another Entity (Party B) MUST have Party B's Entity Identifier and a list of
        Entity Identifiers of Trust Anchors and their public signing keys.
        Party A will first have to fetch
        sufficient Entity Statements to establish at least one chain of trust
        from Party B to one or more of the Trust Anchors.
        After that, Party A MUST validate the Trust Chains independently,
        and if there are multiple valid Trust Chains and if the
        application demands it, choose one to use.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">
        To delegate the Trust Chain evaluation to a trusted third party,
        the Entity (Party A) that wants to establish trust with
        another Entity (Party B) MAY use
        a resolve endpoint, as defined in <a href="#resolve" class="auto internal xref">Section 8.3</a>.<a href="#section-10-2" class="pilcrow">¶</a></p>
<div id="fetching-es">
<section id="section-10.1">
        <h3 id="name-fetching-entity-statements-">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-fetching-entity-statements-" class="section-name selfRef">Fetching Entity Statements to Establish a Trust Chain</a>
        </h3>
<p id="section-10.1-1">
          Depending on the circumstances, Party A MAY be
          handed Party B's Entity Configuration, or it may
          have to fetch it by itself. If it needs to fetch it, it will use the
          process described in <a href="#federation_configuration" class="auto internal xref">Section 9</a>
          based on the Entity Identifier of Party B.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<p id="section-10.1-2">
          The next step is to iterate through the list of
          Intermediates listed in
          <code>authority_hints</code>, ignoring the authority
          hints that end in an unknown Trust Anchor,
          requesting an Entity Configuration from each of the Intermediates.
          If the received Entity Configuration contains an authority hint, this
          process is repeated.<a href="#section-10.1-2" class="pilcrow">¶</a></p>
<p id="section-10.1-3">
          With the list of all Intermediates and the Trust Anchor, the respective
          fetch endpoints, as defined in <a href="#fetch_endpoint" class="auto internal xref">Section 8.1</a>, are used to fetch
          Entity Statements about the Intermediates and Party B.<a href="#section-10.1-3" class="pilcrow">¶</a></p>
<p id="section-10.1-4">
          Federation participants MUST NOT attempt to fetch
          Entity Statements they already have obtained during this
          process to prevent loops.
          If a loop is detected, the authority hint that led to it MUST NOT be used.<a href="#section-10.1-4" class="pilcrow">¶</a></p>
<p id="section-10.1-5">
          A successful operation will return one or more lists of
          Entity Statements. Each of the lists terminating in a self-signed
          Entity Statement is issued by a Trust Anchor.<a href="#section-10.1-5" class="pilcrow">¶</a></p>
<p id="section-10.1-6">
          If there is no path from Party B to at least one of the
          trusted Trust Anchors, then the list will be empty and there is no
          way of establishing trust in Party B's information.
          How Party A deals with this is out of scope for this specification.<a href="#section-10.1-6" class="pilcrow">¶</a></p>
<p id="section-10.1-7" class="keepWithNext">
   The following sequence diagram represents the interactions between the RP,
   the OP, and the Trust Anchor during a trust evaluation made by the OP
   about the RP.
   Relating this to the preceding description, in this diagram,
   Party A is the OP and Party B is the RP.<a href="#section-10.1-7" class="pilcrow">¶</a></p>
<span id="name-resolving-trust-chain-and-m"></span><figure id="figure-47">
          <div class="alignLeft art-text artwork" id="section-10.1-8.1">
<pre>
+-----+                         +-----+                             +--------------+
| RP  |                         | OP  |                             | Trust Anchor |
+-----+                         +-----+                             +--------------+
   |                               |                                        |
   | Entity Configuration Request  |                                        |
   |&lt;------------------------------|                                        |
   |                               |                                        |
   | Entity Configuration Response |                                        |
   |------------------------------&gt;|                                        |
   |                               |                                        |
   |                               | Evaluates authority_hints              |
   |                               |--------------------------              |
   |                               |                         |              |
   |                               |&lt;-------------------------              |
   |                               |                                        |
   |                               | Entity Configuration Request           |
   |                               |---------------------------------------&gt;|
   |                               |                                        |
   |                               |        Entity Configuration Response   |
   |                               |&lt;---------------------------------------|
   |                               |                                        |
   |                               | Obtains Fetch Endpoint                 |
   |                               |-----------------------                 |
   |                               |                      |                 |
   |                               |&lt;----------------------                 |
   |                               |                                        |
   |                               | Request Subordinate Statement about RP |
   |                               |---------------------------------------&gt;|
   |                               |                                        |
   |                               |        Subordinate Statement about RP  |
   |                               |&lt;---------------------------------------|
   |                               |                                        |
   |                               | Evaluates the Trust Chain              |
   |                               |--------------------------              |
   |                               |                         |              |
   |                               |&lt;-------------------------              |
   |                               |                                        |
   |                               | Applies Metadata Policies              |
   |                               |--------------------------              |
   |                               |                         |              |
   |                               |&lt;-------------------------              |
   |                               |                                        |
   |                               | Applies Constraints                    |
   |                               |--------------------                    |
   |                               |                   |                    |
   |                               |&lt;-------------------                    |
   |                               |                                        |
   |                               | Derives the RP's Resolved Metadata     |
   |                               |-----------------------------------     |
   |                               |                                  |     |
   |                               |&lt;----------------------------------     |
</pre>
</div>
<figcaption><a href="#figure-47" class="selfRef">Figure 47</a>:
<a href="#name-resolving-trust-chain-and-m" class="selfRef">Resolving Trust Chain and Metadata from the Perspective of an OP</a>
          </figcaption></figure>
</section>
</div>
<div id="trust_chain_validation">
<section id="section-10.2">
        <h3 id="name-validating-a-trust-chain">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-validating-a-trust-chain" class="section-name selfRef">Validating a Trust Chain</a>
        </h3>
<p id="section-10.2-1">
          As described in <a href="#trust_chain" class="auto internal xref">Section 4</a>,
          a Trust Chain consists of an ordered list of Entity Statements.
          So however Party A has acquired the set of
          Entity Statements, it MUST now verify that it is a proper Trust Chain
          using the rules laid out in that section.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<p id="section-10.2-2">
   Let us refer to the Entity Statements in the Trust Chain as
   ES[j], where j = 0,...,i,
   with 0 being the index of the first Entity Statement
   and i being the zero-based index of the last.
   To validate the Trust Chain, the following MUST be done:<a href="#section-10.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.2-3.1">
            <p id="section-10.2-3.1.1">
              For each Entity Statement ES[j], where j = 0,..,i:<a href="#section-10.2-3.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.2-3.1.2.1">
                <p id="section-10.2-3.1.2.1.1">
                  Verify that the statement contains all the required Claims.<a href="#section-10.2-3.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-10.2-3.1.2.2">
                <p id="section-10.2-3.1.2.2.1">
                  Verify that <code>iat</code> has a value in the
                  past.<a href="#section-10.2-3.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-10.2-3.1.2.3">
                <p id="section-10.2-3.1.2.3.1">
                  Verify that <code>exp</code> has a value that
                  is in the future.<a href="#section-10.2-3.1.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-10.2-3.2">
            <p id="section-10.2-3.2.1">
              For ES[0] (the Entity Configuration of the Trust Chain subject), verify that
       <code>iss</code> == <code>sub</code>.<a href="#section-10.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-3.3">
            <p id="section-10.2-3.3.1">
              For ES[0], verify that its signature validates with a public key
       in ES[0]["jwks"].<a href="#section-10.2-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-3.4">
            <p id="section-10.2-3.4.1">
              For each j = 0,...,i-1, verify that ES[j]["iss"] == ES[j+1]["sub"].<a href="#section-10.2-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-3.5">
            <p id="section-10.2-3.5.1">
              For each j = 0,...,i-1, verify that the signature of ES[j] validates with a public
              key in ES[j+1]["jwks"].<a href="#section-10.2-3.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-3.6">
            <p id="section-10.2-3.6.1">
              For ES[i] (the Trust Anchor's Entity Configuration), verify that
       the issuer matches the Entity Identifier of the Trust Anchor.<a href="#section-10.2-3.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-3.7">
            <p id="section-10.2-3.7.1">
       For ES[i], verify that
       its signature validates with a public key of the Trust Anchor.<a href="#section-10.2-3.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.2-4">
          Verifying the signature is a much more expensive
          operation than verifying the correctness of the statement and the
          timestamps. An implementer MAY therefore choose not to verify the
          signatures until all the other checks have been done.<a href="#section-10.2-4" class="pilcrow">¶</a></p>
<p id="section-10.2-5">
   Federation participants MAY cache Entity Statements and signature verification
          results until they expire, per
          <a href="#trust_lifetime" class="auto internal xref">Section 10.4</a>.<a href="#section-10.2-5" class="pilcrow">¶</a></p>
<p id="section-10.2-6">
          After the preceding validation, metadata MUST be resolved to the subject
          of the Trust Chain, as described in <a href="#metadata_policy_enforcement" class="auto internal xref">Section 6.1.4</a>.
          Furthermore, constraints MUST be enforced for each Subordinate Statement of the Trust Chain,
          as explained in <a href="#chain_constraints" class="auto internal xref">Section 6.2</a>.<a href="#section-10.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="choosing-chain">
<section id="section-10.3">
        <h3 id="name-choosing-one-of-the-valid-t">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-choosing-one-of-the-valid-t" class="section-name selfRef">Choosing One of the Valid Trust Chains</a>
        </h3>
<p id="section-10.3-1">
          If multiple valid Trust Chains are found, Party A will
          need to decide on which one to use.
   One simple rule would be to prefer a shorter chain over a longer one.
   Federation participants MAY follow other rules according to local policy.<a href="#section-10.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trust_lifetime">
<section id="section-10.4">
        <h3 id="name-calculating-the-expiration-">
<a href="#section-10.4" class="section-number selfRef">10.4. </a><a href="#name-calculating-the-expiration-" class="section-name selfRef">Calculating the Expiration Time of a Trust Chain</a>
        </h3>
<p id="section-10.4-1">
          Each Entity Statement in a Trust Chain is signed and MUST have an
          expiration time (<code>exp</code>).
          The expiration time of the whole Trust Chain is the minimum
          (<code>exp</code>) value within the Trust Chain.<a href="#section-10.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="transient_trust_chain_validation_errors">
<section id="section-10.5">
        <h3 id="name-transient-trust-chain-valid">
<a href="#section-10.5" class="section-number selfRef">10.5. </a><a href="#name-transient-trust-chain-valid" class="section-name selfRef">Transient Trust Chain Validation Errors</a>
        </h3>
<p id="section-10.5-1">
          If the federation topology is being updated, for example, when a set
          of Leaf Entities is moved to a new Intermediate Entity, the Trust Chain
          validation may fail in a transient manner. Retrying after a period of
          time may resolve the situation.<a href="#section-10.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ResolvingWithResolver">
<section id="section-10.6">
        <h3 id="name-resolving-the-trust-chain-an">
<a href="#section-10.6" class="section-number selfRef">10.6. </a><a href="#name-resolving-the-trust-chain-an" class="section-name selfRef">Resolving the Trust Chain and Metadata with a Resolver</a>
        </h3>
<p id="section-10.6-1">
   Note that an alternative method for resolving a Trust Chain
   for an Entity (Party B) using the methods described above
   is to use a resolve endpoint, as described in <a href="#resolve" class="auto internal xref">Section 8.3</a>.
   This lets the resolver do the work that otherwise the Entity (Party A)
   wanting to establish trust would have to do for itself.<a href="#section-10.6-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="updating-metadata">
<section id="section-11">
      <h2 id="name-updating-metadata-key-rollo">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-updating-metadata-key-rollo" class="section-name selfRef">Updating Metadata, Key Rollover, and Revocation</a>
      </h2>
<p id="section-11-1">
        This specification facilitates smoothly updating metadata
        and public keys.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">
        As described in <a href="#trust_lifetime" class="auto internal xref">Section 10.4</a>,
        each Trust Chain has an expiration time.
        Federation participants MUST support
        refreshing a Trust Chain when it expires.
        How often a participant reevaluates the Trust Chain depends on
        how quickly it wants to find out that something has changed.<a href="#section-11-2" class="pilcrow">¶</a></p>
<div id="key-rollover">
<section id="section-11.1">
        <h3 id="name-federation-key-rollover">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-federation-key-rollover" class="section-name selfRef">Federation Key Rollover</a>
        </h3>
<p id="section-11.1-1">
   The expiration time (<code>exp</code>)
   of an Entity Configuration is used to control how often it
   needs to be retrieved to fetch an updated set of Federation Keys
   from its <code>jwks</code> member.<a href="#section-11.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key_rollover_anchor">
<section id="section-11.2">
        <h3 id="name-key-rollover-for-a-trust-an">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-key-rollover-for-a-trust-an" class="section-name selfRef">Key Rollover for a Trust Anchor</a>
        </h3>
<p id="section-11.2-1">
          A Trust Anchor MUST publish an Entity Configuration about itself.
          The expiration time (<code>exp</code>) set on this Entity Configuration should be chosen
          such that it ensures that federation participants re-fetch it at reasonable intervals.
          When a Trust Anchor rolls over its signing keys, it needs to:<a href="#section-11.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-11.2-2">
<li id="section-11.2-2.1">
            <p id="section-11.2-2.1.1">
              Add the new keys to the <code>jwks</code> representing
              the Trust Anchor's signing keys in its Entity Configuration.<a href="#section-11.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.2-2.2">
            <p id="section-11.2-2.2.1">
              Keep signing the Entity Configuration and the Entity Statements using
              the old keys for a long enough time period to allow all
              Subordinates to have obtained the new keys.<a href="#section-11.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.2-2.3">
            <p id="section-11.2-2.3.1">
              Switch to signing with the new keys.<a href="#section-11.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.2-2.4">
            <p id="section-11.2-2.4.1">
              After a reasonable time period, remove the old keys. What is
              regarded as a reasonable time is dependent on the security profile
              and risk assessment of the Trust Anchor.<a href="#section-11.2-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="TrustAnchorKeys">
<section id="section-11.3">
        <h3 id="name-redundant-retrieval-of-trus">
<a href="#section-11.3" class="section-number selfRef">11.3. </a><a href="#name-redundant-retrieval-of-trus" class="section-name selfRef">Redundant Retrieval of Trust Anchor Keys</a>
        </h3>
<p id="section-11.3-1">
          It is RECOMMENDED that Federation Operators provide a means of retrieving the public keys
          for the Trust Anchors it administers that is independent of those Trust Anchors' Entity Configurations.
          This is intended to provide redundancy in the eventuality of the compromise of
          the Web PKI <span>[<a href="#RFC9525" class="cite xref">RFC9525</a>]</span> infrastructure underlying retrieval of public keys from Entity Configurations.<a href="#section-11.3-1" class="pilcrow">¶</a></p>
<p id="section-11.3-2">
          The keys retrieved via the independent mechanism specified by the Federation Operator
          SHOULD be compared to those retrieved via the Trust Anchor's Entity Configuration.
          If they do not match, both SHOULD be retrieved again.
          If they still do not match, it is indicative of a security or configuration problem.
          The appropriate remediation steps in that eventuality SHOULD be specified by the Federation Operator.<a href="#section-11.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="revocation">
<section id="section-11.4">
        <h3 id="name-revocation">
<a href="#section-11.4" class="section-number selfRef">11.4. </a><a href="#name-revocation" class="section-name selfRef">Revocation</a>
        </h3>
<p id="section-11.4-1">
          Since the participants in federations are expected to check the Trust Chain on a regular
          frequent basis, this specification does not define a
          revocation process. Specific federations MAY make a
          different choice and will then have to define their own revocation process.<a href="#section-11.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="client_registration">
<section id="section-12">
      <h2 id="name-openid-connect-client-regis">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-openid-connect-client-regis" class="section-name selfRef">OpenID Connect Client Registration</a>
      </h2>
<p id="section-12-1">
 Protocol-specific means of performing client registration for
 OpenID Connect and OAuth 2.0 are defined in
 <span><a href="https://openid.net/specs/openid-federation-connect-1_1.html#client_registration" class="relref">Section 12</a> of [<a href="#OpenID.Federation.Connect-1.1" class="cite xref">OpenID.Federation.Connect-1.1</a>]</span>.<a href="#section-12-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="GeneralPurposeClaims">
<section id="section-13">
      <h2 id="name-general-purpose-jwt-claims">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-general-purpose-jwt-claims" class="section-name selfRef">General-Purpose JWT Claims</a>
      </h2>
<p id="section-13-1">
 This section defines general-purpose JWT Claims designed to be used
 by many different JWT profiles.
 They are also used in specific kinds of JWTs defined by this specification.<a href="#section-13-1" class="pilcrow">¶</a></p>
<div id="jwksClaim">
<section id="section-13.1">
        <h3 id="name-jwks-json-web-key-set-claim">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-jwks-json-web-key-set-claim" class="section-name selfRef">"jwks" (JSON Web Key Set) Claim</a>
        </h3>
<p id="section-13.1-1">
   The <code>jwks</code> (JSON Web Key Set) Claim
   value is a JWK Set, as defined in <span>[<a href="#RFC7517" class="cite xref">RFC7517</a>]</span>.
   It is used to convey a set of cryptographic keys.
   Use of this Claim is OPTIONAL.<a href="#section-13.1-1" class="pilcrow">¶</a></p>
<p id="section-13.1-2">
   For instance, the <code>jwks</code> (JSON Web Key Set) Claim
   might be used to represent a set of signing keys for an application.
   This Claim is used in this specification as specified in <a href="#common-claims" class="auto internal xref">Section 3.1.1</a>
   to represent the public keys used to sign the Entity Statement.<a href="#section-13.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="metadataClaim">
<section id="section-13.2">
        <h3 id="name-metadata-claim">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-metadata-claim" class="section-name selfRef">"metadata" Claim</a>
        </h3>
<p id="section-13.2-1">
   The <code>metadata</code> Claim
   is used for conveying metadata pertaining to the JWT.
   Its value is a JSON object.
   The details of the metadata contained are application-specific.
   Use of this Claim is OPTIONAL.<a href="#section-13.2-1" class="pilcrow">¶</a></p>
<p id="section-13.2-2">
   For instance, the <code>metadata</code> Claim
   might be used to represent a set of endpoint URLs
   and algorithm identifiers in an API description.
   This Claim is used in this specification as specified in <a href="#common-claims" class="auto internal xref">Section 3.1.1</a>
   to represent metadata about the Entity.<a href="#section-13.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="constraintsClaim">
<section id="section-13.3">
        <h3 id="name-constraints-claim">
<a href="#section-13.3" class="section-number selfRef">13.3. </a><a href="#name-constraints-claim" class="section-name selfRef">"constraints" Claim</a>
        </h3>
<p id="section-13.3-1">
   The <code>constraints</code> Claim
   is used for conveying constraints pertaining to the JWT.
   Its value is a JSON object.
   The details of the constraints contained are application-specific.
   Use of this Claim is OPTIONAL.<a href="#section-13.3-1" class="pilcrow">¶</a></p>
<p id="section-13.3-2">
   For instance,
   this Claim is used in this specification as specified in <a href="#ss-specific" class="auto internal xref">Section 3.1.3</a>
   to represent constraints on the Trust Chain for the Entity.<a href="#section-13.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="critClaim">
<section id="section-13.4">
        <h3 id="name-crit-critical-claim">
<a href="#section-13.4" class="section-number selfRef">13.4. </a><a href="#name-crit-critical-claim" class="section-name selfRef">"crit" (Critical) Claim</a>
        </h3>
<p id="section-13.4-1">
   The <code>crit</code> (critical) Claim
   indicates that extensions to the set of Claims
   specified for use in this type of JWT are being used
   that MUST be understood and processed.
   It is used in the same way that
   the <code>crit</code> header parameter
   is used for extension JOSE header parameters
   that MUST be understood and processed.
   Its value is an array listing the Claim Names
   present in the JWT that use those extensions.
   If any of the listed Claims are not
   understood and supported by the recipient, then the JWT is invalid.
   Producers MUST NOT include Claim Names already
   specified for use in this type of JWT,
   duplicate names, or
   names that do not occur as Claim Names in the JWT
   in the <code>crit</code> list.
   Producers MUST NOT use the empty array
   <code>[]</code>
   as the <code>crit</code> value.
   Use of this Claim is OPTIONAL.<a href="#section-13.4-1" class="pilcrow">¶</a></p>
<p id="section-13.4-2">
   Section 4 of <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span> states that
   "Specific applications of JWTs will require implementations
   to understand and process some claims in particular ways.
   However, in the absence of such requirements, all claims
   that are not understood by implementations MUST be ignored."
   Thus, for the <code>crit</code> (critical) Claim to be effective,
   the definition for the particular kind of JWT using it MUST
   specify that <code>crit</code> MUST be
   understood and processed, as allowed in the statement above.<a href="#section-13.4-2" class="pilcrow">¶</a></p>
<p id="section-13.4-3">
   This Claim is used in this specification as specified in <a href="#common-claims" class="auto internal xref">Section 3.1.1</a>
   to identify Claims not defined by this specification
   that MUST be understood and processed
   when used in Entity Statements.<a href="#section-13.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="refClaim">
<section id="section-13.5">
        <h3 id="name-ref-reference-claim">
<a href="#section-13.5" class="section-number selfRef">13.5. </a><a href="#name-ref-reference-claim" class="section-name selfRef">"ref" (Reference) Claim</a>
        </h3>
<p id="section-13.5-1">
   The <code>ref</code> (reference) Claim
   is used for conveying the URI for a resource pertaining to the JWT.
   It plays a similar role in a JWT as
   the <code>href</code> property does in HTML.
   The nature of the content at the referenced resource
   is generally application specific.
   The <code>ref</code> value is a case-sensitive string
   containing a URI value.
   Use of this Claim is OPTIONAL.<a href="#section-13.5-1" class="pilcrow">¶</a></p>
<p id="section-13.5-2">
   For instance, a JWT referring to a contract between two parties might use
   the <code>ref</code> (reference) Claim
   to refer to a resource at which the contract terms can be read.
   This Claim is used in this specification as specified in <a href="#trust_mark_claims" class="auto internal xref">Section 7.1</a>
   to provide a URL referring to human-readable information
   about the issuance of the Trust Mark.<a href="#section-13.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="delegationClaim">
<section id="section-13.6">
        <h3 id="name-delegation-claim">
<a href="#section-13.6" class="section-number selfRef">13.6. </a><a href="#name-delegation-claim" class="section-name selfRef">"delegation" Claim</a>
        </h3>
<p id="section-13.6-1">
   The <code>delegation</code> Claim expresses that
   authority is being delegated to the party referenced in the Claim Value.
   The <code>delegation</code> value is a case-sensitive string
   containing a StringOrURI value.
   Use of this Claim is OPTIONAL.<a href="#section-13.6-1" class="pilcrow">¶</a></p>
<p id="section-13.6-2">
   For instance, the <code>delegation</code> Claim
   might be used to express that the referenced party may sign
   a legal document on behalf of the subject.
   This Claim is used in this specification as specified in <a href="#trust_mark_claims" class="auto internal xref">Section 7.1</a>
   to represent delegation of the right to issue Trust Marks
   with a particular identifier.<a href="#section-13.6-2" class="pilcrow">¶</a></p>
<p id="section-13.6-3">
   Note that the <code>delegation</code> Claim is both
   syntactically and semantically distinct from the existing
   <code>act</code> Claim <span>[<a href="#IANA.JWT.Claims" class="cite xref">IANA.JWT.Claims</a>]</span>.
   <code>act</code> is a JSON object whereas
   <code>delegation</code> is a StringOrURI.
   Semantically, the Delegation JWT defined in <a href="#delegation_jwt" class="auto internal xref">Section 7.2.1</a>
   carries a signature by an issuer cryptographically proving
   the right to delegate to the party.
   The <code>act</code> Claim, carrying no signature,
   cannot achieve this.<a href="#section-13.6-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="logo_uriClaim">
<section id="section-13.7">
        <h3 id="name-logo_uri-logo-uri-claim">
<a href="#section-13.7" class="section-number selfRef">13.7. </a><a href="#name-logo_uri-logo-uri-claim" class="section-name selfRef">"logo_uri" (Logo URI) Claim</a>
        </h3>
<p id="section-13.7-1">
   The <code>logo_uri</code> Claim
   value is a URI that references a logo pertaining to the JWT.
   Use of this Claim is OPTIONAL.<a href="#section-13.7-1" class="pilcrow">¶</a></p>
<p id="section-13.7-2">
   For instance, the <code>logo_uri</code> Claim
   might be used to represent the location from which to retrieve
   the logo of an organization to display in a user interface.
   This Claim is used in this specification as specified in <a href="#trust_mark_claims" class="auto internal xref">Section 7.1</a>
   to convey a URL that references a logo for the Entity.<a href="#section-13.7-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ClaimsLanguagesAndScripts">
<section id="section-14">
      <h2 id="name-claims-languages-and-script">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-claims-languages-and-script" class="section-name selfRef">Claims Languages and Scripts</a>
      </h2>
<p id="section-14-1">
        Human-readable Claim Values and Claim Values that reference human-readable values
        MAY be represented in multiple languages and scripts.
        This specification enables such representations in the same manner as defined in
        Section 5.2 of <span><a href="#OpenID.Core" class="internal xref">OpenID Connect Core 1.0</a> [<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>.<a href="#section-14-1" class="pilcrow">¶</a></p>
<p id="section-14-2">
        As described in OpenID Connect Core,
 to specify the languages and scripts, <span><a href="#RFC5646" class="internal xref">BCP47</a> [<a href="#RFC5646" class="cite xref">RFC5646</a>]</span> language tags are added to member names,
        delimited by a <code>#</code> character.  For example,
        <code>family_name#ja-Kana-JP</code> expresses the
        Family Name in Katakana in Japanese, which is commonly used to index
        and represent the phonetics of the Kanji representation of the same name
        represented as <code>family_name#ja-Hani-JP</code>.<a href="#section-14-2" class="pilcrow">¶</a></p>
<p id="section-14-3">
 Language tags can be used in any data structures
 containing or referencing human-readable values,
 including metadata parameters and Trust Mark parameters.
 For instance, both <code>organization_name</code> and
 <code>organization_name#de</code> might occur together in metadata.<a href="#section-14-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="MediaTypes">
<section id="section-15">
      <h2 id="name-media-types">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-media-types" class="section-name selfRef">Media Types</a>
      </h2>
<p id="section-15-1">
 These media types <span>[<a href="#RFC2046" class="cite xref">RFC2046</a>]</span> are defined by this specification.<a href="#section-15-1" class="pilcrow">¶</a></p>
<div id="entity-statement_jwt">
<section id="section-15.1">
        <h3 id="name-application-entity-statemen">
<a href="#section-15.1" class="section-number selfRef">15.1. </a><a href="#name-application-entity-statemen" class="section-name selfRef">"application/entity-statement+jwt" Media Type</a>
        </h3>
<p id="section-15.1-1">
   The <code>application/entity-statement+jwt</code>
   media type is used to specify that the associated content is
   an Entity Statement, as defined in <a href="#entity-statement" class="auto internal xref">Section 3</a>.
   No parameters are used with this media type.<a href="#section-15.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trust-mark_jwt">
<section id="section-15.2">
        <h3 id="name-application-trust-markjwt-m">
<a href="#section-15.2" class="section-number selfRef">15.2. </a><a href="#name-application-trust-markjwt-m" class="section-name selfRef">"application/trust-mark+jwt" Media Type</a>
        </h3>
<p id="section-15.2-1">
   The <code>application/trust-mark+jwt</code>
   media type is used to specify that the associated content is
   a Trust Mark, as defined in <a href="#trust_marks" class="auto internal xref">Section 7</a>.
   No parameters are used with this media type.<a href="#section-15.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="resolve-response_jwt">
<section id="section-15.3">
        <h3 id="name-application-resolve-respons">
<a href="#section-15.3" class="section-number selfRef">15.3. </a><a href="#name-application-resolve-respons" class="section-name selfRef">"application/resolve-response+jwt" Media Type</a>
        </h3>
<p id="section-15.3-1">
   The <code>application/resolve-response+jwt</code>
   media type is used to specify that the associated content is
   a Resolve Response, as defined in <a href="#resolve-response" class="auto internal xref">Section 8.3.2</a>.
   No parameters are used with this media type.<a href="#section-15.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trust-chain_json">
<section id="section-15.4">
        <h3 id="name-application-trust-chainjson">
<a href="#section-15.4" class="section-number selfRef">15.4. </a><a href="#name-application-trust-chainjson" class="section-name selfRef">"application/trust-chain+json" Media Type</a>
        </h3>
<p id="section-15.4-1">
   The <code>application/trust-chain+json</code>
   media type is used to specify that the associated content is
   a JSON array representing a Trust Chain, as defined in <a href="#trust_chain" class="auto internal xref">Section 4</a>.
   No parameters are used with this media type.<a href="#section-15.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trust-mark-delegation_jwt">
<section id="section-15.5">
        <h3 id="name-application-trust-mark-dele">
<a href="#section-15.5" class="section-number selfRef">15.5. </a><a href="#name-application-trust-mark-dele" class="section-name selfRef">"application/trust-mark-delegation+jwt" Media Type</a>
        </h3>
<p id="section-15.5-1">
   The <code>application/trust-mark-delegation+jwt</code>
   media type is used to specify that the associated content is
   a Trust Mark delegation, as defined in <a href="#delegation_jwt" class="auto internal xref">Section 7.2.1</a>.
   No parameters are used with this media type.<a href="#section-15.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="jwk-set_jwt">
<section id="section-15.6">
        <h3 id="name-application-jwk-setjwt-medi">
<a href="#section-15.6" class="section-number selfRef">15.6. </a><a href="#name-application-jwk-setjwt-medi" class="section-name selfRef">"application/jwk-set+jwt" Media Type</a>
        </h3>
<p id="section-15.6-1">
   The <code>application/jwk-set+jwt</code>
   media type is used to specify that the associated content is
   a signed JWK Set, as defined in <a href="#HistKeysResp" class="auto internal xref">Section 8.7.2</a>.
   No parameters are used with this media type.<a href="#section-15.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trust-mark-status-response_jwt">
<section id="section-15.7">
        <h3 id="name-application-trust-mark-stat">
<a href="#section-15.7" class="section-number selfRef">15.7. </a><a href="#name-application-trust-mark-stat" class="section-name selfRef">"application/trust-mark-status-response+jwt" Media Type</a>
        </h3>
<p id="section-15.7-1">
   The <code>application/trust-mark-status-response+jwt</code>
   media type is used to specify that the associated content is
   a Trust Mark Status Response,
   as defined in <a href="#tm-status-response" class="auto internal xref">Section 8.4.2</a>.
   No parameters are used with this media type.<a href="#section-15.7-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="StringOps">
<section id="section-16">
      <h2 id="name-string-operations">
<a href="#section-16" class="section-number selfRef">16. </a><a href="#name-string-operations" class="section-name selfRef">String Operations</a>
      </h2>
<p id="section-16-1">
 Processing some OpenID Federation messages requires comparing
 values in the messages to other values.
 For example, the Entity Identifier in
 an <code>iss</code> Claim might be compared to
 the Entity Identifier in a <code>sub</code> Claim.
 Comparing Unicode <span>[<a href="#UNICODE" class="cite xref">UNICODE</a>]</span> strings,
 however, has significant security implications.<a href="#section-16-1" class="pilcrow">¶</a></p>
<p id="section-16-2">
 Therefore, comparisons between JSON strings and other Unicode
 strings MUST be performed as specified below:<a href="#section-16-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-16-3">
<li id="section-16-3.1">
          <p id="section-16-3.1.1">
     Remove any JSON applied escaping to produce an array of
     Unicode code points.<a href="#section-16-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-16-3.2">
          <p id="section-16-3.2.1">
     Unicode Normalization <span>[<a href="#USA15" class="cite xref">USA15</a>]</span> MUST NOT
     be applied at any point to either the JSON string or to
     the string it is to be compared against.<a href="#section-16-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-16-3.3">
          <p id="section-16-3.3.1">
     Comparisons between the two strings MUST be performed as a
     Unicode code point to code point equality comparison.<a href="#section-16-3.3.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-16-4">
 Note that this is the same comparison procedure as specified in
 Section 14 of <span><a href="#OpenID.Core" class="internal xref">OpenID Connect Core 1.0</a> [<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>.<a href="#section-16-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Implementation">
<section id="section-17">
      <h2 id="name-implementation-consideratio">
<a href="#section-17" class="section-number selfRef">17. </a><a href="#name-implementation-consideratio" class="section-name selfRef">Implementation Considerations</a>
      </h2>
<p id="section-17-1">
 This section provides guidance to implementers and deployers of Federations
 on situations and properties that they should consider for their Federations.<a href="#section-17-1" class="pilcrow">¶</a></p>
<div id="Topologies">
<section id="section-17.1">
        <h3 id="name-federation-topologies">
<a href="#section-17.1" class="section-number selfRef">17.1. </a><a href="#name-federation-topologies" class="section-name selfRef">Federation Topologies</a>
        </h3>
<p id="section-17.1-1">
   It is possible to construct Federation topologies that have
   multiple trust paths between Entities.
   The specification does not disallow this, but it can create
   ambiguities that deployers need to be aware of.<a href="#section-17.1-1" class="pilcrow">¶</a></p>
<p id="section-17.1-2" class="keepWithNext">
     Consider the following Federation topology:<a href="#section-17.1-2" class="pilcrow">¶</a></p>
<span id="name-example-topology-with-multi"></span><figure id="figure-48">
          <div class="alignLeft art-text artwork" id="section-17.1-3.1">
<pre>
              .--------------.
              | Trust Anchor |
              '--.---.-----.-'
                 |   |     |
              .--'   '--.  '---------------.
              |         |                  |
.-------------v--.   .--v-------------.    |
| Intermediate 1 |   | Intermediate 2 |    |
'-------------.--'   '--.-------------'    |
              |         |                .-v--.
              |         |                | OP |
           .--v---------v---.            '----'
           | Intermediate 3 |
           '-------.--------'
                   |
                   |
                 .-v--.
                 | RP |
                 '----'
</pre>
</div>
<figcaption><a href="#figure-48" class="selfRef">Figure 48</a>:
<a href="#name-example-topology-with-multi" class="selfRef">Example Topology with Multiple Trust Paths between Entities</a>
          </figcaption></figure>
<p id="section-17.1-4">
   In this topology, there are multiple trust paths between
   the RP and the Trust Anchor, meaning that
   multiple different Trust Chains could be built between them.
   If the metadata policies of Intermediate 1 and Intermediate 2 are different,
   this could result in the Resolved Metadata for the RP differing,
   depending upon which Intermediate is used when building the Trust Chain.
   Some such differences will be innocuous and some can cause failures.<a href="#section-17.1-4" class="pilcrow">¶</a></p>
<p id="section-17.1-5">
   It is the job of the Federation architects to deploy topologies and
   metadata policies that work as intended, no matter which trust path
   is chosen when building a Trust Chain.
   Of course, one way to avoid potential ambiguities is to only use
   topologies that are trees, without multiple paths between two Entities.
   Topologies that are not trees are permitted,
   but should be used consciously and with care.<a href="#section-17.1-5" class="pilcrow">¶</a></p>
<p id="section-17.1-6">
   Even when a Federation topology contains loops, Trust Chains built from them MUST NOT contain loops,
          as mandated in <a href="#fetching-es" class="auto internal xref">Section 10.1</a>.<a href="#section-17.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="discovery_patterns">
<section id="section-17.2">
        <h3 id="name-federation-discovery-and-tr">
<a href="#section-17.2" class="section-number selfRef">17.2. </a><a href="#name-federation-discovery-and-tr" class="section-name selfRef">Federation Discovery and Trust Chain Resolution Patterns</a>
        </h3>
<p id="section-17.2-1">
   This section describes different patterns that implementations may use for discovering
   entities within a federation and for resolving Trust Chains. It is important to distinguish
   between two related but distinct concepts:<a href="#section-17.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-17.2-2.1">
            <p id="section-17.2-2.1.1">
       <strong>Discovery</strong>: The process of finding entities that are part of a federation,
       typically to build directories or catalogs of available service providers.<a href="#section-17.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-17.2-2.2">
            <p id="section-17.2-2.2.1">
       <strong>Trust Chain Resolution</strong>: The process of building and validating a Trust Chain
       from a known entity to a Trust Anchor, as described in <a href="#resolving_trust" class="auto internal xref">Section 10</a>.
       This process is also known as Federation Entity Discovery in this specification
       (per the definition in <a href="#Terminology" class="auto internal xref">Section 1.2</a>).<a href="#section-17.2-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-17.2-3">
   While these patterns may involve both discovery and Trust Chain resolution, they serve different
   purposes and may be used independently, depending on the use case. For example, a discovery service
   building a directory of OpenID Providers may collect entity identifiers without necessarily
   resolving Trust Chains for all discovered entities, since the actual Trust Chain resolution
   may occur later on, for example, when an RP and OP engage in an authentication transaction,
          and use the Trust Chain resolution process described in <a href="#resolving_trust" class="auto internal xref">Section 10</a>.<a href="#section-17.2-3" class="pilcrow">¶</a></p>
<p id="section-17.2-4">
   Implementations may support one or more of the following patterns:<a href="#section-17.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-17.2-5.1">
            <p id="section-17.2-5.1.1">
       <span><a href="#bottom_up_discovery" class="internal xref">Bottom-Up Trust Chain Resolution</a> (<a href="#bottom_up_discovery" class="auto internal xref">Section 17.2.1</a>)</span>: Resolving Trust Chains
       starting from a known entity identifier, as described in <a href="#resolving_trust" class="auto internal xref">Section 10</a>.<a href="#section-17.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-17.2-5.2">
            <p id="section-17.2-5.2.1">
       <span><a href="#top_down_discovery" class="internal xref">Top-Down Discovery</a> (<a href="#top_down_discovery" class="auto internal xref">Section 17.2.2</a>)</span>: Finding entities within a federation
       by starting from a Trust Anchor and traversing down the hierarchy.<a href="#section-17.2-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-17.2-5.3">
            <p id="section-17.2-5.3.1">
       <span><a href="#single_point_discovery" class="internal xref">Single Point of Trust Resolution</a> (<a href="#single_point_discovery" class="auto internal xref">Section 17.2.3</a>)</span>: Delegating Trust Chain
       resolution to a trusted resolver implementing the Resolve Endpoint.<a href="#section-17.2-5.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-17.2-6">
   Federation operators may choose to support multiple patterns to accommodate different use cases
   and integration scenarios. The choice of supported patterns affects the federation's usability
   and the types of applications that can effectively integrate with it.<a href="#section-17.2-6" class="pilcrow">¶</a></p>
<div id="bottom_up_discovery">
<section id="section-17.2.1">
          <h4 id="name-bottom-up-trust-chain-resol">
<a href="#section-17.2.1" class="section-number selfRef">17.2.1. </a><a href="#name-bottom-up-trust-chain-resol" class="section-name selfRef">Bottom-Up Trust Chain Resolution</a>
          </h4>
<p id="section-17.2.1-1">
     Bottom-up Trust Chain resolution is the process described in <a href="#resolving_trust" class="auto internal xref">Section 10</a>,
     also known as Federation Entity Discovery (see the definition in the Terminology section).
     This process starts with a known Entity Identifier and builds a Trust Chain by traversing up the
     federation hierarchy until reaching a Trust Anchor. This pattern is not discovery in the sense of
     finding unknown entities, but rather trust resolution for a known entity.<a href="#section-17.2.1-1" class="pilcrow">¶</a></p>
<p id="section-17.2.1-2">
     This pattern is used when an entity needs to verify the trustworthiness of another entity whose
     Entity Identifier is already known. This is typically used for:<a href="#section-17.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-17.2.1-3.1">
              <p id="section-17.2.1-3.1.1">OpenID Providers verifying Relying Parties during authentication requests,<a href="#section-17.2.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-17.2.1-3.2">
              <p id="section-17.2.1-3.2.1">Resource servers verifying Client trustworthiness,<a href="#section-17.2.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-17.2.1-3.3">
              <p id="section-17.2.1-3.3.1">Any Entity validating incoming requests from known parties, and<a href="#section-17.2.1-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-17.2.1-3.4">
              <p id="section-17.2.1-3.4.1">Dynamic trust establishment in federated environments.<a href="#section-17.2.1-3.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-17.2.1-4">
     The bottom-up Trust Chain resolution process follows these steps, as described in <a href="#resolving_trust" class="auto internal xref">Section 10</a>:<a href="#section-17.2.1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-17.2.1-5">
<li id="section-17.2.1-5.1">
              <p id="section-17.2.1-5.1.1">Start with the subject entity's Entity Configuration (provided or fetched using the process defined in <a href="#federation_configuration" class="auto internal xref">Section 9</a>).<a href="#section-17.2.1-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-17.2.1-5.2">
              <p id="section-17.2.1-5.2.1">Use <code>authority_hints</code> to identify immediate superior entities.<a href="#section-17.2.1-5.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-17.2.1-5.3">
              <p id="section-17.2.1-5.3.1">Fetch Entity Configuration for each Superior Entity.<a href="#section-17.2.1-5.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-17.2.1-5.4">
              <p id="section-17.2.1-5.4.1">Use Fetch Endpoints (as defined in <a href="#fetch_statement" class="auto internal xref">Section 8.1.1</a>) to obtain Subordinate Statements about the subject entity.<a href="#section-17.2.1-5.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-17.2.1-5.5">
              <p id="section-17.2.1-5.5.1">Recursively traverse up the hierarchy until reaching a Trust Anchor.<a href="#section-17.2.1-5.5.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-17.2.1-5.6">
              <p id="section-17.2.1-5.6.1">Build and validate the complete Trust Chain.<a href="#section-17.2.1-5.6.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-17.2.1-5.7">
              <p id="section-17.2.1-5.7.1">Apply federation policies to derive Resolved Metadata.<a href="#section-17.2.1-5.7.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="top_down_discovery">
<section id="section-17.2.2">
          <h4 id="name-top-down-discovery">
<a href="#section-17.2.2" class="section-number selfRef">17.2.2. </a><a href="#name-top-down-discovery" class="section-name selfRef">Top-Down Discovery</a>
          </h4>
<p id="section-17.2.2-1">
     Top-down discovery is the process of finding entities that are part of a federation by starting
     from a known Trust Anchor and traversing down the federation hierarchy. This pattern is used
     when the goal is to discover available entities, particularly entities of specific Entity Types,
     without necessarily knowing their Entity Identifiers in advance.<a href="#section-17.2.2-1" class="pilcrow">¶</a></p>
<p id="section-17.2.2-2">
     This pattern is particularly useful for:<a href="#section-17.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-17.2.2-3.1">
              <p id="section-17.2.2-3.1.1">Service discovery by Relying Parties looking for OpenID Providers,<a href="#section-17.2.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-17.2.2-3.2">
              <p id="section-17.2.2-3.2.1">Resource discovery by Clients looking for specific service types,<a href="#section-17.2.2-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-17.2.2-3.3">
              <p id="section-17.2.2-3.3.1">Federation browsing and exploration, and<a href="#section-17.2.2-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-17.2.2-3.4">
              <p id="section-17.2.2-3.4.1">Building provider directories and catalogs (e.g., WAYF services, Seamless Access).<a href="#section-17.2.2-3.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-17.2.2-4">
     The top-down discovery process follows these steps:<a href="#section-17.2.2-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-17.2.2-5">
<li id="section-17.2.2-5.1">
              <p id="section-17.2.2-5.1.1">Start with a known Trust Anchor that the discovering entity trusts.<a href="#section-17.2.2-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-17.2.2-5.2">
              <p id="section-17.2.2-5.2.1">Use the list endpoint (as defined in <a href="#entity_listing" class="auto internal xref">Section 8.2</a>) to discover Immediate Subordinate entities.<a href="#section-17.2.2-5.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-17.2.2-5.3">
              <p id="section-17.2.2-5.3.1">Filter by <code>entity_type</code> parameter to find protocol-specific providers (e.g., <code>openid_provider</code>).<a href="#section-17.2.2-5.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-17.2.2-5.4">
              <p id="section-17.2.2-5.4.1">For Intermediate entities, recursively traverse their Subordinates.<a href="#section-17.2.2-5.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-17.2.2-5.5">
              <p id="section-17.2.2-5.5.1">Collect Entity Identifiers and optionally Entity Configurations for discovered entities.<a href="#section-17.2.2-5.5.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-17.2.2-6">
     Note that top-down discovery may or may not include Trust Chain resolution, depending on the use case.
     For example, when building a directory of OpenID Providers for user selection at login time, the discovery
     service may collect entity identifiers and basic metadata without resolving Trust Chains for all discovered
     entities. However, if the discovery service needs to verify that entities
     are properly registered in the federation before including them in the directory, it may choose to perform Trust Chain resolution as part of the discovery process.<a href="#section-17.2.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="single_point_discovery">
<section id="section-17.2.3">
          <h4 id="name-single-point-of-trust-resol">
<a href="#section-17.2.3" class="section-number selfRef">17.2.3. </a><a href="#name-single-point-of-trust-resol" class="section-name selfRef">Single Point of Trust Resolution</a>
          </h4>
<p id="section-17.2.3-1">
     Single point of trust resolution delegates the entire Trust Chain resolution process to a trusted
     resolver implementing the Resolve Endpoint defined in <a href="#resolve" class="auto internal xref">Section 8.3</a>. This pattern allows
     entities to offload the complexity of Trust Chain resolution to a specialized service.<a href="#section-17.2.3-1" class="pilcrow">¶</a></p>
<p id="section-17.2.3-2">
     This pattern is useful for:<a href="#section-17.2.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-17.2.3-3.1">
              <p id="section-17.2.3-3.1.1">Entities that want to offload Trust Chain resolution complexity,<a href="#section-17.2.3-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-17.2.3-3.2">
              <p id="section-17.2.3-3.2.1">Centralized trust evaluation services,<a href="#section-17.2.3-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-17.2.3-3.3">
              <p id="section-17.2.3-3.3.1">Performance optimization by caching Resolved Metadata, and<a href="#section-17.2.3-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-17.2.3-3.4">
              <p id="section-17.2.3-3.4.1">Simplified integration for lightweight clients.<a href="#section-17.2.3-3.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-17.2.3-4">
     Note that this pattern requires the Entity Identifier of the subject entity to be known in advance.
     It does not provide discovery functionality in the sense of finding unknown entities within a federation.<a href="#section-17.2.3-4" class="pilcrow">¶</a></p>
<p id="section-17.2.3-5">
     The single point of trust resolution process follows these steps:<a href="#section-17.2.3-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-17.2.3-6">
<li id="section-17.2.3-6.1">
              <p id="section-17.2.3-6.1.1">Identify a trusted resolver with a Resolve Endpoint.<a href="#section-17.2.3-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-17.2.3-6.2">
              <p id="section-17.2.3-6.2.1">Submit the subject Entity Identifier and Trust Anchor to the resolver.<a href="#section-17.2.3-6.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-17.2.3-6.3">
              <p id="section-17.2.3-6.3.1">The resolver performs complete Trust Chain resolution internally (following the bottom-up pattern).<a href="#section-17.2.3-6.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-17.2.3-6.4">
              <p id="section-17.2.3-6.4.1">The resolver returns Resolved Metadata and Trust Marks.<a href="#section-17.2.3-6.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-17.2.3-6.5">
              <p id="section-17.2.3-6.5.1">Optionally verify the resolver's own Trust Chain.<a href="#section-17.2.3-6.5.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-17.2.3-6.6">
              <p id="section-17.2.3-6.6.1">Use Resolved Metadata for protocol operations.<a href="#section-17.2.3-6.6.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="anchor_resolver">
<section id="section-17.3">
        <h3 id="name-trust-anchors-and-resolvers">
<a href="#section-17.3" class="section-number selfRef">17.3. </a><a href="#name-trust-anchors-and-resolvers" class="section-name selfRef">Trust Anchors and Resolvers Go Together</a>
        </h3>
<p id="section-17.3-1">
        If only one resolver is present in a federation, that entity should be
        both Trust Anchor and Resolver. If so, users of the resolver will not have to
        collect and evaluate Trust Chains for the Resolver. The Trust Anchor is by definition trusted
        and if the entity also serves as Resolver, that service will be implicitly trusted.<a href="#section-17.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="one_service">
<section id="section-17.4">
        <h3 id="name-one-entity-one-service">
<a href="#section-17.4" class="section-number selfRef">17.4. </a><a href="#name-one-entity-one-service" class="section-name selfRef">One Entity, One Service</a>
        </h3>
<p id="section-17.4-1">
        Apart from letting an entity provide both the Trust Anchor and Resolver services, there is a good reason for
        having each entity only do one thing. The reason is that, later in time, it will be much easier to share specific services
        between federations.<a href="#section-17.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trust_mark_policy">
<section id="section-17.5">
        <h3 id="name-trust-mark-policies">
<a href="#section-17.5" class="section-number selfRef">17.5. </a><a href="#name-trust-mark-policies" class="section-name selfRef">Trust Mark Policies</a>
        </h3>
<p id="section-17.5-1">
            When validating trust marks in an Entity Statement, it can be split into three parts.<a href="#section-17.5-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-17.5-2">
          <dt id="section-17.5-2.1">Validating Trust Marks in the Context of Validating an Entity Statement</dt>
          <dd style="margin-left: 1.5em" id="section-17.5-2.2">
                    According to the text on Entity Statement Validation in <a href="#ESValidation" class="auto internal xref">Section 3.2</a>, validating a
                    Trust Mark is confined to validating the syntax of the Claim Value,
                    including that the <code>trust_mark_type</code> value is consistent.<a href="#section-17.5-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-17.5-2.3">Validating a Specific Trust Mark</dt>
          <dd style="margin-left: 1.5em" id="section-17.5-2.4">
                    This is what is described in <a href="#trust-mark-validation" class="auto internal xref">Section 7.3</a>.
                    In order to validate a Trust Mark, the entity must find a Trust Chain for the Trust Mark Issuer to a
                    Trust Anchor the Entity trusts. This has nothing to do with which federation that will later
                    be used for the application protocol.<a href="#section-17.5-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-17.5-2.5">Deciding which Trust Marks to Use</dt>
          <dd style="margin-left: 1.5em" id="section-17.5-2.6">
            <p id="section-17.5-2.6.1">
                    A federation MAY have a policy that states that only Trust Marks that
                    match certain criteria SHOULD be used.<a href="#section-17.5-2.6.1" class="pilcrow">¶</a></p>
<p id="section-17.5-2.6.2">
                    An example of such criteria could be that the Trust Mark's
                    <code>trust_mark_type</code> must be
                    listed in the Trust Anchor's <code>trust_mark_issuers</code>,
                    and if so, that the instance's <code>iss</code> appears in the corresponding list of
                    Entity Identifiers. Note that the list may be an empty list, which signifies that anyone can issue
                    a Trust Mark with the <code>trust_mark_type</code> in question.
                    Such Trust Marks can appear for various reasons, such as the Entity Configuration including Trust Marks
                    associated with another federation, or Trust Marks intended for specific
                    purposes or Entity audiences.<a href="#section-17.5-2.6.2" class="pilcrow">¶</a></p>
<p id="section-17.5-2.6.3">
                    An Entity MAY also choose, at its own discretion, to utilize Trust Marks presented to it that are not
                    recognized within the federation, and where the accreditation authority is established by an
                    out-of-band mechanism.<a href="#section-17.5-2.6.3" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="Security">
<section id="section-18">
      <h2 id="name-security-considerations">
<a href="#section-18" class="section-number selfRef">18. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="DoS">
<section id="section-18.1">
        <h3 id="name-denial-of-service-attack-pr">
<a href="#section-18.1" class="section-number selfRef">18.1. </a><a href="#name-denial-of-service-attack-pr" class="section-name selfRef">Denial-of-Service Attack Prevention</a>
        </h3>
<p id="section-18.1-1">
          Some of the interfaces defined in this specification could be used for
          Denial-of-Service attacks (DoS), most notably, the resolve endpoint
          (<a href="#resolve" class="auto internal xref">Section 8.3</a>) can
          be exploited as a vector of HTTP propagation attacks.
          Below is an explanation of how such an attack can occur and
          the countermeasures to prevent it.<a href="#section-18.1-1" class="pilcrow">¶</a></p>
<p id="section-18.1-2">
          An adversary, providing hundreds of fake
          <code>authority_hints</code>
          in its Entity Configuration,
          could exploit the Federation Entity Discovery mechanism
          to propagate many HTTP requests.
          Imagine an adversary controlling an RP that sends an authorization
          request to an OP. For each request crafted
          by the adversary, the OP produces one request for
          the adversary's Entity Configuration and another one
          for each URL found in the <code>authority_hints</code>.<a href="#section-18.1-2" class="pilcrow">¶</a></p>
<p id="section-18.1-3">
          Some adequate defense methods are required,
          such as those described below and in
          <span>[<a href="#RFC4732" class="cite xref">RFC4732</a>]</span>.<a href="#section-18.1-3" class="pilcrow">¶</a></p>
<p id="section-18.1-4">
          Implementations should set a limit on the number of
          <code>authority_hints</code>
          they are willing to inspect. This is to protect against attacks
          where an adversary might define a large count of false
          <code>authority_hints</code>
          in their Entity Configuration.<a href="#section-18.1-4" class="pilcrow">¶</a></p>
<p id="section-18.1-5">
          A Trust Mark can be statically validated using the public key of its issuer.
          The static validation of the Trust Marks represents a
          filter against propagation attacks.
          If the OpenID Provider (OP) discovers at least one valid Trust Mark
          within an Entity Configuration, this may serve as evidence of
          the reliability of the Relying Party that initiated the request.
          Given that the Trust Mark is optional, the decision to require
          one is at the discretion of the federation implementation,
          where a federation may define and require Trust Marks
          according to specific needs.<a href="#section-18.1-5" class="pilcrow">¶</a></p>
<p id="section-18.1-6">
          If Client authentication is not required at the resolve endpoint,
          then incoming requests should not automatically trigger the collection
          (Federation Entity Discovery process) and assessment of Trust Chains.
          Instead, the resolve endpoint should only respond to unauthenticated
          Client requests with cached information about Entities that have
          already been evaluated and deemed trustworthy. The initiation of
          the Federation Entity Discovery process should not be the default
          action for the resolve endpoint in this case.<a href="#section-18.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="UnsignedError">
<section id="section-18.2">
        <h3 id="name-unsigned-error-messages">
<a href="#section-18.2" class="section-number selfRef">18.2. </a><a href="#name-unsigned-error-messages" class="section-name selfRef">Unsigned Error Messages</a>
        </h3>
<p id="section-18.2-1">
          One of the fundamental design goals of this protocol is to
          protect messages end-to-end. This cannot be accomplished by demanding
          TLS since TLS, in lots of cases, is not end-to-end but ends in an HTTPS
          to HTTP Reverse Proxy.
          Allowing unsigned error messages therefore opens an attack
          vector for someone who wants to run a Denial-of-Service attack.
          This is not specific to OpenID Federation but equally valid for
          other protocols when HTTPS to HTTP reverse proxies are used.<a href="#section-18.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="privacy">
<section id="section-19">
      <h2 id="name-privacy-considerations">
<a href="#section-19" class="section-number selfRef">19. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-19-1">
        Implementers should be aware of these privacy considerations.<a href="#section-19-1" class="pilcrow">¶</a></p>
<div id="Entity-Statement-privacy">
<section id="section-19.1">
        <h3 id="name-entity-statement-privacy-co">
<a href="#section-19.1" class="section-number selfRef">19.1. </a><a href="#name-entity-statement-privacy-co" class="section-name selfRef">Entity Statement Privacy Considerations</a>
        </h3>
<p id="section-19.1-1">
            Entity Statements are designed to establish trust relationships between organizational entities within a federation, rather than between individuals or for specific business applications. Trust and reputation assessments for individuals or legal entities, such as those required for Know Your Customer and Anti-Money Laundering processes, should be managed through specialized platforms tailored for those purposes. Given that Entity Statements facilitate trust relationships using a public infrastructure, they should be limited to the essential information necessary for federation operations and organizational trust establishment.<a href="#section-19.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Trust-Mark-Status-privacy">
<section id="section-19.2">
        <h3 id="name-trust-mark-status-privacy-c">
<a href="#section-19.2" class="section-number selfRef">19.2. </a><a href="#name-trust-mark-status-privacy-c" class="section-name selfRef">Trust Mark Status Privacy Considerations</a>
        </h3>
<p id="section-19.2-1">
     The Trust Mark Status endpoint enables querying the status
     of Trust Marks in real time.
     Similar to the Fetch endpoint,
     in cases where the Trust Mark Status endpoint is not protected
     by any client authentication method,
     requests to validate Trust Marks may not necessarily indicate
     an actual interaction or relationship between Entities, as they could
     simply be part of routine network inspection or discovery processes.
     This could potentially enable Trust Mark issuers to track Entities
     evaluating Trust Marks about other Entities
     through standard network diagnostic tools like
     IPv4/IPv6 addresses and DNS Whois entries.
     To mitigate tracking risks, implementations can use short-lived Trust Marks,
     or use the Trust Marked Entities Listing (<a href="#tm_listing" class="auto internal xref">Section 8.5</a>)
     with only the <code>trust_mark_type</code> parameter
     and not the <code>sub</code> parameter,
     reducing the need to use the Trust Mark Status endpoint.<a href="#section-19.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Fetch-privacy">
<section id="section-19.3">
        <h3 id="name-fetch-endpoint-privacy-cons">
<a href="#section-19.3" class="section-number selfRef">19.3. </a><a href="#name-fetch-endpoint-privacy-cons" class="section-name selfRef">Fetch Endpoint Privacy Considerations</a>
        </h3>
<p id="section-19.3-1">
   The Fetch endpoint enables querying Subordinate Statements in real time.
   Similar to Trust Mark Status validation, in the cases where the federation infrastructure is public and widely browsable and endpoints are not protected by any client authentication method, requests to fetch Subordinate Statements may not necessarily indicate an actual interaction or relationship between Entities, as they could simply be part of routine network inspection or discovery processes.
   However, this could potentially enable Trust Anchors or Intermediates to track Entities evaluating trust relationships with other Entities through standard network diagnostic tools like IPv4/IPv6 addresses and DNS Whois entries.
   To mitigate tracking risks around Entities inspecting and interacting with other Entities, implementers should consider using static and short-lived Trust Chains where appropriate, which can reduce the need for real-time fetching of Subordinate Statements.<a href="#section-19.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-20">
      <h2 id="name-iana-considerations">
<a href="#section-20" class="section-number selfRef">20. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-20-1">
 This specification makes no requests of IANA.
 It relies on the IANA registrations already made in
 <span><a href="https://openid.net/specs/openid-federation-1_0.html#IANA" class="relref">Section 20</a> of [<a href="#OpenID.Federation-1.0" class="cite xref">OpenID.Federation-1.0</a>]</span>.<a href="#section-20-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-21">
      <h2 id="name-references">
<a href="#section-21" class="section-number selfRef">21. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-21.1">
        <h3 id="name-normative-references">
<a href="#section-21.1" class="section-number selfRef">21.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="OpenID.Core">[OpenID.Core]</dt>
        <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.B.</span>, <span class="refAuthor">de Medeiros, B.</span>, and <span class="refAuthor">C. Mortimore</span>, <span class="refTitle">"OpenID Connect Core 1.0"</span>, <time datetime="2023-12-15" class="refDate">15 December 2023</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-core-1_0.html">https://openid.net/specs/openid-connect-core-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID.Discovery">[OpenID.Discovery]</dt>
        <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.B.</span>, and <span class="refAuthor">E. Jay</span>, <span class="refTitle">"OpenID Connect Discovery 1.0"</span>, <time datetime="2023-12-15" class="refDate">15 December 2023</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-discovery-1_0.html">https://openid.net/specs/openid-connect-discovery-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4732">[RFC4732]</dt>
        <dd>
<span class="refAuthor">Handley, M., Ed.</span>, <span class="refAuthor">Rescorla, E., Ed.</span>, and <span class="refAuthor">IAB</span>, <span class="refTitle">"Internet Denial-of-Service Considerations"</span>, <span class="seriesInfo">RFC 4732</span>, <span class="seriesInfo">DOI 10.17487/RFC4732</span>, <time datetime="2006-12" class="refDate">December 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4732">https://www.rfc-editor.org/info/rfc4732</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5646">[RFC5646]</dt>
        <dd>
<span class="refAuthor">Phillips, A., Ed.</span> and <span class="refAuthor">M. Davis, Ed.</span>, <span class="refTitle">"Tags for Identifying Languages"</span>, <span class="seriesInfo">BCP 47</span>, <span class="seriesInfo">RFC 5646</span>, <span class="seriesInfo">DOI 10.17487/RFC5646</span>, <time datetime="2009-09" class="refDate">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5646">https://www.rfc-editor.org/info/rfc5646</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7515">[RFC7515]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Signature (JWS)"</span>, <span class="seriesInfo">RFC 7515</span>, <span class="seriesInfo">DOI 10.17487/RFC7515</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7515">https://www.rfc-editor.org/info/rfc7515</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7516">[RFC7516]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span> and <span class="refAuthor">J. Hildebrand</span>, <span class="refTitle">"JSON Web Encryption (JWE)"</span>, <span class="seriesInfo">RFC 7516</span>, <span class="seriesInfo">DOI 10.17487/RFC7516</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7516">https://www.rfc-editor.org/info/rfc7516</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7517">[RFC7517]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Key (JWK)"</span>, <span class="seriesInfo">RFC 7517</span>, <span class="seriesInfo">DOI 10.17487/RFC7517</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7517">https://www.rfc-editor.org/info/rfc7517</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7591">[RFC7591]</dt>
        <dd>
<span class="refAuthor">Richer, J., Ed.</span>, <span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Machulak, M.</span>, and <span class="refAuthor">P. Hunt</span>, <span class="refTitle">"OAuth 2.0 Dynamic Client Registration Protocol"</span>, <span class="seriesInfo">RFC 7591</span>, <span class="seriesInfo">DOI 10.17487/RFC7591</span>, <time datetime="2015-07" class="refDate">July 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7591">https://www.rfc-editor.org/info/rfc7591</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7638">[RFC7638]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span> and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Key (JWK) Thumbprint"</span>, <span class="seriesInfo">RFC 7638</span>, <span class="seriesInfo">DOI 10.17487/RFC7638</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7638">https://www.rfc-editor.org/info/rfc7638</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8259">https://www.rfc-editor.org/info/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="UNICODE">[UNICODE]</dt>
        <dd>
<span class="refAuthor">The Unicode Consortium</span>, <span class="refTitle">"The Unicode Standard"</span>, <span>&lt;<a href="http://www.unicode.org/versions/latest/">http://www.unicode.org/versions/latest/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="USA15">[USA15]</dt>
      <dd>
<span class="refAuthor">Whistler, K.</span>, <span class="refTitle">"Unicode Normalization Forms"</span>, <span class="seriesInfo">Unicode Standard Annex 15</span>, <time datetime="2025-07-30" class="refDate">30 July 2025</time>, <span>&lt;<a href="https://www.unicode.org/reports/tr15/">https://www.unicode.org/reports/tr15/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-21.2">
        <h3 id="name-informative-references">
<a href="#section-21.2" class="section-number selfRef">21.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="App-Fed-Linkage">[App-Fed-Linkage]</dt>
        <dd>
<span class="refAuthor">Dzhuvinov, V.</span>, <span class="refTitle">"How to link an application protocol to an OpenID Federation 1.0 trust layer"</span>, <time datetime="2024-12-04" class="refDate">4 December 2024</time>, <span>&lt;<a href="https://connect2id.com/blog/how-to-link-an-app-protocol-to-an-openid-federation-trust-layer">https://connect2id.com/blog/how-to-link-an-app-protocol-to-an-openid-federation-trust-layer</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FAPI">[FAPI]</dt>
        <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">E. Jay</span>, <span class="refTitle">"Financial-grade API Security Profile 1.0 - Part 2: Advanced"</span>, <time datetime="2021-03-12" class="refDate">12 March 2021</time>, <span>&lt;<a href="https://openid.net/specs/openid-financial-api-part-2-1_0.html">https://openid.net/specs/openid-financial-api-part-2-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.JWT.Claims">[IANA.JWT.Claims]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"JSON Web Token Claims"</span>, <span>&lt;<a href="https://www.iana.org/assignments/jwt">https://www.iana.org/assignments/jwt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.OAuth.Parameters">[IANA.OAuth.Parameters]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"OAuth Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/oauth-parameters">https://www.iana.org/assignments/oauth-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID.Federation-1.0">[OpenID.Federation-1.0]</dt>
        <dd>
<span class="refAuthor">Hedberg, R., Ed.</span>, <span class="refAuthor">Jones, M.B.</span>, <span class="refAuthor">Solberg, A.Å.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">De Marco, G.</span>, and <span class="refAuthor">V. Dzhuvinov</span>, <span class="refTitle">"OpenID Federation 1.0"</span>, <time datetime="2026-01-20" class="refDate">20 January 2026</time>, <span>&lt;<a href="https://openid.net/specs/openid-federation-1_0.html">https://openid.net/specs/openid-federation-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID.Federation.Connect-1.1">[OpenID.Federation.Connect-1.1]</dt>
        <dd>
<span class="refAuthor">Hedberg, R.</span>, <span class="refAuthor">Jones, M.B., Ed.</span>, <span class="refAuthor">De Marco, G.</span>, <span class="refAuthor">Solberg, A.Å.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">V. Dzhuvinov</span>, <span class="refTitle">"OpenID Federation for OpenID Connect 1.1"</span>, <time datetime="2026-01-20" class="refDate">20 January 2026</time>, <span>&lt;<a href="https://openid.net/specs/openid-federation-connect-1_1.html">https://openid.net/specs/openid-federation-connect-1_1.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2046">[RFC2046]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span> and <span class="refAuthor">N. Borenstein</span>, <span class="refTitle">"Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types"</span>, <span class="seriesInfo">RFC 2046</span>, <span class="seriesInfo">DOI 10.17487/RFC2046</span>, <time datetime="1996-11" class="refDate">November 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2046">https://www.rfc-editor.org/info/rfc2046</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8725">[RFC8725]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Hardt, D.</span>, and <span class="refAuthor">M. Jones</span>, <span class="refTitle">"JSON Web Token Best Current Practices"</span>, <span class="seriesInfo">BCP 225</span>, <span class="seriesInfo">RFC 8725</span>, <span class="seriesInfo">DOI 10.17487/RFC8725</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8725">https://www.rfc-editor.org/info/rfc8725</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9525">[RFC9525]</dt>
      <dd>
<span class="refAuthor">Saint-Andre, P.</span> and <span class="refAuthor">R. Salz</span>, <span class="refTitle">"Service Identity in TLS"</span>, <span class="seriesInfo">RFC 9525</span>, <span class="seriesInfo">DOI 10.17487/RFC9525</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9525">https://www.rfc-editor.org/info/rfc9525</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="FederationExamples">
<section id="appendix-A">
      <h2 id="name-examples-building-and-using">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-examples-building-and-using" class="section-name selfRef">Examples Building and Using Trust Chains</a>
      </h2>
<p id="appendix-A-1">
 <span><a href="https://openid.net/specs/openid-federation-connect-1_1.html#FederationExamples" class="relref">Appendix A</a> of [<a href="#OpenID.Federation.Connect-1.1" class="cite xref">OpenID.Federation.Connect-1.1</a>]</span>
 contains examples building and using Trust Chains for trust establishment
 between parties wanting to cooperate within a federation.
 The examples are there because some of the operations depicted
 are protocol specific.
 That said, many of the operations depicted
 operate in a protocol-independent manner,
 especially setting up a federation
 and the subsequent descriptions of building a Trust Chain
 and creating Resolved Metadata.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Notices">
<section id="appendix-B">
      <h2 id="name-notices">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-notices" class="section-name selfRef">Notices</a>
      </h2>
<p id="appendix-B-1">
        Copyright (c) 2026 The OpenID Foundation.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">
        The OpenID Foundation (OIDF) grants to any Contributor, developer,
        implementer, or other interested party a non-exclusive, royalty free,
        worldwide copyright license to reproduce, prepare derivative works from,
        distribute, perform and display, this Implementers Draft, Final
        Specification, or Final Specification Incorporating Errata Corrections
        solely for the purposes of (i) developing specifications,
        and (ii) implementing Implementers Drafts, Final Specifications,
        and Final Specification Incorporating Errata Corrections based
        on such documents, provided that attribution be made to the OIDF as the
        source of the material, but that such attribution does not indicate an
        endorsement by the OIDF.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<p id="appendix-B-3">
        The technology described in this specification was made available
        from contributions from various sources, including members of the OpenID
        Foundation and others. Although the OpenID Foundation has taken steps to
        help ensure that the technology is available for distribution, it takes
        no position regarding the validity or scope of any intellectual property
        or other rights that might be claimed to pertain to the implementation
        or use of the technology described in this specification or the extent
        to which any license under such rights might or might not be available;
        neither does it represent that it has made any independent effort to
        identify any such rights. The OpenID Foundation and the contributors to
        this specification make no (and hereby expressly disclaim any)
        warranties (express, implied, or otherwise), including implied
        warranties of merchantability, non-infringement, fitness for a
        particular purpose, or title, related to this specification, and the
        entire risk as to implementing this specification is assumed by the
        implementer. The OpenID Intellectual Property Rights policy
        (found at openid.net) requires
        contributors to offer a patent promise not to assert certain patent
        claims against other contributors and against implementers.
        OpenID invites any interested party to bring to its attention any
        copyrights, patents, patent applications, or other proprietary rights
        that may cover technology that may be required to practice this
        specification.<a href="#appendix-B-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="History">
<section id="appendix-C">
      <h2 id="name-document-history">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-C-1">[[ To be removed from the final specification ]]<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">
 -01<a href="#appendix-C-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-3.1">
          <p id="appendix-C-3.1.1">
     Use the new specification name OpenID Federation for OpenID Connect 1.1,
     which was previously named OpenID Connect Federation 1.1.<a href="#appendix-C-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-3.2">
          <p id="appendix-C-3.2.1">
     Merged in changes made to OpenID Federation 1.0 between
     January 7 and January 19, 2026.<a href="#appendix-C-3.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-4">
 -00<a href="#appendix-C-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-5.1">
          <p id="appendix-C-5.1.1">
     Began life as a copy of OpenID Federation 1.0 as of December 10, 2025.<a href="#appendix-C-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-5.2">
          <p id="appendix-C-5.2.1">
     Removed protocol-specific functionality.<a href="#appendix-C-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-5.3">
          <p id="appendix-C-5.3.1">
     Merged in changes made to OpenID Federation 1.0 as of January 7, 2026.<a href="#appendix-C-5.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-5.4">
          <p id="appendix-C-5.4.1">
     Appled corrections identified by Andreas Solberg.<a href="#appendix-C-5.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="Acknowledgements">
<section id="appendix-D">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<div id="Ack1.1">
<section id="appendix-D.1">
        <h3 id="name-openid-federation-11-acknow">
<a href="#name-openid-federation-11-acknow" class="section-name selfRef">OpenID Federation 1.1 Acknowledgements</a>
        </h3>
<p id="appendix-D.1-1">
   The authors wish to acknowledge the contributions of the following
   individuals and organizations to this specification:
   the SIROS Foundation.<a href="#appendix-D.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Ack1.0">
<section id="appendix-D.2">
        <h3 id="name-openid-federation-10-acknow">
<a href="#name-openid-federation-10-acknow" class="section-name selfRef">OpenID Federation 1.0 Acknowledgements</a>
        </h3>
<p id="appendix-D.2-1">
 The authors wish to acknowledge the contributions of the following
 individuals and organizations to the OpenID Federation 1.0 specification:
 Marcus Almgren,
 Patrick Amrein,
 Pål Axelsson,
 Pasquale Barbaro,
 Ralph Bragg,
 Peter Brand,
 Brian Campbell,
 David Chadwick,
 Michele D'Amico,
 Kushal Das,
 Andrii Deinega,
 Erick Domingues,
 Heather Flanagan,
 Michael Fraser,
 Samuel Gulliksson,
 Joseph Heenan,
 Pedram Hosseyni,
 Marko Ivančić,
 Łukasz Jaromin,
 Leif Johansson,
 Takahiko Kawasaki,
 Ralf Küsters,
 Torsten Lodderstedt,
 Josh Mandel,
 Francesco Marino,
 John Melati,
 Alexey Melnikov,
 Henri Mikkonen,
 Aaron Parecki,
 Eduardo Perottoni,
 Chris Phillips,
 Roberto Polli,
 Justin Richer,
 Jouke Roorda,
 Nat Sakimura,
 Mischa Sallé,
 Stefan Santesson,
 Marcos Sanz,
 Michael Schwartz,
 Giada Sciarretta,
 Amir Sharif,
 Yaron Sheffer,
 Sean Turner,
 Davide Vaghetti,
 Niels van Dijk,
 Tim Würtele,
 Kristina Yasuda,
 Gabriel Zachmann,
 the JRA3T3 task force of GEANT4-2,
 and
 the SIROS Foundation.<a href="#appendix-D.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Roland Hedberg</span></div>
<div dir="auto" class="left"><span class="org">independent</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:roland@catalogix.se" class="email">roland@catalogix.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael B. Jones (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Self-Issued Consulting</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:michael_b_jones@hotmail.com" class="email">michael_b_jones@hotmail.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://self-issued.info/" class="url">https://self-issued.info/</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Giuseppe De Marco</span></div>
<div dir="auto" class="left"><span class="org">independent</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:demarcog83@gmail.com" class="email">demarcog83@gmail.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://www.linkedin.com/in/giuseppe-de-marco-bb054245/" class="url">https://www.linkedin.com/in/giuseppe-de-marco-bb054245/</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Andreas Åkre Solberg</span></div>
<div dir="auto" class="left"><span class="org">Sikt</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Andreas.Solberg@sikt.no" class="email">Andreas.Solberg@sikt.no</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://www.linkedin.com/in/andreassolberg/" class="url">https://www.linkedin.com/in/andreassolberg/</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John Bradley</span></div>
<div dir="auto" class="left"><span class="org">Yubico</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ve7jtb@ve7jtb.com" class="email">ve7jtb@ve7jtb.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://www.linkedin.com/in/ve7jtb/" class="url">https://www.linkedin.com/in/ve7jtb/</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Vladimir Dzhuvinov</span></div>
<div dir="auto" class="left"><span class="org">Connect2id</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:vladimir@connect2id.com" class="email">vladimir@connect2id.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://www.linkedin.com/in/vladimirdzhuvinov/" class="url">https://www.linkedin.com/in/vladimirdzhuvinov/</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>

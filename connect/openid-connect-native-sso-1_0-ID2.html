<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>OpenID Connect Native SSO for Mobile Apps 1.0 - draft 07</title>
<meta content="George F. Fletcher" name="author">
<meta content="
       OpenID Connect 1.0 is a simple identity layer on top of the OAuth 2.0
      protocol. It enables Clients to verify the identity of the End-User based
      on the authentication performed by an Authorization Server, as well as to
      obtain basic profile information about the End-User in an interoperable and
      REST-like manner. 
       
   This document describes a mechanism that allows a mobile
   app to share the identity/authentication obtained by a different mobile
   app where both apps are written by the same vendor and installed on the
   same physical device.
       
    " name="description">
<meta content="xml2rfc 3.25.0" name="generator">
<meta content="openid-connect-native-sso-1_0" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.25.0
    Python 3.10.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.5
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 24.6.1
    pydyf 0.9.0
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 75.7.0
    wcwidth 0.2.13
    weasyprint 61.2
-->
<link href="/usr/src/app/tmp/f13f11e6-2850-4d3c-b085-6043ac3420dd/openid-connect-native-sso-1_0.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body class="xml2rfc">
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left"></td>
<td class="center">Mobile App Native SSO</td>
<td class="right">January 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Fletcher</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">OpenID Connect Working Group</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-01-16" class="published">16 January 2025</time>
    </dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">G.F.F. Fletcher</div>
<div class="org">Capital One</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">OpenID Connect Native SSO for Mobile Apps 1.0 - draft 07</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">OpenID Connect 1.0 is a simple identity layer on top of the OAuth 2.0
      protocol. It enables Clients to verify the identity of the End-User based
      on the authentication performed by an Authorization Server, as well as to
      obtain basic profile information about the End-User in an interoperable and
      REST-like manner.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">
   This document describes a mechanism that allows a mobile
   app to share the identity/authentication obtained by a different mobile
   app where both apps are written by the same vendor and installed on the
   same physical device.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-requirements-notation-and-c" class="internal xref">Requirements Notation and Conventions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-abstract-flow" class="internal xref">Abstract Flow</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-native-app-authorization-ex" class="internal xref">Native App Authorization Extensions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-authorization-request" class="internal xref">Authorization Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-device-secret" class="internal xref">Device Secret</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-token-request" class="internal xref">Token Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-token-response" class="internal xref">Token Response</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="auto internal xref">3.4.1</a>.  <a href="#name-id-token-claims" class="internal xref">ID Token Claims</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.2">
                    <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="auto internal xref">3.4.2</a>.  <a href="#name-authorization-code-grant" class="internal xref">Authorization Code Grant</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.3">
                    <p id="section-toc.1-1.3.2.4.2.3.1"><a href="#section-3.4.3" class="auto internal xref">3.4.3</a>.  <a href="#name-refresh-token-grant" class="internal xref">Refresh Token Grant</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-token-exchange-profile-for-" class="internal xref">Token Exchange Profile for Native SSO</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-oauth2-token-exchange-profi" class="internal xref">OAuth2 Token Exchange Profile</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-token-exchange-request" class="internal xref">Token Exchange Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-native-sso-processing-rules" class="internal xref">Native SSO Processing Rules</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-token-exchange-response" class="internal xref">Token Exchange Response</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-discovery-metadata" class="internal xref">Discovery Metadata</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-device-secret-protection" class="internal xref">Device Secret Protection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-cross-device-sso" class="internal xref">Cross-Device SSO</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-id_token-usage" class="internal xref">id_token usage</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-user-identity-across-sso-ev" class="internal xref">User Identity across SSO events</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-oauth-parameters-registry" class="internal xref">OAuth Parameters Registry</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.1">
                    <p id="section-toc.1-1.7.2.1.2.1.1"><a href="#section-7.1.1" class="auto internal xref">7.1.1</a>.  <a href="#name-registry-contents" class="internal xref">Registry Contents</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-oauth-authorization-server-" class="internal xref">OAuth Authorization Server Metadata Registry</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a href="#section-7.2.1" class="auto internal xref">7.2.1</a>.  <a href="#name-registry-contents-2" class="internal xref">Registry Contents</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-notices" class="internal xref">Notices</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-document-history" class="internal xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="Introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
 OpenID Connect 1.0 is a simple identity layer on top of the OAuth 2.0
 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>
 protocol. It enables Clients to verify the identity of the End-User based
 on the authentication performed by an Authorization Server, as well as to
 obtain basic profile information about the End-User in an interoperable and
 REST-like manner.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
   As the industry moves to a more mobile oriented environment, vendors
   need a way to share identity across the multiple mobile apps they
   deploy. While the current OAuth2 best practice allows for SSO across
   any mobile app by sharing the session cookies in the system browser,
   this has risks such as a user clearing their system browser of cookies
   (possibly as requested by a customer care agent) or using private
   browsing on iOS and Android. On most mobile platforms, mobile apps
   signed by the same vendor certs can share information via the system
   "keychain" (Account Manager on Android).<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">
 The purpose of this specification is to provide a single-sign-on (SSO)
 mechanism across mobile applications installed on the same device
 that addresses the risks highlighted above and that provides
 an equivalent SSO solution to that provided if using a web browser.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">
   This document specifies a new scope, extends the token endpoint and
   profiles the <span><a href="#RFC8693" class="internal xref">OAuth2 Token
   Exchange</a> [<a href="#RFC8693" class="cite xref">RFC8693</a>]</span> specification allowing mobile apps to share identity (SSO)
   between apps produced and signed by the same vendor (i.e. signed with
   the same vendor certificate).<a href="#section-1-4" class="pilcrow">¶</a></p>
<div id="rnc">
<section id="section-1.1">
        <h3 id="name-requirements-notation-and-c">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-notation-and-c" class="section-name selfRef">Requirements Notation and Conventions</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in <span><a href="#RFC2119" class="internal xref">RFC 2119</a> [<a href="#RFC2119" class="cite xref">RFC2119</a>]</span>.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">
   In the .txt version of this specification,
   values are quoted to indicate that they are to be taken literally.
   When using these values in protocol messages,
   the quotes MUST NOT be used as part of the value.
   In the HTML version of this specification,
   values to be taken literally are indicated by
   the use of <code>this fixed-width font</code>.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Terminology">
<section id="section-1.2">
        <h3 id="name-terminology">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.2-1">
   This specification uses the terms
   "Authorization Server",
   "Client", "Client Identifier",
   and "Redirection URI"
   defined by <span><a href="#RFC6749" class="internal xref">OAuth 2.0</a> [<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>,
   the term "User Agent" defined by <span><a href="#RFC7230" class="internal xref">RFC 7230</a> [<a href="#RFC7230" class="cite xref">RFC7230</a>]</span>,
 the term "native app" defined by <span><a href="#RFC8252" class="internal xref">RFC 8252</a> [<a href="#RFC8252" class="cite xref">RFC8252</a>]</span>
   and the terms defined by
   <span><a href="#OpenID.Core" class="internal xref">OpenID Connect Core 1.0</a> [<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">
   This specification also defines the following terms:<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-1.2-3">
          <dt id="section-1.2-3.1">Device Secret</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.2">
       Opaque value to the client, issued by the Authorization
 Server, that uniquely identifies the device instance
 and provides credentials for the device.<a href="#section-1.2-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.3">Session ID</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.4">
       Identifier for a user's authentication session.<a href="#section-1.2-3.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="AbstractFlow">
<section id="section-2">
      <h2 id="name-abstract-flow">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-abstract-flow" class="section-name selfRef">Abstract Flow</a>
      </h2>
<div class="alignLeft art-text artwork" id="section-2-1">
<pre>
+----------+     +----------+      +-----------+      +------------+
|  Native  |     |  Native  |      |  System   |      |            |
|  App     |     |  App     |      |  Browser  |      |    AS      |
|  #1      |     |  #2      |      |           |      |            |
+----+-----+     +----+-----+      +-----+-----+      +-----+------+
     |                |                  |                  |
     | [1] Start OpenID Connect AuthN    |                  |
     +----------------+----------------&gt; |                  |
     |                |                  | [2] /authorize   |
     |                |                  +----------------&gt; |
     |                |                  |                  |
     |                |                  |   [3] authenticate
     |                |                  | &lt;----------------|
     |                |                  |                  |
     |                |                  | [4] user creds   |
     |                |                  +----------------&gt; |
     |                |                  |                  |
     |                |                  |  [5] callback    |
     |                |                  | &lt;----------------+
     |  [6] callback with code           |                  |
     | &lt;--------------+------------------+                  |
     |                |                  |                  |
     |  [7] exchange code for tokens     |                  |
     +----------------+-----------------------------------&gt; |
     |                |                  |                  |
     |     [8] tokens (including device_secret)             |
     | &lt;--------------+------------------+------------------+
     |                |                  |                  |
     |                |                  |                  |
     |                |                  |                  |
     +                +                  +                  +

</pre><a href="#section-2-1" class="pilcrow">¶</a>
</div>
<p id="section-2-2">Steps [1] - [8] are the standard OpenID Connect authorization_code
 flow with the following extensions. In step 2, the
 <code>device_sso</code>
 scope is specified signifying that the client is requesting a
 <code>device_secret</code> to be returned when
 the code is exchanged for tokens.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">After step 8, Native App #1 stores the device_secret and id_token
    in the shared device storage accessible only to Native App #2.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">Native App #2 uses the stored data from the shared device storage
    to obtain tokens for the user thus enabling the app to access
    the user's resources (i.e. SSO)<a href="#section-2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2-5">
<pre>
+----------+     +----------+      +-----------+      +------------+
|  Native  |     |  Native  |      |  System   |      |            |
|  App     |     |  App     |      |  Browser  |      |    AS      |
|  #1      |     |  #2      |      |           |      |            |
+----+-----+     +----+-----+      +-----+-----+      +-----+------+
     |                |                  |                  |
     |                |                  |                  |
     |                | [9] token exchange                  |
     |                +------------------+----------------&gt; |
     |                |                  |                  |
     |                |                  |                  |
     |                |    [10] refresh, access, [device_secret]
     |                | &lt;----------------+------------------|
     |                |                  |                  |
     |                |                  |                  |
     |                |                  |                  |
     +                +                  +                  +

</pre><a href="#section-2-5" class="pilcrow">¶</a>
</div>
<p id="section-2-6">Step [9] invokes the /token endpoint with the token exchange profile
 passing the id_token obtained from the shared device storage, the
 client_id and the device secret.<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7">Step [10] returns the SSO generated refresh and access tokens for
 Native App #2.<a href="#section-2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AuthZExtensions">
<section id="section-3">
      <h2 id="name-native-app-authorization-ex">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-native-app-authorization-ex" class="section-name selfRef">Native App Authorization Extensions</a>
      </h2>
<p id="section-3-1">
   The following sections describe the extensions required to the standard OpenID
   Connect Authentication flow which will enable a second mobile app to share the
   authentication of the first mobile app where both mobile applications are
   signed by the same vendor certificates.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="AuthZReq">
<section id="section-3.1">
        <h3 id="name-authorization-request">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-authorization-request" class="section-name selfRef">Authorization Request</a>
        </h3>
<p id="section-3.1-1">This specification defines a new scope value that is used to convey
   to the Authorization Server that when the code is exchanged for a
   token, a new <code>device_secret</code> will be
   returned in addition to the other tokens identified as part of the
   authorization request.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">The new scope value is defined as <code>device_sso</code>.
   When this scope is present on the authorization request, and the
   code is exchanged for tokens, a new device_secret will be returned.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="DeviceSecret">
<section id="section-3.2">
        <h3 id="name-device-secret">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-device-secret" class="section-name selfRef">Device Secret</a>
        </h3>
<p id="section-3.2-1">The device secret contains relevant data to the device and the
   current users authenticated with the device. The device secret
   is completely opaque to the client and as such the AS MUST
          adequately protect the value such as using a JWE if the AS
          is not maintaining state on the backend.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">In the context of this extension the device secret may be shared
   between mobile apps that can obtain the value via the shared
   security mechanism (e.g. keychain on iOS). If a mobile app
   requests a device secret via the <code>device_sso</code>
   scope and a <code>device_secret</code> exists, then
   the client MUST provide the <code>device_secret</code>
   on the request to the /token endpoint to exchange
   code for tokens. The client SHOULD provide the
   <code>device_secret</code> to the /token endpoint
   during refresh token requests so that the AS may rotate the
          device_secret as necessary.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">The exact construction of the <code>device_secret</code>
   is out of scope for this specification.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="TokenReq">
<section id="section-3.3">
        <h3 id="name-token-request">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-token-request" class="section-name selfRef">Token Request</a>
        </h3>
<p id="section-3.3-1">The native app interacts with the token endpoint in order to retrieve the
   <code>device_secret</code> and other tokens. This
       specification applies to the <code>authorization_code</code>
       and <code>refresh_token</code> grant types. Support for other
       grant types is out of scope for this specification.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">This specification defines the following additional
   parameter to the /token endpoint for the <code>authorization_code</code>
   and <code>refresh_token</code> grant types:<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.3-3">
          <dt id="section-3.3-3.1">device_secret</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-3.2">
   OPTIONAL. This token SHOULD be provided if the client requested
   the <code>device_sso</code> scope and the client
   already has a <code>device_secret</code>
   available.<a href="#section-3.3-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.3-4">
   In the case of the <code>authorization_code</code> grant, the
   standard process of associating the scopes from the authorization request with
   the <code>authorization_code</code> applies. If
   <code>device_sso</code> is included in the set of requested scopes
   the Authorization Service MUST return the <code>device_secret</code>.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5">
   In the case of the <code>refresh_token</code> grant, the Authorization
   Server must determine from the optional <code>scope</code> parameter or
   the scopes originally associated with the refresh token if the
   <code>device_sso</code> scope is part of the request. If so, the
   Authorization Server MUST return the <code>device_secret</code>.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="TokenRsp">
<section id="section-3.4">
        <h3 id="name-token-response">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-token-response" class="section-name selfRef">Token Response</a>
        </h3>
<p id="section-3.4-1">
   In processing the Token Request, the Authorization Server must determine whether
   to include a <code>device_secret</code> in the response. If a
   <code>device_secret</code> is provided as part of the token request,
   and the <code>device_secret</code> is invalid, then the AS must
   process the request as if no <code>device_secret</code> was specified.
   Additionally, in the response from the token endpoint, the <code>device_secret</code>
   and the <code>id_token</code> MUST both be issued or neither issued.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">
   The following sections describe additional claims for the <code>id_token</code>
   and when processing specific grant types.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<div id="idclaims">
<section id="section-3.4.1">
          <h4 id="name-id-token-claims">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-id-token-claims" class="section-name selfRef">ID Token Claims</a>
          </h4>
<p id="section-3.4.1-1">
   This specification defines additional requirements for the <code>id_token</code> issued
       in conjunction with the <code>device_secret</code>. These requirements create a
       strong binding between the <code>id_token</code> representing the logged in
       user and the <code>device_secret</code> representing the user's device and session.<a href="#section-3.4.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.4.1-2">
<li id="section-3.4.1-2.1">
              <p id="section-3.4.1-2.1.1">Add a <code>ds_hash</code> claim to the id_token to represent a function of
   the device_secret.<a href="#section-3.4.1-2.1.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.4.1-2.1.2">
                <dt id="section-3.4.1-2.1.2.1">ds_hash</dt>
                <dd style="margin-left: 1.5em" id="section-3.4.1-2.1.2.2">
   REQUIRED. The ds_hash value provides a binding between
   the id_token and the issued device_secret. The exact
   binding between the ds_hash and device_secret is not
   specified by this profile. As this binding is managed
   solely by the Authorization Server, the AS can choose
   how to protect the relationship between the id_token
   and device_secret.<a href="#section-3.4.1-2.1.2.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</li>
            <li id="section-3.4.1-2.2">
              <p id="section-3.4.1-2.2.1">Add a session id to the id_token that represents the user's
   current authentication session.<a href="#section-3.4.1-2.2.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.4.1-2.2.2">
                <dt id="section-3.4.1-2.2.2.1">sid</dt>
                <dd style="margin-left: 1.5em" id="section-3.4.1-2.2.2.2">
   REQUIRED. A string that uniquely identifies this user's
   authentication session. This value can be used in
   logout flows as well as the flow this spec is describing.
   For mobile apps where there is no explicit browser
   authentication this value SHOULD represent the
   underlying session associated with the refresh_token.<a href="#section-3.4.1-2.2.2.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</li>
          </ol>
<p id="section-3.4.1-3">Note that the implementation of this spec and the specification of the
   <code>ds_hash</code> and <code>sid</code>
   value MUST NOT leak any data that would provide a
   security advantage to an attacker who gains access to the id_token.<a href="#section-3.4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AuthCode">
<section id="section-3.4.2">
          <h4 id="name-authorization-code-grant">
<a href="#section-3.4.2" class="section-number selfRef">3.4.2. </a><a href="#name-authorization-code-grant" class="section-name selfRef">Authorization Code Grant</a>
          </h4>
<p id="section-3.4.2-1">
   If the authorization request includes the <code>device_sso</code>
   scope, then the Authorization Server MUST issue a <code>device_secret</code>
   and an <code>id_token</code> with the additional claims
   defined above.<a href="#section-3.4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Refresh">
<section id="section-3.4.3">
          <h4 id="name-refresh-token-grant">
<a href="#section-3.4.3" class="section-number selfRef">3.4.3. </a><a href="#name-refresh-token-grant" class="section-name selfRef">Refresh Token Grant</a>
          </h4>
<p id="section-3.4.3-1">
   The Authorization Server MUST issue a <code>device_secret</code> if
   the scope parameter or default scopes include a scope of
   <code>device_sso</code> and no existing
   or valid <code>device_secret</code> is provided.<a href="#section-3.4.3-1" class="pilcrow">¶</a></p>
<p id="section-3.4.3-2">
   If an existing <code>device_secret</code> is provided as part of the
   token request and is still valid, the Authorization Server MAY return a new
   <code>device_secret</code> but doing so is not RECOMMENDED.<a href="#section-3.4.3-2" class="pilcrow">¶</a></p>
<p id="section-3.4.3-3">
   If the Authorization Server issues a new <code>device_secret</code> as
   part of the token response, then the AS MUST also issue an updated
   <code>id_token</code> with the required claims.<a href="#section-3.4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="NativeSSOTX">
<section id="section-4">
      <h2 id="name-token-exchange-profile-for-">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-token-exchange-profile-for-" class="section-name selfRef">Token Exchange Profile for Native SSO</a>
      </h2>
<p id="section-4-1">This section profiles the
   <span><a href="#RFC8693" class="internal xref">OAuth2 Token Exchange</a> [<a href="#RFC8693" class="cite xref">RFC8693</a>]</span> spec and
   describes the processing rules used to exchange a previous authentication
   for new refresh and access tokens requested by a mobile app created by
   the same vendor as the first mobile app and both apps signed by the
   same developer certificate.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="TXProfile">
<section id="section-4.1">
        <h3 id="name-oauth2-token-exchange-profi">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-oauth2-token-exchange-profi" class="section-name selfRef">OAuth2 Token Exchange Profile</a>
        </h3>
<p id="section-4.1-1">
   The Authorization Server requires the <code>client_id</code> of
   the requesting OAuth client. The <code>client_id</code> value can be
   obtained from the parameter defined by <span><a href="#RFC6749" class="internal xref">OAuth 2.0</a> [<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> or via
   client authentication methods that identify the <code>client_id</code>.
   Confidential clients MUST use client authentication with this profile.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2"><span><a href="#RFC6749" class="internal xref">OAuth 2.0</a> [<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> defines:<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.1-3">
          <dt id="section-4.1-3.1">client_id</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-3.2">
   OPTIONAL. The client_id value of the requesting OAuth client. This parameter
   is REQUIRED if the client is a <code>public</code> client.<a href="#section-4.1-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.1-4">Additionally, this profile defines the use of the following token exchange parameters:<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.1-5">
          <dt id="section-4.1-5.1">grant_type</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-5.2">
   REQUIRED. The value MUST be urn:ietf:params:oauth:grant-type:token-exchange<a href="#section-4.1-5.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-5.3">audience</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-5.4">
   REQUIRED. This parameter defines the logical purview of the returned tokens.
   For the purposes of this profile, this value MUST be the issuer URI for
   the OpenID Provider that issued the id_token used in this profile.<a href="#section-4.1-5.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-5.5">subject_token</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-5.6">
   REQUIRED. This parameter MUST contain the id_token obtained by the first
   native app. The id_token is used in the same manner as id_token_hint to
   identify the user to SSO into the invoking native app.<a href="#section-4.1-5.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-5.7">subject_token_type</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-5.8">
   REQUIRED. This parameter MUST contain the
   value: urn:ietf:params:oauth:token-type:id_token<a href="#section-4.1-5.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-5.9">actor_token</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-5.10">
   REQUIRED. This value defines the actor making the request which in this
   case is the device_secret issued to the device of the native
   application making the request. The device_secret MUST be presented per
   the definition of the urn:openid:params:token-type:device-secret
   token identifier described below.<a href="#section-4.1-5.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-5.11">actor_token_type</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-5.12">
   REQUIRED. This value MUST be: urn:openid:params:token-type:device-secret<a href="#section-4.1-5.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-5.13">scope</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-5.14">
   OPTIONAL. The scopes required by the requesting native application. When present,
   it MUST include the <code>openid</code> scope value as one of the
   provided values.<a href="#section-4.1-5.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-5.15">requested_token_type</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-5.16">
   OPTIONAL. The desired token(s) to be returned. If no requested_token_type
                          is defined, it is up to the AS to return the appropriate tokens for the
                          requesting client. The full set of possible requested_token_type value
                          is out of scope for this specification.<a href="#section-4.1-5.16" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.1-6">This profile also defines the following token type identifier:<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.1-7">
          <dt id="section-4.1-7.1">urn:openid:params:token-type:device-secret</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-7.2">
   This token type identifier is used to describe the device_secret specified
   in the actor_token parameter.<a href="#section-4.1-7.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="TXReq">
<section id="section-4.2">
        <h3 id="name-token-exchange-request">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-token-exchange-request" class="section-name selfRef">Token Exchange Request</a>
        </h3>
<p id="section-4.2-1">When a mobile app wants to request native SSO (i.e. obtain refresh and access
   tokens for an already signed in user) it makes a standard OAuth2 /token
   endpoint request following the profile for Token Exchange defined above.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">The following is a non-normative example<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-3">
<pre>
    POST /token HTTP/1.1
    Host: as.example.com
    ...
    client_id=cid_235saw4r4
    &amp;grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Atoken-exchange
    &amp;audience=https%3A%3F%3Flogin.example.net&amp;subject_token=&lt;id_token&gt;
    &amp;subject_token_type=urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Aid-token
    &amp;actor_token=95twdf3w4y6wvftw35634t
    &amp;actor_token_type=urn%3Aopenid%3Aparams%3Atoken-type%3Adevice-secret
</pre><a href="#section-4.2-3" class="pilcrow">¶</a>
</div>
<p id="section-4.2-4">
   The <code>client_id</code> in this request is sent via the
   <code>client_id</code> parameter. The
   <code>client_id</code> may also be provided via standard
   client authentication methods.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="TXRules">
<section id="section-4.3">
        <h3 id="name-native-sso-processing-rules">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-native-sso-processing-rules" class="section-name selfRef">Native SSO Processing Rules</a>
        </h3>
<p id="section-4.3-1">When the authorization server receives a request at the token endpoint
   conforming to this profile it MUST perform the following checks before
   issuing any tokens:<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3-2">
<li id="section-4.3-2.1">
            <p id="section-4.3-2.1.1">Validate the device_secret to ensure the token is still valid. The
   format of this secret is defined by the Authorization server and
   is out of scope for this specification.<a href="#section-4.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-2.2">
            <p id="section-4.3-2.2.1">Verify the id_token for integrity protection by validating the
      signature of the id_token JWT.<a href="#section-4.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-2.3">
            <p id="section-4.3-2.3.1">Verify the binding between the id_token and the device_secret
   by validating the <code>ds_hash</code> value obtained
   from the <code>id_token</code> matches the
   <code>device_secret</code> provided in the
   <code>actor_token</code> parameter.<a href="#section-4.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-2.4">
            <p id="section-4.3-2.4.1">Verify that the session id in the id_token (sid claim) is still
   valid. If the session is no longer valid, the AS MUST return an
   error of invalid_grant. Note that in the case of a refresh_tokens
              issued with an offline_scope the 'sid' value SHOULD represent the
              offline "session" such that if the original refresh_token is revoked
              the 'ds_hash' value in the id_token is no longer valid.<a href="#section-4.3-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-2.5">
            <p id="section-4.3-2.5.1">Validate that the client requesting native SSO is authorized to
   do so. The AS SHOULD maintain a list of client_ids that can share
   user authentications. For example, the AS MAY take the 'aud'
   claim from the id_token and the client_id from the token request
   and ensures that both client_ids are allowed to share user
   authentications.<a href="#section-4.3-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-2.6">
            <p id="section-4.3-2.6.1">The AS SHOULD verify that the scopes requested by the client in
   the token request (either default scopes or explicitly specified
   in the optional scope parameter) do NOT require explicit user
   consent. If any requested scopes require explicit user consent
   the AS SHOULD fail the request and return an error of
   <code>interaction_required</code>.<a href="#section-4.3-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-4.3-3">Based on the AS definition of the device_secret, the AS may perform
   additional checks to ensure the security of the request. Provided the
   above criteria is met, the AS will issue a normal Token Response
   object containing a refresh_token, access_token and id_token issued
   to the client_id of the mobile app making the request. The session
   associated with the new refresh_token SHOULD be the same as that
   used to verify the validity of the SSO exchange. If that session
   expires, all refresh_tokens associated with it MUST be invalidated.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="TXRsp">
<section id="section-4.4">
        <h3 id="name-token-exchange-response">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-token-exchange-response" class="section-name selfRef">Token Exchange Response</a>
        </h3>
<p id="section-4.4-1">The Token Exchange response for this profile has the following characteristics:<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.4-2">
          <dt id="section-4.4-2.1">access_token</dt>
          <dd style="margin-left: 1.5em" id="section-4.4-2.2">
   REQUIRED. This response field contains the access token issued to
   the mobile client identified by the client_id sent in the
   Authorization header.<a href="#section-4.4-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.4-2.3">issued_token_type</dt>
          <dd style="margin-left: 1.5em" id="section-4.4-2.4">
   REQUIRED. This value of this parameter MUST be:
   urn:ietf:params:oauth:token-type:access_token<a href="#section-4.4-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.4-2.5">token_type</dt>
          <dd style="margin-left: 1.5em" id="section-4.4-2.6">
   REQUIRED. The value of this parameter MUST be
   <code>bearer</code>.<a href="#section-4.4-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.4-2.7">expires_in</dt>
          <dd style="margin-left: 1.5em" id="section-4.4-2.8">
   RECOMMENDED. Identifies when the access_token expires.<a href="#section-4.4-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.4-2.9">scope</dt>
          <dd style="margin-left: 1.5em" id="section-4.4-2.10">
   OPTIONAL. Follows the token exchange spec definition.<a href="#section-4.4-2.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.4-2.11">refresh_token</dt>
          <dd style="margin-left: 1.5em" id="section-4.4-2.12">
   OPTIONAL. By default the AS should return a refresh_token that
                          the mobile app can use to obtain additional access_tokens when
                          the access_token expires.<a href="#section-4.4-2.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.4-2.13">id_token</dt>
          <dd style="margin-left: 1.5em" id="section-4.4-2.14">
   OPTIONAL. By default the AS should return an id_token that provides
                          the mobile app with an identity assertion about the user.<a href="#section-4.4-2.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.4-2.15">device_secret</dt>
          <dd style="margin-left: 1.5em" id="section-4.4-2.16">
   OPTIONAL. The AS MAY return an updated
   device_secret in the response.<a href="#section-4.4-2.16" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.4-3">
   In the case that the AS requires the user to interact with the AS directly, for example to
   obtain the user's consent for a particular requested scope value, the AS MUST return the
   OpenID Connect defined error of <code>interaction_required</code>. This
   instructs the client to start an authorization request with the AS via the standard web
   based flows, as described in <a href="#AuthZReq" class="auto internal xref">Section 3.1</a>.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<p id="section-4.4-4">In the case of any errors, the AS MUST return a valid OAuth2 Error response
   as described in Section 2.2.2 of the Token Exchange spec.<a href="#section-4.4-4" class="pilcrow">¶</a></p>
<p id="section-4.4-5">The following is a non-normative example<a href="#section-4.4-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4-6">
<pre>
    HTTP/1.1 200 OK
    Content-Type: application/json
    Cache-Control: no-store

    {
      "access_token":"2YotnFZFEjr1zCsicMWpAA",
      "issued_token_type": "urn:ietf:params:oauth:token-type:access_token",
      "token_type":"Bearer",
      "expires_in":3600,
      "refresh_token":"tGzv3JOkF0XG5Qx2TlKWIA",
      "id_token":"&lt;id_token&gt;",
      "device_secret":"casdfgarfgasdfg"
    }
</pre><a href="#section-4.4-6" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="discovery">
<section id="section-5">
      <h2 id="name-discovery-metadata">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-discovery-metadata" class="section-name selfRef">Discovery Metadata</a>
      </h2>
<p id="section-5-1">
   This specification extends the OpenID Connect Discovery Metadata
   <span><a href="#OpenID.Discovery" class="internal xref">Section 3</a> [<a href="#OpenID.Discovery" class="cite xref">OpenID.Discovery</a>]</span> and defines the following:<a href="#section-5-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-5-2">
        <dt id="section-5-2.1">native_sso_supported</dt>
        <dd style="margin-left: 1.5em" id="section-5-2.2">
   OPTIONAL. A boolean value of <code>true</code> identifying that the AS
   supports this OpenID Connect specification.<a href="#section-5-2.2" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-5-3">
   This metadata parameter is OPTIONAL in the context of the OpenID Provider
   not supporting the Native SSO for Mobile Apps specification. If omitted,
   the Relying Party SHOULD assume that this specification is not
   supported. The OpenID Provider MAY provide this metadata parameter even
   if it doesn't support the Native SSO for Mobile Apps specification by
   including the <code>native_sso_support</code> parameter with a
   value of <code>false</code>.<a href="#section-5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Security">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="dsp">
<section id="section-6.1">
        <h3 id="name-device-secret-protection">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-device-secret-protection" class="section-name selfRef">Device Secret Protection</a>
        </h3>
<p id="section-6.1-1">
   Sufficient care must be made to protect the <code>device_secret</code>.
   The device secret SHOULD be encrypted by the Authorization Service and periodically
   refreshed via the mechanisms described in this specification.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cds">
<section id="section-6.2">
        <h3 id="name-cross-device-sso">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-cross-device-sso" class="section-name selfRef">Cross-Device SSO</a>
        </h3>
<p id="section-6.2-1">
 If it is possible to move correctly bound <code>device_secret</code>
 and <code>id_token</code> to a separate device, that device can obtain
 the user's authentication state on the new device. An implementation of this
 specification SHOULD use best efforts to bind the device_secret to the device instance
 to prevent exfiltration of the <code>device_secret</code> and
 <code>id_token</code> from the device.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="idt">
<section id="section-6.3">
        <h3 id="name-id_token-usage">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-id_token-usage" class="section-name selfRef">id_token usage</a>
        </h3>
<p id="section-6.3-1">
 Use of the id_token in this specification takes some liberties with id_token validation.
 For instance, the <code>aud</code> claim normally identifies the client
 receiving the id_token and not the authorization server that issued the id_token.
 Additionally, the id_token may have expired at the time of use designated by this specification.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sso">
<section id="section-6.4">
        <h3 id="name-user-identity-across-sso-ev">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-user-identity-across-sso-ev" class="section-name selfRef">User Identity across SSO events</a>
        </h3>
<p id="section-6.4-1">
 This specification does not ensure that the user (human) who logs into mobile app 1
 is the same user who is SSO'd into mobile app 2. This is equivalent to web based
 SSO where once the browser instance is logged in, the SSO event to a new endpoint
 assumes the user identity is the same. For this specification, if the destination
 mobile app requires a user identity check due to risk or some other reason, how that
 mobile app verifies the user is out of scope for this specification.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="OAuthParams">
<section id="section-7.1">
        <h3 id="name-oauth-parameters-registry">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-oauth-parameters-registry" class="section-name selfRef">OAuth Parameters Registry</a>
        </h3>
<p id="section-7.1-1">
   This specification registers the following parameter in the IANA
   "OAuth Parameters" registry <span>[<a href="#IANA.OAuth.Parameters" class="cite xref">IANA.OAuth.Parameters</a>]</span>
   established by <span><a href="#RFC6749" class="internal xref">RFC 6749</a> [<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<div id="ParametersContents">
<section id="section-7.1.1">
          <h4 id="name-registry-contents">
<a href="#section-7.1.1" class="section-number selfRef">7.1.1. </a><a href="#name-registry-contents" class="section-name selfRef">Registry Contents</a>
          </h4>
<ul class="compact">
<li class="compact" id="section-7.1.1-1.1">
              <p id="section-7.1.1-1.1.1">Parameter name: <code>device_secret</code><a href="#section-7.1.1-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="compact" id="section-7.1.1-1.2">
              <p id="section-7.1.1-1.2.1">Parameter usage location: Authorization Response,
   Access Token Request, Access Token Response<a href="#section-7.1.1-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="compact" id="section-7.1.1-1.3">
              <p id="section-7.1.1-1.3.1">Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net<a href="#section-7.1.1-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="compact" id="section-7.1.1-1.4">
              <p id="section-7.1.1-1.4.1">Specification document(s): <a href="#TokenReq" class="auto internal xref">Section 3.3</a> of this document<a href="#section-7.1.1-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="compact" id="section-7.1.1-1.5">
              <p id="section-7.1.1-1.5.1">Related information: None<a href="#section-7.1.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="ASMetadataRegistry">
<section id="section-7.2">
        <h3 id="name-oauth-authorization-server-">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-oauth-authorization-server-" class="section-name selfRef">OAuth Authorization Server Metadata Registry</a>
        </h3>
<p id="section-7.2-1">
   This specification registers the following metadata name in the
   IANA "OAuth Authorization Server Metadata" registry <span>[<a href="#IANA.OAuth.Parameters" class="cite xref">IANA.OAuth.Parameters</a>]</span>
   established by <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span>.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<div id="MetadataContents">
<section id="section-7.2.1">
          <h4 id="name-registry-contents-2">
<a href="#section-7.2.1" class="section-number selfRef">7.2.1. </a><a href="#name-registry-contents-2" class="section-name selfRef">Registry Contents</a>
          </h4>
<ul class="compact">
<li class="compact" id="section-7.2.1-1.1">
              <p id="section-7.2.1-1.1.1">
   Metadata Name: <code>native_sso_supported</code><a href="#section-7.2.1-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="compact" id="section-7.2.1-1.2">
              <p id="section-7.2.1-1.2.1">
   Metadata Description:
   A boolean value of True identifying that the OpenID Provider
   supports this specification.<a href="#section-7.2.1-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="compact" id="section-7.2.1-1.3">
              <p id="section-7.2.1-1.3.1">
   Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net<a href="#section-7.2.1-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="compact" id="section-7.2.1-1.4">
              <p id="section-7.2.1-1.4.1">
   Specification Document(s): <a href="#discovery" class="auto internal xref">Section 5</a> of this document<a href="#section-7.2.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<section id="section-8">
      <h2 id="name-normative-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="IANA.OAuth.Parameters">[IANA.OAuth.Parameters]</dt>
      <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"OAuth Parameters"</span>, <span>&lt;<a href="http://www.iana.org/assignments/oauth-parameters">http://www.iana.org/assignments/oauth-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID.Core">[OpenID.Core]</dt>
      <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.B.</span>, <span class="refAuthor">de Medeiros, B.</span>, and <span class="refAuthor">C. Mortimore</span>, <span class="refTitle">"OpenID Connect Core 1.0 incorporating errata set 2"</span>, <time datetime="2023-12-15" class="refDate">15 December 2023</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-core-1_0.html">https://openid.net/specs/openid-connect-core-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID.Discovery">[OpenID.Discovery]</dt>
      <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.B.</span>, and <span class="refAuthor">E. Jay</span>, <span class="refTitle">"OpenID Connect Discovery 1.0 incorporating errata set 2"</span>, <time datetime="2023-12-15" class="refDate">15 December 2023</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-discovery-1_0.html">https://openid.net/specs/openid-connect-discovery-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
      <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7230">[RFC7230]</dt>
      <dd>
<span class="refAuthor">Fielding, R., Ed.</span> and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing"</span>, <span class="seriesInfo">RFC 7230</span>, <span class="seriesInfo">DOI 10.17487/RFC7230</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7230">https://www.rfc-editor.org/info/rfc7230</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8252">[RFC8252]</dt>
      <dd>
<span class="refAuthor">Denniss, W.</span> and <span class="refAuthor">J. Bradley</span>, <span class="refTitle">"OAuth 2.0 for Native Apps"</span>, <span class="seriesInfo">BCP 212</span>, <span class="seriesInfo">RFC 8252</span>, <span class="seriesInfo">DOI 10.17487/RFC8252</span>, <time datetime="2017-10" class="refDate">October 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8252">https://www.rfc-editor.org/info/rfc8252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8414">[RFC8414]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Sakimura, N.</span>, and <span class="refAuthor">J. Bradley</span>, <span class="refTitle">"OAuth 2.0 Authorization Server Metadata"</span>, <span class="seriesInfo">RFC 8414</span>, <span class="seriesInfo">DOI 10.17487/RFC8414</span>, <time datetime="2018-06" class="refDate">June 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8414">https://www.rfc-editor.org/info/rfc8414</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8693">[RFC8693]</dt>
    <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Nadalin, A.</span>, <span class="refAuthor">Campbell, B., Ed.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">C. Mortimore</span>, <span class="refTitle">"OAuth 2.0 Token Exchange"</span>, <span class="seriesInfo">RFC 8693</span>, <span class="seriesInfo">DOI 10.17487/RFC8693</span>, <time datetime="2020-01" class="refDate">January 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8693">https://www.rfc-editor.org/info/rfc8693</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="Acknowledgements">
<section id="appendix-A">
      <h2 id="name-acknowledgements">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-A-1">
 The OpenID Community would like to thank the following people for
 their contributions to this specification:<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="appendix-A-2.1">
          <p id="appendix-A-2.1.1">Filip Skokan<a href="#appendix-A-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal ulEmpty" id="appendix-A-2.2">
          <p id="appendix-A-2.2.1">Joseph Heenan<a href="#appendix-A-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal ulEmpty" id="appendix-A-2.3">
          <p id="appendix-A-2.3.1">Nat Sakimura<a href="#appendix-A-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal ulEmpty" id="appendix-A-2.4">
          <p id="appendix-A-2.4.1">Naveen CM<a href="#appendix-A-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal ulEmpty" id="appendix-A-2.5">
          <p id="appendix-A-2.5.1">Nov Matake<a href="#appendix-A-2.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal ulEmpty" id="appendix-A-2.6">
          <p id="appendix-A-2.6.1">Vivek Shankar<a href="#appendix-A-2.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal ulEmpty" id="appendix-A-2.7">
          <p id="appendix-A-2.7.1">Vladimir Dzhuvinov<a href="#appendix-A-2.7.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="Notices">
<section id="appendix-B">
      <h2 id="name-notices">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-notices" class="section-name selfRef">Notices</a>
      </h2>
<p id="appendix-B-1">Copyright (c) 2025 The OpenID Foundation.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">
 The OpenID Foundation (OIDF) grants to any Contributor, developer,
 implementer, or other interested party a non-exclusive, royalty free,
 worldwide copyright license to reproduce, prepare derivative works from,
 distribute, perform and display, this Implementers Draft or
 Final Specification solely for the purposes of (i) developing
 specifications, and (ii) implementing Implementers Drafts and
 Final Specifications based on such documents, provided that attribution
 be made to the OIDF as the source of the material, but that such attribution
 does not indicate an endorsement by the OIDF.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<p id="appendix-B-3">
 The technology described in this specification was
 made available from contributions from various sources,
 including members of the OpenID Foundation and others.
 Although the OpenID Foundation has taken steps to help ensure
 that the technology is available for distribution, it takes
 no position regarding the validity or scope of any intellectual
 property or other rights that might be claimed to pertain to
 the implementation or use of the technology described in
 this specification or the extent to which any license under
 such rights might or might not be available; neither does it
 represent that it has made any independent effort to identify
 any such rights.  The OpenID Foundation and the contributors
 to this specification make no (and hereby expressly disclaim any)
 warranties (express, implied, or otherwise), including implied
 warranties of merchantability, non-infringement, fitness for
 a particular purpose, or title, related to this specification,
 and the entire risk as to implementing this specification is
 assumed by the implementer.  The OpenID Intellectual
 Property Rights policy requires contributors to offer
 a patent promise not to assert certain patent claims against
 other contributors and against implementers.  The OpenID Foundation invites
 any interested party to bring to its attention any copyrights,
 patents, patent applications, or other proprietary rights
 that may cover technology that may be required to practice
 this specification.<a href="#appendix-B-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="History">
<section id="appendix-C">
      <h2 id="name-document-history">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-C-1">[[ To be removed from the final specification ]]<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">
 -07<a href="#appendix-C-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-3.1">
          <p id="appendix-C-3.1.1">
 Updated the draft version and tweaked some language based on updates from
 Vladimir Dzhuvinov. Added clarity around the use of the device_sso scope value, fixed
 a typo and added clarity for how the OP signals the app that user interaction is
 required.<a href="#appendix-C-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-3.2">
          <p id="appendix-C-3.2.1">
 Changed the urn:x-oath:params:* constants to urn:openid:params:* strings.
 This is a normative change.<a href="#appendix-C-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-3.3">
          <p id="appendix-C-3.3.1">
 Refactored section 3.3 and 3.4 to address feedback from issues
 #2172, #2170, #2169, #2168. Clarifies processing of scopes and token
 responses depending on the specific OAuth grant.<a href="#appendix-C-3.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-3.4">
          <p id="appendix-C-3.4.1">
 Made some miscellaneous editor changes.<a href="#appendix-C-3.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-4">
 -06<a href="#appendix-C-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-5.1">
          <p id="appendix-C-5.1.1">
     Updated the draft version and tweaked some language based on updates from
     Vivek Shankar.<a href="#appendix-C-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-5.2">
          <p id="appendix-C-5.2.1">
     Added Notices section.<a href="#appendix-C-5.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-6">
 -05<a href="#appendix-C-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-7.1">
          <p id="appendix-C-7.1.1">
     Updated the draft version and tweaked some language based on updates from
     Naveen CM.<a href="#appendix-C-7.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-8">
 -04<a href="#appendix-C-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-9.1">
          <p id="appendix-C-9.1.1">
     Normative change to verify the id_token plus other edits based on feedback
     from Joseph Heenan.<a href="#appendix-C-9.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-9.2">
          <p id="appendix-C-9.2.1">
     Also updated Security Considerations section and general cleanup.<a href="#appendix-C-9.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-10">
 -03<a href="#appendix-C-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-11.1">
          <p id="appendix-C-11.1.1">
     Applied updates from the community.<a href="#appendix-C-11.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-11.2">
          <p id="appendix-C-11.2.1">
     Removed non-relevant IANA claims section.<a href="#appendix-C-11.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-12">
 -00<a href="#appendix-C-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-13.1">
          <p id="appendix-C-13.1.1">
     Initial Draft.<a href="#appendix-C-13.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">George F. Fletcher</span></div>
<div dir="auto" class="left"><span class="org">Capital One</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:gffletch@aol.com" class="email">gffletch@aol.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>

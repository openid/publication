<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Han,Hiragana,Katakana,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>OpenID for Verifiable Credential Issuance 1.0</title>
<meta content="Torsten Lodderstedt" name="author">
<meta content="Kristina Yasuda" name="author">
<meta content="Tobias Looker" name="author">
<meta content="
       This specification defines an API for the issuance of Verifiable Credentials. 
    " name="description">
<meta content="xml2rfc 3.16.0" name="generator">
<meta content="security" name="keyword">
<meta content="openid" name="keyword">
<meta content="ssi" name="keyword">
<meta content="openid-4-verifiable-credential-issuance-1_0-17" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.16.0
    Python 3.10.2
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.2
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.2
    MarkupSafe 2.1.2
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.2
    setuptools 57.5.0
    six 1.16.0
    wcwidth 0.2.6
-->
<link href="./openid-4-verifiable-credential-issuance-1_0-17.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
</head>
<body class="xml2rfc">
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left"></td>
<td class="center">openid-4-verifiable-credential-issuance</td>
<td class="right">September 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Lodderstedt, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">OpenID Digital Credentials Protocols</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-09-16" class="published">16 September 2025</time>
    </dd>
<dt class="label-status">Status:</dt>
<dd class="status">Final</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Lodderstedt</div>
<div class="org">SPRIND</div>
</div>
<div class="author">
      <div class="author-name">K. Yasuda</div>
<div class="org">SPRIND</div>
</div>
<div class="author">
      <div class="author-name">T. Looker</div>
<div class="org">Mattr</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">OpenID for Verifiable Credential Issuance 1.0</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This specification defines an API for the issuance of Verifiable Credentials.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-errata-revisions" class="internal xref">Errata revisions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-requirements-notation-and-c" class="internal xref">Requirements Notation and Conventions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-credential-issuer" class="internal xref">Credential Issuer</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-oauth-20" class="internal xref">OAuth 2.0</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-core-concepts" class="internal xref">Core Concepts</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="auto internal xref">3.3.1</a>.  <a href="#name-credential-formats-and-cred" class="internal xref">Credential Formats and Credential Format Profiles</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="auto internal xref">3.3.2</a>.  <a href="#name-batch-credential-issuance" class="internal xref">Batch Credential Issuance</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.3">
                    <p id="section-toc.1-1.3.2.3.2.3.1"><a href="#section-3.3.3" class="auto internal xref">3.3.3</a>.  <a href="#name-issuance-flow-variations" class="internal xref">Issuance Flow Variations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.4">
                    <p id="section-toc.1-1.3.2.3.2.4.1"><a href="#section-3.3.4" class="auto internal xref">3.3.4</a>.  <a href="#name-identifying-credentials-bei" class="internal xref">Identifying Credentials Being Issued Throughout the Issuance Flow</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-authorization-code-flow" class="internal xref">Authorization Code Flow</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-pre-authorized-code-flow" class="internal xref">Pre-Authorized Code Flow</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-credential-offer-endpoint" class="internal xref">Credential Offer Endpoint</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-credential-offer" class="internal xref">Credential Offer</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="auto internal xref">4.1.1</a>.  <a href="#name-credential-offer-parameters" class="internal xref">Credential Offer Parameters</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="auto internal xref">4.1.2</a>.  <a href="#name-sending-credential-offer-by" class="internal xref">Sending Credential Offer by Value Using <code>credential_offer</code> Parameter</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a href="#section-4.1.3" class="auto internal xref">4.1.3</a>.  <a href="#name-sending-credential-offer-by-" class="internal xref">Sending Credential Offer by Reference Using <code>credential_offer_uri</code> Parameter</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-credential-offer-response" class="internal xref">Credential Offer Response</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-authorization-endpoint" class="internal xref">Authorization Endpoint</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-authorization-request" class="internal xref">Authorization Request</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-using-authorization-details" class="internal xref">Using Authorization Details Parameter</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="auto internal xref">5.1.2</a>.  <a href="#name-using-scope-parameter-to-re" class="internal xref">Using <code>scope</code> Parameter to Request Issuance of a Credential</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a href="#section-5.1.3" class="auto internal xref">5.1.3</a>.  <a href="#name-additional-request-paramete" class="internal xref">Additional Request Parameters</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4">
                    <p id="section-toc.1-1.5.2.1.2.4.1"><a href="#section-5.1.4" class="auto internal xref">5.1.4</a>.  <a href="#name-pushed-authorization-reques" class="internal xref">Pushed Authorization Request</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-successful-authorization-re" class="internal xref">Successful Authorization Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-authorization-error-respons" class="internal xref">Authorization Error Response</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-token-endpoint" class="internal xref">Token Endpoint</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-token-request" class="internal xref">Token Request</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="auto internal xref">6.1.1</a>.  <a href="#name-request-credential-issuance" class="internal xref">Request Credential Issuance using <code>authorization_details</code> Parameter</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-successful-token-response" class="internal xref">Successful Token Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-token-error-response" class="internal xref">Token Error Response</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-nonce-endpoint" class="internal xref">Nonce Endpoint</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-nonce-request" class="internal xref">Nonce Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-nonce-response" class="internal xref">Nonce Response</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-credential-endpoint" class="internal xref">Credential Endpoint</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-binding-the-issued-credenti" class="internal xref">Binding the Issued Credential to the Identifier of the End-User Possessing that Credential</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-credential-request" class="internal xref">Credential Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-credential-response" class="internal xref">Credential Response</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.1">
                    <p id="section-toc.1-1.8.2.3.2.1.1"><a href="#section-8.3.1" class="auto internal xref">8.3.1</a>.  <a href="#name-credential-error-response" class="internal xref">Credential Error Response</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-deferred-credential-endpoin" class="internal xref">Deferred Credential Endpoint</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-deferred-credential-request" class="internal xref">Deferred Credential Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-deferred-credential-respons" class="internal xref">Deferred Credential Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-deferred-credential-error-r" class="internal xref">Deferred Credential Error Response</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-encrypted-credential-reques" class="internal xref">Encrypted Credential Requests and Responses</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-notification-endpoint" class="internal xref">Notification Endpoint</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-notification-request" class="internal xref">Notification Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-successful-notification-res" class="internal xref">Successful Notification Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="auto internal xref">11.3</a>.  <a href="#name-notification-error-response" class="internal xref">Notification Error Response</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-metadata" class="internal xref">Metadata</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-client-metadata" class="internal xref">Client Metadata</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1.2.1">
                    <p id="section-toc.1-1.12.2.1.2.1.1"><a href="#section-12.1.1" class="auto internal xref">12.1.1</a>.  <a href="#name-client-metadata-retrieval" class="internal xref">Client Metadata Retrieval</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-credential-issuer-metadata" class="internal xref">Credential Issuer Metadata</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.1">
                    <p id="section-toc.1-1.12.2.2.2.1.1"><a href="#section-12.2.1" class="auto internal xref">12.2.1</a>.  <a href="#name-credential-issuer-identifie" class="internal xref">Credential Issuer Identifier</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.2">
                    <p id="section-toc.1-1.12.2.2.2.2.1"><a href="#section-12.2.2" class="auto internal xref">12.2.2</a>.  <a href="#name-credential-issuer-metadata-" class="internal xref">Credential Issuer Metadata Retrieval</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.3">
                    <p id="section-toc.1-1.12.2.2.2.3.1"><a href="#section-12.2.3" class="auto internal xref">12.2.3</a>.  <a href="#name-signed-metadata" class="internal xref">Signed Metadata</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.4">
                    <p id="section-toc.1-1.12.2.2.2.4.1"><a href="#section-12.2.4" class="auto internal xref">12.2.4</a>.  <a href="#name-credential-issuer-metadata-p" class="internal xref">Credential Issuer Metadata Parameters</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#section-12.3" class="auto internal xref">12.3</a>.  <a href="#name-oauth-20-authorization-serv" class="internal xref">OAuth 2.0 Authorization Server Metadata</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-formal-security-analysis" class="internal xref">Formal Security Analysis</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-best-current-practice-for-o" class="internal xref">Best Current Practice for OAuth 2.0 Security</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#section-13.3" class="auto internal xref">13.3</a>.  <a href="#name-trust-between-wallet-and-is" class="internal xref">Trust between Wallet and Issuer</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.4">
                <p id="section-toc.1-1.13.2.4.1"><a href="#section-13.4" class="auto internal xref">13.4</a>.  <a href="#name-split-architecture-wallets" class="internal xref">Split-Architecture Wallets</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.5">
                <p id="section-toc.1-1.13.2.5.1"><a href="#section-13.5" class="auto internal xref">13.5</a>.  <a href="#name-credential-offer-2" class="internal xref">Credential Offer</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.6">
                <p id="section-toc.1-1.13.2.6.1"><a href="#section-13.6" class="auto internal xref">13.6</a>.  <a href="#name-pre-authorized-code-flow-2" class="internal xref">Pre-Authorized Code Flow</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.6.2.1">
                    <p id="section-toc.1-1.13.2.6.2.1.1"><a href="#section-13.6.1" class="auto internal xref">13.6.1</a>.  <a href="#name-replay-prevention" class="internal xref">Replay Prevention</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.6.2.2">
                    <p id="section-toc.1-1.13.2.6.2.2.1"><a href="#section-13.6.2" class="auto internal xref">13.6.2</a>.  <a href="#name-transaction-code-phishing" class="internal xref">Transaction Code Phishing</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.7">
                <p id="section-toc.1-1.13.2.7.1"><a href="#section-13.7" class="auto internal xref">13.7</a>.  <a href="#name-credential-lifecycle-manage" class="internal xref">Credential Lifecycle Management</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.8">
                <p id="section-toc.1-1.13.2.8.1"><a href="#section-13.8" class="auto internal xref">13.8</a>.  <a href="#name-proof-replay" class="internal xref">Proof replay</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.9">
                <p id="section-toc.1-1.13.2.9.1"><a href="#section-13.9" class="auto internal xref">13.9</a>.  <a href="#name-tls-requirements" class="internal xref">TLS Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.10">
                <p id="section-toc.1-1.13.2.10.1"><a href="#section-13.10" class="auto internal xref">13.10</a>. <a href="#name-protecting-the-access-token" class="internal xref">Protecting the Access Token</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.11">
                <p id="section-toc.1-1.13.2.11.1"><a href="#section-13.11" class="auto internal xref">13.11</a>. <a href="#name-application-layer-encryptio" class="internal xref">Application-Layer Encryption</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-implementation-consideratio" class="internal xref">Implementation Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="auto internal xref">14.1</a>.  <a href="#name-claims-based-holder-binding" class="internal xref">Claims-based Holder Binding of the Credential to the End-User possessing the Credential</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-14.2" class="auto internal xref">14.2</a>.  <a href="#name-binding-of-the-credential-w" class="internal xref">Binding of the Credential without Cryptographic Key Binding or Claims-based Holder Binding</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a href="#section-14.3" class="auto internal xref">14.3</a>.  <a href="#name-multiple-accesses-to-the-cr" class="internal xref">Multiple Accesses to the Credential Endpoint</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.4">
                <p id="section-toc.1-1.14.2.4.1"><a href="#section-14.4" class="auto internal xref">14.4</a>.  <a href="#name-relationship-between-the-cr" class="internal xref">Relationship between the Credential Issuer Identifier in the Metadata and the Issuer Identifier in the Issued Credential</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.5">
                <p id="section-toc.1-1.14.2.5.1"><a href="#section-14.5" class="auto internal xref">14.5</a>.  <a href="#name-refreshing-issued-credentia" class="internal xref">Refreshing Issued Credentials</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.6">
                <p id="section-toc.1-1.14.2.6.1"><a href="#section-14.6" class="auto internal xref">14.6</a>.  <a href="#name-batch-issuing-credentials" class="internal xref">Batch Issuing Credentials</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.7">
                <p id="section-toc.1-1.14.2.7.1"><a href="#section-14.7" class="auto internal xref">14.7</a>.  <a href="#name-pre-final-specifications" class="internal xref">Pre-Final Specifications</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="auto internal xref">15</a>. <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-15.1" class="auto internal xref">15.1</a>.  <a href="#name-user-consent" class="internal xref">User Consent</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-15.2" class="auto internal xref">15.2</a>.  <a href="#name-minimum-disclosure" class="internal xref">Minimum Disclosure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a href="#section-15.3" class="auto internal xref">15.3</a>.  <a href="#name-storage-of-the-credentials" class="internal xref">Storage of the Credentials</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.4">
                <p id="section-toc.1-1.15.2.4.1"><a href="#section-15.4" class="auto internal xref">15.4</a>.  <a href="#name-correlation" class="internal xref">Correlation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.4.2.1">
                    <p id="section-toc.1-1.15.2.4.2.1.1"><a href="#section-15.4.1" class="auto internal xref">15.4.1</a>.  <a href="#name-unique-values-encoded-in-th" class="internal xref">Unique Values Encoded in the Credential</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.4.2.2">
                    <p id="section-toc.1-1.15.2.4.2.2.1"><a href="#section-15.4.2" class="auto internal xref">15.4.2</a>.  <a href="#name-credential-offer-3" class="internal xref">Credential Offer</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.4.2.3">
                    <p id="section-toc.1-1.15.2.4.2.3.1"><a href="#section-15.4.3" class="auto internal xref">15.4.3</a>.  <a href="#name-authorization-request-2" class="internal xref">Authorization Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.4.2.4">
                    <p id="section-toc.1-1.15.2.4.2.4.1"><a href="#section-15.4.4" class="auto internal xref">15.4.4</a>.  <a href="#name-wallet-attestation-subject" class="internal xref">Wallet Attestation Subject</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.5">
                <p id="section-toc.1-1.15.2.5.1"><a href="#section-15.5" class="auto internal xref">15.5</a>.  <a href="#name-identifying-the-credential-" class="internal xref">Identifying the Credential Issuer</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.6">
                <p id="section-toc.1-1.15.2.6.1"><a href="#section-15.6" class="auto internal xref">15.6</a>.  <a href="#name-identifying-the-wallet" class="internal xref">Identifying the Wallet</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.7">
                <p id="section-toc.1-1.15.2.7.1"><a href="#section-15.7" class="auto internal xref">15.7</a>.  <a href="#name-untrusted-wallets" class="internal xref">Untrusted Wallets</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-16" class="auto internal xref">16</a>. <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-17" class="auto internal xref">17</a>. <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-credential-format-profiles" class="internal xref">Credential Format Profiles</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.1">
                <p id="section-toc.1-1.18.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-w3c-verifiable-credentials" class="internal xref">W3C Verifiable Credentials</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.1.2.1">
                    <p id="section-toc.1-1.18.2.1.2.1.1"><a href="#appendix-A.1.1" class="auto internal xref">A.1.1</a>.  <a href="#name-vc-signed-as-a-jwt-not-usin" class="internal xref">VC Signed as a JWT, Not Using JSON-LD</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.1.2.2">
                    <p id="section-toc.1-1.18.2.1.2.2.1"><a href="#appendix-A.1.2" class="auto internal xref">A.1.2</a>.  <a href="#name-vc-secured-using-data-integ" class="internal xref">VC Secured using Data Integrity, using JSON-LD, with a Proof Suite Requiring Linked Data Canonicalization</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.1.2.3">
                    <p id="section-toc.1-1.18.2.1.2.3.1"><a href="#appendix-A.1.3" class="auto internal xref">A.1.3</a>.  <a href="#name-vc-signed-as-a-jwt-using-js" class="internal xref">VC signed as a JWT, Using JSON-LD</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.2">
                <p id="section-toc.1-1.18.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-mobile-documents-or-mdocs-i" class="internal xref">Mobile Documents or mdocs (ISO/IEC 18013)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.2.2.1">
                    <p id="section-toc.1-1.18.2.2.2.1.1"><a href="#appendix-A.2.1" class="auto internal xref">A.2.1</a>.  <a href="#name-format-identifier-4" class="internal xref">Format Identifier</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.2.2.2">
                    <p id="section-toc.1-1.18.2.2.2.2.1"><a href="#appendix-A.2.2" class="auto internal xref">A.2.2</a>.  <a href="#name-credential-issuer-metadata-5" class="internal xref">Credential Issuer Metadata</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.2.2.3">
                    <p id="section-toc.1-1.18.2.2.2.3.1"><a href="#appendix-A.2.3" class="auto internal xref">A.2.3</a>.  <a href="#name-authorization-details-4" class="internal xref">Authorization Details</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.2.2.4">
                    <p id="section-toc.1-1.18.2.2.2.4.1"><a href="#appendix-A.2.4" class="auto internal xref">A.2.4</a>.  <a href="#name-credential-response-5" class="internal xref">Credential Response</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.3">
                <p id="section-toc.1-1.18.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-ietf-sd-jwt-vc" class="internal xref">IETF SD-JWT VC</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.3.2.1">
                    <p id="section-toc.1-1.18.2.3.2.1.1"><a href="#appendix-A.3.1" class="auto internal xref">A.3.1</a>.  <a href="#name-format-identifier-5" class="internal xref">Format Identifier</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.3.2.2">
                    <p id="section-toc.1-1.18.2.3.2.2.1"><a href="#appendix-A.3.2" class="auto internal xref">A.3.2</a>.  <a href="#name-credential-issuer-metadata-6" class="internal xref">Credential Issuer Metadata</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.3.2.3">
                    <p id="section-toc.1-1.18.2.3.2.3.1"><a href="#appendix-A.3.3" class="auto internal xref">A.3.3</a>.  <a href="#name-authorization-details-5" class="internal xref">Authorization Details</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.3.2.4">
                    <p id="section-toc.1-1.18.2.3.2.4.1"><a href="#appendix-A.3.4" class="auto internal xref">A.3.4</a>.  <a href="#name-credential-response-6" class="internal xref">Credential Response</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-claims-description" class="internal xref">Claims Description</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.1">
                <p id="section-toc.1-1.19.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-claims-description-for-auth" class="internal xref">Claims Description for Authorization Details</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.2">
                <p id="section-toc.1-1.19.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-claims-description-for-issu" class="internal xref">Claims Description for Issuer Metadata</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.3">
                <p id="section-toc.1-1.19.2.3.1"><a href="#appendix-B.3" class="auto internal xref">B.3</a>.  <a href="#name-processing-rules-for-claims" class="internal xref">Processing Rules for Claims Description Objects</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-claims-path-pointer" class="internal xref">Claims Path Pointer</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.1">
                <p id="section-toc.1-1.20.2.1.1"><a href="#appendix-C.1" class="auto internal xref">C.1</a>.  <a href="#name-semantics-for-json-based-cr" class="internal xref">Semantics for JSON-based credentials</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.1.2.1">
                    <p id="section-toc.1-1.20.2.1.2.1.1"><a href="#appendix-C.1.1" class="auto internal xref">C.1.1</a>.  <a href="#name-processing" class="internal xref">Processing</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.2">
                <p id="section-toc.1-1.20.2.2.1"><a href="#appendix-C.2" class="auto internal xref">C.2</a>.  <a href="#name-semantics-for-iso-mdoc-base" class="internal xref">Semantics for ISO mdoc-based credentials</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.2.2.1">
                    <p id="section-toc.1-1.20.2.2.2.1.1"><a href="#appendix-C.2.1" class="auto internal xref">C.2.1</a>.  <a href="#name-processing-2" class="internal xref">Processing</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.3">
                <p id="section-toc.1-1.20.2.3.1"><a href="#appendix-C.3" class="auto internal xref">C.3</a>.  <a href="#name-claims-path-pointer-example" class="internal xref">Claims Path Pointer Example</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21">
            <p id="section-toc.1-1.21.1"><a href="#appendix-D" class="auto internal xref">Appendix D</a>.  <a href="#name-key-attestations" class="internal xref">Key Attestations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.1">
                <p id="section-toc.1-1.21.2.1.1"><a href="#appendix-D.1" class="auto internal xref">D.1</a>.  <a href="#name-key-attestation-in-jwt-form" class="internal xref">Key Attestation in JWT format</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.2">
                <p id="section-toc.1-1.21.2.2.1"><a href="#appendix-D.2" class="auto internal xref">D.2</a>.  <a href="#name-attack-potential-resistance" class="internal xref">Attack Potential Resistance</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22">
            <p id="section-toc.1-1.22.1"><a href="#appendix-E" class="auto internal xref">Appendix E</a>.  <a href="#name-wallet-attestations-in-jwt-" class="internal xref">Wallet Attestations in JWT format</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.23">
            <p id="section-toc.1-1.23.1"><a href="#appendix-F" class="auto internal xref">Appendix F</a>.  <a href="#name-proof-types" class="internal xref">Proof Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.23.2.1">
                <p id="section-toc.1-1.23.2.1.1"><a href="#appendix-F.1" class="auto internal xref">F.1</a>.  <a href="#name-jwt-proof-type" class="internal xref"><code>jwt</code> Proof Type</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.23.2.2">
                <p id="section-toc.1-1.23.2.2.1"><a href="#appendix-F.2" class="auto internal xref">F.2</a>.  <a href="#name-di_vp-proof-type" class="internal xref"><code>di_vp</code> Proof Type</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.23.2.3">
                <p id="section-toc.1-1.23.2.3.1"><a href="#appendix-F.3" class="auto internal xref">F.3</a>.  <a href="#name-attestation-proof-type" class="internal xref"><code>attestation</code> Proof Type</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.23.2.4">
                <p id="section-toc.1-1.23.2.4.1"><a href="#appendix-F.4" class="auto internal xref">F.4</a>.  <a href="#name-verifying-proof" class="internal xref">Verifying Proof</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24">
            <p id="section-toc.1-1.24.1"><a href="#appendix-G" class="auto internal xref">Appendix G</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.1">
                <p id="section-toc.1-1.24.2.1.1"><a href="#appendix-G.1" class="auto internal xref">G.1</a>.  <a href="#name-oauth-uri-registry" class="internal xref">OAuth URI Registry</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.1.2.1">
                    <p id="section-toc.1-1.24.2.1.2.1.1"><a href="#appendix-G.1.1" class="auto internal xref">G.1.1</a>.  <a href="#name-urnietfparamsoauthgrant-typ" class="internal xref">urn:ietf:params:oauth:grant-type:pre-authorized_code</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.2">
                <p id="section-toc.1-1.24.2.2.1"><a href="#appendix-G.2" class="auto internal xref">G.2</a>.  <a href="#name-oauth-parameters-registry" class="internal xref">OAuth Parameters Registry</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.2.2.1">
                    <p id="section-toc.1-1.24.2.2.2.1.1"><a href="#appendix-G.2.1" class="auto internal xref">G.2.1</a>.  <a href="#name-issuer_state" class="internal xref">issuer_state</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.2.2.2">
                    <p id="section-toc.1-1.24.2.2.2.2.1"><a href="#appendix-G.2.2" class="auto internal xref">G.2.2</a>.  <a href="#name-pre-authorized_code" class="internal xref">pre-authorized_code</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.2.2.3">
                    <p id="section-toc.1-1.24.2.2.2.3.1"><a href="#appendix-G.2.3" class="auto internal xref">G.2.3</a>.  <a href="#name-tx_code" class="internal xref">tx_code</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.3">
                <p id="section-toc.1-1.24.2.3.1"><a href="#appendix-G.3" class="auto internal xref">G.3</a>.  <a href="#name-oauth-authorization-server-" class="internal xref">OAuth Authorization Server Metadata Registry</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.3.2.1">
                    <p id="section-toc.1-1.24.2.3.2.1.1"><a href="#appendix-G.3.1" class="auto internal xref">G.3.1</a>.  <a href="#name-pre-authorized_grant_anonym" class="internal xref">pre-authorized_grant_anonymous_access_supported</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.4">
                <p id="section-toc.1-1.24.2.4.1"><a href="#appendix-G.4" class="auto internal xref">G.4</a>.  <a href="#name-oauth-dynamic-client-regist" class="internal xref">OAuth Dynamic Client Registration Metadata Registry</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.4.2.1">
                    <p id="section-toc.1-1.24.2.4.2.1.1"><a href="#appendix-G.4.1" class="auto internal xref">G.4.1</a>.  <a href="#name-credential_offer_endpoint" class="internal xref">credential_offer_endpoint</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.5">
                <p id="section-toc.1-1.24.2.5.1"><a href="#appendix-G.5" class="auto internal xref">G.5</a>.  <a href="#name-well-known-uri-registry" class="internal xref">Well-Known URI Registry</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.5.2.1">
                    <p id="section-toc.1-1.24.2.5.2.1.1"><a href="#appendix-G.5.1" class="auto internal xref">G.5.1</a>.  <a href="#name-well-known-openid-credentia" class="internal xref">.well-known/openid-credential-issuer</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.6">
                <p id="section-toc.1-1.24.2.6.1"><a href="#appendix-G.6" class="auto internal xref">G.6</a>.  <a href="#name-media-types-registry" class="internal xref">Media Types Registry</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.6.2.1">
                    <p id="section-toc.1-1.24.2.6.2.1.1"><a href="#appendix-G.6.1" class="auto internal xref">G.6.1</a>.  <a href="#name-application-openid4vci-proo" class="internal xref">application/openid4vci-proof+jwt</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.6.2.2">
                    <p id="section-toc.1-1.24.2.6.2.2.1"><a href="#appendix-G.6.2" class="auto internal xref">G.6.2</a>.  <a href="#name-application-key-attestation" class="internal xref">application/key-attestation+jwt</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.6.2.3">
                    <p id="section-toc.1-1.24.2.6.2.3.1"><a href="#appendix-G.6.3" class="auto internal xref">G.6.3</a>.  <a href="#name-application-openidvci-issue" class="internal xref">application/openidvci-issuer-metadata+jwt</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.7">
                <p id="section-toc.1-1.24.2.7.1"><a href="#appendix-G.7" class="auto internal xref">G.7</a>.  <a href="#name-uniform-resource-identifier" class="internal xref">Uniform Resource Identifier (URI) Schemes Registry</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.7.2.1">
                    <p id="section-toc.1-1.24.2.7.2.1.1"><a href="#appendix-G.7.1" class="auto internal xref">G.7.1</a>.  <a href="#name-openid-credential-offer" class="internal xref">openid-credential-offer</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25">
            <p id="section-toc.1-1.25.1"><a href="#appendix-H" class="auto internal xref">Appendix H</a>.  <a href="#name-use-cases" class="internal xref">Use Cases</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.1">
                <p id="section-toc.1-1.25.2.1.1"><a href="#appendix-H.1" class="auto internal xref">H.1</a>.  <a href="#name-credential-offer-same-devic" class="internal xref">Credential Offer - Same-Device</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.2">
                <p id="section-toc.1-1.25.2.2.1"><a href="#appendix-H.2" class="auto internal xref">H.2</a>.  <a href="#name-credential-offer-cross-devi" class="internal xref">Credential Offer - Cross-Device (with Information Pre-Submitted by the End-User)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.3">
                <p id="section-toc.1-1.25.2.3.1"><a href="#appendix-H.3" class="auto internal xref">H.3</a>.  <a href="#name-credential-offer-cross-devic" class="internal xref">Credential Offer - Cross-Device &amp; Deferred</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.4">
                <p id="section-toc.1-1.25.2.4.1"><a href="#appendix-H.4" class="auto internal xref">H.4</a>.  <a href="#name-wallet-initiated-issuance-d" class="internal xref">Wallet-Initiated Issuance during Presentation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.5">
                <p id="section-toc.1-1.25.2.5.1"><a href="#appendix-H.5" class="auto internal xref">H.5</a>.  <a href="#name-wallet-initiated-issuance-du" class="internal xref">Wallet-Initiated Issuance during Presentation (Requires Presentation of Additional Credentials During Issuance)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.6">
                <p id="section-toc.1-1.25.2.6.1"><a href="#appendix-H.6" class="auto internal xref">H.6</a>.  <a href="#name-wallet-initiated-issuance-a" class="internal xref">Wallet-Initiated Issuance after Installation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.26">
            <p id="section-toc.1-1.26.1"><a href="#appendix-I" class="auto internal xref">Appendix I</a>.  <a href="#name-additional-examples" class="internal xref">Additional Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.26.2.1">
                <p id="section-toc.1-1.26.2.1.1"><a href="#appendix-I.1" class="auto internal xref">I.1</a>.  <a href="#name-credential-issuer-metadata-7" class="internal xref">Credential Issuer Metadata</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.26.2.2">
                <p id="section-toc.1-1.26.2.2.1"><a href="#appendix-I.2" class="auto internal xref">I.2</a>.  <a href="#name-wallet-attestation-jwt" class="internal xref">Wallet Attestation JWT</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.27">
            <p id="section-toc.1-1.27.1"><a href="#appendix-J" class="auto internal xref">Appendix J</a>.  <a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.28">
            <p id="section-toc.1-1.28.1"><a href="#appendix-K" class="auto internal xref">Appendix K</a>.  <a href="#name-notices" class="internal xref">Notices</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.29">
            <p id="section-toc.1-1.29.1"><a href="#appendix-L" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This specification defines an OAuth-protected API for the issuance of Verifiable Credentials. Credentials can be of any format, including, but not limited to, IETF SD-JWT VC <span>[<a href="#I-D.ietf-oauth-sd-jwt-vc" class="cite xref">I-D.ietf-oauth-sd-jwt-vc</a>]</span>, ISO mdoc <span>[<a href="#ISO.18013-5" class="cite xref">ISO.18013-5</a>]</span>, and W3C VCDM <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Verifiable Credentials are very similar to identity assertions, like ID Tokens in OpenID Connect <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>, in that they allow a Credential Issuer to assert End-User claims. A Verifiable Credential follows a pre-defined schema (the Credential type) and MAY be bound to a certain Holder, e.g., through Cryptographic Key Binding. Verifiable Credentials can be securely presented for the End-User to the RP, without the involvement of the Credential Issuer.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Access to this API is authorized using OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, i.e., the Wallet uses OAuth 2.0 to obtain authorization to receive Verifiable Credentials. This way the issuance process can benefit from the proven security, simplicity, and flexibility of OAuth 2.0 and existing OAuth 2.0 deployments and OpenID Connect OPs (see <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>) can be extended to become Credential Issuers.<a href="#section-1-3" class="pilcrow">¶</a></p>
<div id="errata-revisions">
<section id="section-1.1">
        <h3 id="name-errata-revisions">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-errata-revisions" class="section-name selfRef">Errata revisions</a>
        </h3>
<p id="section-1.1-1">The latest revision of this specification, incorporating any errata updates, is published at <a href="https://openid.net/specs/openid-4-verifiable-credential-issuance-1_0.html">openid-4-verifiable-credential-issuance-1_0</a>. The text of the final specification as approved will always be available at <a href="https://openid.net/specs/openid-4-verifiable-credential-issuance-1_0-final.html">openid-4-verifiable-credential-issuance-1_0-final</a>. When referring to this specification from other documents, it is recommended to reference <a href="https://openid.net/specs/openid-4-verifiable-credential-issuance-1_0.html">openid-4-verifiable-credential-issuance-1_0</a>.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="requirements-notation-and-conventions">
<section id="section-1.2">
        <h3 id="name-requirements-notation-and-c">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-requirements-notation-and-c" class="section-name selfRef">Requirements Notation and Conventions</a>
        </h3>
<p id="section-1.2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">This specification uses the terms "Access Token", "Authorization Endpoint", "Authorization Request", "Authorization Response", "Authorization Code Grant", "Authorization Server", "Client", "Client Authentication", "Client Identifier", "Grant Type", "Refresh Token", "Token Endpoint", "Token Request" and "Token Response" defined by OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, the terms "End-User", "Entity", and "Request Object" as defined by OpenID Connect Core <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>, the term "JSON Web Token (JWT)" defined by JSON Web Token (JWT) <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>, the term "JOSE Header" defined by JSON Web Signature (JWS) <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Base64url-encoded denotes the URL-safe base64 encoding without padding defined in Section 2 of <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">This specification also defines the following terms. In the case where a term has a definition that differs, the definition below is authoritative for this specification.<a href="#section-2-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-2-4">
        <dt id="section-2-4.1">Credential Dataset:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.2">A set of one or more claims about a subject, provided by a Credential Issuer.<a href="#section-2-4.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.3">Credential (or Verifiable Credential (VC)):</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.4">An instance of a Credential Configuration with a particular Credential Dataset, that is signed by an Issuer and can be cryptographically verified. An Issuer may provide multiple Credentials as separate instances of the same Credential Configuration and Credential Dataset but with different cryptographic values. In this specification, the term "Verifiable Credential" is also referred to as "Credential". It's important to note that the use of the term "Credential" here differs from its usage in <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span> and <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>. In this context, "Credential" specifically does not encompass other meanings such as passwords used for login credentials.<a href="#section-2-4.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.5">Credential Format:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.6">Data Model used to create and represent Credential information. This format defines how various pieces of data within a Verifiable Credential are organized and encoded, ensuring that the Verifiable Credential can be consistently understood, processed, and verified by different systems. The exact parameters required to use a Credential Format in the context of this specification are defined in the Credential Format Profile. Definitions of Credential Formats is out of scope for this specification. Examples for Credential Formats are IETF SD-JWT VC <span>[<a href="#I-D.ietf-oauth-sd-jwt-vc" class="cite xref">I-D.ietf-oauth-sd-jwt-vc</a>]</span>, ISO mdoc <span>[<a href="#ISO.18013-5" class="cite xref">ISO.18013-5</a>]</span>, and W3C VCDM <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span>.<a href="#section-2-4.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.7">Credential Format Profile:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.8">Set of parameters specific to individual Credential Formats. This specification provides Credential Format Profiles for IETF SD-JWT VC <span>[<a href="#I-D.ietf-oauth-sd-jwt-vc" class="cite xref">I-D.ietf-oauth-sd-jwt-vc</a>]</span>, ISO mdoc <span>[<a href="#ISO.18013-5" class="cite xref">ISO.18013-5</a>]</span>, and W3C VCDM <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span>, which can be found in the section <a href="#format-profiles" class="auto internal xref">Appendix A</a>. Additionally, other specifications or deployments can define their own Credential Format Profiles by utilizing the extension points defined in this specification.<a href="#section-2-4.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.9">Credential Format Identifier:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.10">An identifier to denote a specific Credential Format in the context of this specification. This identifier implies the use of parameters specific to the respective Credential Format Profile.<a href="#section-2-4.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.11">Credential Configuration:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.12">Credential Issuer's description of a particular kind of Credential that the Credential Issuer is offering to issue, along with metadata pertaining to the issuance process and the issued Credentials. Each Credential Configuration references a Credential Format and specifies the corresponding parameters given in the Credential Format Profile. It also includes information about how issuance of a described Credential be requested, information on cryptographic methods and algorithms supported for issuance, and display information to be used by the Wallet. A Credential Configuration is identified by a Credential Configuration Identifier string that is unique to an Issuer. Credential Issuer metadata includes one or more Credential Configurations.<a href="#section-2-4.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.13">Presentation:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.14">Data that is presented to a specific Verifier, derived from one or more Verifiable Credentials that can be from the same or different Credential Issuers. It can be of any Credential Format.<a href="#section-2-4.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.15">Credential Issuer (or Issuer):</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.16">An entity that issues Verifiable Credentials. In the context of this specification, the Credential Issuer acts as an OAuth 2.0 Resource Server (see <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>). The Credential Issuer might also act as an Authorization Server.<a href="#section-2-4.16" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.17">Holder:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.18">An entity that receives Verifiable Credentials and has control over them to present them to the Verifiers as Presentations.<a href="#section-2-4.18" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.19">Verifier:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.20">An entity that requests, receives, and validates Presentations.<a href="#section-2-4.20" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.21">Issuer-Holder-Verifier Model:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.22">Model that facilitates the exchange of claims, where claims are issued as Verifiable Credentials independently of the process of presenting them to Verifiers in the form of Presentations. An issued Verifiable Credential may be used multiple times, although this is not a requirement.<a href="#section-2-4.22" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.23">Holder Binding:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.24">Ability of the Holder to prove legitimate possession of a Verifiable Credential.<a href="#section-2-4.24" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.25">Cryptographic Holder Binding or Cryptographic Key Binding:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.26">Ability of the Holder to prove legitimate possession of a Verifiable Credential by proving control over the same private key during the issuance and presentation. The concrete mechanism depends on the Credential Format. For example, in IETF SD-JWT VC <span>[<a href="#I-D.ietf-oauth-sd-jwt-vc" class="cite xref">I-D.ietf-oauth-sd-jwt-vc</a>]</span>, the Issuer can enable this binding by including a public key or a reference to a public key that matches to the private key controlled by the Holder.<a href="#section-2-4.26" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.27">Claims-based Holder Binding:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.28">Ability of the Holder to prove legitimate possession of a Credential by proving certain claims, e.g., name and date of birth, for example by presenting another Credential. Claims-based Holder Binding allows long-term, cross-device use of a Credential as it does not depend on cryptographic key material stored on a certain device. One example of such a Credential could be a diploma.<a href="#section-2-4.28" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.29">Wallet:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.30">An entity used by the Holder to request, receive, store, present, and manage Verifiable Credentials and cryptographic key material. There is no single deployment model of a Wallet: Credentials and keys can be stored and managed either locally, through a remote self-hosted service, or via a remote third-party service. In the context of this specification, the Wallet acts as an OAuth 2.0 Client (see <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>) and obtains an Access Token to access an OAuth 2.0 Resource Server (Credential Endpoint).<a href="#section-2-4.30" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.31">Deferred Credential Issuance:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.32">Issuance of Credentials not directly in the response to a Credential issuance request but following a period of time that can be used to perform certain offline business processes.<a href="#section-2-4.32" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="overview">
<section id="section-3">
      <h2 id="name-overview">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<div id="credential-issuer">
<section id="section-3.1">
        <h3 id="name-credential-issuer">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-credential-issuer" class="section-name selfRef">Credential Issuer</a>
        </h3>
<p id="section-3.1-1">This specification defines an API for Credential issuance provided by a Credential Issuer. The API is comprised of the following endpoints:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.1-2.1">A mandatory Credential Endpoint from which Credentials can be issued (see <a href="#credential-endpoint" class="auto internal xref">Section 8</a>). From this endpoint, one Credential, or multiple Credentials with the same Credential Format and Credential Dataset can be issued in one request.<a href="#section-3.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.1-2.2">An optional Nonce Endpoint from which a fresh <code>c_nonce</code> value can be obtained to be used in proof of possession of key material in a subsequent request to the Credential Endpoint (see <a href="#nonce-endpoint" class="auto internal xref">Section 7</a>).<a href="#section-3.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.1-2.3">An optional Deferred Credential Endpoint to allow for the deferred delivery of Credentials (see <a href="#deferred-credential-issuance" class="auto internal xref">Section 9</a>).<a href="#section-3.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.1-2.4">An optional mechanism for the Credential Issuer to make a Credential Offer to the Wallet to encourage the Wallet to start the issuance flow (see <a href="#credential-offer-endpoint" class="auto internal xref">Section 4</a>).<a href="#section-3.1-2.4" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.1-2.5">An optional mechanism for the Credential Issuer to receive notification(s) from the Wallet about the status of the Credential(s) that have been issued (see <a href="#notification-endpoint" class="auto internal xref">Section 11</a>).<a href="#section-3.1-2.5" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.1-2.6">A mechanism for the Credential Issuer to publish metadata about the Credentials it is capable of issuing (see <a href="#credential-issuer-metadata" class="auto internal xref">Section 12.2</a>).<a href="#section-3.1-2.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.1-3">The Credential Endpoint may bind an issued Credential to specific cryptographic key material, in which case Credential requests include proof(s) of possession or attestations for the key material. Multiple key proof types are supported.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oauth-2-0">
<section id="section-3.2">
        <h3 id="name-oauth-20">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-oauth-20" class="section-name selfRef">OAuth 2.0</a>
        </h3>
<p id="section-3.2-1">According to the OAuth 2.0 framework, each Credential Issuer acts as a Resource Server that is protected by an Access Token issued by an Authorization Server, as defined in OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>. The same Authorization Server can protect one or more Credential Issuers. Wallets identify the Authorization Server for a Credential Issuer by referring to the Credential Issuer's metadata (see <a href="#credential-issuer-metadata" class="auto internal xref">Section 12.2</a>).<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">All OAuth 2.0 Grant Types and extensions mechanisms can be used in conjunction with the Credential issuance API. Aspects not defined in this specification are expected to follow <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">Existing OAuth 2.0 mechanisms are extended as follows:<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2-4.1">A new Grant Type "Pre-Authorized Code" is defined to facilitate flows where the preparation of the Credential issuance is conducted before the actual OAuth flow starts (see <a href="#pre-authz-code-flow" class="auto internal xref">Section 3.5</a>).<a href="#section-3.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.2-4.2">A new authorization details <span>[<a href="#RFC9396" class="cite xref">RFC9396</a>]</span> type <code>openid_credential</code> is defined to convey the details about the Credentials (including Credential Dataset, Credential Formats, and Credential types) the Wallet wants to obtain (see <a href="#authorization-details" class="auto internal xref">Section 5.1.1</a>).<a href="#section-3.2-4.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.2-4.3">Client metadata is used to convey the Wallet's metadata. The new Client metadata parameter <code>credential_offer_endpoint</code> is added to allow a Wallet (acting as OAuth 2.0 client) to publish its Credential Offer Endpoint (see <a href="#client-metadata" class="auto internal xref">Section 12.1</a>).<a href="#section-3.2-4.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.2-4.4">Authorization Endpoint: The additional parameter <code>issuer_state</code> is added to convey state in the context of processing an issuer-initiated Credential Offer (see <a href="#credential-authz-request" class="auto internal xref">Section 5.1</a>).<a href="#section-3.2-4.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="core-concepts">
<section id="section-3.3">
        <h3 id="name-core-concepts">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-core-concepts" class="section-name selfRef">Core Concepts</a>
        </h3>
<p id="section-3.3-1">In the context of this specification, Credential Datasets, Credential Format and Credential Format Profile are defined in <a href="#terminology" class="auto internal xref">Section 2</a>.
While in principle independent of each other, the Credential Dataset and the Credential Format can have a relationship in the sense that an Issuer may only offer certain Credential Formats for certain Credential Datasets.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">An End-User typically authorizes the issuance of Credentials with a specific Credential Dataset, but does not usually care about the Credential Format. The same Credential Dataset may even be issued in different Credential Formats or with multiple Credential instances.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<div id="credential-formats-and-credential-format-profiles">
<section id="section-3.3.1">
          <h4 id="name-credential-formats-and-cred">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-credential-formats-and-cred" class="section-name selfRef">Credential Formats and Credential Format Profiles</a>
          </h4>
<p id="section-3.3.1-1">This specification is Credential Format agnostic and allows implementers to leverage specific capabilities of Credential Formats of their choice.
To this end, extension points to add Credential Format specific parameters in the Credential Issuer metadata, Credential Offer, Authorization Request, and Credential Request are defined.<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2">Credential Format Profiles for IETF SD-JWT VC <span>[<a href="#I-D.ietf-oauth-sd-jwt-vc" class="cite xref">I-D.ietf-oauth-sd-jwt-vc</a>]</span>, ISO mdoc <span>[<a href="#ISO.18013-5" class="cite xref">ISO.18013-5</a>]</span>, and W3C VCDM <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span> are specified in <a href="#format-profiles" class="auto internal xref">Appendix A</a>.
Other specifications or deployments can define their own Credential Format Profiles using the above-mentioned extension points.<a href="#section-3.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="batch-credential-issuance">
<section id="section-3.3.2">
          <h4 id="name-batch-credential-issuance">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-batch-credential-issuance" class="section-name selfRef">Batch Credential Issuance</a>
          </h4>
<p id="section-3.3.2-1">This specification enables the issuance of Verifiable Credentials through the Credential Endpoint.
A single request to this endpoint may request the issuance of a batch of one or more Verifiable Credentials.<a href="#section-3.3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.3.2-2">Credentials can vary in their format, including Credential Format Profile-specific parameters, in their contents known as the Credential Dataset, and in the cryptographic data such as Issuer signatures, hashes, and keys used for Cryptographic Key Binding.
Credentials can therefore vary in the following dimensions:<a href="#section-3.3.2-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.3.2-3.1">Credential Format<a href="#section-3.3.2-3.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.3.2-3.2">Credential Dataset<a href="#section-3.3.2-3.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.3.2-3.3">Cryptographic Data<a href="#section-3.3.2-3.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.3.2-4">In the context of a single request, the batch of issued Credentials sent in response MUST share the same Credential Format and Credential Dataset, but SHOULD contain different Cryptographic Data. For example to achieve unlinkability between the Credentials, each credential should be bound to different cryptographic keys.<a href="#section-3.3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.3.2-5">To issue multiple Verifiable Credentials with differing Credential Formats or Credential Datasets, multiple requests MUST be sent to the Credential Endpoint.<a href="#section-3.3.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuance-flow-variations">
<section id="section-3.3.3">
          <h4 id="name-issuance-flow-variations">
<a href="#section-3.3.3" class="section-number selfRef">3.3.3. </a><a href="#name-issuance-flow-variations" class="section-name selfRef">Issuance Flow Variations</a>
          </h4>
<p id="section-3.3.3-1">The issuance can have multiple characteristics that can be combined depending on the use cases:<a href="#section-3.3.3-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.3.3-2.1">Authorization Code Flow or Pre-Authorized Code Flow: The Credential Issuer can obtain End-User information to turn into a Verifiable Credential using End-User authentication and consent at the Credential Issuer's Authorization Endpoint (Authorization Code Flow) or using out-of-band mechanisms outside of the issuance flow (Pre-Authorized Code Flow).<a href="#section-3.3.3-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.3.3-2.2">Wallet initiated or Issuer initiated: The request from the Wallet can be sent to the Credential Issuer without any gesture from the Credential Issuer (Wallet Initiated) or following the communication from the Credential Issuer (Issuer Initiated).<a href="#section-3.3.3-2.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.3.3-2.3">Same-device or Cross-device Credential Offer: The End-User may receive the Credential Offer from the Credential Issuer either on the same device as the device the Wallet resides on, or through any other means, such as another device or postal mail, so that the Credential Offer can be communicated to the Wallet.<a href="#section-3.3.3-2.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.3.3-2.4">Immediate or Deferred: The Credential Issuer can issue the Credential directly in response to the Credential Request (immediate) or requires time and needs the Wallet to come back to retrieve Credential (deferred).<a href="#section-3.3.3-2.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.3.3-3">The following subsections illustrate some of the authorization flows supported by this specification.<a href="#section-3.3.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="identifying_credential">
<section id="section-3.3.4">
          <h4 id="name-identifying-credentials-bei">
<a href="#section-3.3.4" class="section-number selfRef">3.3.4. </a><a href="#name-identifying-credentials-bei" class="section-name selfRef">Identifying Credentials Being Issued Throughout the Issuance Flow</a>
          </h4>
<p id="section-3.3.4-1">Below is the summary of how Credential(s) that are being issued are identified throughout the issuance flow:<a href="#section-3.3.4-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.3.4-2.1">In the Credential Offer, the Credential Issuer identifies offered Credential Configurations
using the <code>credential_configuration_ids</code> parameter.<a href="#section-3.3.4-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.3.4-2.2">When the Wallet uses Authorization Details in the Authorization Request, the Wallet uses
the <code>credential_configuration_id</code> parameter to identify the requested Credential Configurations.
The Authorization Server returns an <code>authorization_details</code> parameter containing
the <code>credential_identifiers</code> parameter in the Token Response,
and the Wallet uses those <code>credential_identifier</code> values in the Credential Request.<a href="#section-3.3.4-2.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.3.4-2.3">When the Wallet uses <code>scope</code> parameter in the Authorization Request, the <code>scope</code> value(s)
are used to identify requested Credential Configurations. In this case, the Authorization Server has two options.
If the Authorization Server supports returning <code>credential_identifiers</code> parameter
in the Token Response, it MAY do so, in which case the Wallet uses those <code>credential_identifier</code> values
in the Credential Request. If the Authorization Server does not support returning an <code>authorization_details</code> parameter containing the
<code>credential_identifiers</code> parameter in the Token Response, the Wallet uses <code>credential_configuration_id</code> parameter
in the Credential Request.<a href="#section-3.3.4-2.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="authorization-code-flow">
<section id="section-3.4">
        <h3 id="name-authorization-code-flow">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-authorization-code-flow" class="section-name selfRef">Authorization Code Flow</a>
        </h3>
<p id="section-3.4-1">The Authorization Code Flow uses the grant type <code>authorization_code</code> as defined in <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> to issue Access Tokens.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">Figure 1 shows the Authorization Code Flows with the two variations that can be implemented for the issuance of Credentials, as outlined in this specification:<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.4-3.1">
            <strong>Wallet-initiated variation</strong>, described in <a href="#use-case-4" class="auto internal xref">Appendix H.4</a> or <a href="#use-case-6" class="auto internal xref">Appendix H.6</a>;<a href="#section-3.4-3.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.4-3.2">
            <strong>Issuer-initiated variation</strong>, described in <a href="#use-case-1" class="auto internal xref">Appendix H.1</a>.<a href="#section-3.4-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.4-4">Please note that the diagram does not illustrate all the optional features defined in this specification.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<span id="name-issuance-using-authorizatio"></span><figure id="figure-1">
          <div class="lang-ascii-art sourcecode" id="section-3.4-5.1">
<pre>+----------+    +-----------+        +----------------------+   +-------------------+
| End-User |    |   Wallet  |        | Authorization Server |   | Credential Issuer |
+----------+    +-----------+        +----------------------+   +-------------------+
      |               |                           |                        |
      | (1a) End-User |                           |                        |
      |  selects      |  (1b) Credential Offer    |                        |
      |  Credential--&gt;|  (credential type)        |                        |
      |               |&lt;---------------------------------------------------|
      |               |                           |                        |
      |               |  (2) Obtains Issuer's     |                        |
      |               |      Credential Issuer    |                        |
      |               |      metadata             |                        |
      |               |---------------------------------------------------&gt;|
      |               |                           |                        |
      |               |                           |  (3) Authorization     |
      |               |                           |      Request           |
      |               |                           |      (type(s) of       |
      |               |                           |      Credentials to    |
      |               |                           |      be issued)        |
      |               |--------------------------&gt;|                        |
      |               |                           |                        |
      |  End-User Authentication / Consent        |                        |
      |               |                           |  (4) Authorization     |
      |               |                           |      Response (code)   |
      |               |&lt;--------------------------|                        |
      |               |                           |                        |
      |               |                           |  (5) Token Request     |
      |               |                           |      (code)            |
      |               |--------------------------&gt;|      Token Response    |
      |               |                           |      (Access Token)    |
      |               |&lt;--------------------------|                        |
      |               |                           |                        |
      |               |  (6) Credential Request   |                        |
      |               |      (Access Token,       |                        |
      |               |       proof(s))           |                        |
      |               |---------------------------------------------------&gt;|
      |               |                           |                        |
      |               |      Credential Response  |                        |
      |               |      with Credential(s)   |                        |
      |               |      OR Transaction ID    |                        |
      |               |&lt;---------------------------------------------------|
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-issuance-using-authorizatio" class="selfRef">Issuance using Authorization Code Flow</a>
          </figcaption></figure>
<p id="section-3.4-6">(1a) The Wallet-initiated flow begins as the End-User requests a Credential via the Wallet from the Credential Issuer. The End-User either selects a Credential from a pre-configured list of Credentials ready to be issued, or alternatively, the Wallet gives guidance to the End-User to select a Credential from a Credential Issuer based on the information it received in the presentation request from a Verifier.<a href="#section-3.4-6" class="pilcrow">¶</a></p>
<p id="section-3.4-7">(1b) The Issuer-initiated flow begins as the Credential Issuer generates a Credential Offer for certain Credential(s) that it communicates to the Wallet, for example, as a QR code or as a URI. The Credential Offer contains the Credential Issuer's URL and the information about the Credential(s) being offered. This step is defined in <a href="#credential-offer" class="auto internal xref">Section 4.1</a>.<a href="#section-3.4-7" class="pilcrow">¶</a></p>
<p id="section-3.4-8">(2) The Wallet uses the Credential Issuer's URL to fetch the Credential Issuer metadata, as described in <a href="#credential-issuer-metadata" class="auto internal xref">Section 12.2</a>. The Wallet needs the metadata to learn the Credential types and formats that the Credential Issuer supports and to determine the Authorization Endpoint (OAuth 2.0 Authorization Server) as well as Credential Endpoint required to start the request. This specification supports configurations where the Credential Endpoint and the Authorization Endpoint are managed by either separate entities or a single entity.<a href="#section-3.4-8" class="pilcrow">¶</a></p>
<p id="section-3.4-9">(3) The Wallet sends an Authorization Request to the Authorization Endpoint. The Authorization Endpoint processes the Authorization Request, which typically includes authenticating the End-User and gathering End-User consent. Note: The Authorization Request may be sent as a Pushed Authorization Request.<a href="#section-3.4-9" class="pilcrow">¶</a></p>
<p id="section-3.4-10">(4) The Authorization Endpoint returns the Authorization Response with the Authorization Code upon successfully processing the Authorization Request.<a href="#section-3.4-10" class="pilcrow">¶</a></p>
<p id="section-3.4-11">Note: Steps (3) and (4) happen in the front channel, by redirecting the End-User via the User Agent. Those steps are defined in <a href="#authorization-endpoint" class="auto internal xref">Section 5</a>. The Authorization Server and the User Agent may exchange any further messages between the steps if required by the Authorization Server to authenticate the End-User. For example, the Authorization Server may request Credential presentation as a means to authenticate or identify the End-User during the issuance flow, as described in <a href="#use-case-5" class="auto internal xref">Appendix H.5</a>.<a href="#section-3.4-11" class="pilcrow">¶</a></p>
<p id="section-3.4-12">(5) The Wallet sends a Token Request to the Token Endpoint with the Authorization Code obtained in Step (4). The Token Endpoint returns an Access Token in the Token Response upon successfully validating the Authorization Code. This step happens in the back-channel communication (direct communication between two systems using HTTP requests and responses without using redirects through an intermediary such as a browser). This step is defined in <a href="#token-endpoint" class="auto internal xref">Section 6</a>.<a href="#section-3.4-12" class="pilcrow">¶</a></p>
<p id="section-3.4-13">(6) The Wallet sends a Credential Request to the Credential Issuer's Credential Endpoint with the Access Token and (optionally) the proof(s) of possession of the private key of a key pair to which the Credential Issuer should bind the issued Credential to. Upon successfully validating Access Token and proof(s), the Credential Issuer returns a Credential in the Credential Response. This step is defined in <a href="#credential-endpoint" class="auto internal xref">Section 8</a>.<a href="#section-3.4-13" class="pilcrow">¶</a></p>
<p id="section-3.4-14">If the Credential Issuer requires more time to issue a Credential, the Credential Issuer may return a Transaction ID and a time interval in the Credential Response. The Wallet may send a Deferred Credential Request with the Transaction ID to obtain a Credential after the specified time interval has passed, as defined in <a href="#deferred-credential-issuance" class="auto internal xref">Section 9</a>.<a href="#section-3.4-14" class="pilcrow">¶</a></p>
<p id="section-3.4-15">Note: This flow is based on OAuth 2.0 and the Authorization Code Grant type, but this specification can be used with other OAuth 2.0 grant types as well.<a href="#section-3.4-15" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pre-authz-code-flow">
<section id="section-3.5">
        <h3 id="name-pre-authorized-code-flow">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-pre-authorized-code-flow" class="section-name selfRef">Pre-Authorized Code Flow</a>
        </h3>
<p id="section-3.5-1">Figure 2 is a diagram of a Credential issuance using the Pre-Authorized Code Flow. In this flow, before initiating the flow with the Wallet, the Credential Issuer first conducts the steps required to prepare for Credential issuance, e.g., End-User authentication and authorization. Consequently, the Pre-Authorized Code is sent by the Credential Issuer to the Wallet. This flow does not use the Authorization Endpoint, and the Wallet exchanges the Pre-Authorized Code for the Access Token directly at the Token Endpoint. The Access Token is then used to request Credential issuance at the Credential Endpoint. See <a href="#use-case-2" class="auto internal xref">Appendix H.2</a> for the description of such a use case.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">How the End-User provides information required for the issuance of a requested Credential to the Credential Issuer and the business processes conducted by the Credential Issuer to prepare a Credential are out of scope of this specification.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<p id="section-3.5-3">This flow uses the OAuth 2.0 Grant Type <code>urn:ietf:params:oauth:grant-type:pre-authorized_code</code>, which is defined in <a href="#credential-offer-parameters" class="auto internal xref">Section 4.1.1</a>.<a href="#section-3.5-3" class="pilcrow">¶</a></p>
<p id="section-3.5-4">The following diagram is based on the Credential Issuer-initiated flow, as described in the use case in <a href="#use-case-2" class="auto internal xref">Appendix H.2</a>. Please note that it does not illustrate all the optional features outlined in this specification.<a href="#section-3.5-4" class="pilcrow">¶</a></p>
<span id="name-issuance-using-pre-authoriz"></span><figure id="figure-2">
          <div class="lang-ascii-art sourcecode" id="section-3.5-5.1">
<pre>+----------+   +-----------+           +----------------------+   +-------------------+
| End-User |   |   Wallet  |           | Authorization Server |   | Credential Issuer |
+----------+   +-----------+           +----------------------+   +-------------------+
      |              |                              |                       |
      |              |  (1) End-User provides       |                       |
      |              |      information required    |                       |
      |              |      for the issuance of     |                       |
      |              |      a certain Credential    |                       |
      |              |-----------------------------------------------------&gt;|
      |              |                              |                       |
      |              |  (2) Credential Offer        |                       |
      |              |      (Pre-Authorized Code)   |                       |
      |              |&lt;-----------------------------------------------------|
      |              |  (3) Obtains Issuer's        |                       |
      |              |      Credential Issuer       |                       |
      |              |      metadata                |                       |
      |              |-----------------------------------------------------&gt;|
      |   interacts  |                              |                       |
      |-------------&gt;|                              |                       |
      |              |                              |                       |
      |              |  (4) Token Request           |                       |
      |              |      (Pre-Authorized Code,   |                       |
      |              |       tx_code)               |                       |
      |              |-----------------------------&gt;|                       |
      |              |      Token Response          |                       |
      |              |      (access_token)          |                       |
      |              |&lt;-----------------------------|                       |
      |              |                              |                       |
      |              |  (5) Credential Request      |                       |
      |              |      (access_token, proof(s))|                       |
      |              |-----------------------------------------------------&gt;|
      |              |      Credential Response     |                       |
      |              |      (Credential(s))         |                       |
      |              |&lt;-----------------------------------------------------|
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-issuance-using-pre-authoriz" class="selfRef">Issuance using Pre-Authorized Code Flow</a>
          </figcaption></figure>
<p id="section-3.5-6">(1) The Credential Issuer successfully obtains consent and End-User data required for the issuance of a requested Credential from the End-User using an Issuer-specific business process.<a href="#section-3.5-6" class="pilcrow">¶</a></p>
<p id="section-3.5-7">(2) The flow defined in this specification begins as the Credential Issuer generates a Credential Offer for certain Credential(s) and communicates it to the Wallet, for example, as a QR code or as a URI. The Credential Offer contains the Credential Issuer's URL, the information about the Credential(s) being offered, and the Pre-Authorized Code. This step is defined in <a href="#credential-offer" class="auto internal xref">Section 4.1</a>.<a href="#section-3.5-7" class="pilcrow">¶</a></p>
<p id="section-3.5-8">(3) The Wallet uses the Credential Issuer's URL to fetch its metadata, as described in <a href="#credential-issuer-metadata" class="auto internal xref">Section 12.2</a>. The Wallet needs the metadata to learn the Credential types and formats that the Credential Issuer supports, and to determine the Token Endpoint (at the OAuth 2.0 Authorization Server) as well as the Credential Endpoint required to start the request.<a href="#section-3.5-8" class="pilcrow">¶</a></p>
<p id="section-3.5-9">(4) The Wallet sends the Pre-Authorized Code obtained in Step (2) in the Token Request to the Token Endpoint. The Wallet will additionally send a Transaction Code provided by the End-User, if it was required by the Credential Issuer. This step is defined in <a href="#token-endpoint" class="auto internal xref">Section 6</a>.<a href="#section-3.5-9" class="pilcrow">¶</a></p>
<p id="section-3.5-10">(5) This step is the same as Step (6) in the Authorization Code Flow.<a href="#section-3.5-10" class="pilcrow">¶</a></p>
<p id="section-3.5-11">It is important to note that anyone who possesses a valid Pre-Authorized Code, without further security measures, would be able to receive a VC from the Credential Issuer. Implementers MUST implement mitigations most suitable to the use case.<a href="#section-3.5-11" class="pilcrow">¶</a></p>
<p id="section-3.5-12">One such mechanism defined in this specification is the usage of Transaction Codes. The Credential Issuer indicates the usage of Transaction Codes in the Credential Offer and sends the Transaction Code to the End-User via a second channel different than the issuance flow. After the End-User provides the Transaction Code, the Wallet sends the Transaction Code within the Token Request, and the Authorization Server verifies the Transaction Code.<a href="#section-3.5-12" class="pilcrow">¶</a></p>
<p id="section-3.5-13">For more details and concrete mitigations, see <a href="#security-considerations-pre-authz-code" class="auto internal xref">Section 13.6</a>.<a href="#section-3.5-13" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="credential-offer-endpoint">
<section id="section-4">
      <h2 id="name-credential-offer-endpoint">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-credential-offer-endpoint" class="section-name selfRef">Credential Offer Endpoint</a>
      </h2>
<p id="section-4-1">This endpoint is used by a Credential Issuer that is already interacting with an End-User who wishes to initiate a Credential issuance. It is used to pass available information relevant for the Credential issuance to ensure a convenient and secure process.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="credential-offer">
<section id="section-4.1">
        <h3 id="name-credential-offer">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-credential-offer" class="section-name selfRef">Credential Offer</a>
        </h3>
<p id="section-4.1-1">The Credential Issuer makes a Credential Offer by allowing the End-User to invoke the Wallet using the Wallet's Credential Offer Endpoint defined in <a href="#client-metadata" class="auto internal xref">Section 12.1</a>. For example, by clicking a link and/or rendering a QR code containing the Credential Offer that the End-User can scan in a wallet or an arbitrary camera application.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">Credential Issuers MAY also communicate Credential Offers directly to a Wallet's backend, but any mechanism for doing so is currently outside the scope of this specification.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">The Credential Offer object, which is a JSON-encoded object with the Credential Offer parameters, can be sent by value or by reference.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">The Credential Offer contains a single URI query parameter, either <code>credential_offer</code> or <code>credential_offer_uri</code>:<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1-5.1">
            <code>credential_offer</code>: Object with the Credential Offer parameters. This MUST NOT be present when the <code>credential_offer_uri</code> parameter is present.<a href="#section-4.1-5.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.1-5.2">
            <code>credential_offer_uri</code>: String that is a URL using the <code>https</code> scheme referencing a resource containing a JSON object with the Credential Offer parameters. This MUST NOT be present when the <code>credential_offer</code> parameter is present.<a href="#section-4.1-5.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.1-6">For security considerations, see <a href="#credential-offer-security" class="auto internal xref">Section 13.5</a>.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<div id="credential-offer-parameters">
<section id="section-4.1.1">
          <h4 id="name-credential-offer-parameters">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-credential-offer-parameters" class="section-name selfRef">Credential Offer Parameters</a>
          </h4>
<p id="section-4.1.1-1">This specification defines the following parameters for the JSON-encoded Credential Offer object:<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1.1-2.1">
              <code>credential_issuer</code>: REQUIRED. The URL of the Credential Issuer, as defined in <a href="#credential-issuer-identifier" class="auto internal xref">Section 12.2.1</a>, from which the Wallet is requested to obtain one or more Credentials. The Wallet uses it to obtain the Credential Issuer's Metadata following the steps defined in <a href="#credential-issuer-wellknown" class="auto internal xref">Section 12.2.2</a>.<a href="#section-4.1.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-4.1.1-2.2">
              <code>credential_configuration_ids</code>: REQUIRED. A non-empty array of unique strings that each identify one of the keys in the name/value pairs stored in the <code>credential_configurations_supported</code> Credential Issuer metadata. The Wallet uses these string values to obtain the respective object that contains information about the Credential being offered as defined in <a href="#credential-issuer-parameters" class="auto internal xref">Section 12.2.4</a>. For example, these string values can be used to obtain <code>scope</code> values to be used in the Authorization Request.<a href="#section-4.1.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-4.1.1-2.3">
              <code>grants</code>: OPTIONAL. Object indicating to the Wallet the Grant Types the Credential Issuer's Authorization Server is prepared to process for this Credential Offer. Every grant is represented by a name/value pair. The name is the Grant Type identifier; the value is an object that contains parameters either determining the way the Wallet MUST use the particular grant and/or parameters the Wallet MUST send with the respective request(s). If <code>grants</code> is not present or is empty, the Wallet MUST determine the Grant Types the Credential Issuer's Authorization Server supports using the respective metadata. When multiple grants are present, it is at the Wallet's discretion which one to use.<a href="#section-4.1.1-2.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.1.1-3">Additional Credential Offer parameters MAY be defined and used.
The Wallet MUST ignore any unrecognized parameters.<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1.1-4">The following values are defined by this specification:<a href="#section-4.1.1-4" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1.1-5.1">
              <p id="section-4.1.1-5.1.1">Grant Type <code>authorization_code</code>:<a href="#section-4.1.1-5.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1.1-5.1.2.1">
                  <code>issuer_state</code>: OPTIONAL. String value created by the Credential Issuer and opaque to the Wallet that is used to bind the subsequent Authorization Request with a context set up during previous process steps. If the Wallet decides to use the Authorization Code Flow and received a value for this parameter, it MUST include it in the subsequent Authorization Request to the Authorization Server as the <code>issuer_state</code> parameter value.<a href="#section-4.1.1-5.1.2.1" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-4.1.1-5.1.2.2">
                  <code>authorization_server</code>: OPTIONAL string that the Wallet can use to identify the Authorization Server to use with this grant type when <code>authorization_servers</code> parameter in the Credential Issuer metadata has multiple entries. It MUST NOT be used otherwise. The value of this parameter MUST match with one of the values in the <code>authorization_servers</code> array obtained from the Credential Issuer metadata.<a href="#section-4.1.1-5.1.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="compact" id="section-4.1.1-5.2">
              <p id="section-4.1.1-5.2.1">Grant Type <code>urn:ietf:params:oauth:grant-type:pre-authorized_code</code>:<a href="#section-4.1.1-5.2.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1.1-5.2.2.1">
                  <code>pre-authorized_code</code>: REQUIRED. The code representing the Credential Issuer's authorization for the Wallet to obtain Credentials of a certain type. This code MUST be short lived and single use. If the Wallet decides to use the Pre-Authorized Code Flow, this parameter value MUST be included in the subsequent Token Request with the Pre-Authorized Code Flow.<a href="#section-4.1.1-5.2.2.1" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-4.1.1-5.2.2.2">
                  <p id="section-4.1.1-5.2.2.2.1"><code>tx_code</code>: OPTIONAL. Object indicating that a Transaction Code is required if present, even if empty. It describes the requirements for a Transaction Code, which the Authorization Server expects the End-User to present along with the Token Request in a Pre-Authorized Code Flow. If the Authorization Server does not expect a Transaction Code, this object is absent; this is the default. The Transaction Code is intended to bind the Pre-Authorized Code to a certain transaction to prevent replay of this code by an attacker that, for example, scanned the QR code while standing behind the legitimate End-User. It is RECOMMENDED to send the Transaction Code via a separate channel. If the Wallet decides to use the Pre-Authorized Code Flow, the Transaction Code value MUST be sent in the <code>tx_code</code> parameter with the respective Token Request as defined in <a href="#token-request" class="auto internal xref">Section 6.1</a>. If no <code>length</code>, <code>description</code>, or <code>input_mode</code> is given, this object MAY be empty.<a href="#section-4.1.1-5.2.2.2.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1.1-5.2.2.2.2.1">
                      <code>input_mode</code> : OPTIONAL. String specifying the input character set. Possible values are <code>numeric</code> (only digits) and <code>text</code> (any characters). The default is <code>numeric</code>.<a href="#section-4.1.1-5.2.2.2.2.1" class="pilcrow">¶</a>
</li>
                    <li class="compact" id="section-4.1.1-5.2.2.2.2.2">
                      <code>length</code>: OPTIONAL. Integer specifying the length of the Transaction Code. This helps the Wallet to render the input screen and improve the user experience.<a href="#section-4.1.1-5.2.2.2.2.2" class="pilcrow">¶</a>
</li>
                    <li class="compact" id="section-4.1.1-5.2.2.2.2.3">
                      <code>description</code>: OPTIONAL. String containing guidance for the Holder of the Wallet on how to obtain the Transaction Code, e.g., describing over which communication channel it is delivered. The Wallet is RECOMMENDED to display this description next to the Transaction Code input screen to improve the user experience. The length of the string MUST NOT exceed 300 characters. The <code>description</code> does not support internationalization, however the Issuer MAY detect the Holder's language by previous communication or an HTTP Accept-Language header within an HTTP GET request for a Credential Offer URI.<a href="#section-4.1.1-5.2.2.2.2.3" class="pilcrow">¶</a>
</li>
                  </ul>
</li>
                <li class="compact" id="section-4.1.1-5.2.2.3">
                  <code>authorization_server</code>: OPTIONAL string that the Wallet can use to identify the Authorization Server to use with this grant type when <code>authorization_servers</code> parameter in the Credential Issuer metadata has multiple entries. It MUST NOT be used otherwise. The value of this parameter MUST match with one of the values in the <code>authorization_servers</code> array obtained from the Credential Issuer metadata.<a href="#section-4.1.1-5.2.2.3" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-4.1.1-6">The following non-normative example shows a Credential Offer object where the Credential Issuer can offer the issuance of two different Credentials (which may even be of different formats):<a href="#section-4.1.1-6" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-4.1.1-7">
<pre>{
  "credential_issuer": "https://credential-issuer.example.com",
  "credential_configuration_ids": [
    "UniversityDegreeCredential",
    "org.iso.18013.5.1.mDL"
  ],
  "grants": {
    "urn:ietf:params:oauth:grant-type:pre-authorized_code": {
      "pre-authorized_code": "oaKazRN8I0IbtZ0C7JuMn5",
      "tx_code": {
        "length": 4,
        "input_mode": "numeric",
        "description": "Please provide the one-time code that was sent via e-mail"
      }
    }
  }
}
</pre><a href="#section-4.1.1-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sending-credential-offer-by-value-using-credential-offer-parameter">
<section id="section-4.1.2">
          <h4 id="name-sending-credential-offer-by">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-sending-credential-offer-by" class="section-name selfRef">Sending Credential Offer by Value Using <code>credential_offer</code> Parameter</a>
          </h4>
<p id="section-4.1.2-1">Below is a non-normative example of a Credential Offer passed by value (with line breaks within values for display purposes only):<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.2-2">
<pre>GET /credential_offer?
  credential_offer=%7B%22credential_issuer%22:%22https://credential-issuer.exam
  ple.com%22,%22credential_configuration_ids%22:%5B%22UniversityDegree_JWT%22,%
  22org.iso.18013.5.1.mDL%22%5D,%22grants%22:%7B%22urn:ietf:params:oauth:grant-
  type:pre-authorized_code%22:%7B%22pre-authorized_code%22:%22oaKazRN8I0IbtZ0C7
  JuMn5%22,%22tx_code%22:%7B%7D%7D%7D%7D
</pre><a href="#section-4.1.2-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1.2-3">The following is a non-normative example of a Credential Offer that can be included in a QR code or a link used to invoke a Wallet deployed as a native app (with line breaks within values for display purposes only):<a href="#section-4.1.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.2-4">
<pre>openid-credential-offer://?
  credential_offer=%7B%22credential_issuer%22:%22https://credential-issuer.exam
  ple.com%22,%22credential_configuration_ids%22:%5B%22org.iso.18013.5.1.mDL%22%
  5D,%22grants%22:%7B%22urn:ietf:params:oauth:grant-type:pre-authorized_code%22
  :%7B%22pre-authorized_code%22:%22oaKazRN8I0IbtZ0C7JuMn5%22,%22tx_code%22:%7B%
  22input_mode%22:%22text%22,%22description%22:%22Please%20enter%20the%20serial
  %20number%20of%20your%20physical%20drivers%20license%22%7D%7D%7D%7D
</pre><a href="#section-4.1.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sending-credential-offer-by-reference-using-credential-offer-uri-parameter">
<section id="section-4.1.3">
          <h4 id="name-sending-credential-offer-by-">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-sending-credential-offer-by-" class="section-name selfRef">Sending Credential Offer by Reference Using <code>credential_offer_uri</code> Parameter</a>
          </h4>
<p id="section-4.1.3-1">Upon receipt of the <code>credential_offer_uri</code>, the Wallet MUST send an HTTP GET request to the URI to retrieve the referenced Credential Offer Object, unless it is already cached, and parse it to recreate the Credential Offer parameters.<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
<p id="section-4.1.3-2">Note: The Credential Issuer SHOULD use a unique URI for each Credential Offer utilizing distinct parameters, or otherwise prevent the Credential Issuer from caching the <code>credential_offer_uri</code>.<a href="#section-4.1.3-2" class="pilcrow">¶</a></p>
<p id="section-4.1.3-3">Below is a non-normative example of this fetch process:<a href="#section-4.1.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.3-4">
<pre>GET /credential_offer HTTP/1.1
Host: server.example.com
</pre><a href="#section-4.1.3-4" class="pilcrow">¶</a>
</div>
<p id="section-4.1.3-5">The response from the Credential Issuer that contains a Credential Offer Object MUST use the media type <code>application/json</code>.<a href="#section-4.1.3-5" class="pilcrow">¶</a></p>
<p id="section-4.1.3-6">This ability to pass the Credential Offer by reference is particularly useful for large Credential Offer objects.<a href="#section-4.1.3-6" class="pilcrow">¶</a></p>
<p id="section-4.1.3-7">When the Credential Offer is displayed as a QR code, it would usually contain the Credential Offer by reference due to the size limitations of the QR codes. Below is a non-normative example:<a href="#section-4.1.3-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.3-8">
<pre>openid-credential-offer://?
  credential_offer_uri=https%3A%2F%2Fserver%2Eexample%2Ecom%2Fcredential-offer
  %2FGkurKxf5T0Y-mnPFCHqWOMiZi4VS138cQO_V7PZHAdM
</pre><a href="#section-4.1.3-8" class="pilcrow">¶</a>
</div>
<p id="section-4.1.3-9">Below is a non-normative example of a response from the Credential Issuer that contains a Credential Offer Object used to encourage the Wallet to start an Authorization Code Flow:<a href="#section-4.1.3-9" class="pilcrow">¶</a></p>
<div class="lang-txt sourcecode" id="section-4.1.3-10">
<pre>HTTP/1.1 200 OK
Content-Type: application/json

{
  "credential_issuer": "https://credential-issuer.example.com",
  "credential_configuration_ids": [
    "UniversityDegreeCredential"
  ],
  "grants": {
    "authorization_code": {
      "issuer_state": "eyJhbGciOiJSU0Et...FYUaBy"
    }
  }
}
</pre><a href="#section-4.1.3-10" class="pilcrow">¶</a>
</div>
<p id="section-4.1.3-11">Below is a non-normative example of a Credential Offer Object for a Pre-Authorized Code Flow (with a Credential type reference):<a href="#section-4.1.3-11" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-4.1.3-12">
<pre>{
  "credential_issuer": "https://credential-issuer.example.com",
  "credential_configuration_ids": [
    "UniversityDegree_LDP_VC"
  ],
  "grants": {
    "urn:ietf:params:oauth:grant-type:pre-authorized_code": {
      "pre-authorized_code": "adhjhdjajkdkhjhdj",
      "tx_code": {}
    }
  }
}
</pre><a href="#section-4.1.3-12" class="pilcrow">¶</a>
</div>
<p id="section-4.1.3-13">When retrieving the Credential Offer from the Credential Offer URL, the <code>application/json</code> media type MUST be used. The Credential Offer cannot be signed and MUST NOT use <code>application/jwt</code> with <code>"alg": "none"</code>.<a href="#section-4.1.3-13" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="credential-offer-response">
<section id="section-4.2">
        <h3 id="name-credential-offer-response">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-credential-offer-response" class="section-name selfRef">Credential Offer Response</a>
        </h3>
<p id="section-4.2-1">The Wallet does not create a response. UX control stays with the Wallet after completion of the process.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="authorization-endpoint">
<section id="section-5">
      <h2 id="name-authorization-endpoint">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-authorization-endpoint" class="section-name selfRef">Authorization Endpoint</a>
      </h2>
<p id="section-5-1">The Authorization Endpoint is used in the same manner as defined in <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>. Implementers SHOULD follow the best current practices for OAuth 2.0 Security given in <span>[<a href="#BCP240" class="cite xref">BCP240</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">When the grant type <code>authorization_code</code> is used, it is RECOMMENDED to use PKCE <span>[<a href="#RFC7636" class="cite xref">RFC7636</a>]</span> and Pushed Authorization Requests <span>[<a href="#RFC9126" class="cite xref">RFC9126</a>]</span>. PKCE prevents authorization code interception attacks. Pushed Authorization Requests ensure the integrity and authenticity of the authorization request.<a href="#section-5-2" class="pilcrow">¶</a></p>
<div id="credential-authz-request">
<section id="section-5.1">
        <h3 id="name-authorization-request">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-authorization-request" class="section-name selfRef">Authorization Request</a>
        </h3>
<p id="section-5.1-1">An Authorization Request is an OAuth 2.0 Authorization Request as defined in Section 4.1.1 of <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, which requests that access be granted to the Credential Endpoint, as defined in <a href="#credential-endpoint" class="auto internal xref">Section 8</a>.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">There are two possible methods for requesting the issuance of a specific Credential type in an Authorization Request. The first method involves using the <code>authorization_details</code> request parameter, as defined in <span>[<a href="#RFC9396" class="cite xref">RFC9396</a>]</span>, containing one or more authorization details of type <code>openid_credential</code>, as specified in <a href="#authorization-details" class="auto internal xref">Section 5.1.1</a>. The second method utilizes scopes, as outlined in <a href="#credential-request-using-type-specific-scope" class="auto internal xref">Section 5.1.2</a>.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">See <a href="#identifying_credential" class="auto internal xref">Section 3.3.4</a> for the summary of the options how requested Credential(s) are identified throughout the Issuance flow.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<div id="authorization-details">
<section id="section-5.1.1">
          <h4 id="name-using-authorization-details">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-using-authorization-details" class="section-name selfRef">Using Authorization Details Parameter</a>
          </h4>
<p id="section-5.1.1-1">Credential Issuers MAY support requesting authorization to issue a Credential using the <code>authorization_details</code> parameter.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2">The request parameter <code>authorization_details</code> defined in Section 2 of <span>[<a href="#RFC9396" class="cite xref">RFC9396</a>]</span> MUST be used to convey the details about the Credentials the Wallet wants to obtain. This specification introduces a new authorization details type <code>openid_credential</code> and defines the following parameters to be used with this authorization details type:<a href="#section-5.1.1-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.1.1-3.1">
              <code>type</code>: REQUIRED. String that determines the authorization details type. It MUST be set to <code>openid_credential</code> for the purpose of this specification.<a href="#section-5.1.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5.1.1-3.2">
              <code>credential_configuration_id</code>: REQUIRED. String specifying a unique identifier of the Credential being described in the <code>credential_configurations_supported</code> map in the Credential Issuer Metadata as defined in <a href="#credential-issuer-parameters" class="auto internal xref">Section 12.2.4</a>. The referenced object in the <code>credential_configurations_supported</code> map conveys the details of the requested Credential, such as the format and format-specific parameters like <code>vct</code> for SD-JWT VC or <code>doctype</code> for ISO mdoc. This specification defines those Credential Format specific Issuer Metadata in <a href="#format-profiles" class="auto internal xref">Appendix A</a>.<a href="#section-5.1.1-3.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5.1.1-3.3">
              <code>claims</code>: OPTIONAL. A non-empty array of claims description objects as defined in <a href="#claims-description-authorization-details" class="auto internal xref">Appendix B.1</a>.<a href="#section-5.1.1-3.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.1.1-4">Additional <code>authorization_details</code> data fields MAY be defined and used when the <code>type</code> value is <code>openid_credential</code>.
Note that this effectively defines an authorization details type that is never considered invalid due to unknown fields.<a href="#section-5.1.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1.1-5">The following is a non-normative example of an <code>authorization_details</code> object with a <code>credential_configuration_id</code>:<a href="#section-5.1.1-5" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-5.1.1-6">
<pre>[
  {
    "type": "openid_credential",
    "credential_configuration_id": "UniversityDegreeCredential"
  }
]
</pre><a href="#section-5.1.1-6" class="pilcrow">¶</a>
</div>
<p id="section-5.1.1-7">If the Credential Issuer metadata contains an <code>authorization_servers</code> parameter, the authorization detail's <code>locations</code> common data field MUST be set to the Credential Issuer Identifier value. A non-normative example for a deployment where an Authorization Server protects multiple Credential Issuers would look like this:<a href="#section-5.1.1-7" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-5.1.1-8">
<pre>[
  {
    "type": "openid_credential",
    "locations": [
      "https://credential-issuer.example.com"
    ],
    "credential_configuration_id": "UniversityDegreeCredential"
  }
]
</pre><a href="#section-5.1.1-8" class="pilcrow">¶</a>
</div>
<p id="section-5.1.1-9">Below is a non-normative example of an Authorization Request using the <code>authorization_details</code> parameter that would be sent by the User Agent to the Authorization Server in response to an HTTP 302 redirect response by the Wallet (with line breaks within values for display purposes only):<a href="#section-5.1.1-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.1-10">
<pre>GET /authorize?
  response_type=code
  &amp;client_id=s6BhdRkqt3
  &amp;code_challenge=E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM
  &amp;code_challenge_method=S256
  &amp;authorization_details=%5B%7B%22type%22%3A%20%22openid_credential%22%2C%20%22
    credential_configuration_id%22%3A%20%22UniversityDegreeCredential%22%7D%5D
  &amp;redirect_uri=https%3A%2F%2Fwallet.example.org%2Fcb

Host: server.example.com
</pre><a href="#section-5.1.1-10" class="pilcrow">¶</a>
</div>
<p id="section-5.1.1-11">This non-normative example requests authorization to issue two different Credentials:<a href="#section-5.1.1-11" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-5.1.1-12">
<pre>[
  {
    "type": "openid_credential",
    "credential_configuration_id": "UniversityDegreeCredential"
  },
  {
    "type": "openid_credential",
    "credential_configuration_id": "org.iso.18013.5.1.mDL"
  }
]
</pre><a href="#section-5.1.1-12" class="pilcrow">¶</a>
</div>
<p id="section-5.1.1-13">Note: Applications MAY combine authorization details of type <code>openid_credential</code> with any other authorization details types in an Authorization Request.<a href="#section-5.1.1-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credential-request-using-type-specific-scope">
<section id="section-5.1.2">
          <h4 id="name-using-scope-parameter-to-re">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-using-scope-parameter-to-re" class="section-name selfRef">Using <code>scope</code> Parameter to Request Issuance of a Credential</a>
          </h4>
<p id="section-5.1.2-1">Credential Issuers MAY support requesting authorization to issue a Credential using the OAuth 2.0 <code>scope</code> parameter.<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<p id="section-5.1.2-2">When the Wallet does not know which scope value to use to request issuance of a certain Credential, it can discover it using the <code>scope</code> Credential Issuer metadata parameter defined in <a href="#credential-issuer-parameters" class="auto internal xref">Section 12.2.4</a>. When the flow starts with a Credential Offer, the Wallet can use the <code>credential_configuration_ids</code> parameter values to identify object(s) in the <code>credential_configurations_supported</code> map in the Credential Issuer metadata parameter and use the <code>scope</code> parameter value from that object.<a href="#section-5.1.2-2" class="pilcrow">¶</a></p>
<p id="section-5.1.2-3">The Wallet can discover the scope values using other options such as normative text in a profile of this specification that defines scope values along with a description of their semantics.<a href="#section-5.1.2-3" class="pilcrow">¶</a></p>
<p id="section-5.1.2-4">The concrete <code>scope</code> values are out of scope of this specification.<a href="#section-5.1.2-4" class="pilcrow">¶</a></p>
<p id="section-5.1.2-5">The Wallet MAY combine scopes discovered from the Credential Issuer metadata with the scopes discovered from the Authorization Server metadata.<a href="#section-5.1.2-5" class="pilcrow">¶</a></p>
<p id="section-5.1.2-6">It is RECOMMENDED to use collision-resistant scope values.<a href="#section-5.1.2-6" class="pilcrow">¶</a></p>
<p id="section-5.1.2-7">Credential Issuers MUST interpret each scope value as a request to access the Credential Endpoint as defined in <a href="#credential-endpoint" class="auto internal xref">Section 8</a> for the issuance of a Credential type identified by that scope value. Multiple scope values MAY be present in a single request whereby each
occurrence MUST be interpreted individually.<a href="#section-5.1.2-7" class="pilcrow">¶</a></p>
<p id="section-5.1.2-8">Credential Issuers MUST ignore unknown scope values in a request.<a href="#section-5.1.2-8" class="pilcrow">¶</a></p>
<p id="section-5.1.2-9">If the Credential Issuer metadata contains an <code>authorization_servers</code> property, it is RECOMMENDED to use a <code>resource</code> parameter <span>[<a href="#RFC8707" class="cite xref">RFC8707</a>]</span> whose value is the Credential Issuer's identifier value to allow the Authorization Server to differentiate Credential Issuers.<a href="#section-5.1.2-9" class="pilcrow">¶</a></p>
<p id="section-5.1.2-10">Below is a non-normative example of an Authorization Request provided by the Wallet to the Authorization Server using the scope <code>UniversityDegreeCredential</code> and in response to an HTTP 302 redirect (with line breaks within values for display purposes only):<a href="#section-5.1.2-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.2-11">
<pre>GET /authorize?
  response_type=code
  &amp;scope=UniversityDegreeCredential
  &amp;resource=https%3A%2F%2Fcredential-issuer.example.com
  &amp;client_id=s6BhdRkqt3
  &amp;code_challenge=E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM
  &amp;code_challenge_method=S256
  &amp;redirect_uri=https%3A%2F%2Fwallet.example.org%2Fcb
Host: server.example.com
</pre><a href="#section-5.1.2-11" class="pilcrow">¶</a>
</div>
<p id="section-5.1.2-12">If a scope value related to Credential issuance and the <code>authorization_details</code> request parameter containing objects of type <code>openid_credential</code> are both present in a single request, the Credential Issuer MUST interpret these individually. However, if both request the same Credential type, then the Credential Issuer MUST follow the request as given by the authorization details object.<a href="#section-5.1.2-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="additional-request-parameters">
<section id="section-5.1.3">
          <h4 id="name-additional-request-paramete">
<a href="#section-5.1.3" class="section-number selfRef">5.1.3. </a><a href="#name-additional-request-paramete" class="section-name selfRef">Additional Request Parameters</a>
          </h4>
<p id="section-5.1.3-1">This specification defines the following request parameter that can be supplied in an Authorization Request:<a href="#section-5.1.3-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.1.3-2.1">
              <code>issuer_state</code>: OPTIONAL. String value identifying a certain processing context at the Credential Issuer. A value for this parameter is typically passed in a Credential Offer from the Credential Issuer to the Wallet (see <a href="#credential-offer" class="auto internal xref">Section 4.1</a>). This request parameter is used to pass the <code>issuer_state</code> value back to the Credential Issuer.<a href="#section-5.1.3-2.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.1.3-3">Note: When processing the Authorization Request, the Credential Issuer MUST take into account that the <code>issuer_state</code> is not guaranteed to originate from this Credential Issuer in all circumstances. It could have been injected by an attacker.<a href="#section-5.1.3-3" class="pilcrow">¶</a></p>
<p id="section-5.1.3-4">Additional Authorization Request parameters MAY be defined and used,
as described in <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.
The Authorization Server MUST ignore any unrecognized parameters.<a href="#section-5.1.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pushed-authorization-request">
<section id="section-5.1.4">
          <h4 id="name-pushed-authorization-reques">
<a href="#section-5.1.4" class="section-number selfRef">5.1.4. </a><a href="#name-pushed-authorization-reques" class="section-name selfRef">Pushed Authorization Request</a>
          </h4>
<p id="section-5.1.4-1">Use of Pushed Authorization Requests is RECOMMENDED to ensure confidentiality, integrity, and authenticity of the request data and to avoid issues caused by large requests sizes.<a href="#section-5.1.4-1" class="pilcrow">¶</a></p>
<p id="section-5.1.4-2">Below is a non-normative example of a Pushed Authorization Request:<a href="#section-5.1.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.4-3">
<pre>POST /par HTTP/1.1
Host: server.example.com
OAuth-Client-Attestation: eyJ...
OAuth-Client-Attestation-PoP: eyJ...
Content-Type: application/x-www-form-urlencoded

response_type=code
&amp;client_id=CLIENT1234
&amp;code_challenge=E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM
&amp;code_challenge_method=S256
&amp;redirect_uri=https%3A%2F%2Fwallet.example.org%2Fcb
&amp;authorization_details=...
</pre><a href="#section-5.1.4-3" class="pilcrow">¶</a>
</div>
<p id="section-5.1.4-4">Below is a non-normative example of a response to a successful request:<a href="#section-5.1.4-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.4-5">
<pre>HTTP/1.1 201 Created
Content-Type: application/json
Cache-Control: no-cache, no-store

{
  "request_uri": "urn:ietf:params:oauth:request_uri:6esc_11ACC5bwc014ltc14eY22c",
  "expires_in": 60
}
</pre><a href="#section-5.1.4-5" class="pilcrow">¶</a>
</div>
<p id="section-5.1.4-6">Below is a non-normative example of the GET request that might subsequently be sent by the Browser:<a href="#section-5.1.4-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.4-7">
<pre>GET /authorize?client_id=s6BhdRkqt3
  &amp;request_uri=urn%3Aietf%3Aparams%3Aoauth%3Arequest_uri%3A6esc_11ACC5bwc014ltc14eY22c
Host: server.example.com
</pre><a href="#section-5.1.4-7" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="authorization-response">
<section id="section-5.2">
        <h3 id="name-successful-authorization-re">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-successful-authorization-re" class="section-name selfRef">Successful Authorization Response</a>
        </h3>
<p id="section-5.2-1">Authorization Responses MUST be made as defined in <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">Below is a non-normative example of a successful Authorization Response:<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-3">
<pre>HTTP/1.1 302 Found
Location: https://wallet.example.org/cb?
  code=SplxlOBeZQQYbYS6WxSbIA
</pre><a href="#section-5.2-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authorization-error-response">
<section id="section-5.3">
        <h3 id="name-authorization-error-respons">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-authorization-error-respons" class="section-name selfRef">Authorization Error Response</a>
        </h3>
<p id="section-5.3-1">The Authorization Error Response MUST be made as defined in <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">Below is a non-normative example of an unsuccessful Authorization Response:<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-3">
<pre>HTTP/1.1 302 Found
Location: https://wallet.example.org/cb?
  error=invalid_request
  &amp;error_description=Unsupported%20response_type%20value
</pre><a href="#section-5.3-3" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="token-endpoint">
<section id="section-6">
      <h2 id="name-token-endpoint">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-token-endpoint" class="section-name selfRef">Token Endpoint</a>
      </h2>
<p id="section-6-1">The Token Endpoint issues an Access Token and, optionally, a Refresh Token in exchange for the Authorization Code that Client obtained in a successful Authorization Response. It is used in the same manner as defined in <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>. Implementers SHOULD follow the best current practices for OAuth 2.0 Security given in <span>[<a href="#BCP240" class="cite xref">BCP240</a>]</span>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="token-request">
<section id="section-6.1">
        <h3 id="name-token-request">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-token-request" class="section-name selfRef">Token Request</a>
        </h3>
<p id="section-6.1-1">The Token Request is made as defined in Section 4.1.3 of <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">The following are the extension parameters to the Token Request used in the Pre-Authorized Code Flow defined in <a href="#pre-authz-code-flow" class="auto internal xref">Section 3.5</a>:<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-6.1-3.1">
            <code>pre-authorized_code</code>: The code representing the authorization to obtain Credentials of a certain type. This parameter MUST be present if the <code>grant_type</code> is <code>urn:ietf:params:oauth:grant-type:pre-authorized_code</code>.<a href="#section-6.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-6.1-3.2">
            <code>tx_code</code>: OPTIONAL. String value containing a Transaction Code value itself. This value MUST be present if a <code>tx_code</code> object was present in the Credential Offer (including if the object was empty). This parameter MUST only be used if the <code>grant_type</code> is <code>urn:ietf:params:oauth:grant-type:pre-authorized_code</code>.<a href="#section-6.1-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.1-4">Requirements around how the Wallet identifies and, if applicable, authenticates itself with the Authorization Server in the Token Request depend on the Client type defined in Section 2.1 of <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> and the Client authentication method indicated in the <code>token_endpoint_auth_method</code> Client metadata (as defined in <span>[<a href="#RFC7591" class="cite xref">RFC7591</a>]</span>). The requirements specified in Sections 4.1.3 and 3.2.1 of <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> MUST be followed.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">For the Pre-Authorized Code Grant Type, authentication of the Client is OPTIONAL, as described in Section 3.2.1 of OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, and, consequently, the <code>client_id</code> parameter is only needed when a form of Client Authentication that relies on this parameter is used.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<p id="section-6.1-6">If the Token Request contains an <code>authorization_details</code> parameter (as defined by <span>[<a href="#RFC9396" class="cite xref">RFC9396</a>]</span>) of type <code>openid_credential</code> and the Credential Issuer's metadata contains an <code>authorization_servers</code> parameter, the <code>authorization_details</code> object MUST contain the Credential Issuer's identifier in the <code>locations</code> element.<a href="#section-6.1-6" class="pilcrow">¶</a></p>
<p id="section-6.1-7">If the Token Request contains a scope value related to Credential issuance and the Credential Issuer's metadata contains an <code>authorization_servers</code> parameter, it is RECOMMENDED to use a <code>resource</code> parameter <span>[<a href="#RFC8707" class="cite xref">RFC8707</a>]</span> whose value is the Credential Issuer's identifier value to allow the Authorization Server to differentiate Credential Issuers.<a href="#section-6.1-7" class="pilcrow">¶</a></p>
<p id="section-6.1-8">When the Pre-Authorized Grant Type is used, it is RECOMMENDED that the Credential Issuer issues an Access Token valid only for the Credentials indicated in the Credential Offer (see <a href="#credential-offer" class="auto internal xref">Section 4.1</a>). The Wallet SHOULD obtain a separate Access Token if it wants to request issuance of any Credentials that were not included in the Credential Offer, but were discoverable from the Credential Issuer's <code>credential_configurations_supported</code> metadata parameter.<a href="#section-6.1-8" class="pilcrow">¶</a></p>
<p id="section-6.1-9">Additional Token Request parameters MAY be defined and used,
as described in <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.
The Authorization Server MUST ignore any unrecognized parameters.<a href="#section-6.1-9" class="pilcrow">¶</a></p>
<p id="section-6.1-10">Below is a non-normative example of a Token Request in an Authorization Code Flow:<a href="#section-6.1-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1-11">
<pre>POST /token HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code
&amp;code=SplxlOBeZQQYbYS6WxSbIA
&amp;code_verifier=dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk
&amp;redirect_uri=https%3A%2F%2Fwallet.example.org%2Fcb
&amp;client_assertion_type=urn%3Aietf%3Aparams%3Aoauth%3Aclient-assertion-type%3Ajwt-bearer
&amp;client_assertion=eyJhbGciOiJSU...
</pre><a href="#section-6.1-11" class="pilcrow">¶</a>
</div>
<div id="request-credential-issuance-using-authorization-details-parameter">
<section id="section-6.1.1">
          <h4 id="name-request-credential-issuance">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-request-credential-issuance" class="section-name selfRef">Request Credential Issuance using <code>authorization_details</code> Parameter</a>
          </h4>
<p id="section-6.1.1-1">Credential Issuers MAY support requesting authorization to issue a Credential using the <code>authorization_details</code> parameter. This is particularly useful if the Credential Issuer offered multiple Credential Configurations in the Credential Offer of a Pre-Authorized Code Flow.<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2">The Wallet can use <code>authorization_details</code> in the Token Request to request a specific Credential Configuration in both the Authorization Code Flow and the Pre-Authorized Code Flow. The value of the <code>authorization_details</code> parameter is defined in <a href="#authorization-details" class="auto internal xref">Section 5.1.1</a>.<a href="#section-6.1.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1.1-3">Below is a non-normative example of a Token Request in a Pre-Authorized Code Flow (without Client Authentication):<a href="#section-6.1.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1.1-4">
<pre>POST /token HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=urn:ietf:params:oauth:grant-type:pre-authorized_code
&amp;pre-authorized_code=SplxlOBeZQQYbYS6WxSbIA
&amp;tx_code=493536
&amp;authorization_details=%5B%7B%22type%22%3A%20%22openid_credential%22%2C%20%22
    credential_configuration_id%22%3A%20%22UniversityDegreeCredential%22%7D%5D
</pre><a href="#section-6.1.1-4" class="pilcrow">¶</a>
</div>
<p id="section-6.1.1-5">The Wallet may send the <code>authorization_details</code> parameter in the Token Request even when the parameter has been previously sent in the <a href="#credential-authz-request">Authorization Request</a> as described in Section 6.1 of <span>[<a href="#RFC9396" class="cite xref">RFC9396</a>]</span>. It allows the AS to make a decision based on whether the Wallet is asking for more or less access than the previous request. With respect to <code>authorization_details</code> items using the <code>credential_configuration_id</code> introduced in this specification, it is RECOMMENDED that the AS would accept a request from the Wallet containing a subset of <code>credential_configuration_id</code> parameters received in the original <a href="#credential-authz-request">Authorization Request</a> and issue a token for the reduced set.<a href="#section-6.1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="token-response">
<section id="section-6.2">
        <h3 id="name-successful-token-response">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-successful-token-response" class="section-name selfRef">Successful Token Response</a>
        </h3>
<p id="section-6.2-1">Token Responses are made as defined in <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">The Authorization Server might decide to authorize issuance of multiple instances for each Credential requested in the Authorization Request. Each Credential instance is described using the same entry in the <code>credential_configurations_supported</code> Credential Issuer metadata, but contains different claim values or different subset of claims within the claims set identified by the <code>credential_configuration_id</code>.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">In addition to the response parameters defined in <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, the Authorization Server MAY return the following parameters:<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-6.2-4.1">
            <p id="section-6.2-4.1.1"><code>authorization_details</code>: REQUIRED when the <code>authorization_details</code> parameter, as defined in <a href="#authorization-details" class="auto internal xref">Section 5.1.1</a>, is used in either the <a href="#credential-authz-request">Authorization Request</a> or <a href="#token-request">Token Request</a>. OPTIONAL when <code>scope</code> parameter was used to request issuance of a Credential of a certain Credential Configuration. It is a non-empty array of objects, as defined in Section 7 of <span>[<a href="#RFC9396" class="cite xref">RFC9396</a>]</span>. In addition to the parameters defined in <a href="#authorization-details" class="auto internal xref">Section 5.1.1</a>, this specification defines the following parameter to be used with the authorization details type <code>openid_credential</code> in the Token Response:<a href="#section-6.2-4.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-6.2-4.1.2.1">
                <code>credential_identifiers</code>: REQUIRED. A non-empty array of strings, each uniquely identifying a Credential Dataset that can be issued using the Access Token returned in this response. Each of these Credential Datasets corresponds to the Credential Configuration referenced in the <code>credential_configuration_id</code> parameter. The Wallet MUST use these identifiers together with an Access Token in subsequent Credential Requests. See <a href="#identifying_credential" class="auto internal xref">Section 3.3.4</a> for the summary of the options how requested Credential(s) are identified throughout the Issuance flow.<a href="#section-6.2-4.1.2.1" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-6.2-5">Additional Token Response parameters MAY be defined and used,
as described in <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.
The Wallet MUST ignore any unrecognized parameters in the Token Response.
An included <code>authorization_details</code> parameter MAY also have additional data fields defined and used
when the <code>type</code> value is <code>openid_credential</code>.
The Wallet MUST ignore any unrecognized data fields in the <code>authorization_details</code> present in the Token Response.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<p id="section-6.2-6">Below is a non-normative example of a Token Response when the <code>authorization_details</code> parameter was used to request issuance of a certain Credential type:<a href="#section-6.2-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-7">
<pre>HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
  "access_token": "eyJhbGciOiJSUzI1NiIsInR5cCI6Ikp..sHQ",
  "token_type": "Bearer",
  "expires_in": 86400,
  "authorization_details": [
    {
      "type": "openid_credential",
      "credential_configuration_id": "UniversityDegreeCredential",
      "credential_identifiers": [
        "CivilEngineeringDegree-2023",
        "ElectricalEngineeringDegree-2023"
      ]
    }
  ]
}
</pre><a href="#section-6.2-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="token-error-response">
<section id="section-6.3">
        <h3 id="name-token-error-response">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-token-error-response" class="section-name selfRef">Token Error Response</a>
        </h3>
<p id="section-6.3-1">If the Token Request is invalid or unauthorized, the Authorization Server constructs the error response as defined as in Section 5.2 of OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">The following additional clarifications are provided for some of the error codes already defined in <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>:<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3"><code>invalid_request</code>:<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-6.3-4.1">The Authorization Server does not expect a Transaction Code in the Pre-Authorized Code Flow but the Client provides a Transaction Code.<a href="#section-6.3-4.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-6.3-4.2">The Authorization Server expects a Transaction Code in the Pre-Authorized Code Flow but the Client does not provide a Transaction Code.<a href="#section-6.3-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.3-5"><code>invalid_grant</code>:<a href="#section-6.3-5" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-6.3-6.1">The Authorization Server expects a Transaction Code in the Pre-Authorized Code Flow but the Client provides the wrong Transaction Code.<a href="#section-6.3-6.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-6.3-6.2">The End-User provides the wrong Pre-Authorized Code or the Pre-Authorized Code has expired.<a href="#section-6.3-6.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.3-7"><code>invalid_client</code>:<a href="#section-6.3-7" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-6.3-8.1">The Client tried to send a Token Request with a Pre-Authorized Code without a Client ID but the Authorization Server does not support anonymous access.<a href="#section-6.3-8.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.3-9">Below is a non-normative example of a Token Error Response:<a href="#section-6.3-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3-10">
<pre>HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store

{
  "error": "invalid_request"
}
</pre><a href="#section-6.3-10" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="nonce-endpoint">
<section id="section-7">
      <h2 id="name-nonce-endpoint">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-nonce-endpoint" class="section-name selfRef">Nonce Endpoint</a>
      </h2>
<p id="section-7-1">This endpoint allows a Client to acquire a fresh <code>c_nonce</code> value. A Credential Issuer that requires <code>c_nonce</code> values to be incorporated into proofs in the Credential Request (see <a href="#credential-request" class="auto internal xref">Section 8.2</a>) MUST offer a Nonce Endpoint.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">The <code>nonce_endpoint</code> Credential Issuer Metadata parameter, as defined in <a href="#credential-issuer-parameters" class="auto internal xref">Section 12.2.4</a>, contains the URL of the Credential Issuer's Nonce Endpoint.<a href="#section-7-2" class="pilcrow">¶</a></p>
<div id="nonce-request">
<section id="section-7.1">
        <h3 id="name-nonce-request">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-nonce-request" class="section-name selfRef">Nonce Request</a>
        </h3>
<p id="section-7.1-1">A request for a nonce is made by sending an HTTP POST request to the URL provided in the <code>nonce_endpoint</code> Credential Issuer Metadata parameter. The Nonce Endpoint is not a protected resource, meaning the Wallet does not need to supply an access token to access it.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">Below is a non-normative example of a Nonce Request:<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.1-3">
<pre>POST /nonce HTTP/1.1
Host: credential-issuer.example.com
Content-Length: 0
</pre><a href="#section-7.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="nonce-response">
<section id="section-7.2">
        <h3 id="name-nonce-response">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-nonce-response" class="section-name selfRef">Nonce Response</a>
        </h3>
<p id="section-7.2-1">The Credential Issuer provides a nonce value in an HTTP response with a 2xx status code and the following parameters included as top-level members in the message body of the HTTP response using the application/json media type:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-7.2-2.1">
            <code>c_nonce</code>: REQUIRED. String containing a challenge to be used when creating a proof of possession of the key (see <a href="#credential-request" class="auto internal xref">Section 8.2</a>). It is at the discretion of the Credential Issuer when to return a new challenge value as opposed to the one returned in the previous request. New challenge values MUST be unpredictable.<a href="#section-7.2-2.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.2-3">Due to the temporal nature of the <code>c_nonce</code> value, the Credential Issuer MUST make the response uncacheable by adding a <code>Cache-Control</code> header field including the value <code>no-store</code>.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<p id="section-7.2-4">The Credential Issuer MAY provide a DPoP nonce in an HTTP header as defined in Section 8.2 of <span>[<a href="#RFC9449" class="cite xref">RFC9449</a>]</span>. In this case, the Wallet uses the new nonce value in the DPoP proof when presenting an access token at the Credential Endpoint.<a href="#section-7.2-4" class="pilcrow">¶</a></p>
<p id="section-7.2-5">Below is a non-normative example of a Nonce Response:<a href="#section-7.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.2-6">
<pre>HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store
DPoP-Nonce: eyJ7S_zG.eyJH0-Z.HX4w-7v

{
  "c_nonce": "wKI4LT17ac15ES9bw8ac4"
}
</pre><a href="#section-7.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="credential-endpoint">
<section id="section-8">
      <h2 id="name-credential-endpoint">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-credential-endpoint" class="section-name selfRef">Credential Endpoint</a>
      </h2>
<p id="section-8-1">The Credential Endpoint issues one or more Credentials of the same Credential Configuration and Credential Dataset (as approved by the End-User) upon presentation of a valid Access Token representing this approval. Support for this endpoint is REQUIRED.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Communication with the Credential Endpoint MUST utilize TLS.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">The Client sends a Credential Request to obtain:<a href="#section-8-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-8-4.1">one Credential; or<a href="#section-8-4.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-8-4.2">multiple Credential instances of the same Credential Configuration and Credential Dataset, each with distinct cryptographic material.<a href="#section-8-4.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-8-5">If the Issuer supports the issuance of multiple Credentials, the Client can send several consecutive Credential Requests to obtain multiple Credentials in a chosen sequence.<a href="#section-8-5" class="pilcrow">¶</a></p>
<div id="credential-binding">
<section id="section-8.1">
        <h3 id="name-binding-the-issued-credenti">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-binding-the-issued-credenti" class="section-name selfRef">Binding the Issued Credential to the Identifier of the End-User Possessing that Credential</a>
        </h3>
<p id="section-8.1-1">The issued Credential SHOULD be cryptographically bound to the identifier of the End-User who possesses the Credential. Cryptographic Key Binding allows the Verifier to verify during the presentation of a Credential that the End-User presenting a Credential is the same End-User to whom that Credential was issued. For non-cryptographic types of binding and Credentials issued without any binding, see the Implementation Considerations in <a href="#claims-based-binding" class="auto internal xref">Section 14.1</a> and <a href="#no-binding" class="auto internal xref">Section 14.2</a>.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">Note: Claims in the Credential are about the subject of the Credential, which is often the End-User who possesses it.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">For Cryptographic Key Binding, the Client has different options to provide Cryptographic Key Binding material for a requested Credential within a proof of a certain proof type. A proof type may provide the cryptographic public key(s) either with corresponding proof(s) of possession of the private key(s) or with key attestation(s). Proof types are defined in <a href="#proof-types" class="auto internal xref">Appendix F</a>.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credential-request">
<section id="section-8.2">
        <h3 id="name-credential-request">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-credential-request" class="section-name selfRef">Credential Request</a>
        </h3>
<p id="section-8.2-1">A Client makes a Credential Request to the Credential Endpoint by sending the following parameters in the entity-body of an HTTP POST request. The Credential Request MAY be encrypted (on top of TLS) using the <code>credential_request_encryption</code> parameter in <a href="#credential-issuer-metadata" class="auto internal xref">Section 12.2</a> as specified in <a href="#encrypted-messages" class="auto internal xref">Section 10</a>.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-8.2-2.1">
            <code>credential_identifier</code>: REQUIRED when an Authorization Details of type <code>openid_credential</code> was returned from the Token Response. It MUST NOT be used otherwise. A string that identifies a Credential Dataset that is requested for issuance. When this parameter is used, the <code>credential_configuration_id</code> MUST NOT be present.<a href="#section-8.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.2-2.2">
            <code>credential_configuration_id</code>: REQUIRED if a <code>credential_identifiers</code> parameter was not returned from the Token Response as part of the <code>authorization_details</code> parameter. It MUST NOT be used otherwise. String that uniquely identifies one of the keys in the name/value pairs stored in the <code>credential_configurations_supported</code> Credential Issuer metadata. The corresponding object in the <code>credential_configurations_supported</code> map MUST contain one of the value(s) used in the <code>scope</code> parameter in the Authorization Request. When this parameter is used, the <code>credential_identifier</code> MUST NOT be present.<a href="#section-8.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.2-2.3">
            <code>proofs</code>: OPTIONAL. Object providing one or more proof of possessions of the cryptographic key material to which the issued Credential instances will be bound to. The <code>proofs</code> parameter contains exactly one parameter named as the proof type in <a href="#proof-types" class="auto internal xref">Appendix F</a>, the value set for this parameter is a non-empty array containing parameters as defined by the corresponding proof type.<a href="#section-8.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.2-2.4">
            <p id="section-8.2-2.4.1"><code>credential_response_encryption</code>: OPTIONAL. Object containing information for encrypting the Credential Response. If this request element is not present, the corresponding credential response returned is not encrypted.<a href="#section-8.2-2.4.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-8.2-2.4.2.1">
                <code>jwk</code>: REQUIRED. Object containing a single public key as a JWK used for encrypting the Credential Response.<a href="#section-8.2-2.4.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.2-2.4.2.2">
                <code>enc</code>: REQUIRED. JWE <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span> <code>enc</code> algorithm <span>[<a href="#RFC7518" class="cite xref">RFC7518</a>]</span> for encrypting Credential Responses.<a href="#section-8.2-2.4.2.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.2-2.4.2.3">
                <code>zip</code>: OPTIONAL. JWE <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span> <code>zip</code> algorithm <span>[<a href="#RFC7518" class="cite xref">RFC7518</a>]</span> for compressing Credential Responses prior to encryption. If absent then compression MUST not be used.<a href="#section-8.2-2.4.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-8.2-3">See <a href="#identifying_credential" class="auto internal xref">Section 3.3.4</a> for the summary of the options how requested Credential(s) are identified throughout the Issuance flow.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2-4">The proof type contained in the <code>proofs</code> parameter is an extension point that enables the use of different types of proofs for different cryptographic schemes.<a href="#section-8.2-4" class="pilcrow">¶</a></p>
<p id="section-8.2-5">The proof(s) in the <code>proofs</code> parameter MUST incorporate the Credential Issuer Identifier (audience) and, if the Credential Issuer has a Nonce Endpoint, a <code>c_nonce</code> value to allow the Credential Issuer to detect freshness. The way that data is incorporated depends on the key proof type. In a JWT, for example, the <code>c_nonce</code> value is conveyed in the <code>nonce</code> claim, whereas the audience is conveyed in the <code>aud</code> claim. In a Linked Data proof, for example, the <code>c_nonce</code> is included as the <code>challenge</code> element in the key proof object and the Credential Issuer (the intended audience) is included as the <code>domain</code> element.<a href="#section-8.2-5" class="pilcrow">¶</a></p>
<p id="section-8.2-6">The <code>proofs</code> parameter MUST be present if the <code>proof_types_supported</code> parameter is present in the <code>credential_configurations_supported</code> parameter of the Issuer metadata for the requested Credential.<a href="#section-8.2-6" class="pilcrow">¶</a></p>
<p id="section-8.2-7">The <code>c_nonce</code> value is retrieved from the Nonce Endpoint as defined in <a href="#nonce-endpoint" class="auto internal xref">Section 7</a>.<a href="#section-8.2-7" class="pilcrow">¶</a></p>
<p id="section-8.2-8">Additional Credential Request parameters MAY be defined and used.
The Credential Issuer MUST ignore any unrecognized parameters.<a href="#section-8.2-8" class="pilcrow">¶</a></p>
<p id="section-8.2-9">The Credential Issuer indicates support for encrypted requests by including the <code>credential_request_encryption</code> parameter in the Credential Issuer Metadata. The Client MAY encrypt the request when <code>encryption_required</code> is <code>false</code> and MUST do so when <code>encryption_required</code> is <code>true</code>.<a href="#section-8.2-9" class="pilcrow">¶</a></p>
<p id="section-8.2-10">When performing Credential Request encryption, the Client MUST encode the information in the Credential Request in a JWT as specified by <a href="#encrypted-messages" class="auto internal xref">Section 10</a>, using the parameters from the <code>credential_request_encryption</code> object in the Credential Issuer Metadata.<a href="#section-8.2-10" class="pilcrow">¶</a></p>
<p id="section-8.2-11">If the Credential Request is not encrypted, the media type of the request MUST be set to <code>application/json</code>.<a href="#section-8.2-11" class="pilcrow">¶</a></p>
<p id="section-8.2-12">Below is a non-normative example of a Credential Request for a Credential in <span>[<a href="#ISO.18013-5" class="cite xref">ISO.18013-5</a>]</span> format using the Credential configuration identifier and a key proof type <code>jwt</code> (with line breaks within values for display purposes only):<a href="#section-8.2-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.2-13">
<pre>POST /credential HTTP/1.1
Host: server.example.com
Content-Type: application/json
Authorization: Bearer czZCaGRSa3F0MzpnWDFmQmF0M2JW

{
  "credential_configuration_id": "org.iso.18013.5.1.mDL",
  "proofs": {
    "jwt": [
      "eyJraWQiOiJkaWQ6ZXhhbXBsZTplYmZlYjFmNzEyZWJjNmYxYzI3NmUxMmVjMjEva2V5cy8x
       IiwiYWxnIjoiRVMyNTYiLCJ0eXAiOiJKV1QifQ"
    ]
  }
}
</pre><a href="#section-8.2-13" class="pilcrow">¶</a>
</div>
<p id="section-8.2-14">Below is a non-normative example of a Credential Request for two Credential instances in an IETF SD-JWT VC <span>[<a href="#I-D.ietf-oauth-sd-jwt-vc" class="cite xref">I-D.ietf-oauth-sd-jwt-vc</a>]</span> format using a Credential identifier from the Token Response and key proof type <code>jwt</code> (with line breaks within values for display purposes only):<a href="#section-8.2-14" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.2-15">
<pre>POST /credential HTTP/1.1
Host: server.example.com
Content-Type: application/json
Authorization: Bearer czZCaGRSa3F0MzpnWDFmQmF0M2JW

{
  "credential_identifier": "CivilEngineeringDegree-2023",
  "proofs": {
    "jwt": [
      "eyJ0eXAiOiJvcGVuaWQ0dmNpLXByb29mK2p3dCIsImFsZyI6IkVTMjU2IiwiandrIjp7Imt0
       eSI6IkVDIiwiY3J2IjoiUC0yNTYiLCJ4IjoiblVXQW9BdjNYWml0aDhFN2kxOU9kYXhPTFlG
       T3dNLVoyRXVNMDJUaXJUNCIsInkiOiJIc2tIVThCalVpMVU5WHFpN1N3bWo4Z3dBS18weGtj
       RGpFV183MVNvc0VZIn19",
      "eyJraWQiOiJkaWQ6ZXhhbXBsZTplYmZlYjFmNzEyZWJjNmYxYzI3NmUxMmVjMjEva2V5cy8x
       IiwiYWxnIjoiRVMyNTYiLCJ0eXAiOiJKV1QifQ"
    ]
  }
}
</pre><a href="#section-8.2-15" class="pilcrow">¶</a>
</div>
<p id="section-8.2-16">Below is a non-normative example of a Credential Request for one Credential in W3C VCDM format using a Credential identifier from the Token Response and key proof type <code>di_vp</code> (with line breaks within values for display purposes only):<a href="#section-8.2-16" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.2-17">
<pre>POST /credential HTTP/1.1
Host: server.example.com
Content-Type: application/json
Authorization: BEARER czZCaGRSa3F0MzpnWDFmQmF0M2JW

{
  "credential_identifier": "CivilEngineeringDegree-2023",
  "proofs": {
    "di_vp": [
      {
        "@context": [
          "https://www.w3.org/ns/credentials/v2",
          "https://www.w3.org/ns/credentials/examples/v2"
        ],
        "type": [
          "VerifiablePresentation"
        ],
        "holder": "did:key:z6MkvrFpBNCoYewiaeBLgjUDvLxUtnK5R6mqh5XPvLsrPsro",
        "proof": [
          {
            "type": "DataIntegrityProof",
            "cryptosuite": "eddsa-2022",
            "proofPurpose": "authentication",
            "verificationMethod": "did:key:z6MkvrFpBNCoYewiaeBLgjUDvLxUtnK5R6mq
             h5XPvLsrPsro#z6MkvrFpBNCoYewiaeBLgjUDvLxUtnK5R6mqh5XPvLsrPsro",
            "created": "2023-03-01T14:56:29.280619Z",
            "challenge": "82d4cb36-11f6-4273-b9c6-df1ac0ff17e9",
            "domain": "did:web:audience.company.com",
            "proofValue": "z5hrbHzZiqXHNpLq6i7zePEUcUzEbZKmWfNQzXcUXUrqF7bykQ7A
             CiWFyZdT2HcptF1zd1t7NhfQSdqrbPEjZceg7"
          }
        ]
      }
    ]
  }
}
</pre><a href="#section-8.2-17" class="pilcrow">¶</a>
</div>
<p id="section-8.2-18">The Credential Issuer indicates support for encrypted responses by including the <code>credential_response_encryption</code> parameter in the Credential Issuer Metadata. The Client MAY request encrypted responses by providing its encryption parameters in the Credential Request when <code>encryption_required</code> is <code>false</code> and MUST do so when <code>encryption_required</code> is <code>true</code>. Credential Request encryption MUST be used if the <code>credential_response_encryption</code> parameter is included, to prevent it being substituted by an attacker.<a href="#section-8.2-18" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credential-response">
<section id="section-8.3">
        <h3 id="name-credential-response">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-credential-response" class="section-name selfRef">Credential Response</a>
        </h3>
<p id="section-8.3-1">The Credential Response can either be returned immediately or in a deferred manner. The response can contain one or more Credentials with the same Credential Configuration and Credential Dataset depending on the Credential Request:<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-8.3-2.1">If the Credential Issuer is able to immediately issue the requested Credentials, it MUST respond with the HTTP status code 200 (see Section 15.3.3 of <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>).<a href="#section-8.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.3-2.2">If the Credential Issuer is not able to immediately issue the requested credentials (e.g., due to a manual review process being required or the data used to issue the credential is not ready yet), the Credential Issuer MUST return a response with a <code>transaction_id</code> parameter. In this case, the Credential Issuer MUST also use the HTTP status code 202 for the response. The <code>transaction_id</code> MAY be used by the Client at a later time at the Deferred Credential endpoint.<a href="#section-8.3-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.3-3">If the Client requested an encrypted response by including the <code>credential_response_encryption</code> object in the request, the Credential Issuer MUST encode the information in the Credential Response as specified by <a href="#encrypted-messages" class="auto internal xref">Section 10</a>, using the parameters from the <code>credential_response_encryption</code> object. Note that this is done regardless of the content.<a href="#section-8.3-3" class="pilcrow">¶</a></p>
<p id="section-8.3-4">If the Credential Response is not encrypted, the media type of the response MUST be set to <code>application/json</code>.<a href="#section-8.3-4" class="pilcrow">¶</a></p>
<p id="section-8.3-5">The following parameters are used in the JSON-encoded Credential Response body:<a href="#section-8.3-5" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-8.3-6.1">
            <p id="section-8.3-6.1.1"><code>credentials</code>: OPTIONAL. Contains an array of one or more issued Credentials. It MUST NOT be used if the <code>transaction_id</code> parameter is present. The elements of the array MUST be objects. The number of elements in the <code>credentials</code> array matches the number of keys that the Wallet has provided via the <code>proofs</code> parameter of the Credential Request, unless the Issuer decides to issue fewer Credentials. Each key provided by the Wallet is used to bind to, at most, one Credential. This specification defines the following parameters to be used inside this object:<a href="#section-8.3-6.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-8.3-6.1.2.1">
                <code>credential</code>: REQUIRED. Contains one issued Credential. The encoding of the Credential depends on the Credential Format and MAY be a string or an object. Credential Formats expressed as binary data MUST be base64url-encoded and returned as a string. More details are defined in the Credential Format Profiles in <a href="#format-profiles" class="auto internal xref">Appendix A</a>.<a href="#section-8.3-6.1.2.1" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="compact" id="section-8.3-6.2">
            <code>transaction_id</code>: OPTIONAL. String identifying a Deferred Issuance transaction. This parameter is contained in the response if the Credential Issuer cannot immediately issue the Credential. The value is subsequently used to obtain the respective Credential with the Deferred Credential Endpoint (see <a href="#deferred-credential-issuance" class="auto internal xref">Section 9</a>). It MUST not be used if the <code>credentials</code> parameter is present. It MUST be invalidated after the Credential for which it was meant has been obtained by the Wallet.<a href="#section-8.3-6.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.3-6.3">
            <code>interval</code>: REQUIRED if <code>transaction_id</code> is present. Contains a positive number that represents the minimum amount of time in seconds that the Wallet SHOULD wait after receiving the response before sending a new request to the Deferred Credential Endpoint. It MUST NOT be used if the <code>credentials</code> parameter is present.<a href="#section-8.3-6.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.3-6.4">
            <code>notification_id</code>: OPTIONAL. String identifying one or more Credentials issued in one Credential Response. It MUST be included in the Notification Request as defined in <a href="#notification" class="auto internal xref">Section 11.1</a>. It MUST not be used if the <code>credentials</code> parameter is not present.<a href="#section-8.3-6.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.3-7">Additional Credential Response parameters MAY be defined and used. The Wallet MUST ignore any unrecognized parameters.<a href="#section-8.3-7" class="pilcrow">¶</a></p>
<p id="section-8.3-8">Below is a non-normative example of a Credential Response in an immediate issuance flow for a Credential in JWT VC format (JSON encoded):<a href="#section-8.3-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3-9">
<pre>HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
  "credentials": [
    {
      "credential": "LUpixVCWJk0eOt4CXQe1NXK....WZwmhmn9OQp6YxX0a2L"
    }
  ]
}
</pre><a href="#section-8.3-9" class="pilcrow">¶</a>
</div>
<p id="section-8.3-10">Below is a non-normative example of a Credential Response in an immediate issuance flow for multiple Credential instances in JWT VC format (JSON encoded) with an additional <code>notification_id</code> parameter:<a href="#section-8.3-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3-11">
<pre>HTTP/1.1 200 OK
Content-Type: application/json

{
  "credentials": [
    {
      "credential": "LUpixVCWJk0eOt4CXQe1NXK....WZwmhmn9OQp6YxX0a2L"
    },
    {
      "credential": "YXNkZnNhZGZkamZqZGFza23....29tZTIzMjMyMzIzMjMy"
    }
  ],
  "notification_id": "3fwe98js"
}
</pre><a href="#section-8.3-11" class="pilcrow">¶</a>
</div>
<p id="section-8.3-12">Below is a non-normative example of a Credential Response in a deferred flow:<a href="#section-8.3-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3-13">
<pre>HTTP/1.1 202 Accepted
Content-Type: application/json
Cache-Control: no-store

{
  "transaction_id": "8xLOxBtZp8",
  "interval" : 3600
}
</pre><a href="#section-8.3-13" class="pilcrow">¶</a>
</div>
<div id="credential-error-response">
<section id="section-8.3.1">
          <h4 id="name-credential-error-response">
<a href="#section-8.3.1" class="section-number selfRef">8.3.1. </a><a href="#name-credential-error-response" class="section-name selfRef">Credential Error Response</a>
          </h4>
<p id="section-8.3.1-1">When the Credential Request is invalid or unauthorized, the Credential Issuer constructs the error response as defined in this section.<a href="#section-8.3.1-1" class="pilcrow">¶</a></p>
<div id="authorization-errors">
<section id="section-8.3.1.1">
            <h5 id="name-authorization-errors">
<a href="#section-8.3.1.1" class="section-number selfRef">8.3.1.1. </a><a href="#name-authorization-errors" class="section-name selfRef">Authorization Errors</a>
            </h5>
<p id="section-8.3.1.1-1">If the Credential Request does not contain an Access Token that enables issuance of a requested Credential, the Credential Endpoint returns an authorization error response such as defined in Section 3 of <span>[<a href="#RFC6750" class="cite xref">RFC6750</a>]</span>.<a href="#section-8.3.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credential-request-errors">
<section id="section-8.3.1.2">
            <h5 id="name-credential-request-errors">
<a href="#section-8.3.1.2" class="section-number selfRef">8.3.1.2. </a><a href="#name-credential-request-errors" class="section-name selfRef">Credential Request Errors</a>
            </h5>
<p id="section-8.3.1.2-1">For errors related to the Credential Request's payload, such as issues with <code>type</code>, <code>format</code>, <code>proofs</code>, encryption parameters, or if the request is denied, the specific error codes from this section MUST be used instead of the generic <code>invalid_request</code> parameter defined in Section 3.1 of <span>[<a href="#RFC6750" class="cite xref">RFC6750</a>]</span>.<a href="#section-8.3.1.2-1" class="pilcrow">¶</a></p>
<p id="section-8.3.1.2-2">If the Wallet is requesting the issuance of a Credential that is not supported by the Credential Endpoint, the HTTP response MUST use the HTTP status code 400 (Bad Request) and set the content type to <code>application/json</code> with the following parameters in the JSON-encoded response body:<a href="#section-8.3.1.2-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-8.3.1.2-3.1">
                <p id="section-8.3.1.2-3.1.1"><code>error</code>: REQUIRED. The <code>error</code> parameter SHOULD be a single ASCII <span>[<a href="#USASCII" class="cite xref">USASCII</a>]</span> error code from the following:<a href="#section-8.3.1.2-3.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-8.3.1.2-3.1.2.1">
                    <code>invalid_credential_request</code>: The Credential Request is missing a required parameter, includes an unsupported parameter or parameter value, repeats the same parameter, or is otherwise malformed.<a href="#section-8.3.1.2-3.1.2.1" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="section-8.3.1.2-3.1.2.2">
                    <code>unknown_credential_configuration</code>: Requested Credential Configuration is unknown.<a href="#section-8.3.1.2-3.1.2.2" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="section-8.3.1.2-3.1.2.3">
                    <code>unknown_credential_identifier</code>: Requested Credential identifier is unknown.<a href="#section-8.3.1.2-3.1.2.3" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="section-8.3.1.2-3.1.2.4">
                    <code>invalid_proof</code>: The <code>proofs</code> parameter in the Credential Request is invalid: (1) if the field is missing, or (2) one of the provided key proofs is invalid, or (3) if at least one of the key proofs does not contain a <code>c_nonce</code> value (refer to <a href="#nonce-response" class="auto internal xref">Section 7.2</a>).<a href="#section-8.3.1.2-3.1.2.4" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="section-8.3.1.2-3.1.2.5">
                    <code>invalid_nonce</code>: The <code>proofs</code> parameter in the Credential Request uses an invalid nonce: at least one of the key proofs contains an invalid <code>c_nonce</code> value. The wallet should retrieve a new <code>c_nonce</code> value (refer to <a href="#nonce-endpoint" class="auto internal xref">Section 7</a>).<a href="#section-8.3.1.2-3.1.2.5" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="section-8.3.1.2-3.1.2.6">
                    <code>invalid_encryption_parameters</code>: This error occurs when the encryption parameters in the Credential Request are either invalid or missing. In the latter case, it indicates that the Credential Issuer requires the Credential Response to be sent encrypted, but the Credential Request does not contain the necessary encryption parameters.<a href="#section-8.3.1.2-3.1.2.6" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="section-8.3.1.2-3.1.2.7">
                    <code>credential_request_denied</code>: The Credential Request has not been accepted by the Credential Issuer. The Wallet SHOULD treat this error as unrecoverable, meaning if received from a Credential Issuer the Credential cannot be issued.<a href="#section-8.3.1.2-3.1.2.7" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="compact" id="section-8.3.1.2-3.2">
                <code>error_description</code>: OPTIONAL. The <code>error_description</code> parameter MUST be a human-readable ASCII <span>[<a href="#USASCII" class="cite xref">USASCII</a>]</span> text, providing any additional information used to assist the Client implementers in understanding the occurred error. The values for the <code>error_description</code> parameter MUST NOT include characters outside the set <code>%x20-21 / %x23-5B / %x5D-7E</code>.<a href="#section-8.3.1.2-3.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-8.3.1.2-4">The usage of these parameters takes precedence over the <code>invalid_request</code> parameter defined in <a href="#authorization-errors" class="auto internal xref">Section 8.3.1.1</a>, since they provide more details about the errors.<a href="#section-8.3.1.2-4" class="pilcrow">¶</a></p>
<p id="section-8.3.1.2-5">Note that Credential Error Responses are never encrypted, even if a valid Credential Response would have been.<a href="#section-8.3.1.2-5" class="pilcrow">¶</a></p>
<p id="section-8.3.1.2-6">The following is a non-normative example of a Credential Error Response where an unsupported Credential Format was requested:<a href="#section-8.3.1.2-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3.1.2-7">
<pre>HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store

{
  "error": "unknown_credential_configuration"
}
</pre><a href="#section-8.3.1.2-7" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="deferred-credential-issuance">
<section id="section-9">
      <h2 id="name-deferred-credential-endpoin">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-deferred-credential-endpoin" class="section-name selfRef">Deferred Credential Endpoint</a>
      </h2>
<p id="section-9-1">This endpoint is used to issue one or more Credentials previously requested at the Credential Endpoint in cases where the Credential Issuer was not able to immediately issue this Credential. Support for this endpoint is OPTIONAL.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">The Wallet MUST present to the Deferred Endpoint an Access Token that is valid for the issuance of the Credential(s) previously requested at the Credential Endpoint.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">Communication with the Deferred Credential Endpoint MUST utilize TLS.<a href="#section-9-3" class="pilcrow">¶</a></p>
<div id="deferred-credential-request">
<section id="section-9.1">
        <h3 id="name-deferred-credential-request">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-deferred-credential-request" class="section-name selfRef">Deferred Credential Request</a>
        </h3>
<p id="section-9.1-1">The Deferred Credential Request is an HTTP POST request. The Deferred Credential Request MAY be encrypted (on top of TLS) using the <code>credential_request_encryption</code> parameter in <a href="#credential-issuer-metadata" class="auto internal xref">Section 12.2</a> as specified in <a href="#encrypted-messages" class="auto internal xref">Section 10</a>.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">The following parameters are used in the Deferred Credential Request:<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-9.1-3.1">
            <code>transaction_id</code>: REQUIRED. String identifying a Deferred Issuance transaction.<a href="#section-9.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-9.1-3.2">
            <code>credential_response_encryption</code>: OPTIONAL. as defined in <a href="#credential-request" class="auto internal xref">Section 8.2</a>.<a href="#section-9.1-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-9.1-4">The Credential Issuer MUST invalidate the <code>transaction_id</code> after the Credential for which it was meant has been obtained by the Wallet.<a href="#section-9.1-4" class="pilcrow">¶</a></p>
<p id="section-9.1-5">Additional Deferred Credential Request parameters MAY be defined and used.
The Credential Issuer MUST ignore any unrecognized parameters.<a href="#section-9.1-5" class="pilcrow">¶</a></p>
<p id="section-9.1-6">The Credential Issuer indicates support for encrypted requests by including the <code>credential_request_encryption</code> parameter in the Credential Issuer Metadata. The Client MAY encrypt the request when <code>encryption_required</code> is <code>false</code> and MUST do so when <code>encryption_required</code> is <code>true</code>.<a href="#section-9.1-6" class="pilcrow">¶</a></p>
<p id="section-9.1-7">When performing Deferred Credential Request encryption, the Client MUST encode the information in the Deferred Credential Request in a JWT as specified by <a href="#encrypted-messages" class="auto internal xref">Section 10</a>, using the parameters from the <code>credential_request_encryption</code> object in the Credential Issuer Metadata.<a href="#section-9.1-7" class="pilcrow">¶</a></p>
<p id="section-9.1-8">If the Deferred Credential Request is not encrypted, the media type of the request MUST be set to <code>application/json</code>.<a href="#section-9.1-8" class="pilcrow">¶</a></p>
<p id="section-9.1-9">The following is a non-normative example of a Deferred Credential Request:<a href="#section-9.1-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.1-10">
<pre>POST /deferred_credential HTTP/1.1
Host: server.example.com
Content-Type: application/json
Authorization: Bearer czZCaGRSa3F0MzpnWDFmQmF0M2JW

{
  "transaction_id": "8xLOxBtZp8"
}
</pre><a href="#section-9.1-10" class="pilcrow">¶</a>
</div>
<p id="section-9.1-11">The Credential Issuer indicates support for encrypted responses by including the <code>credential_response_encryption</code> parameter in the Credential Issuer Metadata. The Client MAY request encrypted responses by providing its encryption parameters in the Deferred Credential Request when <code>encryption_required</code> is <code>false</code> and MUST do so when <code>encryption_required</code> is <code>true</code>. Note that this object will be used for encrypting the response, regardless of what was sent in the initial Credential Request. If it is not included encryption will not be performed. Deferred Credential Request encryption MUST but used if the <code>credential_response_encryption</code> parameter is included, to prevent it being substituted by an attacker.<a href="#section-9.1-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="deferred-credential-response">
<section id="section-9.2">
        <h3 id="name-deferred-credential-respons">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-deferred-credential-respons" class="section-name selfRef">Deferred Credential Response</a>
        </h3>
<p id="section-9.2-1">A Deferred Credential Response may either contain the requested Credentials or further defer the issuance:<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-9.2-2.1">If the Credential Issuer is able to issue the requested Credentials, the Deferred Credential Response MUST use the <code>credentials</code> parameter as defined in <a href="#credential-response" class="auto internal xref">Section 8.3</a> and MUST respond with the HTTP status code 200 (see Section 15.3.3 of <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>).<a href="#section-9.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-9.2-2.2">If the Credential Issuer still requires more time, the Deferred Credential Response MUST use the <code>interval</code> and <code>transaction_id</code> parameters as defined in <a href="#credential-response" class="auto internal xref">Section 8.3</a> and it MUST respond with the HTTP status code 202 (see Section 15.3.3 of <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>). The value of <code>transaction_id</code> MUST be same as the value of <code>transaction_id</code> in the Deferred Credential Request.<a href="#section-9.2-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-9.2-3">The Deferred Credential Response MAY use the <code>notification_id</code> parameter as defined in <a href="#credential-response" class="auto internal xref">Section 8.3</a>.<a href="#section-9.2-3" class="pilcrow">¶</a></p>
<p id="section-9.2-4">Additional Deferred Credential Response parameters MAY be defined and used.
The Wallet MUST ignore any unrecognized parameters.<a href="#section-9.2-4" class="pilcrow">¶</a></p>
<p id="section-9.2-5">If the Client requested an encrypted response by including the <code>credential_response_encryption</code> object in the request, the Credential Issuer MUST encode the information in the Deferred Credential Response as specified by <a href="#encrypted-messages" class="auto internal xref">Section 10</a>, using the parameters from the <code>credential_response_encryption</code> object. Note that this is done regardless of the content. The <code>credential_response_encryption</code> object may be different from the one included in the initial Credential Request so the Credential Issuer MUST use the newly provided one. This is to simplify key management in the case of longer deferred issuance.<a href="#section-9.2-5" class="pilcrow">¶</a></p>
<p id="section-9.2-6">If the Deferred Credential Response is not encrypted, the media type of the response MUST be set to <code>application/json</code>.<a href="#section-9.2-6" class="pilcrow">¶</a></p>
<p id="section-9.2-7">The following is a non-normative example of a Deferred Credential Response containing Credentials:<a href="#section-9.2-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.2-8">
<pre>HTTP/1.1 200 OK
Content-Type: application/json

{
  "credentials": [
    {
      "credential": "LUpixVCWJk0eOt4CXQe1NXK....WZwmhmn9OQp6YxX0a2L"
    },
    {
      "credential": "YXNkZnNhZGZkamZqZGFza23....29tZTIzMjMyMzIzMjMy"
    }
  ],
  "notification_id": "3fwe98js"
}
</pre><a href="#section-9.2-8" class="pilcrow">¶</a>
</div>
<p id="section-9.2-9">The following is a non-normative example of a Deferred Credential Response, where the Credential Issuer still requires more time:<a href="#section-9.2-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.2-10">
<pre>HTTP/1.1 202 OK
Content-Type: application/json

{
  "transaction_id": "8xLOxBtZp8",
  "interval": 86400
}
</pre><a href="#section-9.2-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="deferred-credential-error-response">
<section id="section-9.3">
        <h3 id="name-deferred-credential-error-r">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-deferred-credential-error-r" class="section-name selfRef">Deferred Credential Error Response</a>
        </h3>
<p id="section-9.3-1">When the Deferred Credential Request is invalid, the Credential Issuer constructs the error response as defined in <a href="#credential-error-response" class="auto internal xref">Section 8.3.1</a>.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3-2">The following additional error code is specified in addition to those already defined in <a href="#credential-request-errors" class="auto internal xref">Section 8.3.1.2</a>:<a href="#section-9.3-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-9.3-3.1">
            <code>invalid_transaction_id</code>: The Deferred Credential Request contains an invalid <code>transaction_id</code>. This error occurs when the <code>transaction_id</code> was not issued by the respective Credential Issuer or it was already used to obtain a Credential.<a href="#section-9.3-3.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-9.3-4">This is a non-normative example of a Deferred Credential Error Response:<a href="#section-9.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.3-5">
<pre>HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store

{
  "error": "invalid_transaction_id"
}
</pre><a href="#section-9.3-5" class="pilcrow">¶</a>
</div>
<p id="section-9.3-6">In the event the Credential Issuer can no longer issue the credential(s), the <code>credential_request_denied</code> error code as defined in <a href="#credential-request-errors" class="auto internal xref">Section 8.3.1.2</a> should be used in response to a request. A wallet upon receiving this error SHOULD stop making requests to the deferred credential endpoint for the given <code>transaction_id</code>.<a href="#section-9.3-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="encrypted-messages">
<section id="section-10">
      <h2 id="name-encrypted-credential-reques">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-encrypted-credential-reques" class="section-name selfRef">Encrypted Credential Requests and Responses</a>
      </h2>
<p id="section-10-1">Encryption of requests and responses for the Credential and Deferred Credential Endpoints is performed as follows:<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">The contents of the message MUST be encoded as a JWT as described in <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>. The media type MUST be set to <code>application/jwt</code>.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">The Public Key used to encrypt the message is selected based on the context. In the case where multiple public keys are available, any may be selected based on the information about each key, such as the <code>kty</code> (Key Type), <code>use</code> (Public Key Use), <code>alg</code> (Algorithm), and other JWK parameters. The <code>alg</code> parameter MUST be present. The JWE <code>alg</code> algorithm used MUST be equal to the <code>alg</code> value of the chosen JWK. If the selected public key contains a <code>kid</code> parameter, the JWE MUST include the same value in the <code>kid</code> JWE Header Parameter (as defined in <a href="https://rfc-editor.org/rfc/rfc7516" class="relref">Section 4.1.6</a>) of the encrypted message. This enables the easy identification of the specific public key that was used to encrypt the message. The JWE <code>enc</code> content encryption algorithm used is obtained based on context.<a href="#section-10-3" class="pilcrow">¶</a></p>
<p id="section-10-4">If a <code>zip</code> (Compression Algorithm) value is specified, then compression is performed before encryption, as specified in <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>. If absent, no compression is performed.<a href="#section-10-4" class="pilcrow">¶</a></p>
<p id="section-10-5">When encryption of a message was required but the received message is unencrypted, it SHOULD be rejected.<a href="#section-10-5" class="pilcrow">¶</a></p>
<p id="section-10-6">For security considerations see <a href="#encryption-security-considersations" class="auto internal xref">Section 13.11</a><a href="#section-10-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="notification-endpoint">
<section id="section-11">
      <h2 id="name-notification-endpoint">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-notification-endpoint" class="section-name selfRef">Notification Endpoint</a>
      </h2>
<p id="section-11-1">This endpoint is used by the Wallet to notify the Credential Issuer of certain events for issued Credentials. These events enable the Credential Issuer to take subsequent actions after issuance. The Credential Issuer needs to return one <code>notification_id</code> parameter per Credential Response or Deferred Credential Response for the Wallet to be able to use this endpoint. Support for this endpoint is OPTIONAL. The Issuer cannot assume that a notification will be sent for every issued Credential since the use of this Endpoint is not mandatory for the Wallet.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">The Wallet MUST present to the Notification Endpoint a valid Access Token issued at the Token Endpoint as defined in <a href="#token-endpoint" class="auto internal xref">Section 6</a>.<a href="#section-11-2" class="pilcrow">¶</a></p>
<p id="section-11-3">A Credential Issuer that requires a request to the Notification Endpoint MUST ensure the Access Token issued by the Authorization Server is valid at the Notification Endpoint.<a href="#section-11-3" class="pilcrow">¶</a></p>
<p id="section-11-4">The notification from the Wallet is idempotent. When the Credential Issuer receives multiple identical calls from the Wallet for the same <code>notification_id</code>, it returns success. Due to the network errors, there are no guarantees that a Credential Issuer will receive a notification within a certain time period or at all.<a href="#section-11-4" class="pilcrow">¶</a></p>
<p id="section-11-5">Communication with the Notification Endpoint MUST utilize TLS.<a href="#section-11-5" class="pilcrow">¶</a></p>
<div id="notification">
<section id="section-11.1">
        <h3 id="name-notification-request">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-notification-request" class="section-name selfRef">Notification Request</a>
        </h3>
<p id="section-11.1-1">The Wallet sends an HTTP POST request to the Notification Endpoint with the following parameters in the entity-body and using the <code>application/json</code> media type. If the Wallet supports the Notification Endpoint, the Wallet MAY send one or more Notification Requests per <code>notification_id</code> value received.<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-11.1-2.1">
            <code>notification_id</code>: REQUIRED. String received in the Credential Response or Deferred Credential Response identifying an issuance flow that contained one or more Credentials with the same Credential Configuration and Credential Dataset.<a href="#section-11.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-11.1-2.2">
            <code>event</code>: REQUIRED. Type of the notification event. It MUST be a case sensitive string whose value is either <code>credential_accepted</code>, <code>credential_failure</code>, or <code>credential_deleted</code>. <code>credential_accepted</code> is to be used when the Credentials were successfully stored in the Wallet, with or without user action. <code>credential_deleted</code> is to be used when the unsuccessful Credential issuance was caused by a user action. In all other unsuccessful cases, <code>credential_failure</code> is to be used. Partial errors during issuance of multiple Credentials as a batch (e.g., one of the Credentials could not be stored) MUST be treated as the overall issuance flow failing.<a href="#section-11.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-11.1-2.3">
            <code>event_description</code>: OPTIONAL. Human-readable ASCII <span>[<a href="#USASCII" class="cite xref">USASCII</a>]</span> text providing additional information, used to assist the Credential Issuer developer in understanding the event that occurred. Values for the <code>event_description</code> parameter MUST NOT include characters outside the set <code>%x20-21 / %x23-5B / %x5D-7E</code>.<a href="#section-11.1-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-11.1-3">Additional Notification Request parameters MAY be defined and used.
The Credential Issuer MUST ignore any unrecognized parameters.<a href="#section-11.1-3" class="pilcrow">¶</a></p>
<p id="section-11.1-4">Below is a non-normative example of a Notification Request when a credential was successfully accepted by the End-User:<a href="#section-11.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.1-5">
<pre>POST /notification HTTP/1.1
Host: server.example.com
Content-Type: application/json
Authorization: Bearer czZCaGRSa3F0MzpnWDFmQmF0M2JW

{
  "notification_id": "3fwe98js",
  "event": "credential_accepted"
}
</pre><a href="#section-11.1-5" class="pilcrow">¶</a>
</div>
<p id="section-11.1-6">Below is a non-normative example of a Notification Request when a Credential was deleted by the End-User:<a href="#section-11.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.1-7">
<pre>POST /notification HTTP/1.1
Host: server.example.com
Content-Type: application/json
Authorization: Bearer czZCaGRSa3F0MzpnWDFmQmF0M2JW

{
  "notification_id": "3fwe98js",
  "event": "credential_failure",
  "event_description": "Could not store the Credential. Out of storage."
}
</pre><a href="#section-11.1-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="successful-notification-response">
<section id="section-11.2">
        <h3 id="name-successful-notification-res">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-successful-notification-res" class="section-name selfRef">Successful Notification Response</a>
        </h3>
<p id="section-11.2-1">When the Credential Issuer has successfully received the Notification Request from the Wallet, it MUST respond with an HTTP status code in the 2xx range. Use of the HTTP status code 204 (No Content) is RECOMMENDED.<a href="#section-11.2-1" class="pilcrow">¶</a></p>
<p id="section-11.2-2">Below is a non-normative example of a response to a successful Notification Request:<a href="#section-11.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.2-3">
<pre>HTTP/1.1 204 No Content
</pre><a href="#section-11.2-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="notification-error-response">
<section id="section-11.3">
        <h3 id="name-notification-error-response">
<a href="#section-11.3" class="section-number selfRef">11.3. </a><a href="#name-notification-error-response" class="section-name selfRef">Notification Error Response</a>
        </h3>
<p id="section-11.3-1">If the Notification Request does not contain an Access Token or contains an invalid Access Token, the Notification Endpoint returns an Authorization Error Response, such as defined in Section 3 of <span>[<a href="#RFC6750" class="cite xref">RFC6750</a>]</span>.<a href="#section-11.3-1" class="pilcrow">¶</a></p>
<p id="section-11.3-2">When the <code>notification_id</code> value is invalid, the HTTP response MUST use the HTTP status code 400 (Bad Request) and set the content type to <code>application/json</code> with the following parameters in the JSON-encoded response body:<a href="#section-11.3-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-11.3-3.1">
            <p id="section-11.3-3.1.1"><code>error</code>: REQUIRED. The value of the <code>error</code> parameter SHOULD be one of the following ASCII <span>[<a href="#USASCII" class="cite xref">USASCII</a>]</span> error codes:<a href="#section-11.3-3.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-11.3-3.1.2.1">
                <code>invalid_notification_id</code>: The <code>notification_id</code> in the Notification Request was invalid.<a href="#section-11.3-3.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-11.3-3.1.2.2">
                <code>invalid_notification_request</code>: The Notification Request is missing a required parameter, includes an unsupported parameter or parameter value, repeats the same parameter, or is otherwise malformed.<a href="#section-11.3-3.1.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-11.3-4">It is at the discretion of the Issuer to decide how to proceed after returning an error response.<a href="#section-11.3-4" class="pilcrow">¶</a></p>
<p id="section-11.3-5">The following is a non-normative example of a Notification Error Response when an invalid <code>notification_id</code> value was used:<a href="#section-11.3-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.3-6">
<pre>HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store

{
  "error": "invalid_notification_id"
}
</pre><a href="#section-11.3-6" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="metadata">
<section id="section-12">
      <h2 id="name-metadata">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-metadata" class="section-name selfRef">Metadata</a>
      </h2>
<div id="client-metadata">
<section id="section-12.1">
        <h3 id="name-client-metadata">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-client-metadata" class="section-name selfRef">Client Metadata</a>
        </h3>
<p id="section-12.1-1">This specification defines the following new Client Metadata parameter in addition to those defined by <span>[<a href="#RFC7591" class="cite xref">RFC7591</a>]</span> for Wallets acting as OAuth 2.0 Client:<a href="#section-12.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-12.1-2.1">
            <code>credential_offer_endpoint</code>: OPTIONAL. Credential Offer Endpoint of a Wallet.<a href="#section-12.1-2.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-12.1-3">Additional Client metadata parameters MAY be defined and used,
as described in <span>[<a href="#RFC7591" class="cite xref">RFC7591</a>]</span>.
The Wallet MUST ignore any unrecognized parameters.<a href="#section-12.1-3" class="pilcrow">¶</a></p>
<div id="client-metadata-retrieval">
<section id="section-12.1.1">
          <h4 id="name-client-metadata-retrieval">
<a href="#section-12.1.1" class="section-number selfRef">12.1.1. </a><a href="#name-client-metadata-retrieval" class="section-name selfRef">Client Metadata Retrieval</a>
          </h4>
<p id="section-12.1.1-1">How to obtain Client Metadata is out of scope of this specification. Profiles of this specification MAY also define static sets of Client Metadata values to be used.<a href="#section-12.1.1-1" class="pilcrow">¶</a></p>
<p id="section-12.1.1-2">If the Credential Issuer is unable to perform discovery of the Wallet's Credential Offer Endpoint, the following custom URL scheme is used: <code>openid-credential-offer://</code>.<a href="#section-12.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="credential-issuer-metadata">
<section id="section-12.2">
        <h3 id="name-credential-issuer-metadata">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-credential-issuer-metadata" class="section-name selfRef">Credential Issuer Metadata</a>
        </h3>
<p id="section-12.2-1">The Credential Issuer Metadata contains information on the Credential Issuer's technical capabilities, supported Credentials, and (internationalized) display information.<a href="#section-12.2-1" class="pilcrow">¶</a></p>
<div id="credential-issuer-identifier">
<section id="section-12.2.1">
          <h4 id="name-credential-issuer-identifie">
<a href="#section-12.2.1" class="section-number selfRef">12.2.1. </a><a href="#name-credential-issuer-identifie" class="section-name selfRef">Credential Issuer Identifier</a>
          </h4>
<p id="section-12.2.1-1">A Credential Issuer is identified by a case sensitive URL using the <code>https</code> scheme that contains scheme, host and, optionally, port number and path components, but no query or fragment components.<a href="#section-12.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credential-issuer-wellknown">
<section id="section-12.2.2">
          <h4 id="name-credential-issuer-metadata-">
<a href="#section-12.2.2" class="section-number selfRef">12.2.2. </a><a href="#name-credential-issuer-metadata-" class="section-name selfRef">Credential Issuer Metadata Retrieval</a>
          </h4>
<p id="section-12.2.2-1">The Credential Issuer's configuration can be retrieved using the Credential Issuer Identifier.<a href="#section-12.2.2-1" class="pilcrow">¶</a></p>
<p id="section-12.2.2-2">Credential Issuers publishing metadata MUST make a JSON document available at the path formed by inserting the string <code>/.well-known/openid-credential-issuer</code> into the Credential Issuer Identifier between the host component and the path component, if any.<a href="#section-12.2.2-2" class="pilcrow">¶</a></p>
<p id="section-12.2.2-3">For example, the metadata for the Credential Issuer Identifier <code>https://issuer.example.com/tenant</code> would be retrieved from <code>https://issuer.example.com/.well-known/openid-credential-issuer/tenant</code>. The metadata for the Credential Issuer Identifier <code>https://tenant.issuer.example.com</code> would be retrieved from <code>https://tenant.issuer.example.com/.well-known/openid-credential-issuer</code>.<a href="#section-12.2.2-3" class="pilcrow">¶</a></p>
<p id="section-12.2.2-4">Communication with the Credential Issuer Metadata Endpoint MUST utilize TLS.<a href="#section-12.2.2-4" class="pilcrow">¶</a></p>
<p id="section-12.2.2-5">To fetch the Credential Issuer Metadata, the Wallet MUST send an HTTP request using the GET method and the path formed following the steps above. The Wallet is RECOMMENDED to send an <code>Accept</code> header in the HTTP GET request to indicate the Content Type(s) it supports, and by doing so, signaling whether it supports signed metadata.<a href="#section-12.2.2-5" class="pilcrow">¶</a></p>
<p id="section-12.2.2-6">The Credential Issuer MUST respond with HTTP Status Code 200 and return the Credential Issuer Metadata containing the parameters defined in <a href="#credential-issuer-parameters" class="auto internal xref">Section 12.2.4</a> as either<a href="#section-12.2.2-6" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-12.2.2-7.1">an unsigned JSON document using the media type <code>application/json</code>, or<a href="#section-12.2.2-7.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-12.2.2-7.2">a signed JSON Web Token (JWT) containing the Credential Issuer Metadata in its payload using the media type <code>application/jwt</code>.<a href="#section-12.2.2-7.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-12.2.2-8">The Credential Issuer MUST support returning metadata in an unsigned form 'application/json' and MAY support returning it in a signed form 'application/jwt'. In all cases the Credential Issuer MUST indicate the media type of the returned Metadata using the HTTP <code>Content-Type</code> header. It is RECOMMENDED for Credential Issuers to respond with a <code>Content-Type</code> matching to the Wallet's requested <code>Accept</code> header when the requested content type is supported.<a href="#section-12.2.2-8" class="pilcrow">¶</a></p>
<p id="section-12.2.2-9">The Wallet is RECOMMENDED to send an <code>Accept-Language</code> header in the HTTP GET request to indicate the language(s) preferred for display. It is up to the Credential Issuer whether to:<a href="#section-12.2.2-9" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-12.2.2-10.1">send a subset the metadata containing internationalized display data for one or all of the requested languages and indicate returned languages using the HTTP <code>Content-Language</code> Header, or<a href="#section-12.2.2-10.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-12.2.2-10.2">ignore the <code>Accept-Language</code> Header and send all supported languages or any chosen subset.<a href="#section-12.2.2-10.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-12.2.2-11">The language(s) in HTTP <code>Accept-Language</code> and <code>Content-Language</code> Headers MUST use the values defined in <span>[<a href="#RFC3066" class="cite xref">RFC3066</a>]</span>.<a href="#section-12.2.2-11" class="pilcrow">¶</a></p>
<p id="section-12.2.2-12">Below is a non-normative example of a Credential Issuer Metadata request:<a href="#section-12.2.2-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-12.2.2-13">
<pre>GET /.well-known/openid-credential-issuer HTTP/1.1
Host: server.example.com
Accept-Language: fr-ch, fr;q=0.9, en;q=0.8, de;q=0.7, *;q=0.5
</pre><a href="#section-12.2.2-13" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="credential-issuer-signed-metadata">
<section id="section-12.2.3">
          <h4 id="name-signed-metadata">
<a href="#section-12.2.3" class="section-number selfRef">12.2.3. </a><a href="#name-signed-metadata" class="section-name selfRef">Signed Metadata</a>
          </h4>
<p id="section-12.2.3-1">The signed metadata MUST be secured using a JSON Web Signature (JWS) <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span> and contain the following elements:<a href="#section-12.2.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2.3-2.1">
              <p id="section-12.2.3-2.1.1">in the JOSE header,<a href="#section-12.2.3-2.1.1" class="pilcrow">¶</a></p>
<ul class="compact normal">
<li class="compact normal" id="section-12.2.3-2.1.2.1">
                  <code>alg</code>: REQUIRED. A digital signature algorithm identifier such as per IANA "JSON Web Signature and Encryption Algorithms" registry <span>[<a href="#IANA.JOSE" class="cite xref">IANA.JOSE</a>]</span>. It MUST NOT be <code>none</code> or an identifier for a symmetric algorithm (MAC).<a href="#section-12.2.3-2.1.2.1" class="pilcrow">¶</a>
</li>
                <li class="compact normal" id="section-12.2.3-2.1.2.2">
                  <code>typ</code>: REQUIRED. MUST be <code>openidvci-issuer-metadata+jwt</code>, which explicitly types the key proof JWT as recommended in Section 3.11 of <span>[<a href="#RFC8725" class="cite xref">RFC8725</a>]</span>.<a href="#section-12.2.3-2.1.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-12.2.3-2.2">
              <p id="section-12.2.3-2.2.1">in the JWS payload,<a href="#section-12.2.3-2.2.1" class="pilcrow">¶</a></p>
<ul class="compact normal">
<li class="compact normal" id="section-12.2.3-2.2.2.1">
                  <code>iss</code>: OPTIONAL. String denoting the party attesting to the claims in the signed metadata<a href="#section-12.2.3-2.2.2.1" class="pilcrow">¶</a>
</li>
                <li class="compact normal" id="section-12.2.3-2.2.2.2">
                  <code>sub</code>: REQUIRED. String matching the Credential Issuer Identifier<a href="#section-12.2.3-2.2.2.2" class="pilcrow">¶</a>
</li>
                <li class="compact normal" id="section-12.2.3-2.2.2.3">
                  <code>iat</code>: REQUIRED. Integer for the time at which the Credential Issuer Metadata was issued using the syntax defined in <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-12.2.3-2.2.2.3" class="pilcrow">¶</a>
</li>
                <li class="compact normal" id="section-12.2.3-2.2.2.4">
                  <code>exp</code>: OPTIONAL. Integer for the time at which the Credential Issuer Metadata is expiring, using the syntax defined in <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-12.2.3-2.2.2.4" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-12.2.3-3">All <a href="#credential-issuer-parameters">metadata parameters</a> used by the Credential Issuer MUST be added as top-level claims in the JWS payload.<a href="#section-12.2.3-3" class="pilcrow">¶</a></p>
<p id="section-12.2.3-4">When requesting signed metadata, the Wallet MUST establish trust in the signer of the metadata. Otherwise, the Wallet MUST reject the signed metadata. When validating the signature, the Wallet obtains the keys to validate the signature before processing the metadata, e.g., using JOSE header parameters like <code>x5c</code>, <code>kid</code> or <code>trust_chain</code> to convey the public key. The concrete mechanisms for doing this are out of scope of this specification.<a href="#section-12.2.3-4" class="pilcrow">¶</a></p>
<p id="section-12.2.3-5">See <a href="#additional-issuer-metadata-examples" class="auto internal xref">Appendix I.1</a> for a non-normative example of signed Credential Issuer Metadata.<a href="#section-12.2.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credential-issuer-parameters">
<section id="section-12.2.4">
          <h4 id="name-credential-issuer-metadata-p">
<a href="#section-12.2.4" class="section-number selfRef">12.2.4. </a><a href="#name-credential-issuer-metadata-p" class="section-name selfRef">Credential Issuer Metadata Parameters</a>
          </h4>
<p id="section-12.2.4-1">This specification defines the following Credential Issuer Metadata parameters:<a href="#section-12.2.4-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-12.2.4-2.1">
              <code>credential_issuer</code>: REQUIRED. The Credential Issuer's identifier, as defined in <a href="#credential-issuer-identifier" class="auto internal xref">Section 12.2.1</a>. The value MUST be identical to the Credential Issuer's identifier value into which the well-known URI string was inserted to create the URL used to retrieve the metadata. If these values are not identical (when compared using a simple string comparison with no normalization), the data contained in the response MUST NOT be used.<a href="#section-12.2.4-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-12.2.4-2.2">
              <code>authorization_servers</code>: OPTIONAL. A non-empty array of strings, where each string is an identifier of the OAuth 2.0 Authorization Server (as defined in <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span>) the Credential Issuer relies on for authorization. If this parameter is omitted, the entity providing the Credential Issuer is also acting as the Authorization Server, i.e., the Credential Issuer's identifier is used to obtain the Authorization Server metadata. The actual OAuth 2.0 Authorization Server metadata is obtained from the <code>oauth-authorization-server</code> well-known location as defined in Section 3 of <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span>. When there are multiple entries in the array, the Wallet may be able to determine which Authorization Server to use by querying the metadata; for example, by examining the <code>grant_types_supported</code> values, the Wallet can filter the server to use based on the grant type it plans to use. When the Wallet is using <code>authorization_server</code> parameter in the Credential Offer as a hint to determine which Authorization Server to use out of multiple, the Wallet MUST NOT proceed with the flow if the <code>authorization_server</code> Credential Offer parameter value does not match any of the entries in the <code>authorization_servers</code> array.<a href="#section-12.2.4-2.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-12.2.4-2.3">
              <code>credential_endpoint</code>: REQUIRED. URL of the Credential Issuer's Credential Endpoint, as defined in <a href="#credential-request" class="auto internal xref">Section 8.2</a>. This URL MUST use the <code>https</code> scheme and MAY contain port, path, and query parameter components.<a href="#section-12.2.4-2.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-12.2.4-2.4">
              <code>nonce_endpoint</code>: OPTIONAL. URL of the Credential Issuer's Nonce Endpoint, as defined in <a href="#nonce-endpoint" class="auto internal xref">Section 7</a>. This URL MUST use the <code>https</code> scheme and MAY contain port, path, and query parameter components. If omitted, the Credential Issuer does not require the use of <code>c_nonce</code>.<a href="#section-12.2.4-2.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-12.2.4-2.5">
              <code>deferred_credential_endpoint</code>: OPTIONAL. URL of the Credential Issuer's Deferred Credential Endpoint, as defined in <a href="#deferred-credential-issuance" class="auto internal xref">Section 9</a>. This URL MUST use the <code>https</code> scheme and MAY contain port, path, and query parameter components. If omitted, the Credential Issuer does not support the Deferred Credential Endpoint.<a href="#section-12.2.4-2.5" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-12.2.4-2.6">
              <code>notification_endpoint</code>: OPTIONAL. URL of the Credential Issuer's Notification Endpoint, as defined in <a href="#notification-endpoint" class="auto internal xref">Section 11</a>. This URL MUST use the <code>https</code> scheme and MAY contain port, path, and query parameter components. If omitted, the Credential Issuer does not support the Notification Endpoint.<a href="#section-12.2.4-2.6" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-12.2.4-2.7">
              <p id="section-12.2.4-2.7.1"><code>credential_request_encryption</code>: OPTIONAL. Object containing information about whether the Credential Issuer supports encryption of the Credential Request on top of TLS.<a href="#section-12.2.4-2.7.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-12.2.4-2.7.2.1">
                  <code>jwks</code>: REQUIRED. A JSON Web Key Set, as defined in <span>[<a href="#RFC7591" class="cite xref">RFC7591</a>]</span>, that contains one or more public keys, to be used by the Wallet as an input to a key agreement for encryption of the Credential Request. Each JWK in the set MUST have a kid (Key ID) parameter that uniquely identifies the key.<a href="#section-12.2.4-2.7.2.1" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-12.2.4-2.7.2.2">
                  <code>enc_values_supported</code>: REQUIRED. A non-empty array containing a list of the JWE <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span> encryption algorithms (<code>enc</code> values) <span>[<a href="#RFC7518" class="cite xref">RFC7518</a>]</span> supported by the Credential Endpoint to decode the Credential Request from a JWT <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-12.2.4-2.7.2.2" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-12.2.4-2.7.2.3">
                  <code>zip_values_supported</code>: OPTIONAL. A non-empty array containing a list of the JWE <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span> compression algorithms (<code>zip</code> values) <span>[<a href="#RFC7518" class="cite xref">RFC7518</a>]</span> supported by the Credential Endpoint to uncompress the Credential Request after decryption. If absent then no compression algorithms are supported. The Wallet may use any of the supported compression algorithm to compress the Credential Request prior to encryption.<a href="#section-12.2.4-2.7.2.3" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-12.2.4-2.7.2.4">
                  <code>encryption_required</code>: REQUIRED. Boolean value specifying whether the Credential Issuer requires the additional encryption on top of TLS for the Credential Requests. If the value is <code>true</code>, the Credential Issuer requires encryption for every Credential Request. If the value is <code>false</code>, the Wallet MAY choose whether it encrypts the request or not.<a href="#section-12.2.4-2.7.2.4" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="compact" id="section-12.2.4-2.8">
              <p id="section-12.2.4-2.8.1"><code>credential_response_encryption</code>: OPTIONAL. Object containing information about whether the Credential Issuer supports encryption of the Credential Response on top of TLS.<a href="#section-12.2.4-2.8.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-12.2.4-2.8.2.1">
                  <code>alg_values_supported</code>: REQUIRED. A non-empty array containing a list of the JWE <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span> encryption algorithms (<code>alg</code> values) <span>[<a href="#RFC7518" class="cite xref">RFC7518</a>]</span> supported by the Credential Endpoint to encode the Credential Response in a JWT <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-12.2.4-2.8.2.1" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-12.2.4-2.8.2.2">
                  <code>enc_values_supported</code>: REQUIRED. A non-empty array containing a list of the JWE <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span> encryption algorithms (<code>enc</code> values) <span>[<a href="#RFC7518" class="cite xref">RFC7518</a>]</span> supported by the Credential Endpoint to encode the Credential Response in a JWT <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-12.2.4-2.8.2.2" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-12.2.4-2.8.2.3">
                  <code>zip_values_supported</code>: OPTIONAL. A non-empty array containing a list of the JWE <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span> compression algorithms (<code>zip</code> values) <span>[<a href="#RFC7518" class="cite xref">RFC7518</a>]</span> supported by the Credential Endpoint to compress the Credential Response prior to encryption. If absent then compression is not supported.<a href="#section-12.2.4-2.8.2.3" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-12.2.4-2.8.2.4">
                  <code>encryption_required</code>: REQUIRED. Boolean value specifying whether the Credential Issuer requires the additional encryption on top of TLS for the Credential Response. If the value is <code>true</code>, the Credential Issuer requires encryption for every Credential Response and therefore the Wallet MUST provide encryption keys in the Credential Request. If the value is <code>false</code>, the Wallet MAY choose whether it provides encryption keys or not.<a href="#section-12.2.4-2.8.2.4" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="compact" id="section-12.2.4-2.9">
              <p id="section-12.2.4-2.9.1"><code>batch_credential_issuance</code>: OPTIONAL. Object containing information about the Credential Issuer's support for issuance of multiple Credentials in a batch in the Credential Endpoint. The presence of this parameter means that the issuer supports more than one key proof in the <code>proofs</code> parameter in the Credential Request so can issue more than one Verifiable Credential for the same Credential Dataset in a single request/response.<a href="#section-12.2.4-2.9.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-12.2.4-2.9.2.1">
                  <code>batch_size</code>: REQUIRED. Integer value specifying the maximum array size for the <code>proofs</code> parameter in a Credential Request. It MUST be 2 or greater.<a href="#section-12.2.4-2.9.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="compact" id="section-12.2.4-2.10">
              <p id="section-12.2.4-2.10.1"><code>display</code>: OPTIONAL. A non-empty array of objects, where each object contains display properties of a Credential Issuer for a certain language. Below is a non-exhaustive list of valid parameters that MAY be included:<a href="#section-12.2.4-2.10.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-12.2.4-2.10.2.1">
                  <code>name</code>: OPTIONAL. String value of a display name for the Credential Issuer.<a href="#section-12.2.4-2.10.2.1" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-12.2.4-2.10.2.2">
                  <code>locale</code>: OPTIONAL. String value that identifies the language of this object represented as a language tag taken from values defined in BCP47 <span>[<a href="#RFC5646" class="cite xref">RFC5646</a>]</span>. There MUST be only one object for each language identifier.<a href="#section-12.2.4-2.10.2.2" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-12.2.4-2.10.2.3">
                  <p id="section-12.2.4-2.10.2.3.1"><code>logo</code>: OPTIONAL. Object with information about the logo of the Credential Issuer. Below is a non-exhaustive list of parameters that MAY be included:<a href="#section-12.2.4-2.10.2.3.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-12.2.4-2.10.2.3.2.1">
                      <code>uri</code>: REQUIRED. String value that contains a URI where the Wallet can obtain the logo of the Credential Issuer. The Wallet needs to determine the scheme, since the URI value could use the <code>https:</code> scheme, the <code>data:</code> scheme, etc.<a href="#section-12.2.4-2.10.2.3.2.1" class="pilcrow">¶</a>
</li>
                    <li class="compact" id="section-12.2.4-2.10.2.3.2.2">
                      <code>alt_text</code>: OPTIONAL. String value of the alternative text for the logo image.<a href="#section-12.2.4-2.10.2.3.2.2" class="pilcrow">¶</a>
</li>
                  </ul>
</li>
              </ul>
</li>
            <li class="compact" id="section-12.2.4-2.11">
              <p id="section-12.2.4-2.11.1"><code>credential_configurations_supported</code>: REQUIRED. Object that describes specifics of the Credential that the Credential Issuer supports issuance of. This object contains a list of name/value pairs, where each name is a unique identifier of the supported Credential being described. This identifier is used in the Credential Offer as defined in <a href="#credential-offer-parameters" class="auto internal xref">Section 4.1.1</a> to communicate to the Wallet which Credential is being offered. The value is an object that contains metadata about a specific Credential and contains the following parameters defined by this specification:<a href="#section-12.2.4-2.11.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-12.2.4-2.11.2.1">
                  <code>format</code>: REQUIRED. A JSON string identifying the format of this Credential, i.e., <code>jwt_vc_json</code> or <code>ldp_vc</code>. Depending on the format value, the object contains further elements defining the type and (optionally) particular claims the Credential MAY contain and information about how to display the Credential. <a href="#format-profiles" class="auto internal xref">Appendix A</a> contains Credential Format Profiles introduced by this specification.<a href="#section-12.2.4-2.11.2.1" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-12.2.4-2.11.2.2">
                  <code>scope</code>: OPTIONAL. A JSON string identifying the scope value that this Credential Issuer supports for this particular Credential. The value can be the same across multiple <code>credential_configurations_supported</code> objects. The Authorization Server MUST be able to uniquely identify the Credential Issuer based on the scope value. The Wallet can use this value in the Authorization Request as defined in <a href="#credential-request-using-type-specific-scope" class="auto internal xref">Section 5.1.2</a>. Scope values in this Credential Issuer metadata MAY duplicate those in the <code>scopes_supported</code> parameter of the Authorization Server. If <code>scope</code> is absent, the only way to request the Credential is using <code>authorization_details</code> <span>[<a href="#RFC9396" class="cite xref">RFC9396</a>]</span> - in this case, the OAuth Authorization Server metadata for one of the Authorization Servers found from the Credential Issuer's Metadata must contain an <code>authorization_details_types_supported</code> that contains <code>openid_credential</code>.<a href="#section-12.2.4-2.11.2.2" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-12.2.4-2.11.2.3">
                  <code>credential_signing_alg_values_supported</code>: OPTIONAL. A non-empty array of algorithm identifiers that identify the algorithms that the Issuer uses to sign the issued Credential. Algorithm identifier types and values used are determined by the Credential Format and are defined in <a href="#format-profiles" class="auto internal xref">Appendix A</a>.<a href="#section-12.2.4-2.11.2.3" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-12.2.4-2.11.2.4">
                  <code>cryptographic_binding_methods_supported</code>: OPTIONAL. A non-empty array of case sensitive strings that identify the representation of the cryptographic key material that the issued Credential is bound to, as defined in <a href="#credential-binding" class="auto internal xref">Section 8.1</a>. It MUST be present when Cryptographic Key Binding is required for a Credential, and omitted otherwise. If absent, Cryptographic Key Binding is not required for this credential. Support for keys in JWK format <span>[<a href="#RFC7517" class="cite xref">RFC7517</a>]</span> is indicated by the value <code>jwk</code>. Support for keys expressed as a COSE Key object <span>[<a href="#RFC8152" class="cite xref">RFC8152</a>]</span> (for example, used in <span>[<a href="#ISO.18013-5" class="cite xref">ISO.18013-5</a>]</span>) is indicated by the value <code>cose_key</code>. When the Cryptographic Key Binding method is a DID, valid values are a <code>did:</code> prefix followed by a method-name using a syntax as defined in Section 3.1 of <span>[<a href="#DID-Core" class="cite xref">DID-Core</a>]</span>, but without a <code>:</code> and method-specific-id. For example, support for the DID method with a method-name "example" would be represented by <code>did:example</code>.<a href="#section-12.2.4-2.11.2.4" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-12.2.4-2.11.2.5">
                  <p id="section-12.2.4-2.11.2.5.1"><code>proof_types_supported</code>: OPTIONAL. Object that describes specifics of the key proof(s) that the Credential Issuer supports. It MUST be present if <code>cryptographic_binding_methods_supported</code> is present, and omitted otherwise. If absent, the Wallet is not required to supply proofs when requesting this credential. This object contains a list of name/value pairs, where each name is a unique identifier of the supported proof type(s). Valid values are defined in <a href="#proof-types" class="auto internal xref">Appendix F</a>, other values MAY be used. The Wallet also uses this identifier in the Credential Request as defined in <a href="#credential-request" class="auto internal xref">Section 8.2</a>. The value in the name/value pair is an object that contains metadata about the key proof and contains the following parameters defined by this specification:<a href="#section-12.2.4-2.11.2.5.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-12.2.4-2.11.2.5.2.1">
                      <code>proof_signing_alg_values_supported</code>: REQUIRED. A non-empty array of algorithm identifiers that the Issuer supports for this proof type. The Wallet uses one of them to sign the proof. Algorithm identifier types and values used are determined by the proof type and are defined in <a href="#proof-types" class="auto internal xref">Appendix F</a>.<a href="#section-12.2.4-2.11.2.5.2.1" class="pilcrow">¶</a>
</li>
                    <li class="compact" id="section-12.2.4-2.11.2.5.2.2">
                      <p id="section-12.2.4-2.11.2.5.2.2.1"><code>key_attestations_required</code>: OPTIONAL. Object that describes the requirement for key attestations as described in <a href="#keyattestation" class="auto internal xref">Appendix D</a>, which the Credential Issuer expects the Wallet to send within the proof(s) of the Credential Request. If the Credential Issuer does not require a key attestation, this parameter MUST NOT be present in the metadata. If both <code>key_storage</code> and <code>user_authentication</code> parameters are absent, the <code>key_attestations_required</code> parameter may be empty, indicating a key attestation is needed without additional constraints.<a href="#section-12.2.4-2.11.2.5.2.2.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-12.2.4-2.11.2.5.2.2.2.1">
                          <code>key_storage</code>: OPTIONAL. A non-empty array defining values specified in <a href="#keyattestation-apr" class="auto internal xref">Appendix D.2</a> accepted by the Credential Issuer.<a href="#section-12.2.4-2.11.2.5.2.2.2.1" class="pilcrow">¶</a>
</li>
                        <li class="compact" id="section-12.2.4-2.11.2.5.2.2.2.2">
                          <code>user_authentication</code>: OPTIONAL. A non-empty array defining values specified in <a href="#keyattestation-apr" class="auto internal xref">Appendix D.2</a> accepted by the Credential Issuer.<a href="#section-12.2.4-2.11.2.5.2.2.2.2" class="pilcrow">¶</a>
</li>
                      </ul>
</li>
                  </ul>
</li>
                <li class="compact" id="section-12.2.4-2.11.2.6">
                  <p id="section-12.2.4-2.11.2.6.1"><code>credential_metadata</code>: OPTIONAL. Object containing information relevant to the usage and display of issued Credentials. Credential Format-specific mechanisms can overwrite the information in this object to convey Credential metadata. Format-specific mechanisms, such as SD-JWT VC display metadata are always preferred by the Wallet over the information in this object, which serves as the default fallback. Below is a non-exhaustive list of parameters that MAY be included:<a href="#section-12.2.4-2.11.2.6.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-12.2.4-2.11.2.6.2.1">
                      <p id="section-12.2.4-2.11.2.6.2.1.1"><code>display</code>: OPTIONAL. A non-empty array of objects, where each object contains the display properties of the supported Credential for a certain language. Below is a non-exhaustive list of parameters that MAY be included.<a href="#section-12.2.4-2.11.2.6.2.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-12.2.4-2.11.2.6.2.1.2.1">
                          <code>name</code>: REQUIRED. String value of a display name for the Credential.<a href="#section-12.2.4-2.11.2.6.2.1.2.1" class="pilcrow">¶</a>
</li>
                        <li class="compact" id="section-12.2.4-2.11.2.6.2.1.2.2">
                          <code>locale</code>: OPTIONAL. String value that identifies the language of this object represented as a language tag taken from values defined in BCP47 <span>[<a href="#RFC5646" class="cite xref">RFC5646</a>]</span>. Multiple <code>display</code> objects MAY be included for separate languages. There MUST be only one object for each language identifier.<a href="#section-12.2.4-2.11.2.6.2.1.2.2" class="pilcrow">¶</a>
</li>
                        <li class="compact" id="section-12.2.4-2.11.2.6.2.1.2.3">
                          <p id="section-12.2.4-2.11.2.6.2.1.2.3.1"><code>logo</code>: OPTIONAL. Object with information about the logo of the Credential. The following non-exhaustive set of parameters MAY be included:<a href="#section-12.2.4-2.11.2.6.2.1.2.3.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-12.2.4-2.11.2.6.2.1.2.3.2.1">
                              <code>uri</code>: REQUIRED. String value that contains a URI where the Wallet can obtain the logo of the Credential from the Credential Issuer. The Wallet needs to determine the scheme, since the URI value could use the <code>https:</code> scheme, the <code>data:</code> scheme, etc.<a href="#section-12.2.4-2.11.2.6.2.1.2.3.2.1" class="pilcrow">¶</a>
</li>
                            <li class="compact" id="section-12.2.4-2.11.2.6.2.1.2.3.2.2">
                              <code>alt_text</code>: OPTIONAL. String value of the alternative text for the logo image.<a href="#section-12.2.4-2.11.2.6.2.1.2.3.2.2" class="pilcrow">¶</a>
</li>
                          </ul>
</li>
                        <li class="compact" id="section-12.2.4-2.11.2.6.2.1.2.4">
                          <code>description</code>: OPTIONAL. String value of a description of the Credential.<a href="#section-12.2.4-2.11.2.6.2.1.2.4" class="pilcrow">¶</a>
</li>
                        <li class="compact" id="section-12.2.4-2.11.2.6.2.1.2.5">
                          <code>background_color</code>: OPTIONAL. String value of a background color of the Credential represented as numerical color values defined in CSS Color Module Level 3 <span>[<a href="#CSS-Color" class="cite xref">CSS-Color</a>]</span>.<a href="#section-12.2.4-2.11.2.6.2.1.2.5" class="pilcrow">¶</a>
</li>
                        <li class="compact" id="section-12.2.4-2.11.2.6.2.1.2.6">
                          <p id="section-12.2.4-2.11.2.6.2.1.2.6.1"><code>background_image</code>: OPTIONAL. Object with information about the background image of the Credential. At least the following parameter MUST be included:<a href="#section-12.2.4-2.11.2.6.2.1.2.6.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-12.2.4-2.11.2.6.2.1.2.6.2.1">
                              <code>uri</code>: REQUIRED. String value that contains a URI where the Wallet can obtain the background image of the Credential from the Credential Issuer. The Wallet needs to determine the scheme, since the URI value could use the <code>https:</code> scheme, the <code>data:</code> scheme, etc.<a href="#section-12.2.4-2.11.2.6.2.1.2.6.2.1" class="pilcrow">¶</a>
</li>
                          </ul>
</li>
                        <li class="compact" id="section-12.2.4-2.11.2.6.2.1.2.7">
                          <code>text_color</code>: OPTIONAL. String value of a text color of the Credential represented as numerical color values defined in CSS Color Module Level 3 <span>[<a href="#CSS-Color" class="cite xref">CSS-Color</a>]</span>.<a href="#section-12.2.4-2.11.2.6.2.1.2.7" class="pilcrow">¶</a>
</li>
                      </ul>
</li>
                    <li class="compact" id="section-12.2.4-2.11.2.6.2.2">
                      <code>claims</code>: OPTIONAL. A non-empty array of claims description objects as defined in <a href="#claims-description-issuer-metadata" class="auto internal xref">Appendix B.2</a>.<a href="#section-12.2.4-2.11.2.6.2.2" class="pilcrow">¶</a>
</li>
                  </ul>
</li>
              </ul>
</li>
          </ul>
<p id="section-12.2.4-3">An Authorization Server that only supports the Pre-Authorized Code grant type MAY omit the <code>response_types_supported</code> parameter in its metadata despite <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span> mandating it.<a href="#section-12.2.4-3" class="pilcrow">¶</a></p>
<p id="section-12.2.4-4">Note: It can be challenging for a Credential Issuer that accepts tokens from multiple Authorization Servers to introspect an Access Token to check the validity and determine the permissions granted. Some ways to achieve this are relying on Authorization Servers that use <span>[<a href="#RFC9068" class="cite xref">RFC9068</a>]</span> or by the Credential Issuer understanding the proprietary Access Token structures of the Authorization Servers.<a href="#section-12.2.4-4" class="pilcrow">¶</a></p>
<p id="section-12.2.4-5">Depending on the Credential Format, additional parameters might be present in the <code>credential_configurations_supported</code> object values, such as information about claims in the Credential. For Credential Format-specific claims, see the "Credential Issuer Metadata" subsections in <a href="#format-profiles" class="auto internal xref">Appendix A</a>.<a href="#section-12.2.4-5" class="pilcrow">¶</a></p>
<p id="section-12.2.4-6">The Authorization Server MUST be able to determine from the Issuer metadata what claims are disclosed by the requested Credentials to be able to render meaningful End-User consent.<a href="#section-12.2.4-6" class="pilcrow">¶</a></p>
<p id="section-12.2.4-7">Additional Credential Issuer metadata parameters MAY be defined and used.
The Wallet MUST ignore any unrecognized parameters.<a href="#section-12.2.4-7" class="pilcrow">¶</a></p>
<p id="section-12.2.4-8">The following is a non-normative example of Credential Issuer metadata of a Credential in the IETF SD-JWT VC <span>[<a href="#I-D.ietf-oauth-sd-jwt-vc" class="cite xref">I-D.ietf-oauth-sd-jwt-vc</a>]</span> format:<a href="#section-12.2.4-8" class="pilcrow">¶</a></p>
<div class="breakable lang-json sourcecode" id="section-12.2.4-9">
<pre>{
  "credential_configurations_supported": {
    "SD_JWT_VC_example_in_OpenID4VCI": {
      "format": "dc+sd-jwt",
      "scope": "SD_JWT_VC_example_in_OpenID4VCI",
      "cryptographic_binding_methods_supported": [
        "jwk"
      ],
      "credential_signing_alg_values_supported": [
        "ES256"
      ],
      "proof_types_supported": {
        "jwt": {
          "proof_signing_alg_values_supported": [
            "ES256"
          ],
          "key_attestations_required": {
            "key_storage": [ "iso_18045_moderate" ],
            "user_authentication": [ "iso_18045_moderate" ]
          }
        }
      },
      "vct": "SD_JWT_VC_example_in_OpenID4VCI",
      "credential_metadata": {
        "display": [
          {
            "name": "IdentityCredential",
            "logo": {
              "uri": "https://university.example.edu/public/logo.png",
              "alt_text": "a square logo of a university"
            },
            "locale": "en-US",
            "background_color": "#12107c",
            "text_color": "#FFFFFF"
          }
        ],
        "claims": [
          {
            "path": ["given_name"],
            "display": [
              {
                "name": "Given Name",
                "locale": "en-US"
              },
              {
                "name": "Vorname",
                "locale": "de-DE"
              }
            ]
          },
          {
            "path": ["family_name"],
            "display": [
              {
                "name": "Surname",
                "locale": "en-US"
              },
              {
                "name": "Nachname",
                "locale": "de-DE"
              }
            ]
          },
          {"path": ["email"]},
          {"path": ["phone_number"]},
          {
            "path": ["address"],
            "display": [
              {
                "name": "Place of residence",
                "locale": "en-US"
              },
              {
                "name": "Wohnsitz",
                "locale": "de-DE"
              }
            ]
          },
          {"path": ["address", "street_address"]},
          {"path": ["address", "locality"]},
          {"path": ["address", "region"]},
          {"path": ["address", "country"]},
          {"path": ["birthdate"]},
          {"path": ["is_over_18"]},
          {"path": ["is_over_21"]},
          {"path": ["is_over_65"]}
        ]
      }
    }
  }
}
</pre><a href="#section-12.2.4-9" class="pilcrow">¶</a>
</div>
<p id="section-12.2.4-10">Note: The Client MAY use other mechanisms to obtain information about the Verifiable Credentials that a Credential Issuer can issue.<a href="#section-12.2.4-10" class="pilcrow">¶</a></p>
<p id="section-12.2.4-11">See <a href="#additional-issuer-metadata-examples" class="auto internal xref">Appendix I.1</a> for additional examples of Credential Issuer Metadata.<a href="#section-12.2.4-11" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="as-metadata">
<section id="section-12.3">
        <h3 id="name-oauth-20-authorization-serv">
<a href="#section-12.3" class="section-number selfRef">12.3. </a><a href="#name-oauth-20-authorization-serv" class="section-name selfRef">OAuth 2.0 Authorization Server Metadata</a>
        </h3>
<p id="section-12.3-1">This specification also defines a new OAuth 2.0 Authorization Server metadata <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span> parameter to publish whether the Authorization Server that the Credential Issuer relies on for authorization supports anonymous Token Requests with the Pre-Authorized Grant Type. It is defined as follows:<a href="#section-12.3-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-12.3-2.1">
            <code>pre-authorized_grant_anonymous_access_supported</code>: OPTIONAL. A boolean indicating whether the Credential Issuer accepts a Token Request with a Pre-Authorized Code but without a <code>client_id</code>. The default is <code>false</code>.<a href="#section-12.3-2.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-12.3-3">Additional Authorization Server metadata parameters MAY be defined and used,
as described in <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span>.
The Wallet MUST ignore any unrecognized parameters.<a href="#section-12.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-13">
      <h2 id="name-security-considerations">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="formal-security-analysis">
<section id="section-13.1">
        <h3 id="name-formal-security-analysis">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-formal-security-analysis" class="section-name selfRef">Formal Security Analysis</a>
        </h3>
<p id="section-13.1-1">The security properties of some features in a previous revision of this specification have been formally analyzed, see <span>[<a href="#secanalysis" class="cite xref">secanalysis</a>]</span>.<a href="#section-13.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="securitybcp">
<section id="section-13.2">
        <h3 id="name-best-current-practice-for-o">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-best-current-practice-for-o" class="section-name selfRef">Best Current Practice for OAuth 2.0 Security</a>
        </h3>
<p id="section-13.2-1">Implementers of this specification SHOULD follow the Best Current Practice for OAuth 2.0 Security given in <span>[<a href="#BCP240" class="cite xref">BCP240</a>]</span>. It is RECOMMENDED that implementers do this by following the <span>[<a href="#FAPI2_Security_Profile" class="cite xref">FAPI2_Security_Profile</a>]</span> where it is applicable.<a href="#section-13.2-1" class="pilcrow">¶</a></p>
<p id="section-13.2-2">The parts of <span>[<a href="#FAPI2_Security_Profile" class="cite xref">FAPI2_Security_Profile</a>]</span> that may not be applicable when using this specification are:<a href="#section-13.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-13.2-3">
<li id="section-13.2-3.1">Client authentication: The private_key_jwt and MTLS client authentication methods may not be practical to implement in a secure way for native app Wallets. The use of Wallet Attestations as defined in <a href="#walletattestation" class="auto internal xref">Appendix E</a> is RECOMMENDED instead.<a href="#section-13.2-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-13.2-3.2">Sender-constrained access tokens: MTLS sender constrained access token may not be practical to implement in a secure way for native app Wallets. The use of DPoP <span>[<a href="#RFC9449" class="cite xref">RFC9449</a>]</span> is RECOMMENDED.<a href="#section-13.2-3.2" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="trust-between-wallet-and-issuer">
<section id="section-13.3">
        <h3 id="name-trust-between-wallet-and-is">
<a href="#section-13.3" class="section-number selfRef">13.3. </a><a href="#name-trust-between-wallet-and-is" class="section-name selfRef">Trust between Wallet and Issuer</a>
        </h3>
<p id="section-13.3-1">Credential Issuers often want to know what Wallet they are issuing Credentials to and how private keys are managed for the following reasons:<a href="#section-13.3-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-13.3-2.1">The Credential Issuer MAY want to ensure that private keys are properly protected from exfiltration and replay to prevent an adversary from impersonating the legitimate Credential Holder by presenting their Credentials.<a href="#section-13.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-13.3-2.2">The Credential Issuer MAY also want to ensure that the Wallet managing the Credentials adheres to certain policies and, potentially, was audited and approved under a certain regulatory and/or commercial scheme.<a href="#section-13.3-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-13.3-3">The following mechanisms in concert can be utilized to fulfill those objectives:<a href="#section-13.3-3" class="pilcrow">¶</a></p>
<p id="section-13.3-4"><strong>Key attestation</strong> is a mechanism where the key storage component or Wallet Provider asserts the cryptographic public keys and their security policy. The Wallet MAY provide this data in the Credential Request to allow the Credential Issuer to validate the cryptographic key management policy. This requires the Credential Issuer to rely on the trust anchor of the key attestation and the respective key management policy. While some existing platforms have key attestation formats, this specification introduces a common key attestation format that may be used by Credential Issuers for improved interoperability, see <a href="#keyattestation" class="auto internal xref">Appendix D</a>.<a href="#section-13.3-4" class="pilcrow">¶</a></p>
<p id="section-13.3-5"><strong>Client Authentication</strong> enables a Wallet to authenticate with the Credential Issuer's Authorization Server. This authentication ensures that the Wallet complies with the Authorization Server's security, compliance, and governance standards, which may be required by trust frameworks, regulatory requirements, laws, or internal policies. Any method listed in the <a href="https://www.iana.org/assignments/oauth-parameters/oauth-parameters.xhtml#token-endpoint-auth-method">OAuth Token Endpoint Authentication Methods IANA Registry</a> can be used for authentication during the Pushed Authorization or Token Request. The Authorization Server SHOULD specify its client authentication requirements using the <code>token_endpoint_auth_method</code> metadata parameter.<a href="#section-13.3-5" class="pilcrow">¶</a></p>
<p id="section-13.3-6"><strong>Wallet Attestation</strong> is a signed proof provided by the Wallet Provider, verifying the client's authenticity and genuineness. This process uses the mechanisms outlined in Attestation-Based Client Authentication, described in the Section <a href="#walletattestation">Wallet Attestation</a>. Once obtained, the Wallet Attestation can be used as a client authentication for the Wallet.<a href="#section-13.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="split-architecture-wallets">
<section id="section-13.4">
        <h3 id="name-split-architecture-wallets">
<a href="#section-13.4" class="section-number selfRef">13.4. </a><a href="#name-split-architecture-wallets" class="section-name selfRef">Split-Architecture Wallets</a>
        </h3>
<p id="section-13.4-1">A Wallet may consist of multiple components with varying levels of trust, security, and privacy. A common example of this is an architecture that involves both a server-side component and a native application. While the server component can offer advantages such as enhanced reliability, centralized security controls, and certain privacy protections, it also introduces distinct risks. These include increased difficulty in conducting audits (particularly by external security experts), the potential for opaque or unverified updates, and a higher susceptibility to insider threats.<a href="#section-13.4-1" class="pilcrow">¶</a></p>
<p id="section-13.4-2">To ensure the server component can provide meaningful functionality while preserving user privacy, the principle of data minimization is encouraged to be employed. In particular, ensure the confidentiality of user data, it is best to apply application level encryption to the Credential Request/Response, from the device through the server component.<a href="#section-13.4-2" class="pilcrow">¶</a></p>
<p id="section-13.4-3">It is important to note that when the server component acts as the trust anchor (e.g., for Wallet Attestations or Key Attestations), it cannot also serve as a safeguard against itself.<a href="#section-13.4-3" class="pilcrow">¶</a></p>
<p id="section-13.4-4">If the server component has access to authorization codes, pre-authorization codes, or other sensitive tokens or proofs, and no additional mitigations are implemented beyond those outlined here, it MAY be able to impersonate the application and gain access to confidential data. In cases where the server component is not fully trusted, these sensitive elements MUST NOT be passed to or routed through it.<a href="#section-13.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credential-offer-security">
<section id="section-13.5">
        <h3 id="name-credential-offer-2">
<a href="#section-13.5" class="section-number selfRef">13.5. </a><a href="#name-credential-offer-2" class="section-name selfRef">Credential Offer</a>
        </h3>
<p id="section-13.5-1">The Wallet MUST consider the parameter values in the Credential Offer as not trustworthy, since the origin is not authenticated and the message integrity is not protected. The Credential Issuer is not considered trustworthy just because it sent the Credential Offer. Therefore, the Wallet MUST perform the same validation checks on the Credential Issuer as it would when initiating the flow directly from the Wallet. An attacker might attempt to use a Credential Offer to conduct a phishing or injection attack.<a href="#section-13.5-1" class="pilcrow">¶</a></p>
<p id="section-13.5-2">The Wallet MUST NOT accept Credentials just because this mechanism was used. All protocol steps defined in this specification MUST be performed in the same way as if the Wallet would have started the flow.<a href="#section-13.5-2" class="pilcrow">¶</a></p>
<p id="section-13.5-3">The Credential Issuer MUST ensure the release of any privacy-sensitive data in Credential Offer is legal.<a href="#section-13.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations-pre-authz-code">
<section id="section-13.6">
        <h3 id="name-pre-authorized-code-flow-2">
<a href="#section-13.6" class="section-number selfRef">13.6. </a><a href="#name-pre-authorized-code-flow-2" class="section-name selfRef">Pre-Authorized Code Flow</a>
        </h3>
<div id="replay-prevention">
<section id="section-13.6.1">
          <h4 id="name-replay-prevention">
<a href="#section-13.6.1" class="section-number selfRef">13.6.1. </a><a href="#name-replay-prevention" class="section-name selfRef">Replay Prevention</a>
          </h4>
<p id="section-13.6.1-1">The Pre-Authorized Code Flow is vulnerable to the replay of the Pre-Authorized Code, because by design, it is not bound to a certain session (as the Authorization Code Flow does with PKCE). This means an attacker can replay the Pre-Authorized Code meant for a victim at another device. In a 'shoulder surfing' scenario, the attacker might scan the QR code while it is displayed on the victim's screen, and thereby get access to the Credential. As the Pre-Authorized Code is presented as a link or QR code, either may be shared beyond its intended use, allowing others to replay the transaction. Such replay attacks must be prevented using other means. The design facilitates the following options:<a href="#section-13.6.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-13.6.1-2.1">Transaction Code: the Credential Issuer might set up a Transaction Code with the End-User (e.g., via text message or email) that needs to be presented in the Token Request.<a href="#section-13.6.1-2.1" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="transaction-code-phishing">
<section id="section-13.6.2">
          <h4 id="name-transaction-code-phishing">
<a href="#section-13.6.2" class="section-number selfRef">13.6.2. </a><a href="#name-transaction-code-phishing" class="section-name selfRef">Transaction Code Phishing</a>
          </h4>
<p id="section-13.6.2-1">An attacker might leverage the Credential issuance process and the End-User's trust in the Wallet to phish Transaction Codes sent out by a different service that grant the attacker access to services other than Credential issuance. The attacker could set up a Credential Issuer site and in parallel to the issuance request, trigger transmission of a Transaction Code to the End-User's phone from a service other than Credential issuance, e.g., from a payment service. The End-User would then be asked to enter this Transaction Code into the Wallet and since the Wallet sends this Transaction Code to the Token Endpoint of the Credential Issuer (the attacker), the attacker would get access to the Transaction Code, and access to that other service.<a href="#section-13.6.2-1" class="pilcrow">¶</a></p>
<p id="section-13.6.2-2">In order to cope with that issue, the Wallet is RECOMMENDED to interact with trusted Credential Issuers only. In that case, the Wallet would not process a Credential Offer with an untrusted issuer URL. The Wallet MAY also show the End-User the endpoint of the Credential Issuer it will be sending the Transaction Code to and ask the End-User for confirmation.<a href="#section-13.6.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="credential-lifecycle-management">
<section id="section-13.7">
        <h3 id="name-credential-lifecycle-manage">
<a href="#section-13.7" class="section-number selfRef">13.7. </a><a href="#name-credential-lifecycle-manage" class="section-name selfRef">Credential Lifecycle Management</a>
        </h3>
<p id="section-13.7-1">The Credential Issuer is supposed to be responsible for the lifecycle of its Credentials. This means the Credential Issuer will invalidate Credentials when it deems appropriate, e.g., if it detects fraudulent behavior.<a href="#section-13.7-1" class="pilcrow">¶</a></p>
<p id="section-13.7-2">The Wallet is supposed to detect signs of fraudulent behavior related to the Credential management in the Wallet (e.g., device rooting) and to act upon such signals. Options include Credential revocation at the Credential Issuer and/or invalidation of the key material used to cryptographically bind the Credential to the identifier of the End-User possessing that Credential.<a href="#section-13.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-proof-replay">
<section id="section-13.8">
        <h3 id="name-proof-replay">
<a href="#section-13.8" class="section-number selfRef">13.8. </a><a href="#name-proof-replay" class="section-name selfRef">Proof replay</a>
        </h3>
<p id="section-13.8-1">If an adversary obtains a key proof (as outlined in <a href="#proof-types" class="auto internal xref">Appendix F</a>), they could potentially replay that proof to a Credential Issuer to obtain a duplicate Credential or multiple duplicates issued to the same key. The <code>c_nonce</code> parameter serves as the main defense against this, by providing Credential Issuers with a mechanism to determine freshness of a generated proof and thus reject a proof when required. It is RECOMMENDED that Credential Issuers utilize the Nonce Endpoint as specified in <a href="#nonce-endpoint" class="auto internal xref">Section 7</a> to protect against this. A Wallet can continue using a given nonce until it is rejected by the Credential Issuer. The Credential Issuer determines for how long a particular nonce can be used.<a href="#section-13.8-1" class="pilcrow">¶</a></p>
<p id="section-13.8-2">Note: For the attacker to be able to present a Credential bound to a replayed key proof to the Verifier, the attacker also needs to obtain the victim's private key. To limit this, Credential Issuers are RECOMMENDED to check how the Wallet protects the private keys, using mechanisms defined in <a href="#keyattestation" class="auto internal xref">Appendix D</a>.<a href="#section-13.8-2" class="pilcrow">¶</a></p>
<p id="section-13.8-3">Note: To accommodate for clock offsets, the Credential Issuer server MAY accept proofs that carry an <code>iat</code> time in the reasonably near future (on the order of seconds or minutes). Because clock skews between servers and Clients may be large, servers MAY limit key proof lifetimes by using server-provided nonce values containing the time at the server rather than comparing the client-supplied <code>iat</code> time to the time at the server. Nonces created in this way yield the same result even in the face of arbitrarily large clock skews.<a href="#section-13.8-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tls-requirements">
<section id="section-13.9">
        <h3 id="name-tls-requirements">
<a href="#section-13.9" class="section-number selfRef">13.9. </a><a href="#name-tls-requirements" class="section-name selfRef">TLS Requirements</a>
        </h3>
<p id="section-13.9-1">Implementations MUST follow <span>[<a href="#BCP195" class="cite xref">BCP195</a>]</span>.
Whenever TLS is used, a TLS server certificate check MUST be performed, per <span>[<a href="#RFC6125" class="cite xref">RFC6125</a>]</span>.<a href="#section-13.9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protecting-the-access-token">
<section id="section-13.10">
        <h3 id="name-protecting-the-access-token">
<a href="#section-13.10" class="section-number selfRef">13.10. </a><a href="#name-protecting-the-access-token" class="section-name selfRef">Protecting the Access Token</a>
        </h3>
<p id="section-13.10-1">Access Tokens represent End-User authorization and consent to issue certain Credential(s). Long-lived Access Tokens giving access to Credentials MUST not be issued unless sender-constrained. Access Tokens with lifetimes longer than 5 minutes are, in general, considered long lived.<a href="#section-13.10-1" class="pilcrow">¶</a></p>
<p id="section-13.10-2">To sender-constrain Access Tokens, see the recommendations in <a href="#securitybcp" class="auto internal xref">Section 13.2</a>. If Bearer Access Tokens are stored by the Wallet, they MUST be stored in a secure manner, for example, encrypted using a key stored in a protected key store.<a href="#section-13.10-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="encryption-security-considersations">
<section id="section-13.11">
        <h3 id="name-application-layer-encryptio">
<a href="#section-13.11" class="section-number selfRef">13.11. </a><a href="#name-application-layer-encryptio" class="section-name selfRef">Application-Layer Encryption</a>
        </h3>
<p id="section-13.11-1">Depending on the architecture of the Wallet and the Issuer, adding encryption to requests and responses, beyond transport-level security (TLS), can offer enhanced data confidentiality. This can come at the cost of added complexity. This approach can be particularly relevant when the Wallet consists of multiple components with varying trust levels, such as a backend server and a client application. Similar considerations may apply to more complex Issuer architectures.<a href="#section-13.11-1" class="pilcrow">¶</a></p>
<p id="section-13.11-2">It is important that the Wallet component responsible for encryption can establish trust in the Issuer's key material to prevent man-in-the-middle attacks. The simplest way to achieve this is by retrieving the keys directly from the Issuer’s hosted Issuer Metadata. Alternatively, in the case of signed Issuer Metadata, the signature can be verified to ensure authenticity.<a href="#section-13.11-2" class="pilcrow">¶</a></p>
<p id="section-13.11-3">In cases where the application-layer encryption begins and terminates in the same component as TLS, it provides no additional protection.<a href="#section-13.11-3" class="pilcrow">¶</a></p>
<p id="section-13.11-4">While application-layer encryption can enhance the confidentiality of data in transit, it does not protect against other threats, such as access token theft, client impersonation, or other forms of unauthorized access. These risks must be mitigated through additional security measures.<a href="#section-13.11-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="implementation-considerations">
<section id="section-14">
      <h2 id="name-implementation-consideratio">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-implementation-consideratio" class="section-name selfRef">Implementation Considerations</a>
      </h2>
<div id="claims-based-binding">
<section id="section-14.1">
        <h3 id="name-claims-based-holder-binding">
<a href="#section-14.1" class="section-number selfRef">14.1. </a><a href="#name-claims-based-holder-binding" class="section-name selfRef">Claims-based Holder Binding of the Credential to the End-User possessing the Credential</a>
        </h3>
<p id="section-14.1-1">Credentials not cryptographically bound to the identifier of the End-User possessing it (see <a href="#credential-binding" class="auto internal xref">Section 8.1</a>), should be bound to the End-User possessing the Credential, based on the claims included in the Credential.<a href="#section-14.1-1" class="pilcrow">¶</a></p>
<p id="section-14.1-2">In Claims-based Holder Binding, no Cryptographic Key Binding material is provided. Instead, the issued Credential includes End-User claims that can be used by the Verifier to verify possession of the Credential by requesting presentation of existing forms of physical or digital identification that includes the same claims (e.g., a driving license or other ID cards in person, or an online ID verification service).<a href="#section-14.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="no-binding">
<section id="section-14.2">
        <h3 id="name-binding-of-the-credential-w">
<a href="#section-14.2" class="section-number selfRef">14.2. </a><a href="#name-binding-of-the-credential-w" class="section-name selfRef">Binding of the Credential without Cryptographic Key Binding or Claims-based Holder Binding</a>
        </h3>
<p id="section-14.2-1">Some Credential Issuers might choose to issue bearer Credentials without either Cryptographic Key Binding or Claims-based Holder Binding because they are meant to be presented without proof of possession.<a href="#section-14.2-1" class="pilcrow">¶</a></p>
<p id="section-14.2-2">One such use case is low assurance Credentials, such as coupons or tickets.<a href="#section-14.2-2" class="pilcrow">¶</a></p>
<p id="section-14.2-3">Another use case is when the Credential Issuer uses cryptographic schemes that can provide binding to the End-User possessing that Credential without explicit cryptographic material being supplied by the application used by that End-User. For example, in the case of the BBS Signature Scheme, the issued Credential itself is a secret and only a derivation from the Credential is presented to the Verifier. Effectively, the Credential is bound to the Credential Issuer's signature on the Credential, which becomes a shared secret transferred from the Credential Issuer to the End-User.<a href="#section-14.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="multiple-accesses-to-the-credential-endpoint">
<section id="section-14.3">
        <h3 id="name-multiple-accesses-to-the-cr">
<a href="#section-14.3" class="section-number selfRef">14.3. </a><a href="#name-multiple-accesses-to-the-cr" class="section-name selfRef">Multiple Accesses to the Credential Endpoint</a>
        </h3>
<p id="section-14.3-1">The Credential Endpoint can be accessed multiple times by a Wallet using the same Access Token, even for the same Credential. The Credential Issuer determines if the subsequent successful requests will return the same or an updated Credential, such as having a new expiration time or using the most current End-User claims.<a href="#section-14.3-1" class="pilcrow">¶</a></p>
<p id="section-14.3-2">The Credential Issuer MAY also decide to no longer accept the Access Token and a re-authentication or Token Refresh (see <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, Section 6) MAY be required at the Credential Issuer's discretion. The policies between the Credential Endpoint and the Authorization Server that MAY change the behavior of what is returned with a new Access Token are beyond the scope of this specification (see Section 7 of <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>).<a href="#section-14.3-2" class="pilcrow">¶</a></p>
<p id="section-14.3-3">The Credential Issuer SHOULD NOT revoke previously issued, valid Credentials solely as a result of a subsequent successful Credential Request. This, for example, ensures that the Wallet can keep a desired number of Credentials without causing additional revocation and issuance overhead.<a href="#section-14.3-3" class="pilcrow">¶</a></p>
<p id="section-14.3-4">The action leading to the Wallet performing another Credential Request can also be triggered by a background process, or by the Credential Issuer using an out-of-band mechanism (SMS, email, etc.) to inform the End-User.<a href="#section-14.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="relationship-between-the-credential-issuer-identifier-in-the-metadata-and-the-issuer-identifier-in-the-issued-credential">
<section id="section-14.4">
        <h3 id="name-relationship-between-the-cr">
<a href="#section-14.4" class="section-number selfRef">14.4. </a><a href="#name-relationship-between-the-cr" class="section-name selfRef">Relationship between the Credential Issuer Identifier in the Metadata and the Issuer Identifier in the Issued Credential</a>
        </h3>
<p id="section-14.4-1">The Credential Issuer Identifier is always a URL using the <code>https</code> scheme, as defined in <a href="#credential-issuer-identifier" class="auto internal xref">Section 12.2.1</a>. Depending on the Credential Format, the Issuer Identifier in the issued Credential may not be a URL using the <code>https</code> scheme. Some other forms that it can take are a DID included in the <code>issuer</code> property in a <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span> format, or the <code>Subject</code> value of the document signer certificate included in the <code>x5chain</code> element in an <span>[<a href="#ISO.18013-5" class="cite xref">ISO.18013-5</a>]</span> format.<a href="#section-14.4-1" class="pilcrow">¶</a></p>
<p id="section-14.4-2">When the Issuer Identifier in the issued Credential is a DID, a non-exhaustive list of mechanisms the Credential Issuer MAY use to bind to the Credential Issuer Identifier is as follows:<a href="#section-14.4-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-14.4-3">
<li id="section-14.4-3.1">Use the <span>[<a href="#DIF.Well-Known_DID" class="cite xref">DIF.Well-Known_DID</a>]</span> Specification to provide binding between a DID and a certain domain.<a href="#section-14.4-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-14.4-3.2">If the Issuer Identifier in the issued Credential is an object, add to the object a <code>credential_issuer</code> claim, as defined in <a href="#credential-issuer-identifier" class="auto internal xref">Section 12.2.1</a>.<a href="#section-14.4-3.2" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-14.4-4">The Wallet MAY check the binding between the Credential Issuer Identifier and the Issuer Identifier in the issued Credential.<a href="#section-14.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="refreshing-issued-credentials">
<section id="section-14.5">
        <h3 id="name-refreshing-issued-credentia">
<a href="#section-14.5" class="section-number selfRef">14.5. </a><a href="#name-refreshing-issued-credentia" class="section-name selfRef">Refreshing Issued Credentials</a>
        </h3>
<p id="section-14.5-1">After a Verifiable Credential has been issued to the Holder, claim values about the subject of a Credential or a signature on the Credential may need to be updated. There are two possible mechanisms to do so.<a href="#section-14.5-1" class="pilcrow">¶</a></p>
<p id="section-14.5-2">First, the Wallet may receive an updated version of a Credential from a Credential Endpoint using a valid Access Token. This does not involve interaction with the End-User. If the Credential Issuer issued a Refresh Token to the Wallet, the Wallet would obtain a fresh Access Token by making a request to the Token Endpoint, as defined in Section 6 of <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-14.5-2" class="pilcrow">¶</a></p>
<p id="section-14.5-3">Second, the Credential Issuer can reissue the Credential by starting the issuance process from the beginning. This would involve interaction with the End-User. A Credential needs to be reissued if the Wallet does not have a valid Access Token or a valid Refresh Token. With this approach, when a new Credential is issued, the Wallet might need to check if it already has a Credential of the same type and, if necessary, delete the old Credential. Otherwise, the Wallet might end up with more than one Credential of the same type, without knowing which one is the latest.<a href="#section-14.5-3" class="pilcrow">¶</a></p>
<p id="section-14.5-4">Credential Refresh can be initiated by the Wallet independently from the Credential Issuer, or the Credential Issuer can send a signal to the Wallet asking it to request Credential refresh. How the Credential Issuer sends such a signal is out of scope of this specification.<a href="#section-14.5-4" class="pilcrow">¶</a></p>
<p id="section-14.5-5">It is up to the Credential Issuer whether to update both the signature and the claim values, or only the signature.<a href="#section-14.5-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="batch-issuing-credentials">
<section id="section-14.6">
        <h3 id="name-batch-issuing-credentials">
<a href="#section-14.6" class="section-number selfRef">14.6. </a><a href="#name-batch-issuing-credentials" class="section-name selfRef">Batch Issuing Credentials</a>
        </h3>
<p id="section-14.6-1">The Credential Issuer determines the number of the Credentials issued in the Credential Response, regardless of number of proofs/keys contained in the <code>proofs</code> parameter in the Credential Request.<a href="#section-14.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pre-final-specifications">
<section id="section-14.7">
        <h3 id="name-pre-final-specifications">
<a href="#section-14.7" class="section-number selfRef">14.7. </a><a href="#name-pre-final-specifications" class="section-name selfRef">Pre-Final Specifications</a>
        </h3>
<p id="section-14.7-1">Implementers should be aware that this specification uses several specifications that are not yet final specifications. Those specifications are:<a href="#section-14.7-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-14.7-2.1">OpenID Federation 1.0 draft -43 <span>[<a href="#OpenID.Federation" class="cite xref">OpenID.Federation</a>]</span><a href="#section-14.7-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-14.7-2.2">SD-JWT-based Verifiable Credentials (SD-JWT VC) draft -11 <span>[<a href="#I-D.ietf-oauth-sd-jwt-vc" class="cite xref">I-D.ietf-oauth-sd-jwt-vc</a>]</span><a href="#section-14.7-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-14.7-2.3">Attestation-Based Client Authentication draft -07 <span>[<a href="#I-D.ietf-oauth-attestation-based-client-auth" class="cite xref">I-D.ietf-oauth-attestation-based-client-auth</a>]</span><a href="#section-14.7-2.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-14.7-2.4">Token Status List draft -12 <span>[<a href="#I-D.ietf-oauth-status-list" class="cite xref">I-D.ietf-oauth-status-list</a>]</span><a href="#section-14.7-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-14.7-3">While breaking changes to the specifications referenced in this specification are not expected, should they occur, OpenID4VCI implementations should continue to use the specifically referenced versions above in preference to the final versions, unless updated by a profile or new version of this specification.<a href="#section-14.7-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-15">
      <h2 id="name-privacy-considerations">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-15-1">When <span>[<a href="#RFC9396" class="cite xref">RFC9396</a>]</span> is used, the Privacy Considerations of that specification also apply.<a href="#section-15-1" class="pilcrow">¶</a></p>
<p id="section-15-2">The privacy principles of <span>[<a href="#ISO.29100" class="cite xref">ISO.29100</a>]</span> should be adhered to.<a href="#section-15-2" class="pilcrow">¶</a></p>
<div id="user-consent">
<section id="section-15.1">
        <h3 id="name-user-consent">
<a href="#section-15.1" class="section-number selfRef">15.1. </a><a href="#name-user-consent" class="section-name selfRef">User Consent</a>
        </h3>
<p id="section-15.1-1">The Credential Issuer SHOULD obtain the End-User's consent before issuing Credential(s)
to the Wallet. It SHOULD be made clear to the End-User what information is being included in the
Credential(s) and for what purpose.<a href="#section-15.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="minimum-disclosure">
<section id="section-15.2">
        <h3 id="name-minimum-disclosure">
<a href="#section-15.2" class="section-number selfRef">15.2. </a><a href="#name-minimum-disclosure" class="section-name selfRef">Minimum Disclosure</a>
        </h3>
<p id="section-15.2-1">To ensure minimum disclosure and prevent Verifiers from obtaining claims unnecessary for the
transaction at hand, when issuing Credentials that are intended to be created once and then used a
number of times by the End-User, the Credential Issuers and the Wallets SHOULD implement
Credential Formats that support selective disclosure, or consider issuing a separate Credential
for each user claim.<a href="#section-15.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="storage-of-the-credentials">
<section id="section-15.3">
        <h3 id="name-storage-of-the-credentials">
<a href="#section-15.3" class="section-number selfRef">15.3. </a><a href="#name-storage-of-the-credentials" class="section-name selfRef">Storage of the Credentials</a>
        </h3>
<p id="section-15.3-1">To prevent a leak of End-User data, especially when it is signed, which risks revealing private data of End-Users to
third parties, systems implementing this specification SHOULD be designed to minimize the amount
of End-User data that is stored. All involved parties SHOULD store Verifiable Credentials
containing privacy-sensitive data only for as long as needed, including in log files. Any logging of
End-User data should be carefully considered as to whether it is necessary at all. The time logs are retained
for should be minimized.<a href="#section-15.3-1" class="pilcrow">¶</a></p>
<p id="section-15.3-2">After Issuance, Credential Issuers SHOULD NOT store the Issuer-signed Credentials if they
contain privacy-sensitive data. Wallets SHOULD store Credentials only in encrypted form, and,
wherever possible, use hardware-backed encryption. Wallets SHOULD not store
Credentials longer than needed.<a href="#section-15.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="correlation">
<section id="section-15.4">
        <h3 id="name-correlation">
<a href="#section-15.4" class="section-number selfRef">15.4. </a><a href="#name-correlation" class="section-name selfRef">Correlation</a>
        </h3>
<div id="unique-values-encoded-in-the-credential">
<section id="section-15.4.1">
          <h4 id="name-unique-values-encoded-in-th">
<a href="#section-15.4.1" class="section-number selfRef">15.4.1. </a><a href="#name-unique-values-encoded-in-th" class="section-name selfRef">Unique Values Encoded in the Credential</a>
          </h4>
<p id="section-15.4.1-1">Issuance/presentation or two presentation sessions by the same End-User can be linked on the basis of
unique values encoded in the Credential (End-User claims, identifiers, Issuer signature, etc.) either by colluding Issuer/Verifier or Verifier/Verifier pairs, or by the same Verifier.<a href="#section-15.4.1-1" class="pilcrow">¶</a></p>
<p id="section-15.4.1-2">To prevent these types of correlation, Credential Issuers and Wallets SHOULD use
methods, including but not limited to the following ones:<a href="#section-15.4.1-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-15.4.1-3.1">Issue a batch of Credentials with the same Credential Dataset to facilitate the use of a unique Credential per presentation or per Verifier. This approach solely aids in achieving Verifier-to-Verifier unlinkability.<a href="#section-15.4.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-15.4.1-3.2">Use cryptographic schemes that can provide non-correlation.<a href="#section-15.4.1-3.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-15.4.1-4">Claims containing time-related information, such as issuance or expiration dates, SHOULD be either individually randomized within an appropriate time window (e.g., within the last 24 hours), or rounded (e.g., to the start of the day), to avoid unintended correlation factors.<a href="#section-15.4.1-4" class="pilcrow">¶</a></p>
<p id="section-15.4.1-5">Credential Issuers specifically SHOULD discard values that can be used in collusion with a Verifier to track a user, such as the Issuer's signature or cryptographic key material to which an issued credential was bound to.<a href="#section-15.4.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credential-offer-1">
<section id="section-15.4.2">
          <h4 id="name-credential-offer-3">
<a href="#section-15.4.2" class="section-number selfRef">15.4.2. </a><a href="#name-credential-offer-3" class="section-name selfRef">Credential Offer</a>
          </h4>
<p id="section-15.4.2-1">The Privacy Considerations in Section 11.2 of <span>[<a href="#RFC9101" class="cite xref">RFC9101</a>]</span> apply to the <code>credential_offer</code> and
<code>credential_offer_uri</code> parameters defined in <a href="#credential-offer" class="auto internal xref">Section 4.1</a>.<a href="#section-15.4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authorization-request">
<section id="section-15.4.3">
          <h4 id="name-authorization-request-2">
<a href="#section-15.4.3" class="section-number selfRef">15.4.3. </a><a href="#name-authorization-request-2" class="section-name selfRef">Authorization Request</a>
          </h4>
<p id="section-15.4.3-1">The Wallet SHOULD NOT include potentially sensitive information in the Authorization Request,
for example, by including clear-text session information as a <code>state</code> parameter value or encoding
it in a <code>redirect_uri</code> parameter. A third party may observe such information through browser
history, etc. and correlate the user's activity using it.<a href="#section-15.4.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="walletattestation-sub">
<section id="section-15.4.4">
          <h4 id="name-wallet-attestation-subject">
<a href="#section-15.4.4" class="section-number selfRef">15.4.4. </a><a href="#name-wallet-attestation-subject" class="section-name selfRef">Wallet Attestation Subject</a>
          </h4>
<p id="section-15.4.4-1">The Wallet Attestation as defined in <a href="#walletattestation" class="auto internal xref">Appendix E</a> SHOULD NOT introduce a unique identifier specific to a single client.
The subject claim for the Wallet Attestation SHOULD be a value that is shared by all Wallet instances using this type of
wallet implementation. The value should be understood as an identifier of the Wallet type, rather than the specific Wallet
instance itself.<a href="#section-15.4.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="identifying-the-credential-issuer">
<section id="section-15.5">
        <h3 id="name-identifying-the-credential-">
<a href="#section-15.5" class="section-number selfRef">15.5. </a><a href="#name-identifying-the-credential-" class="section-name selfRef">Identifying the Credential Issuer</a>
        </h3>
<p id="section-15.5-1">Information in the credential identifying a particular Credential Issuer, such as a Credential Issuer Identifier,
issuer's certificate, or issuer's public key may reveal information about the End-User.<a href="#section-15.5-1" class="pilcrow">¶</a></p>
<p id="section-15.5-2">For example, when a military organization or a drug rehabilitation center issues a vaccine
credential, verifiers can deduce that the owner of the Wallet storing such a Credential is a
military member or may have a substance use disorder.<a href="#section-15.5-2" class="pilcrow">¶</a></p>
<p id="section-15.5-3">In addition, when a Credential Issuer issues only one type of Credential, it might have privacy implications,
because if the Wallet has a Credential issued by that Issuer, its type and claim names can be
determined.<a href="#section-15.5-3" class="pilcrow">¶</a></p>
<p id="section-15.5-4">For example, if the National Cancer Institute only issued Credentials with cancer registry
information, it is possible to deduce that the owner of the Wallet storing such a Credential is a
cancer patient.<a href="#section-15.5-4" class="pilcrow">¶</a></p>
<p id="section-15.5-5">To mitigate these issues, a group of organizations may elect to use a common Credential Issuer,
such that any credentials issued by this Issuer cannot be attributed to a particular organization
through identifiers of the Credential Issuers alone. A group signature scheme may also be used
instead of an individual signature.<a href="#section-15.5-5" class="pilcrow">¶</a></p>
<p id="section-15.5-6">When a common Credential Issuer is used, appropriate guardrails need to be in place to prevent
one organization from issuing illegitimate credentials on behalf of other organizations.<a href="#section-15.5-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="identifying-the-wallet">
<section id="section-15.6">
        <h3 id="name-identifying-the-wallet">
<a href="#section-15.6" class="section-number selfRef">15.6. </a><a href="#name-identifying-the-wallet" class="section-name selfRef">Identifying the Wallet</a>
        </h3>
<p id="section-15.6-1">There is a potential for leaking information about the Wallet to third parties when the
Wallet reacts to a Credential Offer. An attacker may send Credential Offers using different
custom URL schemes or claimed https urls, see if the
Wallet reacts (e.g., whether the wallet retrieves Credential Issuer metadata hosted by an
attacker's server), and, therefore, learn which Wallet is installed. To avoid this, the Wallet SHOULD
require user interaction or establish trust in the Issuer before fetching any <code>credential_offer_uri</code>
or acting on the received Credential Offer.<a href="#section-15.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="untrusted-wallets">
<section id="section-15.7">
        <h3 id="name-untrusted-wallets">
<a href="#section-15.7" class="section-number selfRef">15.7. </a><a href="#name-untrusted-wallets" class="section-name selfRef">Untrusted Wallets</a>
        </h3>
<p id="section-15.7-1">The Wallet transmits and stores sensitive information about the End-User. To ensure that the
Wallet can handle those appropriately (i.e., according to a certain trust framework or a
regulation), the Credential Issuer should properly authenticate the Wallet and ensure it is a trusted entity. For more details, see <a href="#trust-between-wallet-and-issuer" class="auto internal xref">Section 13.3</a>.<a href="#section-15.7-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-16">
      <h2 id="name-normative-references">
<a href="#section-16" class="section-number selfRef">16. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="BCP195">[BCP195]</dt>
      <dd>
<span class="refAuthor">IETF</span>, <span class="refTitle">"BCP195"</span>, <time datetime="2022-11" class="refDate">November 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/bcp195">https://www.rfc-editor.org/info/bcp195</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CSS-Color">[CSS-Color]</dt>
      <dd>
<span class="refAuthor">Çelik, T.</span>, <span class="refAuthor">Lilley, C.</span>, and <span class="refAuthor">D. Baron</span>, <span class="refTitle">"CSS Color Module Level 3"</span>, <time datetime="2022-01-18" class="refDate">18 January 2022</time>, <span>&lt;<a href="https://www.w3.org/TR/2022/REC-css-color-3-20220118/">https://www.w3.org/TR/2022/REC-css-color-3-20220118/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DID-Core">[DID-Core]</dt>
      <dd>
<span class="refAuthor">Sporny, M.</span>, <span class="refAuthor">Guy, A.</span>, <span class="refAuthor">Sabadello, M.</span>, and <span class="refAuthor">D. Reed</span>, <span class="refTitle">"Decentralized Identifiers (DIDs) v1.0"</span>, <time datetime="2022-07-19" class="refDate">19 July 2022</time>, <span>&lt;<a href="https://www.w3.org/TR/2022/REC-did-core-20220719/">https://www.w3.org/TR/2022/REC-did-core-20220719/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FAPI2_Security_Profile">[FAPI2_Security_Profile]</dt>
      <dd>
<span class="refAuthor">Fett, D.</span>, <span class="refAuthor">Tonge, D.</span>, and <span class="refAuthor">J. Heenan</span>, <span class="refTitle">"FAPI 2.0 Security Profile"</span>, <time datetime="2025-02-22" class="refDate">22 February 2025</time>, <span>&lt;<a href="https://openid.net/specs/fapi-security-profile-2_0.html">https://openid.net/specs/fapi-security-profile-2_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-jose-fully-specified-algorithms">[I-D.ietf-jose-fully-specified-algorithms]</dt>
      <dd>
<span class="refAuthor">Jones, M. B.</span> and <span class="refAuthor">O. Steele</span>, <span class="refTitle">"Fully-Specified Algorithms for JOSE and COSE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-jose-fully-specified-algorithms-13</span>, <time datetime="2025-05-11" class="refDate">11 May 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-jose-fully-specified-algorithms-13">https://datatracker.ietf.org/doc/html/draft-ietf-jose-fully-specified-algorithms-13</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-oauth-attestation-based-client-auth">[I-D.ietf-oauth-attestation-based-client-auth]</dt>
      <dd>
<span class="refAuthor">Looker, T.</span>, <span class="refAuthor">Bastian, P.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"OAuth 2.0 Attestation-Based Client Authentication"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-attestation-based-client-auth-07</span>, <time datetime="2025-09-15" class="refDate">15 September 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-attestation-based-client-auth-07">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-attestation-based-client-auth-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-oauth-sd-jwt-vc">[I-D.ietf-oauth-sd-jwt-vc]</dt>
      <dd>
<span class="refAuthor">Terbu, O.</span>, <span class="refAuthor">Fett, D.</span>, and <span class="refAuthor">B. Campbell</span>, <span class="refTitle">"SD-JWT-based Verifiable Credentials (SD-JWT VC)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-sd-jwt-vc-11</span>, <time datetime="2025-09-15" class="refDate">15 September 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-sd-jwt-vc-11">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-sd-jwt-vc-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-oauth-status-list">[I-D.ietf-oauth-status-list]</dt>
      <dd>
<span class="refAuthor">Looker, T.</span>, <span class="refAuthor">Bastian, P.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Token Status List (TSL)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-status-list-12</span>, <time datetime="2025-07-07" class="refDate">7 July 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-status-list-12">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-status-list-12</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.COSE">[IANA.COSE]</dt>
      <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE)"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml">https://www.iana.org/assignments/cose/cose.xhtml</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISO.18013-5">[ISO.18013-5]</dt>
      <dd>
<span class="refAuthor">ISO/IEC JTC 1/SC 17 Cards and security devices for personal identification</span>, <span class="refTitle">"ISO/IEC 18013-5:2021 Personal identification — ISO-compliant driving licence — Part 5: Mobile driving licence (mDL) application"</span>, <time datetime="2021" class="refDate">2021</time>, <span>&lt;<a href="https://www.iso.org/standard/69084.html">https://www.iso.org/standard/69084.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISO.18045">[ISO.18045]</dt>
      <dd>
<span class="refAuthor">ISO</span>, <span class="refTitle">"ISO/IEC 18045:2022 Information security, cybersecurity and privacy protection — Evaluation criteria for IT security — Methodology for IT security evaluation"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://www.iso.org/standard/72889.html">https://www.iso.org/standard/72889.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID.Core">[OpenID.Core]</dt>
      <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.B.</span>, <span class="refAuthor">de Medeiros, B.</span>, and <span class="refAuthor">C. Mortimore</span>, <span class="refTitle">"OpenID Connect Core 1.0 incorporating errata set 2"</span>, <time datetime="2023-12-15" class="refDate">15 December 2023</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-core-1_0.html">https://openid.net/specs/openid-connect-core-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID.Federation">[OpenID.Federation]</dt>
      <dd>
<span class="refAuthor">Ed., R. H.</span>, <span class="refAuthor">Jones, M. B.</span>, <span class="refAuthor">Solberg, A.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Marco, G. D.</span>, and <span class="refAuthor">V. Dzhuvinov</span>, <span class="refTitle">"OpenID Federation 1.0"</span>, <time datetime="2025-06-02" class="refDate">2 June 2025</time>, <span>&lt;<a href="https://openid.net/specs/openid-federation-1_0-43.html">https://openid.net/specs/openid-federation-1_0-43.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3066">[RFC3066]</dt>
      <dd>
<span class="refAuthor">Alvestrand, H.</span>, <span class="refTitle">"Tags for the Identification of Languages"</span>, <span class="seriesInfo">RFC 3066</span>, <span class="seriesInfo">DOI 10.17487/RFC3066</span>, <time datetime="2001-01" class="refDate">January 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3066">https://www.rfc-editor.org/info/rfc3066</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5646">[RFC5646]</dt>
      <dd>
<span class="refAuthor">Phillips, A., Ed.</span> and <span class="refAuthor">M. Davis, Ed.</span>, <span class="refTitle">"Tags for Identifying Languages"</span>, <span class="seriesInfo">BCP 47</span>, <span class="seriesInfo">RFC 5646</span>, <span class="seriesInfo">DOI 10.17487/RFC5646</span>, <time datetime="2009-09" class="refDate">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5646">https://www.rfc-editor.org/info/rfc5646</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6125">[RFC6125]</dt>
      <dd>
<span class="refAuthor">Saint-Andre, P.</span> and <span class="refAuthor">J. Hodges</span>, <span class="refTitle">"Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 6125</span>, <span class="seriesInfo">DOI 10.17487/RFC6125</span>, <time datetime="2011-03" class="refDate">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6125">https://www.rfc-editor.org/info/rfc6125</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
      <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6750">[RFC6750]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span> and <span class="refAuthor">D. Hardt</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework: Bearer Token Usage"</span>, <span class="seriesInfo">RFC 6750</span>, <span class="seriesInfo">DOI 10.17487/RFC6750</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6750">https://www.rfc-editor.org/info/rfc6750</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6755">[RFC6755]</dt>
      <dd>
<span class="refAuthor">Campbell, B.</span> and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"An IETF URN Sub-Namespace for OAuth"</span>, <span class="seriesInfo">RFC 6755</span>, <span class="seriesInfo">DOI 10.17487/RFC6755</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6755">https://www.rfc-editor.org/info/rfc6755</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7515">[RFC7515]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Signature (JWS)"</span>, <span class="seriesInfo">RFC 7515</span>, <span class="seriesInfo">DOI 10.17487/RFC7515</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7515">https://www.rfc-editor.org/info/rfc7515</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7516">[RFC7516]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span> and <span class="refAuthor">J. Hildebrand</span>, <span class="refTitle">"JSON Web Encryption (JWE)"</span>, <span class="seriesInfo">RFC 7516</span>, <span class="seriesInfo">DOI 10.17487/RFC7516</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7516">https://www.rfc-editor.org/info/rfc7516</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7517">[RFC7517]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Key (JWK)"</span>, <span class="seriesInfo">RFC 7517</span>, <span class="seriesInfo">DOI 10.17487/RFC7517</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7517">https://www.rfc-editor.org/info/rfc7517</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7518">[RFC7518]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Algorithms (JWA)"</span>, <span class="seriesInfo">RFC 7518</span>, <span class="seriesInfo">DOI 10.17487/RFC7518</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7518">https://www.rfc-editor.org/info/rfc7518</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7591">[RFC7591]</dt>
      <dd>
<span class="refAuthor">Richer, J., Ed.</span>, <span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Machulak, M.</span>, and <span class="refAuthor">P. Hunt</span>, <span class="refTitle">"OAuth 2.0 Dynamic Client Registration Protocol"</span>, <span class="seriesInfo">RFC 7591</span>, <span class="seriesInfo">DOI 10.17487/RFC7591</span>, <time datetime="2015-07" class="refDate">July 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7591">https://www.rfc-editor.org/info/rfc7591</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7636">[RFC7636]</dt>
      <dd>
<span class="refAuthor">Sakimura, N., Ed.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Agarwal</span>, <span class="refTitle">"Proof Key for Code Exchange by OAuth Public Clients"</span>, <span class="seriesInfo">RFC 7636</span>, <span class="seriesInfo">DOI 10.17487/RFC7636</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7636">https://www.rfc-editor.org/info/rfc7636</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8152">[RFC8152]</dt>
      <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE)"</span>, <span class="seriesInfo">RFC 8152</span>, <span class="seriesInfo">DOI 10.17487/RFC8152</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8152">https://www.rfc-editor.org/info/rfc8152</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8414">[RFC8414]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Sakimura, N.</span>, and <span class="refAuthor">J. Bradley</span>, <span class="refTitle">"OAuth 2.0 Authorization Server Metadata"</span>, <span class="seriesInfo">RFC 8414</span>, <span class="seriesInfo">DOI 10.17487/RFC8414</span>, <time datetime="2018-06" class="refDate">June 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8414">https://www.rfc-editor.org/info/rfc8414</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8615">[RFC8615]</dt>
      <dd>
<span class="refAuthor">Nottingham, M.</span>, <span class="refTitle">"Well-Known Uniform Resource Identifiers (URIs)"</span>, <span class="seriesInfo">RFC 8615</span>, <span class="seriesInfo">DOI 10.17487/RFC8615</span>, <time datetime="2019-05" class="refDate">May 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8615">https://www.rfc-editor.org/info/rfc8615</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8707">[RFC8707]</dt>
      <dd>
<span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Resource Indicators for OAuth 2.0"</span>, <span class="seriesInfo">RFC 8707</span>, <span class="seriesInfo">DOI 10.17487/RFC8707</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8707">https://www.rfc-editor.org/info/rfc8707</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8725">[RFC8725]</dt>
      <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Hardt, D.</span>, and <span class="refAuthor">M. Jones</span>, <span class="refTitle">"JSON Web Token Best Current Practices"</span>, <span class="seriesInfo">BCP 225</span>, <span class="seriesInfo">RFC 8725</span>, <span class="seriesInfo">DOI 10.17487/RFC8725</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8725">https://www.rfc-editor.org/info/rfc8725</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9068">[RFC9068]</dt>
      <dd>
<span class="refAuthor">Bertocci, V.</span>, <span class="refTitle">"JSON Web Token (JWT) Profile for OAuth 2.0 Access Tokens"</span>, <span class="seriesInfo">RFC 9068</span>, <span class="seriesInfo">DOI 10.17487/RFC9068</span>, <time datetime="2021-10" class="refDate">October 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9068">https://www.rfc-editor.org/info/rfc9068</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9101">[RFC9101]</dt>
      <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">M. Jones</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework: JWT-Secured Authorization Request (JAR)"</span>, <span class="seriesInfo">RFC 9101</span>, <span class="seriesInfo">DOI 10.17487/RFC9101</span>, <time datetime="2021-08" class="refDate">August 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9101">https://www.rfc-editor.org/info/rfc9101</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9110">[RFC9110]</dt>
      <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP Semantics"</span>, <span class="seriesInfo">STD 97</span>, <span class="seriesInfo">RFC 9110</span>, <span class="seriesInfo">DOI 10.17487/RFC9110</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9110">https://www.rfc-editor.org/info/rfc9110</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9396">[RFC9396]</dt>
      <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Richer, J.</span>, and <span class="refAuthor">B. Campbell</span>, <span class="refTitle">"OAuth 2.0 Rich Authorization Requests"</span>, <span class="seriesInfo">RFC 9396</span>, <span class="seriesInfo">DOI 10.17487/RFC9396</span>, <time datetime="2023-05" class="refDate">May 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9396">https://www.rfc-editor.org/info/rfc9396</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9449">[RFC9449]</dt>
      <dd>
<span class="refAuthor">Fett, D.</span>, <span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Jones, M.</span>, and <span class="refAuthor">D. Waite</span>, <span class="refTitle">"OAuth 2.0 Demonstrating Proof of Possession (DPoP)"</span>, <span class="seriesInfo">RFC 9449</span>, <span class="seriesInfo">DOI 10.17487/RFC9449</span>, <time datetime="2023-09" class="refDate">September 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9449">https://www.rfc-editor.org/info/rfc9449</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="USASCII">[USASCII]</dt>
    <dd>
<span class="refAuthor">American National Standards Institute</span>, <span class="refTitle">"Coded Character Set -- 7-bit American Standard Code for Information Interchange"</span>, <time datetime="2002" class="refDate">2002</time>, <span>&lt;<a href="https://www.unicode.org/L2/L2006/06388-review-incits4.pdf">https://www.unicode.org/L2/L2006/06388-review-incits4.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-17">
      <h2 id="name-informative-references">
<a href="#section-17" class="section-number selfRef">17. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="BCP240">[BCP240]</dt>
      <dd>
<span class="refAuthor">IETF</span>, <span class="refTitle">"BCP240"</span>, <time datetime="2025-01" class="refDate">January 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/bcp240">https://www.rfc-editor.org/info/bcp240</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DIF.Well-Known_DID">[DIF.Well-Known_DID]</dt>
      <dd>
<span class="refAuthor">Buchner, D.</span>, <span class="refAuthor">Steele, O.</span>, and <span class="refAuthor">T. Looker</span>, <span class="refTitle">"Well Known DID Configuration"</span>, <span>&lt;<a href="https://identity.foundation/specs/did-configuration/">https://identity.foundation/specs/did-configuration/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.JOSE">[IANA.JOSE]</dt>
      <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"JSON Object Signing and Encryption (JOSE)"</span>, <span>&lt;<a href="https://www.iana.org/assignments/jose">https://www.iana.org/assignments/jose</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.MediaTypes">[IANA.MediaTypes]</dt>
      <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Media Types"</span>, <span>&lt;<a href="https://www.iana.org/assignments/media-types">https://www.iana.org/assignments/media-types</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.OAuth.Parameters">[IANA.OAuth.Parameters]</dt>
      <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"OAuth Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/oauth-parameters">https://www.iana.org/assignments/oauth-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.URI.Schemes">[IANA.URI.Schemes]</dt>
      <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Uniform Resource Identifier (URI) Schemes"</span>, <span>&lt;<a href="https://www.iana.org/assignments/uri-schemes">https://www.iana.org/assignments/uri-schemes</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.Well-Known.URIs">[IANA.Well-Known.URIs]</dt>
      <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Well-Known URIs"</span>, <span>&lt;<a href="https://www.iana.org/assignments/well-known-uris">https://www.iana.org/assignments/well-known-uris</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISO.29100">[ISO.29100]</dt>
      <dd>
<span class="refAuthor">ISO</span>, <span class="refTitle">"ISO/IEC 29100:2011 Information technology — Security techniques — Privacy framework"</span>, <span>&lt;<a href="https://standards.iso.org/ittf/PubliclyAvailableStandards/index.html">https://standards.iso.org/ittf/PubliclyAvailableStandards/index.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="JSON-LD">[JSON-LD]</dt>
      <dd>
<span class="refAuthor">Kellogg, G.</span>, <span class="refAuthor">Sporny, M.</span>, <span class="refAuthor">Longley, D.</span>, <span class="refAuthor">Lanthaler, M.</span>, <span class="refAuthor">Champin, P.</span>, and <span class="refAuthor">N. Lindström</span>, <span class="refTitle">"JSON-LD 1.1: A JSON-based Serialization for Linked Data."</span>, <time datetime="2020-07-16" class="refDate">16 July 2020</time>, <span>&lt;<a href="https://www.w3.org/TR/2020/REC-json-ld11-20200716/">https://www.w3.org/TR/2020/REC-json-ld11-20200716/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="LD_Suite_Registry">[LD_Suite_Registry]</dt>
      <dd>
<span class="refAuthor">Sporny, M.</span>, <span class="refAuthor">Reed, D.</span>, and <span class="refAuthor">O. Steele</span>, <span class="refTitle">"Linked Data Cryptographic Suite Registry"</span>, <time datetime="2020-12-29" class="refDate">29 December 2020</time>, <span>&lt;<a href="https://w3c-ccg.github.io/ld-cryptosuite-registry/">https://w3c-ccg.github.io/ld-cryptosuite-registry/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2046">[RFC2046]</dt>
      <dd>
<span class="refAuthor">Freed, N.</span> and <span class="refAuthor">N. Borenstein</span>, <span class="refTitle">"Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types"</span>, <span class="seriesInfo">RFC 2046</span>, <span class="seriesInfo">DOI 10.17487/RFC2046</span>, <time datetime="1996-11" class="refDate">November 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2046">https://www.rfc-editor.org/info/rfc2046</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6838">[RFC6838]</dt>
      <dd>
<span class="refAuthor">Freed, N.</span>, <span class="refAuthor">Klensin, J.</span>, and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"Media Type Specifications and Registration Procedures"</span>, <span class="seriesInfo">BCP 13</span>, <span class="seriesInfo">RFC 6838</span>, <span class="seriesInfo">DOI 10.17487/RFC6838</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6838">https://www.rfc-editor.org/info/rfc6838</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9126">[RFC9126]</dt>
      <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Tonge, D.</span>, and <span class="refAuthor">F. Skokan</span>, <span class="refTitle">"OAuth 2.0 Pushed Authorization Requests"</span>, <span class="seriesInfo">RFC 9126</span>, <span class="seriesInfo">DOI 10.17487/RFC9126</span>, <time datetime="2021-09" class="refDate">September 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9126">https://www.rfc-editor.org/info/rfc9126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="VC_DATA">[VC_DATA]</dt>
      <dd>
<span class="refAuthor">Sporny, M.</span>, <span class="refAuthor">Noble, G.</span>, <span class="refAuthor">Longley, D.</span>, <span class="refAuthor">Burnett, D. C.</span>, <span class="refAuthor">Zundel, B.</span>, and <span class="refAuthor">K. D. Hartog</span>, <span class="refTitle">"Verifiable Credentials Data Model 1.1"</span>, <time datetime="2022-03-03" class="refDate">3 March 2022</time>, <span>&lt;<a href="https://www.w3.org/TR/2022/REC-vc-data-model-20220303">https://www.w3.org/TR/2022/REC-vc-data-model-20220303</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="VC_DATA_2.0">[VC_DATA_2.0]</dt>
      <dd>
<span class="refAuthor">Sporny, M.</span>, <span class="refAuthor">Jr, T. T.</span>, <span class="refAuthor">Herman, I.</span>, and <span class="refAuthor">G. Cohen</span>, <span class="refTitle">"Verifiable Credentials Data Model 2.0"</span>, <time datetime="2025-05-15" class="refDate">15 May 2025</time>, <span>&lt;<a href="https://www.w3.org/TR/2025/REC-vc-data-model-2.0-20250515/">https://www.w3.org/TR/2025/REC-vc-data-model-2.0-20250515/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="VC_Data_Integrity">[VC_Data_Integrity]</dt>
      <dd>
<span class="refAuthor">Sporny, M.</span>, <span class="refAuthor">Jr, T. T.</span>, <span class="refAuthor">Herman, I.</span>, <span class="refAuthor">Longley, D.</span>, and <span class="refAuthor">G. Bernstein</span>, <span class="refTitle">"Verifiable Credential Data Integrity 1.0"</span>, <time datetime="2025-05-15" class="refDate">15 May 2025</time>, <span>&lt;<a href="https://www.w3.org/TR/2025/REC-vc-data-integrity-20250515/">https://www.w3.org/TR/2025/REC-vc-data-integrity-20250515/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="secanalysis">[secanalysis]</dt>
    <dd>
<span class="refAuthor">Hauck, F.</span>, <span class="refTitle">"OpenID for Verifiable Credentials: Formal Security Analysis using the Web Infrastructure Model"</span>, <time datetime="2023-10-02" class="refDate">2 October 2023</time>, <span>&lt;<a href="https://elib.uni-stuttgart.de/items/07055a8e-a85e-42b9-98b5-11f046d5fb91">https://elib.uni-stuttgart.de/items/07055a8e-a85e-42b9-98b5-11f046d5fb91</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="format-profiles">
<section id="appendix-A">
      <h2 id="name-credential-format-profiles">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-credential-format-profiles" class="section-name selfRef">Credential Format Profiles</a>
      </h2>
<p id="appendix-A-1">This specification defines several extension points to accommodate the differences across Credential Formats. Sets of Credential Format-specific parameters or claims referred to as Credential Format Profiles are identified by the Credential Format Identifier and used at these extension points.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">This section defines Credential Format Profiles for a few of the commonly used Credential Formats. Other specifications or deployments can define their own Credential Format Profiles. It is RECOMMENDED that new Credential Format Profiles use the media type of the particular Credential Format for the Credential Format Identifier.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<div id="w3c-verifiable-credentials">
<section id="appendix-A.1">
        <h3 id="name-w3c-verifiable-credentials">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-w3c-verifiable-credentials" class="section-name selfRef">W3C Verifiable Credentials</a>
        </h3>
<p id="appendix-A.1-1">Sections 6.1 and 6.2 of <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span> define how Verifiable Credentials MAY or MAY NOT use JSON-LD <span>[<a href="#JSON-LD" class="cite xref">JSON-LD</a>]</span>. As acknowledged in Section 4.1 of <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span>, implementations can behave differently regarding processing of the <code>@context</code> property whether JSON-LD is used or not.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2">This specification therefore differentiates between the following three Credential Formats for W3C Verifiable Credentials:<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-A.1-3.1">VC signed as a JWT, not using JSON-LD (<code>jwt_vc_json</code>)<a href="#appendix-A.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-A.1-3.2">VC signed as a JWT, using JSON-LD (<code>jwt_vc_json-ld</code>)<a href="#appendix-A.1-3.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-A.1-3.3">VC secured using Data Integrity, using JSON-LD, with a proof suite requiring Linked Data canonicalization (<code>ldp_vc</code>)<a href="#appendix-A.1-3.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="appendix-A.1-4">Note: VCs secured using Data Integrity MAY NOT necessarily use JSON-LD and MAY NOT necessarily use proof suites requiring Linked Data canonicalization. Credential Format Profiles for them may be defined in the future versions of this specification.<a href="#appendix-A.1-4" class="pilcrow">¶</a></p>
<p id="appendix-A.1-5">Distinct Credential Format Identifiers, extension parameters/claims, and processing rules are defined for each of the above-mentioned Credential Formats.<a href="#appendix-A.1-5" class="pilcrow">¶</a></p>
<div id="jwt-vc-json">
<section id="appendix-A.1.1">
          <h4 id="name-vc-signed-as-a-jwt-not-usin">
<a href="#appendix-A.1.1" class="section-number selfRef">A.1.1. </a><a href="#name-vc-signed-as-a-jwt-not-usin" class="section-name selfRef">VC Signed as a JWT, Not Using JSON-LD</a>
          </h4>
<div id="format-identifier">
<section id="appendix-A.1.1.1">
            <h5 id="name-format-identifier">
<a href="#appendix-A.1.1.1" class="section-number selfRef">A.1.1.1. </a><a href="#name-format-identifier" class="section-name selfRef">Format Identifier</a>
            </h5>
<p id="appendix-A.1.1.1-1">The Credential Format Identifier is <code>jwt_vc_json</code>.<a href="#appendix-A.1.1.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1.1.1-2">When the <code>format</code> value is <code>jwt_vc_json</code>, the entire Credential Offer, Authorization Details, Credential Request and Credential Issuer metadata, including <code>credential_definition</code> object, MUST NOT be processed using JSON-LD rules.<a href="#appendix-A.1.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-metadata-jwt-vc-json">
<section id="appendix-A.1.1.2">
            <h5 id="name-credential-issuer-metadata-2">
<a href="#appendix-A.1.1.2" class="section-number selfRef">A.1.1.2. </a><a href="#name-credential-issuer-metadata-2" class="section-name selfRef">Credential Issuer Metadata</a>
            </h5>
<p id="appendix-A.1.1.2-1">Cryptographic algorithm identifiers used in the <code>credential_signing_alg_values_supported</code> parameter are case sensitive strings and SHOULD be one of those JWS Algorithm Names defined in <span>[<a href="#IANA.JOSE" class="cite xref">IANA.JOSE</a>]</span>.<a href="#appendix-A.1.1.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1.1.2-2">The following additional Credential Issuer metadata parameters are defined for this Credential Format for use in the <code>credential_configurations_supported</code> parameter, in addition to those defined in <a href="#credential-issuer-parameters" class="auto internal xref">Section 12.2.4</a>.<a href="#appendix-A.1.1.2-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-A.1.1.2-3.1">
                <p id="appendix-A.1.1.2-3.1.1"><code>credential_definition</code>: REQUIRED. Object containing the detailed description of the Credential type. It consists of the following parameter:<a href="#appendix-A.1.1.2-3.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-A.1.1.2-3.1.2.1">
                    <code>type</code>: REQUIRED. Array designating the types a certain Credential type supports, according to <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span>, Section 4.3.<a href="#appendix-A.1.1.2-3.1.2.1" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ul>
<p id="appendix-A.1.1.2-4">The following is a non-normative example of an object containing the <code>credential_configurations_supported</code> parameter for Credential Format <code>jwt_vc_json</code>:<a href="#appendix-A.1.1.2-4" class="pilcrow">¶</a></p>
<div class="breakable lang-json sourcecode" id="appendix-A.1.1.2-5">
<pre>{
  "credential_configurations_supported": {
    "UniversityDegreeCredential": {
      "format": "jwt_vc_json",
      "scope": "UniversityDegree",
      "cryptographic_binding_methods_supported": [
        "did:example"
      ],
      "credential_signing_alg_values_supported": [
        "ES256"
      ],
      "credential_definition": {
        "type": [
          "VerifiableCredential",
          "UniversityDegreeCredential"
        ]
      },
      "proof_types_supported": {
        "jwt": {
          "proof_signing_alg_values_supported": [
            "ES256"
          ]
        }
      },
      "credential_metadata": {
        "claims": [
          {
            "path": ["credentialSubject", "given_name"],
            "display": [
              {
                "name": "Given Name",
                "locale": "en-US"
              }
            ]
          },
          {
            "path": ["credentialSubject", "family_name"],
            "display": [
              {
                "name": "Surname",
                "locale": "en-US"
              }
            ]
          },
          {"path": ["credentialSubject", "degree"]},
          {
            "path": ["credentialSubject", "gpa"],
            "mandatory": true,
            "display": [
              {
                "name": "GPA"
              }
            ]
          }
        ],
        "display": [
          {
            "name": "University Credential",
            "locale": "en-US",
            "logo": {
              "uri": "https://university.example.edu/public/logo.png",
              "alt_text": "a square logo of a university"
            },
            "background_color": "#12107c",
            "text_color": "#FFFFFF"
          }
        ]
      }
    }
  }
}
</pre><a href="#appendix-A.1.1.2-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authorization-jwt-vc-json">
<section id="appendix-A.1.1.3">
            <h5 id="name-authorization-details">
<a href="#appendix-A.1.1.3" class="section-number selfRef">A.1.1.3. </a><a href="#name-authorization-details" class="section-name selfRef">Authorization Details</a>
            </h5>
<p id="appendix-A.1.1.3-1">The following is a non-normative example of an authorization details object with Credential Format <code>jwt_vc_json</code>:<a href="#appendix-A.1.1.3-1" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="appendix-A.1.1.3-2">
<pre>[
  {
    "type": "openid_credential",
    "credential_configuration_id": "UniversityDegreeCredential",
    "claims": [
      {"path": ["credentialSubject", "given_name"]},
      {"path": ["credentialSubject", "family_name"]},
      {"path": ["credentialSubject", "degree"]}
    ]
  }
]
</pre><a href="#appendix-A.1.1.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="credential-response-jwt-vc-json">
<section id="appendix-A.1.1.4">
            <h5 id="name-credential-response-2">
<a href="#appendix-A.1.1.4" class="section-number selfRef">A.1.1.4. </a><a href="#name-credential-response-2" class="section-name selfRef">Credential Response</a>
            </h5>
<p id="appendix-A.1.1.4-1">The value of the <code>credential</code> claim in the Credential Response MUST be a JWT. Credentials of this format are already a sequence of base64url-encoded values separated by period characters and MUST NOT be re-encoded.<a href="#appendix-A.1.1.4-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1.1.4-2">The following is a non-normative example of a Credential Response with Credential Format <code>jwt_vc_json</code> (with line breaks within values for display purposes only):<a href="#appendix-A.1.1.4-2" class="pilcrow">¶</a></p>
<div class="lang-txt sourcecode" id="appendix-A.1.1.4-3">
<pre>
HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
  "credentials": [
    {
      "credential": "eyJ0eXAiOiJKV1QiLCJhbGciOiJFUzI1NiIsImtpZCI6I
      nVybjppZXRmOnBhcmFtczpvYXV0aDpqd2stdGh1bWJwcmludDpzaGEtMjU2O
      m1sVXBvZzd2RWV3RkJlbTZVbDA5YzJkdFR3YzhkRnpWcElEWDNzcUdXVzAif
      Q.eyJ2YyI6eyJAY29udGV4dCI6WyJodHRwczovL3d3dy53My5vcmcvMjAxOC
      9jcmVkZW50aWFscy92MSIsImh0dHBzOi8vd3d3LnczLm9yZy8yMDE4L2NyZW
      RlbnRpYWxzL2V4YW1wbGVzL3YxIl0sImlkIjoiaHR0cHM6Ly9jcmVkZW50aW
      FsLWlzc3Vlci5leGFtcGxlLmNvbS9jcmVkZW50aWFscy8zNzMyIiwidHlwZS
      I6WyJWZXJpZmlhYmxlQ3JlZGVudGlhbCIsIlVuaXZlcnNpdHlEZWdyZWVDcm
      VkZW50aWFsIl0sImlzc3VlciI6Imh0dHBzOi8vY3JlZGVudGlhbC1pc3N1ZX
      IuZXhhbXBsZS5jb20iLCJpc3N1YW5jZURhdGUiOiIyMDI1LTAxLTAxVDAwOj
      AwOjAwWiIsImNyZWRlbnRpYWxTdWJqZWN0Ijp7ImlkIjoiZGlkOmp3azpleU
      pyYVdRaU9pSjFjbTQ2YVdWMFpqcHdZWEpoYlhNNmIyRjFkR2c2YW5kckxYUm
      9kVzFpY0hKcGJuUTZjMmhoTFRJMU5qcFdZa3BQVTNacWVGVTJURGhETjBkVl
      R6UmtjMmhKV1ZZemVtSjJSbmRyV1VJME0xbEtOVXQwZERoRklpd2lhM1I1SW
      pvaVJVTWlMQ0pqY25ZaU9pSlFMVEkxTmlJc0ltRnNaeUk2SWtWVE1qVTJJaX
      dpZUNJNklrMWtReTFQUzNFMFFWRktabFpEV0RWNmNGRnZURGhxTkZaRlpuWl
      FXRGs0ZEZVNWFIaGpUbGhIY204aUxDSjVJam9pYm5OWGJtWmlOazVYYzBzek
      9VSklMV2hCWVZOclExTmxORUo1YldWT2MyTktSVjl6WVVRelJETmlUU0o5Ii
      wiZGVncmVlIjp7InR5cGUiOiJCYWNoZWxvckRlZ3JlZSIsIm5hbWUiOiJCYW
      NoZWxvciBvZiBTY2llbmNlIGFuZCBBcnRzIn19fSwiaXNzIjoiaHR0cHM6Ly
      9jcmVkZW50aWFsLWlzc3Vlci5leGFtcGxlLmNvbSIsIm5iZiI6MTczNTY4OT
      YwMCwianRpIjoiaHR0cHM6Ly9jcmVkZW50aWFsLWlzc3Vlci5leGFtcGxlLm
      NvbS9jcmVkZW50aWFscy8zNzMyIiwic3ViIjoiZGlkOmp3azpleUpyYVdRaU
      9pSjFjbTQ2YVdWMFpqcHdZWEpoYlhNNmIyRjFkR2c2YW5kckxYUm9kVzFpY0
      hKcGJuUTZjMmhoTFRJMU5qcFdZa3BQVTNacWVGVTJURGhETjBkVlR6UmtjMm
      hKV1ZZemVtSjJSbmRyV1VJME0xbEtOVXQwZERoRklpd2lhM1I1SWpvaVJVTW
      lMQ0pqY25ZaU9pSlFMVEkxTmlJc0ltRnNaeUk2SWtWVE1qVTJJaXdpZUNJNk
      lrMWtReTFQUzNFMFFWRktabFpEV0RWNmNGRnZURGhxTkZaRlpuWlFXRGs0ZE
      ZVNWFIaGpUbGhIY204aUxDSjVJam9pYm5OWGJtWmlOazVYYzBzek9VSklMV2
      hCWVZOclExTmxORUo1YldWT2MyTktSVjl6WVVRelJETmlUU0o5In0.k13xQC
      nQIKAIuwQIbg37dwlNr8D6_2YUQtDTVQCq-ZsjcXxHagGC_VIZtd7RpR8OvB
      zTBHVwrBRD-_RzoV2Ofg"
    }
  ]
}
</pre><a href="#appendix-A.1.1.4-3" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1.1.4-4">The following is the dereferenced document for the Issuer HTTP URL identifier that matches the Credential in the above example (with line breaks within values for display purposes only):<a href="#appendix-A.1.1.4-4" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="appendix-A.1.1.4-5">
<pre>{
  "jwks": [
    {
      "kid": "urn:ietf:params:oauth:jwk-thumbprint:sha-256:mlUpog7vEewFBem6Ul09
       c2dtTwc8dFzVpIDX3sqGWW0",
      "kty": "EC",
      "crv": "P-256",
      "alg": "ES256",
      "x": "_LC1FTUl0MltKAOQzXNsofVMpWFV2obLGrNCat_CQ-g",
      "y": "kBjoyjNuMVAOq--qVUgylDoLKuMdk4imS-Kk5ahuYIU"
    }
  ]
}
</pre><a href="#appendix-A.1.1.4-5" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="vc-secured-using-data-integrity-using-json-ld-with-a-proof-suite-requiring-linked-data-canonicalization">
<section id="appendix-A.1.2">
          <h4 id="name-vc-secured-using-data-integ">
<a href="#appendix-A.1.2" class="section-number selfRef">A.1.2. </a><a href="#name-vc-secured-using-data-integ" class="section-name selfRef">VC Secured using Data Integrity, using JSON-LD, with a Proof Suite Requiring Linked Data Canonicalization</a>
          </h4>
<div id="format-identifier-1">
<section id="appendix-A.1.2.1">
            <h5 id="name-format-identifier-2">
<a href="#appendix-A.1.2.1" class="section-number selfRef">A.1.2.1. </a><a href="#name-format-identifier-2" class="section-name selfRef">Format Identifier</a>
            </h5>
<p id="appendix-A.1.2.1-1">The Credential Format Identifier is <code>ldp_vc</code>.<a href="#appendix-A.1.2.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1.2.1-2">When the <code>format</code> value is <code>ldp_vc</code>, the entire Credential Offer, Authorization Details, Credential Request and Credential Issuer metadata, including <code>credential_definition</code> object, MUST NOT be processed using JSON-LD rules.<a href="#appendix-A.1.2.1-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1.2.1-3">The <code>@context</code> value in the <code>credential_definition</code> object can be used by the Wallet to check whether it supports a certain VC or not. If necessary, the Wallet could apply JSON-LD processing to the Credential issued by the Credential Issuer.<a href="#appendix-A.1.2.1-3" class="pilcrow">¶</a></p>
<p id="appendix-A.1.2.1-4">Note: Data Integrity used to be called Linked Data Proofs, hence the "ldp" in the Credential Format Identifier.<a href="#appendix-A.1.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-metadata-ldp-vc">
<section id="appendix-A.1.2.2">
            <h5 id="name-credential-issuer-metadata-3">
<a href="#appendix-A.1.2.2" class="section-number selfRef">A.1.2.2. </a><a href="#name-credential-issuer-metadata-3" class="section-name selfRef">Credential Issuer Metadata</a>
            </h5>
<p id="appendix-A.1.2.2-1">Cryptographic algorithm identifiers used in the <code>credential_signing_alg_values_supported</code> parameter are case sensitive strings and SHOULD be one of those signature suite identifiers defined in <span>[<a href="#LD_Suite_Registry" class="cite xref">LD_Suite_Registry</a>]</span>.<a href="#appendix-A.1.2.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1.2.2-2">The following additional Credential Issuer metadata parameters are defined for this Credential Format for use in the <code>credential_configurations_supported</code> parameter, in addition to those defined in <a href="#credential-issuer-parameters" class="auto internal xref">Section 12.2.4</a>:<a href="#appendix-A.1.2.2-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-A.1.2.2-3.1">
                <p id="appendix-A.1.2.2-3.1.1"><code>credential_definition</code>: REQUIRED. Object containing the detailed description of the Credential type. It consists of the following parameters:<a href="#appendix-A.1.2.2-3.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-A.1.2.2-3.1.2.1">
                    <code>@context</code>: REQUIRED. Array as defined in <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span>, Section 4.1.<a href="#appendix-A.1.2.2-3.1.2.1" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="appendix-A.1.2.2-3.1.2.2">
                    <code>type</code>: REQUIRED. Array designating the types a certain credential type supports, according to <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span>, Section 4.3.<a href="#appendix-A.1.2.2-3.1.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ul>
<p id="appendix-A.1.2.2-4">The following is a non-normative example of an object containing the <code>credential_configurations_supported</code> parameter for Credential Format <code>ldp_vc</code>:<a href="#appendix-A.1.2.2-4" class="pilcrow">¶</a></p>
<div class="breakable lang-json sourcecode" id="appendix-A.1.2.2-5">
<pre>{
  "credential_configurations_supported": {
    "UniversityDegree_LDP_VC": {
      "format": "ldp_vc",
      "cryptographic_binding_methods_supported": [
        "did:example"
      ],
      "credential_signing_alg_values_supported": [
        "Ed25519Signature2018"
      ],
      "credential_definition": {
        "@context": [
          "https://www.w3.org/2018/credentials/v1",
          "https://www.w3.org/2018/credentials/examples/v1"
        ],
        "type": [
          "VerifiableCredential",
          "UniversityDegreeCredential"
        ]
      },
      "credential_metadata": {
        "claims": [
          {
            "path": ["credentialSubject", "given_name"],
            "display": [
              {
                "name": "Given Name",
                "locale": "en-US"
              }
            ]
          },
          {
            "path": ["credentialSubject", "family_name"],
            "display": [
              {
                "name": "Surname",
                "locale": "en-US"
              }
            ]
          },
          {
            "path": ["credentialSubject", "degree"]
          },
          {
            "path": ["credentialSubject", "gpa"],
            "mandatory": true,
            "display": [
              {
                "name": "GPA"
              }
            ]
          }
        ],
        "display": [
          {
            "name": "University Credential",
            "locale": "en-US",
            "logo": {
              "uri": "https://university.example.edu/public/logo.png",
              "alt_text": "a square logo of a university"
            },
            "background_color": "#12107c",
            "text_color": "#FFFFFF"
          }
        ]
      }
    }
  }
}
</pre><a href="#appendix-A.1.2.2-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authorization-ldp-vc">
<section id="appendix-A.1.2.3">
            <h5 id="name-authorization-details-2">
<a href="#appendix-A.1.2.3" class="section-number selfRef">A.1.2.3. </a><a href="#name-authorization-details-2" class="section-name selfRef">Authorization Details</a>
            </h5>
<p id="appendix-A.1.2.3-1">The following is a non-normative example of an authorization details object with Credential Format <code>ldp_vc</code>:<a href="#appendix-A.1.2.3-1" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="appendix-A.1.2.3-2">
<pre>[
  {
    "type": "openid_credential",
    "credential_configuration_id": "UniversityDegree_LDP_VC",
    "claims": [
      {"path": ["credentialSubject", "given_name"]},
      {"path": ["credentialSubject", "family_name"]},
      {"path": ["credentialSubject", "degree"]}
    ]
  }
]
</pre><a href="#appendix-A.1.2.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="credential-response-1">
<section id="appendix-A.1.2.4">
            <h5 id="name-credential-response-3">
<a href="#appendix-A.1.2.4" class="section-number selfRef">A.1.2.4. </a><a href="#name-credential-response-3" class="section-name selfRef">Credential Response</a>
            </h5>
<p id="appendix-A.1.2.4-1">The value of the <code>credential</code> claim in the Credential Response MUST be a JSON object. Credentials of this format MUST NOT be re-encoded.<a href="#appendix-A.1.2.4-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1.2.4-2">The following is a non-normative example of a Credential Response with Credential Format <code>ldp_vc</code>:<a href="#appendix-A.1.2.4-2" class="pilcrow">¶</a></p>
<div class="lang-txt sourcecode" id="appendix-A.1.2.4-3">
<pre>HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
  "credentials": [
    {
      "credential": {
        "@context": [
          "https://www.w3.org/2018/credentials/v1",
          "https://www.w3.org/2018/credentials/examples/v1"
        ],
        "id": "http://example.edu/credentials/3732",
        "type": [
          "VerifiableCredential",
          "UniversityDegreeCredential"
        ],
        "issuer": "https://example.edu/issuers/565049",
        "issuanceDate": "2010-01-01T00:00:00Z",
        "credentialSubject": {
          "id": "did:example:ebfeb1f712ebc6f1c276e12ec21",
          "degree": {
            "type": "BachelorDegree",
            "name": "Bachelor of Science and Arts"
          }
        },
        "proof": {
          "type": "Ed25519Signature2020",
          "created": "2022-02-25T14:58:43Z",
          "verificationMethod": "https://example.edu/issuers/565049#key-1",
          "proofPurpose": "assertionMethod",
          "proofValue": "zeEdUoM7m9cY8ZyTpey83yBKeBcmcvbyrEQzJ19rD2UXArU2U1
                         jPGoEtrRvGYppdiK37GU4NBeoPakxpWhAvsVSt"
        }
      }
    }
  ]
}
</pre><a href="#appendix-A.1.2.4-3" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="vc-signed-as-a-jwt-using-json-ld">
<section id="appendix-A.1.3">
          <h4 id="name-vc-signed-as-a-jwt-using-js">
<a href="#appendix-A.1.3" class="section-number selfRef">A.1.3. </a><a href="#name-vc-signed-as-a-jwt-using-js" class="section-name selfRef">VC signed as a JWT, Using JSON-LD</a>
          </h4>
<div id="format-identifier-2">
<section id="appendix-A.1.3.1">
            <h5 id="name-format-identifier-3">
<a href="#appendix-A.1.3.1" class="section-number selfRef">A.1.3.1. </a><a href="#name-format-identifier-3" class="section-name selfRef">Format Identifier</a>
            </h5>
<p id="appendix-A.1.3.1-1">The Credential Format Identifier is <code>jwt_vc_json-ld</code>.<a href="#appendix-A.1.3.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1.3.1-2">When the <code>format</code> value is <code>jwt_vc_json-ld</code>, the entire Credential Offer, Authorization Details, Credential Request and Credential Issuer metadata, including <code>credential_definition</code> object, MUST NOT be processed using JSON-LD rules.<a href="#appendix-A.1.3.1-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1.3.1-3">The <code>@context</code> value in the <code>credential_definition</code> parameter can be used by the Wallet to check whether it supports a certain VC or not. If necessary, the Wallet could apply JSON-LD processing to the Credential issued by the Credential Issuer.<a href="#appendix-A.1.3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credential-issuer-metadata-1">
<section id="appendix-A.1.3.2">
            <h5 id="name-credential-issuer-metadata-4">
<a href="#appendix-A.1.3.2" class="section-number selfRef">A.1.3.2. </a><a href="#name-credential-issuer-metadata-4" class="section-name selfRef">Credential Issuer Metadata</a>
            </h5>
<p id="appendix-A.1.3.2-1">The definitions in <a href="#server-metadata-ldp-vc" class="auto internal xref">Appendix A.1.2.2</a> apply for metadata of Credentials of this type as well.<a href="#appendix-A.1.3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authorization-details-1">
<section id="appendix-A.1.3.3">
            <h5 id="name-authorization-details-3">
<a href="#appendix-A.1.3.3" class="section-number selfRef">A.1.3.3. </a><a href="#name-authorization-details-3" class="section-name selfRef">Authorization Details</a>
            </h5>
<p id="appendix-A.1.3.3-1">The definitions in <a href="#authorization-ldp-vc" class="auto internal xref">Appendix A.1.2.3</a> apply for Credentials of this type as well.<a href="#appendix-A.1.3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credential-response-1-1">
<section id="appendix-A.1.3.4">
            <h5 id="name-credential-response-4">
<a href="#appendix-A.1.3.4" class="section-number selfRef">A.1.3.4. </a><a href="#name-credential-response-4" class="section-name selfRef">Credential Response</a>
            </h5>
<p id="appendix-A.1.3.4-1">The definitions in <a href="#credential-response-jwt-vc-json" class="auto internal xref">Appendix A.1.1.4</a> apply for Credentials of this type as well.<a href="#appendix-A.1.3.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="mdocs">
<section id="appendix-A.2">
        <h3 id="name-mobile-documents-or-mdocs-i">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-mobile-documents-or-mdocs-i" class="section-name selfRef">Mobile Documents or mdocs (ISO/IEC 18013)</a>
        </h3>
<p id="appendix-A.2-1">This section defines a Credential Format Profile for credentials that conform to the mobile document (mdoc) format specified in ISO/IEC 18013-5 <span>[<a href="#ISO.18013-5" class="cite xref">ISO.18013-5</a>]</span>.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-2">ISO/IEC 18013-5:2021 <span>[<a href="#ISO.18013-5" class="cite xref">ISO.18013-5</a>]</span> defines the mdoc format in the context of mobile driving licences (mDLs). While the specification is focused on mDLs, the mdoc format itself is general-purpose and can be used for other types of Credentials.<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
<div id="format-identifier-3">
<section id="appendix-A.2.1">
          <h4 id="name-format-identifier-4">
<a href="#appendix-A.2.1" class="section-number selfRef">A.2.1. </a><a href="#name-format-identifier-4" class="section-name selfRef">Format Identifier</a>
          </h4>
<p id="appendix-A.2.1-1">The Credential Format Identifier is <code>mso_mdoc</code>. This refers to the Mobile Security Object (MSO) which secures the mdoc data model encoded as CBOR.<a href="#appendix-A.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-metadata-mso-mdoc">
<section id="appendix-A.2.2">
          <h4 id="name-credential-issuer-metadata-5">
<a href="#appendix-A.2.2" class="section-number selfRef">A.2.2. </a><a href="#name-credential-issuer-metadata-5" class="section-name selfRef">Credential Issuer Metadata</a>
          </h4>
<p id="appendix-A.2.2-1">Cryptographic algorithm identifiers used in the <code>credential_signing_alg_values_supported</code> parameter correspond to the numeric COSE algorithm identifiers used to secure the <code>IssuerAuth</code> COSE structure, as defined in <span>[<a href="#ISO.18013-5" class="cite xref">ISO.18013-5</a>]</span>. The values SHOULD be chosen from the following:<a href="#appendix-A.2.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-A.2.2-2.1">The value exactly matches the <code>alg</code> value in the <code>IssuerAuth</code> COSE header;<a href="#appendix-A.2.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-A.2.2-2.2">Or, the value is a fully specified algorithm, as defined in <span>[<a href="#I-D.ietf-jose-fully-specified-algorithms" class="cite xref">I-D.ietf-jose-fully-specified-algorithms</a>]</span>, and the combination of the <code>alg</code> value and the signing key's curve in the <code>IssuerAuth</code> COSE structure matches the combination specified by the fully specified algorithm.<a href="#appendix-A.2.2-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="appendix-A.2.2-3">Consequently, depending on the approach taken by the Issuer as described above, the <code>alg</code> value in the <code>IssuerAuth</code> COSE header MAY differ from the identifier listed in the <code>credential_signing_alg_values_supported</code> metadata parameter. This metadata parameter is primarily informational for the Wallet.<a href="#appendix-A.2.2-3" class="pilcrow">¶</a></p>
<p id="appendix-A.2.2-4">Example:
If the <code>IssuerAuth</code> structure contains an <code>alg</code> header value of <code>-7</code> (ECDSA with SHA-256, per <span>[<a href="#IANA.COSE" class="cite xref">IANA.COSE</a>]</span>) and is signed using a P-256 key, it matches both <code>-7</code> and <code>-9</code> in <code>credential_signing_alg_values_supported</code>. The latter (<code>-9</code>) corresponds to ECDSA with P-256 and SHA-256, as defined in <span>[<a href="#I-D.ietf-jose-fully-specified-algorithms" class="cite xref">I-D.ietf-jose-fully-specified-algorithms</a>]</span>.<a href="#appendix-A.2.2-4" class="pilcrow">¶</a></p>
<p id="appendix-A.2.2-5">The following additional Credential Issuer metadata parameters are defined for this Credential Format for use in the <code>credential_configurations_supported</code> parameter, in addition to those defined in <a href="#credential-issuer-parameters" class="auto internal xref">Section 12.2.4</a>.<a href="#appendix-A.2.2-5" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-A.2.2-6.1">
              <code>doctype</code>: REQUIRED. String identifying the Credential type, as defined in <span>[<a href="#ISO.18013-5" class="cite xref">ISO.18013-5</a>]</span>.<a href="#appendix-A.2.2-6.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="appendix-A.2.2-7">The following is a non-normative example of an object containing the <code>credential_configurations_supported</code> parameter for Credential Format <code>mso_mdoc</code>:<a href="#appendix-A.2.2-7" class="pilcrow">¶</a></p>
<div class="breakable lang-json sourcecode" id="appendix-A.2.2-8">
<pre>{
  "credential_configurations_supported": {
    "org.iso.18013.5.1.mDL": {
      "format": "mso_mdoc",
      "doctype": "org.iso.18013.5.1.mDL",
      "cryptographic_binding_methods_supported": [
        "cose_key"
      ],
      "credential_signing_alg_values_supported": [
        -7, -9
      ],
      "credential_metadata": {
        "display": [
          {
            "name": "Mobile Driving License",
            "locale": "en-US",
            "logo": {
              "uri": "https://state.example.org/public/mdl.png",
              "alt_text": "state mobile driving license"
            },
            "background_color": "#12107c",
            "text_color": "#FFFFFF"
          },
          {
            "name": "モバイル運転免許証",
            "locale": "ja-JP",
            "logo": {
              "uri": "https://state.example.org/public/mdl.png",
              "alt_text": "米国州発行のモバイル運転免許証"
            },
            "background_color": "#12107c",
            "text_color": "#FFFFFF"
          }
        ],
        "claims": [
          {
            "path": ["org.iso.18013.5.1", "given_name"],
            "display": [
              {
                "name": "Given Name",
                "locale": "en-US"
              },
              {
                "name": "名前",
                "locale": "ja-JP"
              }
            ]
          },
          {
            "path": ["org.iso.18013.5.1", "family_name"],
            "display": [
              {
                "name": "Surname",
                "locale": "en-US"
              }
            ]
          },
          {
            "path": ["org.iso.18013.5.1", "birth_date"],
            "mandatory": true
          },
          {"path": ["org.iso.18013.5.1.aamva", "organ_donor"]}
        ]
      }
    }
  }
}
</pre><a href="#appendix-A.2.2-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authorization-details-1-1">
<section id="appendix-A.2.3">
          <h4 id="name-authorization-details-4">
<a href="#appendix-A.2.3" class="section-number selfRef">A.2.3. </a><a href="#name-authorization-details-4" class="section-name selfRef">Authorization Details</a>
          </h4>
<p id="appendix-A.2.3-1">The following is a non-normative example of an authorization details object with Credential Format <code>mso_mdoc</code>:<a href="#appendix-A.2.3-1" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="appendix-A.2.3-2">
<pre>[
  {
    "type": "openid_credential",
    "credential_configuration_id": "org.iso.18013.5.1.mDL",
    "claims": [
      {"path": ["org.iso.18013.5.1","given_name"]},
      {"path": ["org.iso.18013.5.1","family_name"]},
      {"path": ["org.iso.18013.5.1","birth_date"]},
      {"path": ["org.iso.18013.5.1.aamva","organ_donor"]}
    ]
  }
]
</pre><a href="#appendix-A.2.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="credential-response-2">
<section id="appendix-A.2.4">
          <h4 id="name-credential-response-5">
<a href="#appendix-A.2.4" class="section-number selfRef">A.2.4. </a><a href="#name-credential-response-5" class="section-name selfRef">Credential Response</a>
          </h4>
<p id="appendix-A.2.4-1">The value of the <code>credential</code> claim in the Credential Response MUST be a string that is the base64url-encoded representation of the CBOR-encoded <code>IssuerSigned</code> structure, as defined in <span>[<a href="#ISO.18013-5" class="cite xref">ISO.18013-5</a>]</span>.<a href="#appendix-A.2.4-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2.4-2">The following is a non-normative example of a Credential Response containing a Credential of format <code>mso_mdoc</code>.<a href="#appendix-A.2.4-2" class="pilcrow">¶</a></p>
<div class="lang-txt sourcecode" id="appendix-A.2.4-3">
<pre>HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
  "credentials": [
    {
      "credential": "omppc3N1ZXJBdXRohEOhASahG...ArQwggKwMIICVqADAgEC"
    }
  ]
}
</pre><a href="#appendix-A.2.4-3" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="ietf-sd-jwt-vc">
<section id="appendix-A.3">
        <h3 id="name-ietf-sd-jwt-vc">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-ietf-sd-jwt-vc" class="section-name selfRef">IETF SD-JWT VC</a>
        </h3>
<p id="appendix-A.3-1">This section defines a Credential Format Profile for Credentials complying with <span>[<a href="#I-D.ietf-oauth-sd-jwt-vc" class="cite xref">I-D.ietf-oauth-sd-jwt-vc</a>]</span>.<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
<div id="format-identifier-4">
<section id="appendix-A.3.1">
          <h4 id="name-format-identifier-5">
<a href="#appendix-A.3.1" class="section-number selfRef">A.3.1. </a><a href="#name-format-identifier-5" class="section-name selfRef">Format Identifier</a>
          </h4>
<p id="appendix-A.3.1-1">The Credential Format Identifier is <code>dc+sd-jwt</code>.<a href="#appendix-A.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-metadata-sd-jwt-vc">
<section id="appendix-A.3.2">
          <h4 id="name-credential-issuer-metadata-6">
<a href="#appendix-A.3.2" class="section-number selfRef">A.3.2. </a><a href="#name-credential-issuer-metadata-6" class="section-name selfRef">Credential Issuer Metadata</a>
          </h4>
<p id="appendix-A.3.2-1">Cryptographic algorithm identifiers used in the <code>credential_signing_alg_values_supported</code> parameter are case sensitive strings and SHOULD be one of those JWS Algorithm Names defined in <span>[<a href="#IANA.JOSE" class="cite xref">IANA.JOSE</a>]</span>.<a href="#appendix-A.3.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.3.2-2">The following additional Credential Issuer metadata parameters are defined for this Credential Format for use in the <code>credential_configurations_supported</code> parameter, in addition to those defined in <a href="#credential-issuer-parameters" class="auto internal xref">Section 12.2.4</a>.<a href="#appendix-A.3.2-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-A.3.2-3.1">
              <code>vct</code>: REQUIRED. String designating the type of the Credential, as defined in <span>[<a href="#I-D.ietf-oauth-sd-jwt-vc" class="cite xref">I-D.ietf-oauth-sd-jwt-vc</a>]</span>.<a href="#appendix-A.3.2-3.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="appendix-A.3.2-4">The following is a non-normative example of an object comprising the <code>credential_configurations_supported</code> parameter for Credential Format <code>dc+sd-jwt</code>.<a href="#appendix-A.3.2-4" class="pilcrow">¶</a></p>
<div class="breakable lang-json sourcecode" id="appendix-A.3.2-5">
<pre>{
  "credential_configurations_supported": {
    "SD_JWT_VC_example_in_OpenID4VCI": {
      "format": "dc+sd-jwt",
      "scope": "SD_JWT_VC_example_in_OpenID4VCI",
      "cryptographic_binding_methods_supported": [
        "jwk"
      ],
      "credential_signing_alg_values_supported": [
        "ES256"
      ],
      "proof_types_supported": {
        "jwt": {
          "proof_signing_alg_values_supported": [
            "ES256"
          ],
          "key_attestations_required": {
            "key_storage": [ "iso_18045_moderate" ],
            "user_authentication": [ "iso_18045_moderate" ]
          }
        }
      },
      "vct": "SD_JWT_VC_example_in_OpenID4VCI",
      "credential_metadata": {
        "display": [
          {
            "name": "IdentityCredential",
            "logo": {
              "uri": "https://university.example.edu/public/logo.png",
              "alt_text": "a square logo of a university"
            },
            "locale": "en-US",
            "background_color": "#12107c",
            "text_color": "#FFFFFF"
          }
        ],
        "claims": [
          {
            "path": ["given_name"],
            "display": [
              {
                "name": "Given Name",
                "locale": "en-US"
              },
              {
                "name": "Vorname",
                "locale": "de-DE"
              }
            ]
          },
          {
            "path": ["family_name"],
            "display": [
              {
                "name": "Surname",
                "locale": "en-US"
              },
              {
                "name": "Nachname",
                "locale": "de-DE"
              }
            ]
          },
          {"path": ["email"]},
          {"path": ["phone_number"]},
          {
            "path": ["address"],
            "display": [
              {
                "name": "Place of residence",
                "locale": "en-US"
              },
              {
                "name": "Wohnsitz",
                "locale": "de-DE"
              }
            ]
          },
          {"path": ["address", "street_address"]},
          {"path": ["address", "locality"]},
          {"path": ["address", "region"]},
          {"path": ["address", "country"]},
          {"path": ["birthdate"]},
          {"path": ["is_over_18"]},
          {"path": ["is_over_21"]},
          {"path": ["is_over_65"]}
        ]
      }
    }
  }
}
</pre><a href="#appendix-A.3.2-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authorization-sd-jwt-vc">
<section id="appendix-A.3.3">
          <h4 id="name-authorization-details-5">
<a href="#appendix-A.3.3" class="section-number selfRef">A.3.3. </a><a href="#name-authorization-details-5" class="section-name selfRef">Authorization Details</a>
          </h4>
<p id="appendix-A.3.3-1">The following is a non-normative example of an authorization details object with Credential Format <code>dc+sd-jwt</code>.<a href="#appendix-A.3.3-1" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="appendix-A.3.3-2">
<pre>[
  {
    "type": "openid_credential",
    "credential_configuration_id": "PID_SD_JWT_VC",
    "claims": [
      {"path": ["given_name"]},
      {"path": ["family_name"]}
    ]
  }
]
</pre><a href="#appendix-A.3.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="credential-response-jwt-vc-json-1">
<section id="appendix-A.3.4">
          <h4 id="name-credential-response-6">
<a href="#appendix-A.3.4" class="section-number selfRef">A.3.4. </a><a href="#name-credential-response-6" class="section-name selfRef">Credential Response</a>
          </h4>
<p id="appendix-A.3.4-1">The value of the <code>credential</code> claim in the Credential Response MUST be a string that is an SD-JWT VC. Credentials of this format are already suitable for transfer and, therefore, they need not and MUST NOT be re-encoded.<a href="#appendix-A.3.4-1" class="pilcrow">¶</a></p>
<p id="appendix-A.3.4-2">The following is a non-normative example of a Credential Response containing a Credential of format <code>dc+sd-jwt</code> (with line breaks within values for display purposes only).<a href="#appendix-A.3.4-2" class="pilcrow">¶</a></p>
<div class="lang-txt sourcecode" id="appendix-A.3.4-3">
<pre>HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
  "credentials": [
    {
      "credential": "eyJhbGciOiAiRVMyNTYiLCAidHlwIjogImRjK3NkLWp3d
      CIsICJraWQiOiAiZG9jLXNpZ25lci0wNS0yNS0yMDIyIn0.eyJfc2QiOiBbI
      jA5dktySk1PbHlUV00wc2pwdV9wZE9CVkJRMk0xeTNLaHBINTE1blhrcFkiL
      CAiMnJzakdiYUMwa3k4bVQwcEpyUGlvV1RxMF9kYXcxc1g3NnBvVWxnQ3diS
      SIsICJFa084ZGhXMGRIRUpidlVIbEVfVkNldUM5dVJFTE9pZUxaaGg3WGJVV
      HRBIiwgIklsRHpJS2VpWmREd3BxcEs2WmZieXBoRnZ6NUZnbldhLXNONndxU
      VhDaXciLCAiSnpZakg0c3ZsaUgwUjNQeUVNZmVadTZKdDY5dTVxZWhabzdGN
      0VQWWxTRSIsICJQb3JGYnBLdVZ1Nnh5bUphZ3ZrRnNGWEFiUm9jMkpHbEFVQ
      TJCQTRvN2NJIiwgIlRHZjRvTGJnd2Q1SlFhSHlLVlFaVTlVZEdFMHc1cnREc
      3JaemZVYW9tTG8iLCAiamRyVEU4WWNiWTRFaWZ1Z2loaUFlX0JQZWt4SlFaS
      UNlaVVRd1k5UXF4SSIsICJqc3U5eVZ1bHdRUWxoRmxNXzNKbHpNYVNGemdsa
      FFHMERwZmF5UXdMVUs0Il0sICJpc3MiOiAiaHR0cHM6Ly9leGFtcGxlLmNvb
      S9pc3N1ZXIiLCAiaWF0IjogMTY4MzAwMDAwMCwgImV4cCI6IDE4ODMwMDAwM
      DAsICJ2Y3QiOiAiaHR0cHM6Ly9jcmVkZW50aWFscy5leGFtcGxlLmNvbS9pZ
      GVudGl0eV9jcmVkZW50aWFsIiwgIl9zZF9hbGciOiAic2hhLTI1NiIsICJjb
      mYiOiB7Imp3ayI6IHsia3R5IjogIkVDIiwgImNydiI6ICJQLTI1NiIsICJ4I
      jogIlRDQUVSMTladnUzT0hGNGo0VzR2ZlNWb0hJUDFJTGlsRGxzN3ZDZUdlb
      WMiLCAieSI6ICJaeGppV1diWk1RR0hWV0tWUTRoYlNJaXJzVmZ1ZWNDRTZ0N
      GpUOUYySFpRIn19fQ.dVjA0sh4xGD32uPqc9h4WHiEL3A08kiKNE08IIrtn3
      PJvljLU7n19LBTtuzPFZoc_GoPuS97SIDbz96K8pkZew~WyIyR0xDNDJzS1F
      2ZUNmR2ZyeU5STjl3IiwgImdpdmVuX25hbWUiLCAiSm9obiJd~WyJlbHVWNU
      9nM2dTTklJOEVZbnN4QV9BIiwgImZhbWlseV9uYW1lIiwgIkRvZSJd~WyI2S
      Wo3dE0tYTVpVlBHYm9TNXRtdlZBIiwgImVtYWlsIiwgImpvaG5kb2VAZXhhb
      XBsZS5jb20iXQ~WyJlSThaV205UW5LUHBOUGVOZW5IZGhRIiwgInBob25lX2
      51bWJlciIsICIrMS0yMDItNTU1LTAxMDEiXQ~WyJRZ19PNjR6cUF4ZTQxMmE
      xMDhpcm9BIiwgImFkZHJlc3MiLCB7InN0cmVldF9hZGRyZXNzIjogIjEyMyB
      NYWluIFN0IiwgImxvY2FsaXR5IjogIkFueXRvd24iLCAicmVnaW9uIjogIkF
      ueXN0YXRlIiwgImNvdW50cnkiOiAiVVMifV0~WyJBSngtMDk1VlBycFR0TjR
      RTU9xUk9BIiwgImJpcnRoZGF0ZSIsICIxOTQwLTAxLTAxIl0~WyJQYzMzSk0
      yTGNoY1VfbEhnZ3ZfdWZRIiwgImlzX292ZXJfMTgiLCB0cnVlXQ~WyJHMDJO
      U3JRZmpGWFE3SW8wOXN5YWpBIiwgImlzX292ZXJfMjEiLCB0cnVlXQ~WyJsa
      2x4RjVqTVlsR1RQVW92TU5JdkNBIiwgImlzX292ZXJfNjUiLCB0cnVlXQ~"
    }
  ]
}
</pre><a href="#appendix-A.3.4-3" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="claims-description">
<section id="appendix-B">
      <h2 id="name-claims-description">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-claims-description" class="section-name selfRef">Claims Description</a>
      </h2>
<p id="appendix-B-1">Claims description objects are used in two places in this specification, in the
Credential Issuer metadata and in the Authorization Details. The following
sections define the structure and semantics of claims description objects.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<div id="claims-description-authorization-details">
<section id="appendix-B.1">
        <h3 id="name-claims-description-for-auth">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-claims-description-for-auth" class="section-name selfRef">Claims Description for Authorization Details</a>
        </h3>
<p id="appendix-B.1-1">A claims description object as used in authorization details is an object that defines the
requirements for the claims that the Wallet requests to be included in the
Credential.<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<p id="appendix-B.1-2">For a claims description object, the following keys defined by this
specification can be used to describe the claim or claims (other keys MAY also
be used):<a href="#appendix-B.1-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B.1-3.1">
            <code>path</code>: REQUIRED. Non-empty array. Claim path pointer as defined in <a href="#claims_path_pointer" class="auto internal xref">Appendix C</a>
to identify the claim(s) in the Credential.<a href="#appendix-B.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-B.1-3.2">
            <code>mandatory</code>: OPTIONAL. Boolean which, when set to <code>true</code>, indicates that the
Wallet will only accept a Credential that includes this claim. If set to
<code>false</code>, the claim is not required to be included in the Credential. If the
<code>mandatory</code> parameter is omitted, the default value is <code>false</code>.<a href="#appendix-B.1-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="appendix-B.1-4">The rules defined in <a href="#claims-description-processing" class="auto internal xref">Appendix B.3</a> apply.<a href="#appendix-B.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="claims-description-issuer-metadata">
<section id="appendix-B.2">
        <h3 id="name-claims-description-for-issu">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-claims-description-for-issu" class="section-name selfRef">Claims Description for Issuer Metadata</a>
        </h3>
<p id="appendix-B.2-1">A claims description object as used in the Credential Issuer metadata is an
object used to describe how a certain claim in the Credential is
displayed to the End-User. It is used in the <code>claims</code>
parameter in the Credential Issuer metadata defined in <a href="#format-profiles" class="auto internal xref">Appendix A</a>. The
following keys can be used to describe the claim or claims:<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B.2-2.1">
            <code>path</code>: REQUIRED. The value MUST be a non-empty array representing a claims
path pointer that specifies the path to a claim within the credential, as
defined in <a href="#claims_path_pointer" class="auto internal xref">Appendix C</a>.<a href="#appendix-B.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-B.2-2.2">
            <code>mandatory</code>: OPTIONAL. Boolean which, when set to <code>true</code>, indicates that the
Credential Issuer will always include this claim in the issued Credential.
If set to <code>false</code>, the claim is not included in the issued Credential if the
wallet did not request the inclusion of the claim, and/or if the Credential
Issuer chose to not include the claim. If the <code>mandatory</code> parameter is
omitted, the default value is <code>false</code>.<a href="#appendix-B.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-B.2-2.3">
            <p id="appendix-B.2-2.3.1"><code>display</code>: OPTIONAL. A non-empty array of objects, where each object contains display
properties of a certain claim in the Credential for a certain language.
Below is a non-exhaustive list of valid parameters that MAY be included:<a href="#appendix-B.2-2.3.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B.2-2.3.2.1">
                <code>name</code>: OPTIONAL. String value of a display name for the claim.<a href="#appendix-B.2-2.3.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="appendix-B.2-2.3.2.2">
                <code>locale</code>: OPTIONAL. String value that identifies the language of this object,
represented as language tag values defined in BCP47 <span>[<a href="#RFC5646" class="cite xref">RFC5646</a>]</span>. There
MUST be only one object for each language identifier.<a href="#appendix-B.2-2.3.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="appendix-B.2-3">The rules defined in <a href="#claims-description-processing" class="auto internal xref">Appendix B.3</a> apply.<a href="#appendix-B.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="claims-description-processing">
<section id="appendix-B.3">
        <h3 id="name-processing-rules-for-claims">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-processing-rules-for-claims" class="section-name selfRef">Processing Rules for Claims Description Objects</a>
        </h3>
<p id="appendix-B.3-1">The order of claims description objects in the <code>claims</code>
array is used by the Wallet to determine the order in which the claims are
displayed to the End-User, unless another mechanism is defined by the profile.<a href="#appendix-B.3-1" class="pilcrow">¶</a></p>
<p id="appendix-B.3-2">When a repeated or contradictory claim description is provided, the processing
MUST be aborted. This is in particular the case if<a href="#appendix-B.3-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B.3-3.1">the same claim is addressed by two or more claims description objects in the
<code>claims</code> array, or<a href="#appendix-B.3-3.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-B.3-3.2">there is a claims description object with a <code>path</code> that addresses a set of
claims in an array (using <code>null</code>, as defined in <a href="#claims_path_pointer" class="auto internal xref">Appendix C</a>) and
another object that uses a non-negative integer to address a specific claim
in the same array, or<a href="#appendix-B.3-3.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-B.3-3.3">there is a claims description object indicating that a certain claim is an array
(implied by using <code>null</code> or a non-negative integer in the <code>path</code>), and another
object indicating that the same claim is an object (implied by using a string
in the <code>path</code>).<a href="#appendix-B.3-3.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="claims_path_pointer">
<section id="appendix-C">
      <h2 id="name-claims-path-pointer">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-claims-path-pointer" class="section-name selfRef">Claims Path Pointer</a>
      </h2>
<p id="appendix-C-1">A claims path pointer is a pointer into the Verifiable Credential, identifying one or more claims.
A claims path pointer MUST be a non-empty array of strings, nulls and integers.
A claims path pointer can be processed, which means it is applied to a credential. The results of
processing are the referenced claims.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<div id="semantics-for-json-based-credentials">
<section id="appendix-C.1">
        <h3 id="name-semantics-for-json-based-cr">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-semantics-for-json-based-cr" class="section-name selfRef">Semantics for JSON-based credentials</a>
        </h3>
<p id="appendix-C.1-1">This section defines the semantics of a claims path pointer when applied to a JSON-based credential.<a href="#appendix-C.1-1" class="pilcrow">¶</a></p>
<p id="appendix-C.1-2">A string value indicates that the respective key is to be selected, a null value
indicates that all elements of the currently selected array(s) are to be selected;
and a non-negative integer indicates that the respective index in an array is to be selected.
Negative integer values are not used for JSON-based credentials. The path
is formed as follows:<a href="#appendix-C.1-2" class="pilcrow">¶</a></p>
<p id="appendix-C.1-3">Start with an empty array and repeat the following until the full path is formed.<a href="#appendix-C.1-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-C.1-4.1">To address a particular claim within an object, append the key (claim name)
to the array.<a href="#appendix-C.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-C.1-4.2">To address an element within an array, append the index to the array (as a
non-negative, 0-based integer).<a href="#appendix-C.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-C.1-4.3">To address all elements within an array, append a null value to the array.<a href="#appendix-C.1-4.3" class="pilcrow">¶</a>
</li>
        </ul>
<div id="processing">
<section id="appendix-C.1.1">
          <h4 id="name-processing">
<a href="#appendix-C.1.1" class="section-number selfRef">C.1.1. </a><a href="#name-processing" class="section-name selfRef">Processing</a>
          </h4>
<p id="appendix-C.1.1-1">In detail, the array is processed from left to right as follows:<a href="#appendix-C.1.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="appendix-C.1.1-2">
<li id="appendix-C.1.1-2.1">Select the root element of the Credential, i.e., the top-level object of the
JSON structure representing the claims in the Credential.<a href="#appendix-C.1.1-2.1" class="pilcrow">¶</a>
</li>
            <li id="appendix-C.1.1-2.2">
              <p id="appendix-C.1.1-2.2.1">Process the query of the claims path pointer array from left to right:<a href="#appendix-C.1.1-2.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="appendix-C.1.1-2.2.2">
<li id="appendix-C.1.1-2.2.2.1">If the path component is a string, select the element in the respective
key in the currently selected element(s). If any of the currently
selected element(s) is not an object, abort processing and return an
error. If the key does not exist in any element currently selected,
remove that element from the selection.<a href="#appendix-C.1.1-2.2.2.1" class="pilcrow">¶</a>
</li>
                <li id="appendix-C.1.1-2.2.2.2">If the path component is null, select all elements of the currently
selected array(s). If any of the currently selected element(s) is not an
array, abort processing and return an error.<a href="#appendix-C.1.1-2.2.2.2" class="pilcrow">¶</a>
</li>
                <li id="appendix-C.1.1-2.2.2.3">If the path component is a negative integer, abort processing and return an error.<a href="#appendix-C.1.1-2.2.2.3" class="pilcrow">¶</a>
</li>
                <li id="appendix-C.1.1-2.2.2.4">If the path component is a non-negative integer, select the element at
the respective index in the currently selected array(s). If any of the
currently selected element(s) is not an array, abort processing and
return an error. If the index does not exist in a selected array, remove
that array from the selection.<a href="#appendix-C.1.1-2.2.2.4" class="pilcrow">¶</a>
</li>
                <li id="appendix-C.1.1-2.2.2.5">If the set of elements currently selected is empty, abort processing and
return an error.<a href="#appendix-C.1.1-2.2.2.5" class="pilcrow">¶</a>
</li>
              </ol>
</li>
          </ol>
<p id="appendix-C.1.1-3">The result of the processing is the set of selected JSON elements.<a href="#appendix-C.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="semantics-for-iso-mdoc-based-credentials">
<section id="appendix-C.2">
        <h3 id="name-semantics-for-iso-mdoc-base">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-semantics-for-iso-mdoc-base" class="section-name selfRef">Semantics for ISO mdoc-based credentials</a>
        </h3>
<p id="appendix-C.2-1">This section defines the semantics of a claims path pointer when applied to a
credential in ISO mdoc format.<a href="#appendix-C.2-1" class="pilcrow">¶</a></p>
<p id="appendix-C.2-2">A claims path pointer into an ISO mdoc always contains at least two path components of type string.
Start with an array of two elements where the first element represents
the namespace and the second element represents the data element identifier in that namespace
and repeat the following until the full path is formed.
  * To address a claim within a data structure (i.e., map), append the corresponding key (string or integer).
  * To address an element within an array, append the index (as a non-negative, 0-based integer).
  * To address all elements of an array, append a null value.<a href="#appendix-C.2-2" class="pilcrow">¶</a></p>
<p id="appendix-C.2-3">Whether a non-negative integer is interpreted as a map key or an array index depends on the type of the
currently selected element.<a href="#appendix-C.2-3" class="pilcrow">¶</a></p>
<div id="processing-1">
<section id="appendix-C.2.1">
          <h4 id="name-processing-2">
<a href="#appendix-C.2.1" class="section-number selfRef">C.2.1. </a><a href="#name-processing-2" class="section-name selfRef">Processing</a>
          </h4>
<p id="appendix-C.2.1-1">In detail, the array is processed from left to right as follows:<a href="#appendix-C.2.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="appendix-C.2.1-2">
<li id="appendix-C.2.1-2.1">If the path contains fewer than two path components, abort processing and return an error.<a href="#appendix-C.2.1-2.1" class="pilcrow">¶</a>
</li>
            <li id="appendix-C.2.1-2.2">Select the namespace referenced by the first path component. If the namespace does not exist in the mdoc, abort processing and return an error.<a href="#appendix-C.2.1-2.2" class="pilcrow">¶</a>
</li>
            <li id="appendix-C.2.1-2.3">Select the data element with the data element identifier that matches the second path component. If the data element does not exist in the mdoc, abort processing and return an error.<a href="#appendix-C.2.1-2.3" class="pilcrow">¶</a>
</li>
            <li id="appendix-C.2.1-2.4">
              <p id="appendix-C.2.1-2.4.1">Process each subsequent path component as follows:<a href="#appendix-C.2.1-2.4.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="appendix-C.2.1-2.4.2">
<li id="appendix-C.2.1-2.4.2.1">If all the currently selected element(s) are arrays, and the path component is a non-negative integer, select the element at the given index in each array. If the index is out of bounds in a selected array, remove that array from the selection.<a href="#appendix-C.2.1-2.4.2.1" class="pilcrow">¶</a>
</li>
                <li id="appendix-C.2.1-2.4.2.2">If all the currently selected element(s) are maps, and the path component is a string or integer, select the element(s) associated with the key. If the key does not exist in a selected map, remove that map from the selection.<a href="#appendix-C.2.1-2.4.2.2" class="pilcrow">¶</a>
</li>
                <li id="appendix-C.2.1-2.4.2.3">If the path component is null, select all elements in each currently selected array. If any selected element is not an array, abort processing and return an error.<a href="#appendix-C.2.1-2.4.2.3" class="pilcrow">¶</a>
</li>
                <li id="appendix-C.2.1-2.4.2.4">If none of the above applied, abort processing and return an error.<a href="#appendix-C.2.1-2.4.2.4" class="pilcrow">¶</a>
</li>
              </ol>
</li>
            <li id="appendix-C.2.1-2.5">If the set of elements currently selected is empty, abort processing and return an error.<a href="#appendix-C.2.1-2.5" class="pilcrow">¶</a>
</li>
          </ol>
<p id="appendix-C.2.1-3">The result of the processing is the set of selected elements contained within the selected data element value, or the value itself.<a href="#appendix-C.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="claims_path_pointer_example">
<section id="appendix-C.3">
        <h3 id="name-claims-path-pointer-example">
<a href="#appendix-C.3" class="section-number selfRef">C.3. </a><a href="#name-claims-path-pointer-example" class="section-name selfRef">Claims Path Pointer Example</a>
        </h3>
<p id="appendix-C.3-1">The following shows a non-normative, simplified example of a JSON-based Credential:<a href="#appendix-C.3-1" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="appendix-C.3-2">
<pre>{
  "name": "Arthur Dent",
  "address": {
    "street_address": "42 Market Street",
    "locality": "Milliways",
    "postal_code": "12345"
  },
  "degrees": [
    {
      "type": "Bachelor of Science",
      "university": "University of Betelgeuse"
    },
    {
      "type": "Master of Science",
      "university": "University of Betelgeuse"
    }
  ],
  "nationalities": ["British", "Betelgeusian"]
}
</pre><a href="#appendix-C.3-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.3-3">The following shows examples of claims path pointers and the respective selected
claims:<a href="#appendix-C.3-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-C.3-4.1">
            <code>["name"]</code>: The claim <code>name</code> with the value <code>Arthur Dent</code> is selected.<a href="#appendix-C.3-4.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-C.3-4.2">
            <code>["address"]</code>: The claim <code>address</code> with its sub-claims as the value is
selected.<a href="#appendix-C.3-4.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-C.3-4.3">
            <code>["address", "street_address"]</code>: The claim <code>street_address</code> with the value <code>42
Market Street</code> is selected.<a href="#appendix-C.3-4.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-C.3-4.4">
            <code>["degrees", null, "type"]</code>: All <code>type</code> claims in the <code>degrees</code> array are
selected.<a href="#appendix-C.3-4.4" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-C.3-4.5">
            <code>["nationalities", 1]</code>: The second nationality is selected.<a href="#appendix-C.3-4.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="keyattestation">
<section id="appendix-D">
      <h2 id="name-key-attestations">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-key-attestations" class="section-name selfRef">Key Attestations</a>
      </h2>
<p id="appendix-D-1">A key attestation, as defined by this specification, is a verifiable statement that demonstrates the authenticity and security properties of a key and its storage component to the Credential Issuer. Keys can be stored in various key storage components, which vary in their ability to protect the private key from extraction and duplication, as well as in the methods used for User authentication to enable key operations. These key storage components can be software-based or hardware-based and may reside on the same device as the Wallet, on external security tokens, or on remote services that facilitate cryptographic key operations. Key attestations are issued either by the Wallet's key storage component itself or by the Wallet Provider. When the Wallet Provider creates the key attestation, it MUST verify the authenticity of its claims about the keys, possibly using platform-specific key attestations.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">A Wallet MAY provide key attestations to inform the Credential Issuer about the properties of the cryptographic public keys, such as those used in proof types sent in the Credential Request. Credential Issuers SHOULD evaluate these key attestations to ensure the cryptographic keys meet their security requirements, based on the trust framework, regulatory requirements, laws, or internal policies. A Credential Issuer MUST communicate the need to evaluate key attestations through its metadata or via an out-of-band mechanism.<a href="#appendix-D-2" class="pilcrow">¶</a></p>
<p id="appendix-D-3">Key attestations are used by various Credential Issuers with different trust frameworks and requirements, so a common approach is needed for interoperability. Therefore, key attestations SHOULD follow a common format. This helps Credential Issuers create consistent evaluation processes, reducing complexity and errors. Common formats also simplify compliance with regulatory requirements across jurisdictions and support the creation of shared best practices and security standards.<a href="#appendix-D-3" class="pilcrow">¶</a></p>
<div id="keyattestation-jwt">
<section id="appendix-D.1">
        <h3 id="name-key-attestation-in-jwt-form">
<a href="#appendix-D.1" class="section-number selfRef">D.1. </a><a href="#name-key-attestation-in-jwt-form" class="section-name selfRef">Key Attestation in JWT format</a>
        </h3>
<p id="appendix-D.1-1">The JWT is signed by the Wallet Provider or the Wallet's key storage component itself and contains the following elements:<a href="#appendix-D.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-D.1-2.1">
            <p id="appendix-D.1-2.1.1">in the JOSE header,<a href="#appendix-D.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-D.1-2.1.2.1">
                <code>alg</code>: REQUIRED. A digital signature algorithm identifier such as per IANA "JSON Web Signature and Encryption Algorithms" registry <span>[<a href="#IANA.JOSE" class="cite xref">IANA.JOSE</a>]</span>. It MUST NOT be <code>none</code> or an identifier for a symmetric algorithm (MAC).<a href="#appendix-D.1-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="appendix-D.1-2.1.2.2">
                <code>typ</code>: REQUIRED. MUST be <code>key-attestation+jwt</code>, which explicitly types the key proof JWT as recommended in Section 3.11 of <span>[<a href="#RFC8725" class="cite xref">RFC8725</a>]</span>.<a href="#appendix-D.1-2.1.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="appendix-D.1-3">The key attestation may use <code>x5c</code>, <code>kid</code> or <code>trust_chain</code> (as defined in <a href="#jwt-proof-type" class="auto internal xref">Appendix F.1</a>) to convey the public key and the associated trust mechanism to sign the key attestation.<a href="#appendix-D.1-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-D.1-4.1">
            <p id="appendix-D.1-4.1.1">in the JWT body,<a href="#appendix-D.1-4.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-D.1-4.1.2.1">
                <code>iat</code>: REQUIRED (number). Integer for the time at which the key attestation was issued using the syntax defined in <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#appendix-D.1-4.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="appendix-D.1-4.1.2.2">
                <code>exp</code>: OPTIONAL (number). Integer for the time at which the key attestation and the key(s) it is attesting expire, using the syntax defined in <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>. MUST be present if the attestation is used with the JWT proof type.<a href="#appendix-D.1-4.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="appendix-D.1-4.1.2.3">
                <code>attested_keys</code> : REQUIRED. A non-empty array of attested keys from the same key storage component using the syntax of JWK as defined in <span>[<a href="#RFC7517" class="cite xref">RFC7517</a>]</span>.<a href="#appendix-D.1-4.1.2.3" class="pilcrow">¶</a>
</li>
              <li class="compact" id="appendix-D.1-4.1.2.4">
                <code>key_storage</code> : OPTIONAL. A non-empty array of case sensitive strings that assert the attack potential resistance of the key storage component and its keys attested in the <code>attested_keys</code> parameter. This specification defines initial values in <a href="#keyattestation-apr" class="auto internal xref">Appendix D.2</a>.<a href="#appendix-D.1-4.1.2.4" class="pilcrow">¶</a>
</li>
              <li class="compact" id="appendix-D.1-4.1.2.5">
                <code>user_authentication</code> : OPTIONAL. A non-empty array of case sensitive strings that assert the attack potential resistance of the user authentication methods allowed to access the private keys from the <code>attested_keys</code> parameter. This specification defines initial values in <a href="#keyattestation-apr" class="auto internal xref">Appendix D.2</a>.<a href="#appendix-D.1-4.1.2.5" class="pilcrow">¶</a>
</li>
              <li class="compact" id="appendix-D.1-4.1.2.6">
                <code>certification</code> : OPTIONAL. A String that contains a URL that links to the certification of the key storage component.<a href="#appendix-D.1-4.1.2.6" class="pilcrow">¶</a>
</li>
              <li class="compact" id="appendix-D.1-4.1.2.7">
                <code>nonce</code>: OPTIONAL. String that represents a nonce provided by the Issuer to prove that a key attestation was freshly generated.<a href="#appendix-D.1-4.1.2.7" class="pilcrow">¶</a>
</li>
              <li class="compact" id="appendix-D.1-4.1.2.8">
                <code>status</code>: OPTIONAL. JSON Object representing the supported revocation check mechanisms, such as the one defined in <span>[<a href="#I-D.ietf-oauth-status-list" class="cite xref">I-D.ietf-oauth-status-list</a>]</span><a href="#appendix-D.1-4.1.2.8" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="appendix-D.1-5">If used with the <code>jwt</code> proof type, the Credential Issuer MUST validate that the JWT used as a proof is signed by a key contained in the attestation in the JOSE Header.<a href="#appendix-D.1-5" class="pilcrow">¶</a></p>
<p id="appendix-D.1-6">This is an example of a Key Attestation:<a href="#appendix-D.1-6" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="appendix-D.1-7">
<pre>{
  "typ": "key-attestation+jwt",
  "alg": "ES256",
  "x5c": ["MIIDQjCCA..."]
}
.
{
  "iss": "&lt;identifier of the issuer of this key attestation&gt;",
  "iat": 1516247022,
  "exp": 1541493724,
  "key_storage": [ "iso_18045_moderate" ],
  "user_authentication": [ "iso_18045_moderate" ],
  "attested_keys": [
    {
      "kty": "EC",
      "crv": "P-256",
      "x": "TCAER19Zvu3OHF4j4W4vfSVoHIP1ILilDls7vCeGemc",
      "y": "ZxjiWWbZMQGHVWKVQ4hbSIirsVfuecCE6t4jT9F2HZQ"
    }
  ]
}
</pre><a href="#appendix-D.1-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="keyattestation-apr">
<section id="appendix-D.2">
        <h3 id="name-attack-potential-resistance">
<a href="#appendix-D.2" class="section-number selfRef">D.2. </a><a href="#name-attack-potential-resistance" class="section-name selfRef">Attack Potential Resistance</a>
        </h3>
<p id="appendix-D.2-1">This specification defines the following values for <code>key_storage</code> and <code>user_authentication</code>:<a href="#appendix-D.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-D.2-2.1">
            <code>iso_18045_high</code>: It MUST be used when key storage or user authentication is resistant to attack with attack potential "High", equivalent to VAN.5 according to <span>[<a href="#ISO.18045" class="cite xref">ISO.18045</a>]</span>.<a href="#appendix-D.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-D.2-2.2">
            <code>iso_18045_moderate</code>: It MUST be used when key storage or user authentication is resistant to attack with attack potential "Moderate", equivalent to VAN.4 according to <span>[<a href="#ISO.18045" class="cite xref">ISO.18045</a>]</span>.<a href="#appendix-D.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-D.2-2.3">
            <code>iso_18045_enhanced-basic</code>: It MUST be used when key storage or user authentication is resistant to attack with attack potential "Enhanced-Basic", equivalent to VAN.3 according to <span>[<a href="#ISO.18045" class="cite xref">ISO.18045</a>]</span>.<a href="#appendix-D.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-D.2-2.4">
            <code>iso_18045_basic</code>: It MUST be used when key storage or user authentication is resistant to attack with attack potential "Basic", equivalent to VAN.2 according to <span>[<a href="#ISO.18045" class="cite xref">ISO.18045</a>]</span>.<a href="#appendix-D.2-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="appendix-D.2-3">Specifications that extend this list MUST choose collision-resistant values.<a href="#appendix-D.2-3" class="pilcrow">¶</a></p>
<p id="appendix-D.2-4">When <span>[<a href="#ISO.18045" class="cite xref">ISO.18045</a>]</span> is not used, ecosystems may define their own values. If the value does not map to a well-known specification, it is RECOMMENDED that the value is a URL that gives further information about the attack potential resistance and possible relations to level of assurances.<a href="#appendix-D.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="walletattestation">
<section id="appendix-E">
      <h2 id="name-wallet-attestations-in-jwt-">
<a href="#appendix-E" class="section-number selfRef">Appendix E. </a><a href="#name-wallet-attestations-in-jwt-" class="section-name selfRef">Wallet Attestations in JWT format</a>
      </h2>
<p id="appendix-E-1">The Wallet Attestation defined in this section is a client authentication method especially designed for native App Wallets. Instead of using platform-specific key, app, and/or device attestations directly, it uses a key-bound, platform agnostic common format based on JWTs. This allows Authorization Servers to authenticate Wallets across different platforms in a unified fashion and exposes only a minimum dataset. Also, it allows the Wallet app to directly interact with the Credential Issuer without involving the Wallet Provider's backend. The Authorization Server MUST verify that the Wallet Attestation is signed by an issuer that the Credential Issuer trusts for this purpose.<a href="#appendix-E-1" class="pilcrow">¶</a></p>
<p id="appendix-E-2">In a typical architecture of a native Wallet App, the Wallet Provider's backend will use attestations provided by the mobile operating system, like iOS's DeviceCheck or Android's Play Integrity, to validate the app's integrity and authenticity before issuing the Wallet Attestation.<a href="#appendix-E-2" class="pilcrow">¶</a></p>
<p id="appendix-E-3">There are two requests where Wallets may need to authenticate during Credential issuance:<a href="#appendix-E-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-E-4.1">The Wallet sends it in the Pushed Authorization Request<a href="#appendix-E-4.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-E-4.2">The Wallet sends it in the Token Request<a href="#appendix-E-4.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-5">The Wallet Attestation format follows Section 5.1 "Client Attestation JWT" of <span>[<a href="#I-D.ietf-oauth-attestation-based-client-auth" class="cite xref">I-D.ietf-oauth-attestation-based-client-auth</a>]</span>. The Wallet Attestation additionally includes the following JWT Claims:<a href="#appendix-E-5" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-E-6.1">
          <code>wallet_name</code>: OPTIONAL. String containing a human-readable name of the Wallet.<a href="#appendix-E-6.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-E-6.2">
          <code>wallet_link</code>: OPTIONAL. String containing a URL to get further information about the Wallet and the Wallet Provider.<a href="#appendix-E-6.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-E-6.3">
          <code>status</code>: OPTIONAL. Status mechanism for the Wallet Attestation as defined in <span>[<a href="#I-D.ietf-oauth-status-list" class="cite xref">I-D.ietf-oauth-status-list</a>]</span><a href="#appendix-E-6.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-E-7">The following is a non-normative example of a decoded Wallet Attestation:<a href="#appendix-E-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-E-8">
<pre>{
  "typ": "oauth-client-attestation+jwt",
  "alg": "ES256",
  "kid": "11"
}
.
{
  "iss": "https://wallet-provider.example.com",
  "sub": "https://wallet.example.org",
  "wallet_name": "Wallet Solution X by Wonderland State Department",
  "wallet_link": "https://example.com/wallet/detail_info.html",
  "nbf": 1300815780,
  "exp": 1300819380,
  "cnf": {
    "jwk": {
      "kty": "EC",
      "use": "sig",
      "crv": "P-256",
      "x": "18wHLeIgW9wVN6VD1Txgpqy2LszYkMf6J8njVAibvhM",
      "y": "-V4dS4UaLMgP_4fY4j8ir7cl1TXlFdAgcx55o7TkcSA"
    }
  }
}
</pre><a href="#appendix-E-8" class="pilcrow">¶</a>
</div>
<p id="appendix-E-9">See <a href="#wallet-attestation-example" class="auto internal xref">Appendix I.2</a> for an example of a signed Wallet Attestation JWT.<a href="#appendix-E-9" class="pilcrow">¶</a></p>
<p id="appendix-E-10">To use the Wallet Attestation towards the Authorization Server, the Wallet MUST generate a proof of possession according to Section 5.2 "Client Attestation PoP JWT" of Attestation-Based Client Authentication.<a href="#appendix-E-10" class="pilcrow">¶</a></p>
<p id="appendix-E-11">The <code>sub</code> claim of the Wallet Attestation JWT is the <code>client_id</code> of the Wallet instance. For privacy reasons, this value is the same across Wallet instances of that Wallet Provider, see <a href="#walletattestation-sub" class="auto internal xref">Section 15.4.4</a> for more details.<a href="#appendix-E-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="proof-types">
<section id="appendix-F">
      <h2 id="name-proof-types">
<a href="#appendix-F" class="section-number selfRef">Appendix F. </a><a href="#name-proof-types" class="section-name selfRef">Proof Types</a>
      </h2>
<p id="appendix-F-1">A proof type communicates a proof of cryptographic key material used for binding a Credential in the Credential Request.<a href="#appendix-F-1" class="pilcrow">¶</a></p>
<p id="appendix-F-2">This specification defines the following proof types:<a href="#appendix-F-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-F-3.1">
          <code>jwt</code>: A JWT <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span> is used for proof of possession. When a <code>proofs</code> object is using a <code>jwt</code> proof type, it MUST include a <code>jwt</code> parameter with its value being a non-empty array of JWTs, where each JWT is formed as defined in <a href="#jwt-proof-type" class="auto internal xref">Appendix F.1</a>.<a href="#appendix-F-3.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-3.2">
          <code>di_vp</code>: A W3C Verifiable Presentation object signed using the Data Integrity Proof <span>[<a href="#VC_Data_Integrity" class="cite xref">VC_Data_Integrity</a>]</span> as defined in <span>[<a href="#VC_DATA_2.0" class="cite xref">VC_DATA_2.0</a>]</span> or <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span> is used for proof of possession. When a <code>proofs</code> object is using a <code>di_vp</code> proof type, it MUST include an <code>di_vp</code> parameter with its value being a non-empty array of W3C Verifiable Presentations as defined by <span>[<a href="#VC_DATA_2.0" class="cite xref">VC_DATA_2.0</a>]</span> or <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span>, where each of these W3C Verifiable Presentation is formed as defined in <a href="#di-vp-proof-type" class="auto internal xref">Appendix F.2</a>.<a href="#appendix-F-3.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-3.3">
          <code>attestation</code>:  A JWT <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span> representing a key attestation without using a proof of possession of the cryptographic key material that is being attested. When a <code>proofs</code> object is using an <code>attestation</code> proof type, the object MUST include an <code>attestation</code> parameter with its value being an array that contains exactly one JWT that is formed as defined in <a href="#keyattestation-jwt" class="auto internal xref">Appendix D.1</a>.<a href="#appendix-F-3.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-F-4">There are two ways to convey key attestations (as defined in <a href="#keyattestation" class="auto internal xref">Appendix D</a>) of the cryptographic key material during Credential issuance:<a href="#appendix-F-4" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-F-5.1">The Wallet uses the <code>jwt</code> proof type in the Credential Request to create a proof of possession for one of the attested keys and adds the key attestation in the JOSE header.<a href="#appendix-F-5.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-5.2">The Wallet uses the <code>attestation</code> proof type in the Credential Request to provide a key attestation without a proof of possession of any of the keys.<a href="#appendix-F-5.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-F-6">Depending on the Wallet's implementation, the <code>attestation</code> may avoid unnecessary End-User interaction during Credential issuance, as the key(s) to which the Credential(s) will be bound does not necessarily need to perform signature operations, and one key attestation can be used to attest multiple keys.<a href="#appendix-F-6" class="pilcrow">¶</a></p>
<p id="appendix-F-7">Additional proof types MAY be defined and used.<a href="#appendix-F-7" class="pilcrow">¶</a></p>
<div id="jwt-proof-type">
<section id="appendix-F.1">
        <h3 id="name-jwt-proof-type">
<a href="#appendix-F.1" class="section-number selfRef">F.1. </a><a href="#name-jwt-proof-type" class="section-name selfRef"><code>jwt</code> Proof Type</a>
        </h3>
<p id="appendix-F.1-1">The JWT MUST contain the following elements:<a href="#appendix-F.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-F.1-2.1">
            <p id="appendix-F.1-2.1.1">in the JOSE header,<a href="#appendix-F.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="compact normal">
<li class="compact normal" id="appendix-F.1-2.1.2.1">
                <code>alg</code>: REQUIRED. A digital signature algorithm identifier such as per IANA "JSON Web Signature and Encryption Algorithms" registry <span>[<a href="#IANA.JOSE" class="cite xref">IANA.JOSE</a>]</span>. It MUST NOT be <code>none</code> or an identifier for a symmetric algorithm (MAC).<a href="#appendix-F.1-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="appendix-F.1-2.1.2.2">
                <code>typ</code>: REQUIRED. MUST be <code>openid4vci-proof+jwt</code>, which explicitly types the key proof JWT as recommended in Section 3.11 of <span>[<a href="#RFC8725" class="cite xref">RFC8725</a>]</span>.<a href="#appendix-F.1-2.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="appendix-F.1-2.1.2.3">
                <code>kid</code>: OPTIONAL. JOSE Header containing the key ID. If the Credential is to be bound to a DID, the <code>kid</code> refers to a DID URL which identifies a particular key in the DID Document that the Credential is to be bound to. It MUST NOT be present if <code>jwk</code> or <code>x5c</code> is present.<a href="#appendix-F.1-2.1.2.3" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="appendix-F.1-2.1.2.4">
                <code>jwk</code>: OPTIONAL. JOSE Header containing the key material the new Credential is to be bound to. It MUST NOT be present if <code>kid</code> or <code>x5c</code> is present.<a href="#appendix-F.1-2.1.2.4" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="appendix-F.1-2.1.2.5">
                <code>x5c</code>: OPTIONAL. JOSE Header containing at least one certificate where the first certificate contains the key that the Credential is to be bound to, additional certificates may also be present. It MUST NOT be present if <code>kid</code> or <code>jwk</code> is present.<a href="#appendix-F.1-2.1.2.5" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="appendix-F.1-2.1.2.6">
                <code>key_attestation</code>: OPTIONAL. JOSE Header containing a key attestation as described in <a href="#keyattestation" class="auto internal xref">Appendix D</a>. If the Credential Issuer provided a <code>c_nonce</code>, the <code>nonce</code> claim in the key attestation MUST be set to a server-provided <code>c_nonce</code>.<a href="#appendix-F.1-2.1.2.6" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="appendix-F.1-2.1.2.7">
                <code>trust_chain</code>: OPTIONAL. JOSE Header containing an <span>[<a href="#OpenID.Federation" class="cite xref">OpenID.Federation</a>]</span> Trust Chain. This element MAY be used to convey key attestation, metadata, metadata policies, federation Trust Marks and any other information related to a specific federation, if available in the chain. When used for signature verification, the header parameter <code>kid</code> MUST be present.<a href="#appendix-F.1-2.1.2.7" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-F.1-2.2">
            <p id="appendix-F.1-2.2.1">in the JWT body,<a href="#appendix-F.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="compact normal">
<li class="compact normal" id="appendix-F.1-2.2.2.1">
                <code>iss</code>: OPTIONAL (string). The value of this claim MUST be the <code>client_id</code> of the Client making the Credential request. This claim MUST be omitted if the access token authorizing the issuance call was obtained from a Pre-Authorized Code Flow through anonymous access to the token endpoint.<a href="#appendix-F.1-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="appendix-F.1-2.2.2.2">
                <code>aud</code>: REQUIRED (string). The value of this claim MUST be the Credential Issuer Identifier.<a href="#appendix-F.1-2.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="appendix-F.1-2.2.2.3">
                <code>iat</code>: REQUIRED (number). The value of this claim MUST be the time at which the key proof was issued using the syntax defined in <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#appendix-F.1-2.2.2.3" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="appendix-F.1-2.2.2.4">
                <code>nonce</code>: OPTIONAL (string). The value type of this claim MUST be a string, where the value is a server-provided <code>c_nonce</code>. It MUST be present when the issuer has a Nonce Endpoint as defined in <a href="#nonce-endpoint" class="auto internal xref">Section 7</a>.<a href="#appendix-F.1-2.2.2.4" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="appendix-F.1-3">The Credential Issuer MUST validate that the JWT used as a proof is actually signed by a key identified in the JOSE Header through either <code>kid</code>, <code>jwk</code> or <code>x5c</code> element.<a href="#appendix-F.1-3" class="pilcrow">¶</a></p>
<p id="appendix-F.1-4">The Credential Issuer SHOULD issue a Credential for each cryptographic public key specified in the <code>attested_keys</code> claim within the <code>key_attestation</code> parameter.<a href="#appendix-F.1-4" class="pilcrow">¶</a></p>
<p id="appendix-F.1-5">Cryptographic algorithm identifiers used in the <code>proof_signing_alg_values_supported</code> Credential Issuer metadata parameter for this proof type are case sensitive strings and SHOULD be one of the Algorithm Names defined in <span>[<a href="#IANA.JOSE" class="cite xref">IANA.JOSE</a>]</span>.
If Credential Issuer metadata is provided, the <code>alg</code> JWT header of the key proof, and if present, the <code>alg</code> JOSE headers of both <code>key_attestation</code> and <code>trust_chain</code>, MUST match one of the values listed in the <code>proof_signing_alg_values_supported</code> metadata parameter.<a href="#appendix-F.1-5" class="pilcrow">¶</a></p>
<p id="appendix-F.1-6">Below is a non-normative example of a <code>proofs</code> parameter (with line breaks within values for display purposes only):<a href="#appendix-F.1-6" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="appendix-F.1-7">
<pre>{
  "jwt": [
    "eyJ0eXAiOiJvcGVuaWQ0dmNpLXByb29mK2p3dCIsImFsZyI6IkVTMjU2Iiwiand
    rIjp7Imt0eSI6IkVDIiwiY3J2IjoiUC0yNTYiLCJ4IjoiblVXQW9BdjNYWml0aDh
    FN2kxOU9kYXhPTFlGT3dNLVoyRXVNMDJUaXJUNCIsInkiOiJIc2tIVThCalVpMVU
    5WHFpN1N3bWo4Z3dBS18weGtjRGpFV183MVNvc0VZIn19.eyJhdWQiOiJodHRwcz
    ovL2NyZWRlbnRpYWwtaXNzdWVyLmV4YW1wbGUuY29tIiwiaWF0IjoxNzAxOTYwND
    Q0LCJub25jZSI6IkxhclJHU2JtVVBZdFJZTzZCUTR5bjgifQ.-a3EDsxClUB4O3L
    eDD5DVGEnNMT01FCQW4P6-2-BNBqc_Zxf0Qw4CWayLEpqkAomlkLb9zioZoipdP-
    jvh1WlA"
  ]
}
</pre><a href="#appendix-F.1-7" class="pilcrow">¶</a>
</div>
<p id="appendix-F.1-8">where the decoded JWT looks like this:<a href="#appendix-F.1-8" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="appendix-F.1-9">
<pre>{
  "typ": "openid4vci-proof+jwt",
  "alg": "ES256",
  "jwk": {
    "kty": "EC",
    "crv": "P-256",
    "x": "nUWAoAv3XZith8E7i19OdaxOLYFOwM-Z2EuM02TirT4",
    "y": "HskHU8BjUi1U9Xqi7Swmj8gwAK_0xkcDjEW_71SosEY"
  }
}.{
  "aud": "https://credential-issuer.example.com",
  "iat": 1701960444,
  "nonce": "LarRGSbmUPYtRYO6BQ4yn8"
}
</pre><a href="#appendix-F.1-9" class="pilcrow">¶</a>
</div>
<p id="appendix-F.1-10">Here is another example of a JWT not only proving possession of a private key but also providing key attestation data for that key:<a href="#appendix-F.1-10" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="appendix-F.1-11">
<pre>{
  "typ": "openid4vci-proof+jwt",
  "alg": "ES256",
  "kid": "0",
  "key_attestation": &lt;key attestation in JWT format&gt;
}.
{
  "iss": "s6BhdRkqt3",
  "aud": "https://server.example.com",
  "iat": 1659145924,
  "nonce": "tZignsnFbp"
}
</pre><a href="#appendix-F.1-11" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="di-vp-proof-type">
<section id="appendix-F.2">
        <h3 id="name-di_vp-proof-type">
<a href="#appendix-F.2" class="section-number selfRef">F.2. </a><a href="#name-di_vp-proof-type" class="section-name selfRef"><code>di_vp</code> Proof Type</a>
        </h3>
<p id="appendix-F.2-1">When a W3C Verifiable Presentation as defined by <span>[<a href="#VC_DATA_2.0" class="cite xref">VC_DATA_2.0</a>]</span> or <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span> secured using Data Integrity <span>[<a href="#VC_Data_Integrity" class="cite xref">VC_Data_Integrity</a>]</span> is used as key proof, it MUST contain at least the following properties, in addition to any other properties required by <span>[<a href="#VC_DATA_2.0" class="cite xref">VC_DATA_2.0</a>]</span> or <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span>:<a href="#appendix-F.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-F.2-2.1">
            <code>holder</code>: OPTIONAL. If present, it MUST be equivalent to the controller identifier part (e.g., DID) of the <code>verificationMethod</code> value identified by the <code>proof.verificationMethod</code> property.<a href="#appendix-F.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-F.2-2.2">
            <p id="appendix-F.2-2.2.1"><code>proof</code>: REQUIRED. The <code>proof</code> property of the W3C Verifiable Presentation MUST be a Data Integrity Proof, as defined in <span>[<a href="#VC_Data_Integrity" class="cite xref">VC_Data_Integrity</a>]</span>, and its properties MUST conform with the following rules, in addition to those specified in <span>[<a href="#VC_Data_Integrity" class="cite xref">VC_Data_Integrity</a>]</span>:<br><a href="#appendix-F.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-F.2-2.2.2.1">
                <code>cryptosuite</code>: REQUIRED. If Credential Issuer metadata is provided, the value MUST match one of the entries in the <code>proof_signing_alg_values_supported</code> metadata parameter.<a href="#appendix-F.2-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="appendix-F.2-2.2.2.2">
                <code>proofPurpose</code>: REQUIRED. MUST be set to <code>authentication</code>.<a href="#appendix-F.2-2.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="appendix-F.2-2.2.2.3">
                <code>domain</code>: REQUIRED. MUST be set to the Credential Issuer Identifier.<br><a href="#appendix-F.2-2.2.2.3" class="pilcrow">¶</a>
</li>
              <li class="compact" id="appendix-F.2-2.2.2.4">
                <code>challenge</code>: REQUIRED when the Credential Issuer has provided a <code>c_nonce</code>. It MUST NOT be used otherwise. String, where the value is a server-provided <code>c_nonce</code>. It MUST be present when the issuer has a Nonce Endpoint as defined in <a href="#nonce-endpoint" class="auto internal xref">Section 7</a>.<a href="#appendix-F.2-2.2.2.4" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="appendix-F.2-3">The Credential Issuer MUST validate that the W3C Verifiable Presentation used as a proof is actually signed with a key in the possession of the Holder.<a href="#appendix-F.2-3" class="pilcrow">¶</a></p>
<p id="appendix-F.2-4">Additional properties in the W3C Verifiable Presentation and Data Integrity Proof MUST be ignored if not understood.
Cryptographic algorithm identifiers used in the <code>proof_signing_alg_values_supported</code> Credential Issuer metadata parameter for this proof type are case sensitive strings and SHOULD be one of those defined in, or referenced by, <span>[<a href="#VC_Data_Integrity" class="cite xref">VC_Data_Integrity</a>]</span>.<a href="#appendix-F.2-4" class="pilcrow">¶</a></p>
<p id="appendix-F.2-5">Below is a non-normative example of a <code>proofs</code> parameter (with line breaks within values for display purposes only):<a href="#appendix-F.2-5" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="appendix-F.2-6">
<pre>{
  "di_vp": [
    {
      "@context": [
        "https://www.w3.org/ns/credentials/v2",
        "https://www.w3.org/ns/credentials/examples/v2"
      ],
      "type": [
        "VerifiablePresentation"
      ],
      "holder": "did:key:z6MkvrFpBNCoYewiaeBLgjUDvLxUtnK5R6mqh5XPvLsrPsro",
      "proof": [
        {
          "type": "DataIntegrityProof",
          "cryptosuite": "eddsa-2022",
          "proofPurpose": "authentication",
          "verificationMethod": "did:key:z6MkvrFpBNCoYewiaeBLgjUDvLxUtnK5R6mqh5
           XPvLsrPsro#z6MkvrFpBNCoYewiaeBLgjUDvLxUtnK5R6mqh5XPvLsrPsro",
          "created": "2023-03-01T14:56:29.280619Z",
          "challenge": "82d4cb36-11f6-4273-b9c6-df1ac0ff17e9",
          "domain": "did:web:audience.company.com",
          "proofValue": "z5hrbHzZiqXHNpLq6i7zePEUcUzEbZKmWfNQzXcUXUrqF7bykQ7ACi
           WFyZdT2HcptF1zd1t7NhfQSdqrbPEjZceg7"
        }
      ]
    }
  ]
}

</pre><a href="#appendix-F.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="attestation-proof-type">
<section id="appendix-F.3">
        <h3 id="name-attestation-proof-type">
<a href="#appendix-F.3" class="section-number selfRef">F.3. </a><a href="#name-attestation-proof-type" class="section-name selfRef"><code>attestation</code> Proof Type</a>
        </h3>
<p id="appendix-F.3-1">A key attestation in JWT format as defined in <a href="#keyattestation-jwt" class="auto internal xref">Appendix D.1</a>.<a href="#appendix-F.3-1" class="pilcrow">¶</a></p>
<p id="appendix-F.3-2">If the Credential Issuer has a Nonce Endpoint (as defined in <a href="#nonce-endpoint" class="auto internal xref">Section 7</a>), the <code>c_nonce</code> value provided by the Credential Issuer MUST be provided in the key attestation's <code>nonce</code> parameter.<a href="#appendix-F.3-2" class="pilcrow">¶</a></p>
<p id="appendix-F.3-3">Cryptographic algorithm identifiers used in the <code>proof_signing_alg_values_supported</code> Credential Issuer metadata parameter for this proof type are case sensitive strings and SHOULD be one of those defined in <span>[<a href="#IANA.JOSE" class="cite xref">IANA.JOSE</a>]</span>.<a href="#appendix-F.3-3" class="pilcrow">¶</a></p>
<p id="appendix-F.3-4">Below is a non-normative example of a <code>proofs</code> parameter (with line breaks within values for display purposes only):<a href="#appendix-F.3-4" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="appendix-F.3-5">
<pre>{
  "attestation": [
    "&lt;key attestation in JWT format&gt;"
  ]
}
</pre><a href="#appendix-F.3-5" class="pilcrow">¶</a>
</div>
<p id="appendix-F.3-6">The Credential Issuer SHOULD issue a Credential for each cryptographic public key specified in the <code>attested_keys</code> claim within the <code>key_attestation</code> parameter.<a href="#appendix-F.3-6" class="pilcrow">¶</a></p>
<p id="appendix-F.3-7">If Credential Issuer metadata is provided, the value of the <code>alg</code> JWT header of the key attestation MUST match one of the entries in the <code>proof_signing_alg_values_supported</code> metadata parameter.<a href="#appendix-F.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verifying-key-proof">
<section id="appendix-F.4">
        <h3 id="name-verifying-proof">
<a href="#appendix-F.4" class="section-number selfRef">F.4. </a><a href="#name-verifying-proof" class="section-name selfRef">Verifying Proof</a>
        </h3>
<p id="appendix-F.4-1">To validate a key proof, the Credential Issuer MUST ensure that:<a href="#appendix-F.4-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-F.4-2.1">all required claims for that proof type are contained as defined in <a href="#proof-types" class="auto internal xref">Appendix F</a>,<a href="#appendix-F.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-F.4-2.2">the key proof is explicitly typed using header parameters as defined for that proof type,<a href="#appendix-F.4-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-F.4-2.3">the header parameter indicates a registered asymmetric digital signature algorithm, <code>alg</code> parameter value is not <code>none</code>, is supported by the application, and is acceptable per local policy,<a href="#appendix-F.4-2.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-F.4-2.4">the signature on the key proof verifies with the public key contained in the header parameter,<a href="#appendix-F.4-2.4" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-F.4-2.5">the header parameter does not contain a private key,<a href="#appendix-F.4-2.5" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-F.4-2.6">if the server has a Nonce Endpoint, the nonce in the key proof matches the server-provided <code>c_nonce</code> value,<a href="#appendix-F.4-2.6" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-F.4-2.7">the creation time of the JWT, as determined by either the issuance time, or a server managed timestamp via the nonce claim, is within an acceptable window (see <a href="#key-proof-replay" class="auto internal xref">Section 13.8</a>).<a href="#appendix-F.4-2.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="appendix-F.4-3">These checks may be performed in any order.<a href="#appendix-F.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="appendix-G">
      <h2 id="name-iana-considerations">
<a href="#appendix-G" class="section-number selfRef">Appendix G. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="oauth-uri-registry">
<section id="appendix-G.1">
        <h3 id="name-oauth-uri-registry">
<a href="#appendix-G.1" class="section-number selfRef">G.1. </a><a href="#name-oauth-uri-registry" class="section-name selfRef">OAuth URI Registry</a>
        </h3>
<p id="appendix-G.1-1">This specification registers the following URN
in the IANA "OAuth URI" registry <span>[<a href="#IANA.OAuth.Parameters" class="cite xref">IANA.OAuth.Parameters</a>]</span>
established by <span>[<a href="#RFC6755" class="cite xref">RFC6755</a>]</span>.<a href="#appendix-G.1-1" class="pilcrow">¶</a></p>
<div id="urn-ietf-params-oauth-grant-type-pre-authorized-code">
<section id="appendix-G.1.1">
          <h4 id="name-urnietfparamsoauthgrant-typ">
<a href="#appendix-G.1.1" class="section-number selfRef">G.1.1. </a><a href="#name-urnietfparamsoauthgrant-typ" class="section-name selfRef">urn:ietf:params:oauth:grant-type:pre-authorized_code</a>
          </h4>
<ul class="compact">
<li class="compact" id="appendix-G.1.1-1.1">URN: <code>urn:ietf:params:oauth:grant-type:pre-authorized_code</code><a href="#appendix-G.1.1-1.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.1.1-1.2">Common Name: Pre-Authorized Code<a href="#appendix-G.1.1-1.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.1.1-1.3">Change Controller: OpenID Foundation Digital Credentials Protocols Working Group - openid-specs-digital-credentials-protocols@lists.openid.net<a href="#appendix-G.1.1-1.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.1.1-1.4">Reference: <a href="#credential-offer-parameters" class="auto internal xref">Section 4.1.1</a> of this specification<a href="#appendix-G.1.1-1.4" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="oauth-parameters-registry">
<section id="appendix-G.2">
        <h3 id="name-oauth-parameters-registry">
<a href="#appendix-G.2" class="section-number selfRef">G.2. </a><a href="#name-oauth-parameters-registry" class="section-name selfRef">OAuth Parameters Registry</a>
        </h3>
<p id="appendix-G.2-1">This specification registers the following OAuth parameter
in the IANA "OAuth Parameters" registry <span>[<a href="#IANA.OAuth.Parameters" class="cite xref">IANA.OAuth.Parameters</a>]</span>
established by <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#appendix-G.2-1" class="pilcrow">¶</a></p>
<div id="issuer-state">
<section id="appendix-G.2.1">
          <h4 id="name-issuer_state">
<a href="#appendix-G.2.1" class="section-number selfRef">G.2.1. </a><a href="#name-issuer_state" class="section-name selfRef">issuer_state</a>
          </h4>
<ul class="compact">
<li class="compact" id="appendix-G.2.1-1.1">Name: <code>issuer_state</code><a href="#appendix-G.2.1-1.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.2.1-1.2">Parameter Usage Location: authorization request<a href="#appendix-G.2.1-1.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.2.1-1.3">Change Controller: OpenID Foundation Digital Credentials Protocols Working Group - openid-specs-digital-credentials-protocols@lists.openid.net<a href="#appendix-G.2.1-1.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.2.1-1.4">Reference: <a href="#credential-authz-request" class="auto internal xref">Section 5.1</a> of this specification<a href="#appendix-G.2.1-1.4" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="pre-authorized-code">
<section id="appendix-G.2.2">
          <h4 id="name-pre-authorized_code">
<a href="#appendix-G.2.2" class="section-number selfRef">G.2.2. </a><a href="#name-pre-authorized_code" class="section-name selfRef">pre-authorized_code</a>
          </h4>
<ul class="compact">
<li class="compact" id="appendix-G.2.2-1.1">Name: <code>pre-authorized_code</code><a href="#appendix-G.2.2-1.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.2.2-1.2">Parameter Usage Location: token request<a href="#appendix-G.2.2-1.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.2.2-1.3">Change Controller: OpenID Foundation Digital Credentials Protocols Working Group - openid-specs-digital-credentials-protocols@lists.openid.net<a href="#appendix-G.2.2-1.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.2.2-1.4">Reference: <a href="#token-request" class="auto internal xref">Section 6.1</a> of this specification<a href="#appendix-G.2.2-1.4" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="tx-code">
<section id="appendix-G.2.3">
          <h4 id="name-tx_code">
<a href="#appendix-G.2.3" class="section-number selfRef">G.2.3. </a><a href="#name-tx_code" class="section-name selfRef">tx_code</a>
          </h4>
<ul class="compact">
<li class="compact" id="appendix-G.2.3-1.1">Name: <code>tx_code</code><a href="#appendix-G.2.3-1.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.2.3-1.2">Parameter Usage Location: token request<a href="#appendix-G.2.3-1.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.2.3-1.3">Change Controller: OpenID Foundation Digital Credentials Protocols Working Group - openid-specs-digital-credentials-protocols@lists.openid.net<a href="#appendix-G.2.3-1.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.2.3-1.4">Reference: <a href="#token-request" class="auto internal xref">Section 6.1</a> of this specification<a href="#appendix-G.2.3-1.4" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="oauth-authorization-server-metadata-registry">
<section id="appendix-G.3">
        <h3 id="name-oauth-authorization-server-">
<a href="#appendix-G.3" class="section-number selfRef">G.3. </a><a href="#name-oauth-authorization-server-" class="section-name selfRef">OAuth Authorization Server Metadata Registry</a>
        </h3>
<p id="appendix-G.3-1">This specification registers the following authorization server metadata parameter
in the IANA "OAuth Authorization Server Metadata" registry <span>[<a href="#IANA.OAuth.Parameters" class="cite xref">IANA.OAuth.Parameters</a>]</span>
established by <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span>.<a href="#appendix-G.3-1" class="pilcrow">¶</a></p>
<div id="pre-authorized-grant-anonymous-access-supported">
<section id="appendix-G.3.1">
          <h4 id="name-pre-authorized_grant_anonym">
<a href="#appendix-G.3.1" class="section-number selfRef">G.3.1. </a><a href="#name-pre-authorized_grant_anonym" class="section-name selfRef">pre-authorized_grant_anonymous_access_supported</a>
          </h4>
<ul class="compact">
<li class="compact" id="appendix-G.3.1-1.1">Metadata Name: <code>pre-authorized_grant_anonymous_access_supported</code><a href="#appendix-G.3.1-1.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.3.1-1.2">Metadata Description: Boolean indicating whether Credential Issuer accepts Token Request with Pre-Authorized Code but without <code>client_id</code><a href="#appendix-G.3.1-1.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.3.1-1.3">Change Controller: OpenID Foundation Digital Credentials Protocols Working Group - openid-specs-digital-credentials-protocols@lists.openid.net<a href="#appendix-G.3.1-1.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.3.1-1.4">Reference: <a href="#as-metadata" class="auto internal xref">Section 12.3</a> of this specification<a href="#appendix-G.3.1-1.4" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="oauth-dynamic-client-registration-metadata-registry">
<section id="appendix-G.4">
        <h3 id="name-oauth-dynamic-client-regist">
<a href="#appendix-G.4" class="section-number selfRef">G.4. </a><a href="#name-oauth-dynamic-client-regist" class="section-name selfRef">OAuth Dynamic Client Registration Metadata Registry</a>
        </h3>
<p id="appendix-G.4-1">This specification registers the following client metadata parameter
in the IANA "OAuth Dynamic Client Registration Metadata" registry <span>[<a href="#IANA.OAuth.Parameters" class="cite xref">IANA.OAuth.Parameters</a>]</span>
established by <span>[<a href="#RFC7591" class="cite xref">RFC7591</a>]</span>.<a href="#appendix-G.4-1" class="pilcrow">¶</a></p>
<div id="credential-offer-endpoint-1">
<section id="appendix-G.4.1">
          <h4 id="name-credential_offer_endpoint">
<a href="#appendix-G.4.1" class="section-number selfRef">G.4.1. </a><a href="#name-credential_offer_endpoint" class="section-name selfRef">credential_offer_endpoint</a>
          </h4>
<ul class="compact">
<li class="compact" id="appendix-G.4.1-1.1">Client Metadata Name: <code>credential_offer_endpoint</code><a href="#appendix-G.4.1-1.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.4.1-1.2">Client Metadata Description: Credential Offer Endpoint<a href="#appendix-G.4.1-1.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.4.1-1.3">Change Controller: OpenID Foundation Digital Credentials Protocols Working Group - openid-specs-digital-credentials-protocols@lists.openid.net<a href="#appendix-G.4.1-1.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.4.1-1.4">Reference: <a href="#client-metadata" class="auto internal xref">Section 12.1</a> of this specification<a href="#appendix-G.4.1-1.4" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="well-known-uri-registry">
<section id="appendix-G.5">
        <h3 id="name-well-known-uri-registry">
<a href="#appendix-G.5" class="section-number selfRef">G.5. </a><a href="#name-well-known-uri-registry" class="section-name selfRef">Well-Known URI Registry</a>
        </h3>
<p id="appendix-G.5-1">This specification registers the following well-known URI
in the IANA "Well-Known URI" registry <span>[<a href="#IANA.Well-Known.URIs" class="cite xref">IANA.Well-Known.URIs</a>]</span>
established by <span>[<a href="#RFC8615" class="cite xref">RFC8615</a>]</span>.<a href="#appendix-G.5-1" class="pilcrow">¶</a></p>
<div id="well-known-openid-credential-issuer">
<section id="appendix-G.5.1">
          <h4 id="name-well-known-openid-credentia">
<a href="#appendix-G.5.1" class="section-number selfRef">G.5.1. </a><a href="#name-well-known-openid-credentia" class="section-name selfRef">.well-known/openid-credential-issuer</a>
          </h4>
<ul class="compact">
<li class="compact" id="appendix-G.5.1-1.1">URI suffix: <code>openid-credential-issuer</code><a href="#appendix-G.5.1-1.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.5.1-1.2">Change controller: OpenID Foundation Digital Credentials Protocols Working Group - openid-specs-digital-credentials-protocols@lists.openid.net<a href="#appendix-G.5.1-1.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.5.1-1.3">Specification document: <a href="#credential-issuer-wellknown" class="auto internal xref">Section 12.2.2</a> of this specification<a href="#appendix-G.5.1-1.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.5.1-1.4">Related information: (none)<a href="#appendix-G.5.1-1.4" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="media-types-registry">
<section id="appendix-G.6">
        <h3 id="name-media-types-registry">
<a href="#appendix-G.6" class="section-number selfRef">G.6. </a><a href="#name-media-types-registry" class="section-name selfRef">Media Types Registry</a>
        </h3>
<p id="appendix-G.6-1">This specification registers the following media type <span>[<a href="#RFC2046" class="cite xref">RFC2046</a>]</span>
in the IANA "Media Types" registry <span>[<a href="#IANA.MediaTypes" class="cite xref">IANA.MediaTypes</a>]</span>
in the manner described in <span>[<a href="#RFC6838" class="cite xref">RFC6838</a>]</span>.<a href="#appendix-G.6-1" class="pilcrow">¶</a></p>
<div id="application-openid4vci-proof-jwt">
<section id="appendix-G.6.1">
          <h4 id="name-application-openid4vci-proo">
<a href="#appendix-G.6.1" class="section-number selfRef">G.6.1. </a><a href="#name-application-openid4vci-proo" class="section-name selfRef">application/openid4vci-proof+jwt</a>
          </h4>
<ul class="compact">
<li class="compact" id="appendix-G.6.1-1.1">Type name: <code>application</code><a href="#appendix-G.6.1-1.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.1-1.2">Subtype name: <code>openid4vci-proof+jwt</code><a href="#appendix-G.6.1-1.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.1-1.3">Required parameters: n/a<a href="#appendix-G.6.1-1.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.1-1.4">Optional parameters: n/a<a href="#appendix-G.6.1-1.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.1-1.5">Encoding considerations: Uses JWS Compact Serialization, as specified in <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#appendix-G.6.1-1.5" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.1-1.6">Security considerations: See the Security Considerations in <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#appendix-G.6.1-1.6" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.1-1.7">Interoperability considerations: n/a<a href="#appendix-G.6.1-1.7" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.1-1.8">Published specification: <a href="#jwt-proof-type" class="auto internal xref">Appendix F.1</a> of this specification<a href="#appendix-G.6.1-1.8" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.1-1.9">Applications that use this media type: Applications that issue and store verifiable credentials<a href="#appendix-G.6.1-1.9" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.1-1.10">
              <p id="appendix-G.6.1-1.10.1">Additional information:<a href="#appendix-G.6.1-1.10.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-G.6.1-1.10.2.1">Magic number(s): n/a<a href="#appendix-G.6.1-1.10.2.1" class="pilcrow">¶</a>
</li>
                <li class="compact" id="appendix-G.6.1-1.10.2.2">File extension(s): n/a<a href="#appendix-G.6.1-1.10.2.2" class="pilcrow">¶</a>
</li>
                <li class="compact" id="appendix-G.6.1-1.10.2.3">Macintosh file type code(s): n/a<a href="#appendix-G.6.1-1.10.2.3" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="compact" id="appendix-G.6.1-1.11">Person &amp; email address to contact for further information: Torsten Lodderstedt, torsten@lodderstedt.net<a href="#appendix-G.6.1-1.11" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.1-1.12">Intended usage: COMMON<a href="#appendix-G.6.1-1.12" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.1-1.13">Restrictions on usage: none<a href="#appendix-G.6.1-1.13" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.1-1.14">Author: Torsten Lodderstedt, torsten@lodderstedt.net<a href="#appendix-G.6.1-1.14" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.1-1.15">Change controller: OpenID Foundation Digital Credentials Protocols Working Group - openid-specs-digital-credentials-protocols@lists.openid.net<a href="#appendix-G.6.1-1.15" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.1-1.16">Provisional registration? No<a href="#appendix-G.6.1-1.16" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="application-key-attestation-jwt">
<section id="appendix-G.6.2">
          <h4 id="name-application-key-attestation">
<a href="#appendix-G.6.2" class="section-number selfRef">G.6.2. </a><a href="#name-application-key-attestation" class="section-name selfRef">application/key-attestation+jwt</a>
          </h4>
<ul class="compact">
<li class="compact" id="appendix-G.6.2-1.1">Type name: <code>application</code><a href="#appendix-G.6.2-1.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.2-1.2">Subtype name: <code>key-attestation+jwt</code><a href="#appendix-G.6.2-1.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.2-1.3">Required parameters: n/a<a href="#appendix-G.6.2-1.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.2-1.4">Optional parameters: n/a<a href="#appendix-G.6.2-1.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.2-1.5">Encoding considerations: Uses JWS Compact Serialization, as specified in <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#appendix-G.6.2-1.5" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.2-1.6">Security considerations: See the Security Considerations in <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#appendix-G.6.2-1.6" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.2-1.7">Interoperability considerations: n/a<a href="#appendix-G.6.2-1.7" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.2-1.8">Published specification: <a href="#keyattestation-jwt" class="auto internal xref">Appendix D.1</a> of this specification<a href="#appendix-G.6.2-1.8" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.2-1.9">Applications that use this media type: Applications that use the key attestation format defined in this specification<a href="#appendix-G.6.2-1.9" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.2-1.10">
              <p id="appendix-G.6.2-1.10.1">Additional information:<a href="#appendix-G.6.2-1.10.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-G.6.2-1.10.2.1">Magic number(s): n/a<a href="#appendix-G.6.2-1.10.2.1" class="pilcrow">¶</a>
</li>
                <li class="compact" id="appendix-G.6.2-1.10.2.2">File extension(s): n/a<a href="#appendix-G.6.2-1.10.2.2" class="pilcrow">¶</a>
</li>
                <li class="compact" id="appendix-G.6.2-1.10.2.3">Macintosh file type code(s): n/a<a href="#appendix-G.6.2-1.10.2.3" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="compact" id="appendix-G.6.2-1.11">Person &amp; email address to contact for further information: Torsten Lodderstedt, torsten@lodderstedt.net<a href="#appendix-G.6.2-1.11" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.2-1.12">Intended usage: COMMON<a href="#appendix-G.6.2-1.12" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.2-1.13">Restrictions on usage: none<a href="#appendix-G.6.2-1.13" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.2-1.14">Author: Torsten Lodderstedt, torsten@lodderstedt.net<a href="#appendix-G.6.2-1.14" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.2-1.15">Change controller: OpenID Foundation Digital Credentials Protocols Working Group - openid-specs-digital-credentials-protocols@lists.openid.net<a href="#appendix-G.6.2-1.15" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.2-1.16">Provisional registration? No<a href="#appendix-G.6.2-1.16" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="application-openidvci-issuer-metadata-jwt">
<section id="appendix-G.6.3">
          <h4 id="name-application-openidvci-issue">
<a href="#appendix-G.6.3" class="section-number selfRef">G.6.3. </a><a href="#name-application-openidvci-issue" class="section-name selfRef">application/openidvci-issuer-metadata+jwt</a>
          </h4>
<ul class="compact">
<li class="compact" id="appendix-G.6.3-1.1">Type name: <code>application</code><a href="#appendix-G.6.3-1.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.3-1.2">Subtype name: <code>openidvci-issuer-metadata+jwt</code><a href="#appendix-G.6.3-1.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.3-1.3">Required parameters: n/a<a href="#appendix-G.6.3-1.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.3-1.4">Optional parameters: n/a<a href="#appendix-G.6.3-1.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.3-1.5">Encoding considerations: Uses JWS Compact Serialization, as specified in <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#appendix-G.6.3-1.5" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.3-1.6">Security considerations: See the Security Considerations in <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#appendix-G.6.3-1.6" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.3-1.7">Interoperability considerations: n/a<a href="#appendix-G.6.3-1.7" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.3-1.8">Published specification: <a href="#credential-issuer-signed-metadata" class="auto internal xref">Section 12.2.3</a> of this specification<a href="#appendix-G.6.3-1.8" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.3-1.9">Applications that use this media type: Applications that use signed metadata format defined in this specification<a href="#appendix-G.6.3-1.9" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.3-1.10">
              <p id="appendix-G.6.3-1.10.1">Additional information:<a href="#appendix-G.6.3-1.10.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-G.6.3-1.10.2.1">Magic number(s): n/a<a href="#appendix-G.6.3-1.10.2.1" class="pilcrow">¶</a>
</li>
                <li class="compact" id="appendix-G.6.3-1.10.2.2">File extension(s): n/a<a href="#appendix-G.6.3-1.10.2.2" class="pilcrow">¶</a>
</li>
                <li class="compact" id="appendix-G.6.3-1.10.2.3">Macintosh file type code(s): n/a<a href="#appendix-G.6.3-1.10.2.3" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="compact" id="appendix-G.6.3-1.11">Person &amp; email address to contact for further information: Torsten Lodderstedt, torsten@lodderstedt.net<a href="#appendix-G.6.3-1.11" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.3-1.12">Intended usage: COMMON<a href="#appendix-G.6.3-1.12" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.3-1.13">Restrictions on usage: none<a href="#appendix-G.6.3-1.13" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.3-1.14">Author: Torsten Lodderstedt, torsten@lodderstedt.net<a href="#appendix-G.6.3-1.14" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.3-1.15">Change controller: OpenID Foundation Digital Credentials Protocols Working Group - openid-specs-digital-credentials-protocols@lists.openid.net<a href="#appendix-G.6.3-1.15" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.6.3-1.16">Provisional registration? No<a href="#appendix-G.6.3-1.16" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="uniform-resource-identifier-uri-schemes-registry">
<section id="appendix-G.7">
        <h3 id="name-uniform-resource-identifier">
<a href="#appendix-G.7" class="section-number selfRef">G.7. </a><a href="#name-uniform-resource-identifier" class="section-name selfRef">Uniform Resource Identifier (URI) Schemes Registry</a>
        </h3>
<p id="appendix-G.7-1">This specification registers the following URI scheme
in the IANA "Uniform Resource Identifier (URI) Schemes" registry <span>[<a href="#IANA.URI.Schemes" class="cite xref">IANA.URI.Schemes</a>]</span>.<a href="#appendix-G.7-1" class="pilcrow">¶</a></p>
<div id="openid-credential-offer">
<section id="appendix-G.7.1">
          <h4 id="name-openid-credential-offer">
<a href="#appendix-G.7.1" class="section-number selfRef">G.7.1. </a><a href="#name-openid-credential-offer" class="section-name selfRef">openid-credential-offer</a>
          </h4>
<ul class="compact">
<li class="compact" id="appendix-G.7.1-1.1">URI Scheme: openid-credential-offer<a href="#appendix-G.7.1-1.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.7.1-1.2">Description: Custom scheme used for credential offers<a href="#appendix-G.7.1-1.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.7.1-1.3">Status: Permanent<a href="#appendix-G.7.1-1.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.7.1-1.4">Well-Known URI Support: -<a href="#appendix-G.7.1-1.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.7.1-1.5">Change Controller: OpenID Foundation Digital Credentials Protocols Working Group - openid-specs-digital-credentials-protocols@lists.openid.net<a href="#appendix-G.7.1-1.5" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.7.1-1.6">Reference: <a href="#client-metadata-retrieval" class="auto internal xref">Section 12.1.1</a> of this specification<a href="#appendix-G.7.1-1.6" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="use-cases">
<section id="appendix-H">
      <h2 id="name-use-cases">
<a href="#appendix-H" class="section-number selfRef">Appendix H. </a><a href="#name-use-cases" class="section-name selfRef">Use Cases</a>
      </h2>
<p id="appendix-H-1">This is a non-exhaustive list of sample use cases.<a href="#appendix-H-1" class="pilcrow">¶</a></p>
<div id="use-case-1">
<section id="appendix-H.1">
        <h3 id="name-credential-offer-same-devic">
<a href="#appendix-H.1" class="section-number selfRef">H.1. </a><a href="#name-credential-offer-same-devic" class="section-name selfRef">Credential Offer - Same-Device</a>
        </h3>
<p id="appendix-H.1-1">While browsing the university's home page, the End-User finds a link "request your digital diploma". The End-User clicks on this link and is redirected to a digital Wallet. The Wallet notifies the End-User that a Credential Issuer offered to issue a diploma Credential. The End-User confirms this inquiry and is taken to the university's Credential issuance service's End-User experience. Upon successful authentication at the university and consent to the issuance of a digital diploma, the End-User is redirected back to the Wallet. Here, the End-User can verify the successful creation of the digital diploma.<a href="#appendix-H.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-case-2">
<section id="appendix-H.2">
        <h3 id="name-credential-offer-cross-devi">
<a href="#appendix-H.2" class="section-number selfRef">H.2. </a><a href="#name-credential-offer-cross-devi" class="section-name selfRef">Credential Offer - Cross-Device (with Information Pre-Submitted by the End-User)</a>
        </h3>
<p id="appendix-H.2-1">The End-User is starting a job with a new employer. The employer requests the End-User to upload specific documents to the employee portal. After a few days, the End-User receives an email from the employer indicating that the employee Credential is ready to be claimed and provides instructions to scan a presented QR code for its retrieval. The End-User scans the QR code with a smartphone, which opens the Wallet. Meanwhile, the End-User has received a text message with a Transaction Code to the smartphone. After entering the Transaction Code in the Wallet for security reasons, the End-User approves the Credential issuance and receives the Credential in the Wallet.<a href="#appendix-H.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-case-3">
<section id="appendix-H.3">
        <h3 id="name-credential-offer-cross-devic">
<a href="#appendix-H.3" class="section-number selfRef">H.3. </a><a href="#name-credential-offer-cross-devic" class="section-name selfRef">Credential Offer - Cross-Device &amp; Deferred</a>
        </h3>
<p id="appendix-H.3-1">The End-User intends to acquire a digital criminal record. This involves a visit to the local administration's office to request the official criminal record be issued as a digital Credential. After presenting an ID document, the End-User is prompted to scan a QR code using the Wallet and is informed that the issuance of the Credential will require some time, due to necessary background checks by the authority.<a href="#appendix-H.3-1" class="pilcrow">¶</a></p>
<p id="appendix-H.3-2">While using the Wallet, the End-User notices an indication that the issuance of the digital record is in progress. After a few days, the End-User receives a notification from the Wallet indicating that the requested Credential was successfully issued. Upon opening the Wallet, the End-User is queried about the download of the Credential. After confirmation, the Wallet fetches and saves the new Credential.<a href="#appendix-H.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-case-4">
<section id="appendix-H.4">
        <h3 id="name-wallet-initiated-issuance-d">
<a href="#appendix-H.4" class="section-number selfRef">H.4. </a><a href="#name-wallet-initiated-issuance-d" class="section-name selfRef">Wallet-Initiated Issuance during Presentation</a>
        </h3>
<p id="appendix-H.4-1">An End-User comes across a Verifier app that is requesting the End-User to present a Credential, e.g., a driving license. The Wallet determines the requested Credential type(s) from the presentation request and notifies the End-User that there is currently no matching Credential in the Wallet. The Wallet selects a Credential Issuer capable of issuing the missing Credential and, upon End-User consent, sends the End-User to the Credential Issuer's End-User experience (website or app). Once authenticated and consent is provided for the issuance of the Credential into the Wallet, the End-User is redirected back to the Wallet. The Wallet informs the End-User that Credential was successfully issued into the Wallet and is ready to be presented to the Verifier app that originally requested presentation of that Credential.<a href="#appendix-H.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-case-5">
<section id="appendix-H.5">
        <h3 id="name-wallet-initiated-issuance-du">
<a href="#appendix-H.5" class="section-number selfRef">H.5. </a><a href="#name-wallet-initiated-issuance-du" class="section-name selfRef">Wallet-Initiated Issuance during Presentation (Requires Presentation of Additional Credentials During Issuance)</a>
        </h3>
<p id="appendix-H.5-1">An End-User comes across a Verifier app that is requesting the End-User to present a Credential, e.g., a university diploma. The Wallet determines the requested Credential type(s) from the presentation request and notifies the End-User that there is currently no matching Credential in the Wallet. The Wallet then offers the End-User a list of Credential Issuers, which might be based on a Credential Issuer list curated by the Wallet provider. The End-User selects the university of graduation and is subsequently redirected to the corresponding university's website or app.<a href="#appendix-H.5-1" class="pilcrow">¶</a></p>
<p id="appendix-H.5-2">The End-User logs into the university, which identifies that the corresponding End-User account is not yet verified. Among various identification options, the End-User opts to present a Credential from the Wallet. The End-User is redirected back to the Wallet to consent to present the requested Credential(s) to the university. Following this, the End-User is redirected back to the university End-User experience. Based on the presented Credential, the university finalizes the End-User verification, retrieves data about the End-User from its database, and proposes to issue a diploma as a Verifiable Credential.<a href="#appendix-H.5-2" class="pilcrow">¶</a></p>
<p id="appendix-H.5-3">Upon providing consent, the End-User is sent back to the Wallet. The Wallet informs the End-User that the Credential was successfully issued into the Wallet and is ready to be presented to the Verifier app that originally requested presentation of that Credential.<a href="#appendix-H.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-case-6">
<section id="appendix-H.6">
        <h3 id="name-wallet-initiated-issuance-a">
<a href="#appendix-H.6" class="section-number selfRef">H.6. </a><a href="#name-wallet-initiated-issuance-a" class="section-name selfRef">Wallet-Initiated Issuance after Installation</a>
        </h3>
<p id="appendix-H.6-1">The End-User installs a new Wallet and opens it. The Wallet offers the End-User a selection of Credentials that the End-User may obtain from a Credential Issuer, e.g., a national identity Credential, a mobile driving license, or a public transport ticket. The corresponding Credential Issuers (and their URLs) are pre-configured by the Wallet or follow some discovery processes that are out of scope for this specification. By clicking on one of these options corresponding to the Credentials available for issuance, the issuance process starts using a flow supported by the Credential Issuer (Pre-Authorized Code flow or Authorization Code flow).<a href="#appendix-H.6-1" class="pilcrow">¶</a></p>
<p id="appendix-H.6-2">Wallet Providers may also provide a market place where Issuers can register to be found for Wallet-initiated flows.<a href="#appendix-H.6-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="additional-examples">
<section id="appendix-I">
      <h2 id="name-additional-examples">
<a href="#appendix-I" class="section-number selfRef">Appendix I. </a><a href="#name-additional-examples" class="section-name selfRef">Additional Examples</a>
      </h2>
<div id="additional-issuer-metadata-examples">
<section id="appendix-I.1">
        <h3 id="name-credential-issuer-metadata-7">
<a href="#appendix-I.1" class="section-number selfRef">I.1. </a><a href="#name-credential-issuer-metadata-7" class="section-name selfRef">Credential Issuer Metadata</a>
        </h3>
<p id="appendix-I.1-1">This section contains additional examples for Credential issuer Metadata<a href="#appendix-I.1-1" class="pilcrow">¶</a></p>
<p id="appendix-I.1-2">The following is a non-normative example of Credential Issuer metadata of a Credential in the IETF SD-JWT VC <span>[<a href="#I-D.ietf-oauth-sd-jwt-vc" class="cite xref">I-D.ietf-oauth-sd-jwt-vc</a>]</span> format in signed form (JWT):<a href="#appendix-I.1-2" class="pilcrow">¶</a></p>
<div class="breakable lang-txt sourcecode" id="appendix-I.1-3">
<pre>eyJhbGciOiJFUzI1NiIsInR5cCI6Im9wZW5pZHZjaS1pc3N1ZXItbWV0YWRhdGErand0Ii
wieDVjIjpbIk1JSUI5RENDQVpxZ0F3SUJBZ0lVRkFIcFd2VjdOR1J4T05JSFQvQ0N3RUU5
QmE0d0NnWUlLb1pJemowRUF3SXdLREVtTUNRR0ExVUVBd3dkWTNKbFpHVnVkR2xoYkMxcG
MzTjFaWEl1WlhoaGJYQnNaUzVqYjIwd0lCY05NalV3TnpJeU1EZ3lPREEyV2hnUE1qQTFO
VEEzTVRVd09ESTRNRFphTUNneEpqQWtCZ05WQkFNTUhXTnlaV1JsYm5ScFlXd3RhWE56ZF
dWeUxtVjRZVzF3YkdVdVkyOXRNRmt3RXdZSEtvWkl6ajBDQVFZSUtvWkl6ajBEQVFjRFFn
QUVsSG50aWhHdTV2Q3RrWituMllhQ28rdW5ubndrd2xVUHBUc25PMk9TdnpvVHNYdGQxaz
E4WWhBUGhPTjYvbERXei9mN0FNcmRWN0xNZ0JZU3BwMndKS09CbnpDQm5EQWRCZ05WSFE0
RUZnUVVhTWo0bmEvUWpjdHA3V2dyR2xxam0zUFQxU2t3SHdZRFZSMGpCQmd3Rm9BVWFNaj
RuYS9RamN0cDdXZ3JHbHFqbTNQVDFTa3dEd1lEVlIwVEFRSC9CQVV3QXdFQi96QkpCZ05W
SFJFRVFqQkFnaDFqY21Wa1pXNTBhV0ZzTFdsemMzVmxjaTVsZUdGdGNHeGxMbU52YllJZk
tpNWpjbVZrWlc1MGFXRnNMV2x6YzNWbGNpNWxlR0Z0Y0d4bExtTnZiVEFLQmdncWhrak9Q
UVFEQWdOSUFEQkZBaUJMWjNuTGhMT1diR2hBTGNSUHhQTGlIdFV1bGRqRFQ0MUZrOTBUan
d5MEpRSWhBT3NtWXpTcHNGenBqTjBPV1R2UEV5dURrL05nUnVmSjNkRGFnOHNaSjZkTSJd
fQ.eyJzdWIiOiJodHRwczovL2NyZWRlbnRpYWwtaXNzdWVyLmV4YW1wbGUuY29tIiwiaWF
0IjoxNTE2MjM5MDIyLCJjcmVkZW50aWFsX2lzc3VlciI6Imh0dHBzOi8vY3JlZGVudGlhb
C1pc3N1ZXIuZXhhbXBsZS5jb20iLCJhdXRob3JpemF0aW9uX3NlcnZlcnMiOlsiaHR0cHM
6Ly9zZXJ2ZXIuZXhhbXBsZS5jb20iXSwiY3JlZGVudGlhbF9lbmRwb2ludCI6Imh0dHBzO
i8vY3JlZGVudGlhbC1pc3N1ZXIuZXhhbXBsZS5jb20vY3JlZGVudGlhbCIsImRlZmVycmV
kX2NyZWRlbnRpYWxfZW5kcG9pbnQiOiJodHRwczovL2NyZWRlbnRpYWwtaXNzdWVyLmV4Y
W1wbGUuY29tL2RlZmVycmVkX2NyZWRlbnRpYWwiLCJjcmVkZW50aWFsX3Jlc3BvbnNlX2V
uY3J5cHRpb24iOnsiYWxnX3ZhbHVlc19zdXBwb3J0ZWQiOlsiRUNESC1FUyJdLCJlbmNfd
mFsdWVzX3N1cHBvcnRlZCI6WyJBMTI4R0NNIl0sImVuY3J5cHRpb25fcmVxdWlyZWQiOmZ
hbHNlfSwiZGlzcGxheSI6W3sibmFtZSI6IkV4YW1wbGUgVW5pdmVyc2l0eSIsImxvY2FsZ
SI6ImVuLVVTIn0seyJuYW1lIjoiRXhhbXBsZSBVbml2ZXJzaXTDqSIsImxvY2FsZSI6ImZ
yLUZSIn1dLCJjcmVkZW50aWFsX2NvbmZpZ3VyYXRpb25zX3N1cHBvcnRlZCI6eyJTRF9KV
1RfVkNfZXhhbXBsZV9pbl9PcGVuSUQ0VkNJIjp7ImZvcm1hdCI6ImRjK3NkLWp3dCIsInN
jb3BlIjoiU0RfSldUX1ZDX2V4YW1wbGVfaW5fT3BlbklENFZDSSIsImNyeXB0b2dyYXBoa
WNfYmluZGluZ19tZXRob2RzX3N1cHBvcnRlZCI6WyJqd2siXSwiY3JlZGVudGlhbF9zaWd
uaW5nX2FsZ192YWx1ZXNfc3VwcG9ydGVkIjpbIkVTMjU2Il0sInByb29mX3R5cGVzX3N1c
HBvcnRlZCI6eyJqd3QiOnsicHJvb2Zfc2lnbmluZ19hbGdfdmFsdWVzX3N1cHBvcnRlZCI
6WyJFUzI1NiJdLCJrZXlfYXR0ZXN0YXRpb25zX3JlcXVpcmVkIjp7ImtleV9zdG9yYWdlI
jpbImlzb18xODA0NV9tb2RlcmF0ZSJdLCJ1c2VyX2F1dGhlbnRpY2F0aW9uIjpbImlzb18
xODA0NV9tb2RlcmF0ZSJdfX19LCJ2Y3QiOiJTRF9KV1RfVkNfZXhhbXBsZV9pbl9PcGVuS
UQ0VkNJIiwiY3JlZGVudGlhbF9tZXRhZGF0YSI6eyJkaXNwbGF5IjpbeyJuYW1lIjoiSWR
lbnRpdHlDcmVkZW50aWFsIiwibG9nbyI6eyJ1cmkiOiJodHRwczovL3VuaXZlcnNpdHkuZ
XhhbXBsZS5lZHUvcHVibGljL2xvZ28ucG5nIiwiYWx0X3RleHQiOiJhIHNxdWFyZSBsb2d
vIG9mIGEgdW5pdmVyc2l0eSJ9LCJsb2NhbGUiOiJlbi1VUyIsImJhY2tncm91bmRfY29sb
3IiOiIjMTIxMDdjIiwidGV4dF9jb2xvciI6IiNGRkZGRkYifV0sImNsYWltcyI6W3sicGF
0aCI6WyJnaXZlbl9uYW1lIl0sImRpc3BsYXkiOlt7Im5hbWUiOiJHaXZlbiBOYW1lIiwib
G9jYWxlIjoiZW4tVVMifSx7Im5hbWUiOiJWb3JuYW1lIiwibG9jYWxlIjoiZGUtREUifV1
9LHsicGF0aCI6WyJmYW1pbHlfbmFtZSJdLCJkaXNwbGF5IjpbeyJuYW1lIjoiU3VybmFtZ
SIsImxvY2FsZSI6ImVuLVVTIn0seyJuYW1lIjoiTmFjaG5hbWUiLCJsb2NhbGUiOiJkZS1
ERSJ9XX0seyJwYXRoIjpbImVtYWlsIl19LHsicGF0aCI6WyJwaG9uZV9udW1iZXIiXX0se
yJwYXRoIjpbImFkZHJlc3MiXSwiZGlzcGxheSI6W3sibmFtZSI6IlBsYWNlIG9mIHJlc2l
kZW5jZSIsImxvY2FsZSI6ImVuLVVTIn0seyJuYW1lIjoiV29obnNpdHoiLCJsb2NhbGUiO
iJkZS1ERSJ9XX0seyJwYXRoIjpbImFkZHJlc3MiLCJzdHJlZXRfYWRkcmVzcyJdfSx7InB
hdGgiOlsiYWRkcmVzcyIsImxvY2FsaXR5Il19LHsicGF0aCI6WyJhZGRyZXNzIiwicmVna
W9uIl19LHsicGF0aCI6WyJhZGRyZXNzIiwiY291bnRyeSJdfSx7InBhdGgiOlsiYmlydGh
kYXRlIl19LHsicGF0aCI6WyJpc19vdmVyXzE4Il19LHsicGF0aCI6WyJpc19vdmVyXzIxI
l19LHsicGF0aCI6WyJpc19vdmVyXzY1Il19XX19fX0.KkM97TGKU9yTAPnbTfSPVFT3Ryw
X9_5QPEtNwMhiu8V_UPBGMYA2mkVc-VxGTm9vdeV482-TWnVfbub_kzS9Eg
</pre><a href="#appendix-I.1-3" class="pilcrow">¶</a>
</div>
<p id="appendix-I.1-4">The following is a non-normative example of Credential Issuer metadata of a Credential in the IETF SD-JWT VC <span>[<a href="#I-D.ietf-oauth-sd-jwt-vc" class="cite xref">I-D.ietf-oauth-sd-jwt-vc</a>]</span> format with optional parameters present:<a href="#appendix-I.1-4" class="pilcrow">¶</a></p>
<div class="breakable lang-json sourcecode" id="appendix-I.1-5">
<pre>{
  "credential_issuer": "https://credential-issuer.example.com",
  "authorization_servers": [
    "https://server.example.com"
  ],
  "credential_endpoint": "https://credential-issuer.example.com/credential",
  "nonce_endpoint": "https://credential-issuer.example.com/nonce",
  "deferred_credential_endpoint": "https://credential-issuer.example.com/deferred_credential",
  "notification_endpoint": "https://credential-issuer.example.com/notification",
  "credential_request_encryption": {
    "jwks": [
      {
        "kty":"EC", "kid":"ac", "use":"enc", "crv":"P-256", "alg":"ECDH-ES",
        "x":"YO4epjifD-KWeq1sL2tNmm36BhXnkJ0He-WqMYrp9Fk",
        "y":"Hekpm0zfK7C-YccH5iBjcIXgf6YdUvNUac_0At55Okk"
      }
    ],
    "enc_values_supported": ["A128GCM"],
    "zip_values_supported": ["DEF"],
    "encryption_required": true
  },
  "credential_response_encryption": {
    "alg_values_supported": ["ECDH-ES"],
    "enc_values_supported": ["A128GCM"],
    "zip_values_supported": ["DEF"],
    "encryption_required": true
  },
  "batch_credential_issuance": {
    "batch_size": 10
  },
  "display": [
    {
      "name": "Example University",
      "locale": "en-US",
      "logo": {
        "uri": "https://university.example.edu/public/logo.png",
        "alt_text":"a square logo of a university"
      }
    },
    {
      "name": "Example Université",
      "locale": "fr-FR",
      "logo": {
        "uri": "https://university.example.edu/public/logo.png",
        "alt_text":"Un logo universitaire carré"
      }
    }
  ],
  "credential_configurations_supported": {
    "SD_JWT_VC_example_in_OpenID4VCI": {
      "format": "dc+sd-jwt",
      "scope": "SD_JWT_VC_example_in_OpenID4VCI",
      "credential_signing_alg_values_supported": ["ES256"],
      "cryptographic_binding_methods_supported": ["jwk"],
      "proof_types_supported": {
        "jwt": {
          "proof_signing_alg_values_supported": ["ES256"],
          "key_attestations_required": {
            "key_storage": ["iso_18045_moderate"],
            "user_authentication": ["iso_18045_moderate"]
          }
        }
      },
      "vct": "SD_JWT_VC_example_in_OpenID4VCI",
      "credential_metadata": {
        "display": [
          {
            "name": "IdentityCredential",
            "locale": "en-US",
            "logo": {
              "uri": "https://university.example.edu/public/logo_credential.png",
              "alt_text": "a square logo of a university credential"
            },
            "description": "A credential that signals the membership of a university",
            "background_color": "#12107c",
            "text_color": "#FFFFFF"
          }
        ],
        "claims": [
          {
            "path": ["given_name"],
            "display": [
              {
                "name": "Given Name",
                "locale": "en-US"
              },
              {
                "name": "Vorname",
                "locale": "de-DE"
              }
            ]
          },
          {
            "path": ["family_name"],
            "display": [
              {
                "name": "Surname",
                "locale": "en-US"
              },
              {
                "name": "Nachname",
                "locale": "de-DE"
              }
            ]
          },
          {"path": ["email"]},
          {"path": ["phone_number"]},
          {
            "path": ["address"],
            "display": [
              {
                "name": "Place of residence",
                "locale": "en-US"
              },
              {
                "name": "Wohnsitz",
                "locale": "de-DE"
              }
            ]
          },
          {"path": ["address", "street_address"]},
          {"path": ["address", "locality"]},
          {"path": ["address", "region"]},
          {"path": ["address", "country"]},
          {"path": ["birthdate"]},
          {"path": ["is_over_18"]},
          {"path": ["is_over_21"]},
          {"path": ["is_over_65"]}
        ]
      }
    }
  }
}
</pre><a href="#appendix-I.1-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="wallet-attestation-example">
<section id="appendix-I.2">
        <h3 id="name-wallet-attestation-jwt">
<a href="#appendix-I.2" class="section-number selfRef">I.2. </a><a href="#name-wallet-attestation-jwt" class="section-name selfRef">Wallet Attestation JWT</a>
        </h3>
<p id="appendix-I.2-1">The following is a non-normative example of a signed Wallet Attestation:<a href="#appendix-I.2-1" class="pilcrow">¶</a></p>
<div class="lang-txt sourcecode" id="appendix-I.2-2">
<pre>eyJ0eXAiOiJvYXV0aC1jbGllbnQtYXR0ZXN0YXRpb24rand0IiwiYWxnIjoiRVMyNTYiLC
J4NWMiOlsiTUlJQnl6Q0NBWEdnQXdJQkFnSVVKblorYXY3a0ZSYUNyS2xOaTRSU2dSTWxN
emN3Q2dZSUtvWkl6ajBFQXdJd0pqRWtNQ0lHQTFVRUF3d2JkMkZzYkdWMExYQnliM1pwWk
dWeUxtVjRZVzF3YkdVdVkyOXRNQ0FYRFRJMU1EZ3hNakU0TXpFek4xb1lEekl3TlRVd09E
QTFNVGd6TVRNM1dqQW1NU1F3SWdZRFZRUUREQnQzWVd4c1pYUXRjSEp2ZG1sa1pYSXVaWG
hoYlhCc1pTNWpiMjB3V1RBVEJnY3Foa2pPUFFJQkJnZ3Foa2pPUFFNQkJ3TkNBQVFKREZp
WGZ0THp2bVFmVnduQytGVFVKSFlMZ0pWTVlQbXM3ZWlGYytEQ0EreFUxVTgzSms4WEtyMH
FrRGxzYlcxU3JVRXB0V0pvSmx0NU43S1dhdGl1bzNzd2VUQWRCZ05WSFE0RUZnUVVMNStl
WnVrY3kvTFFVN2VYdnN6V0tHVEEraWt3SHdZRFZSMGpCQmd3Rm9BVUw1K2VadWtjeS9MUV
U3ZVh2c3pXS0dUQStpa3dEd1lEVlIwVEFRSC9CQVV3QXdFQi96QW1CZ05WSFJFRUh6QWRn
aHQzWVd4c1pYUXRjSEp2ZG1sa1pYSXVaWGhoYlhCc1pTNWpiMjB3Q2dZSUtvWkl6ajBFQX
dJRFNBQXdSUUlnZkVVdkFWMzhSUDdCU1JDSllLK0UvTWVSU291amlmRTZBT2Z1aGVKVVZG
OENJUURiZDduMytoRU5Rd2kyanY1SHhWUnoxSHJxSkhSOWlYUnNzSjJPSnhObHF3PT0iXX
0.eyJpc3MiOiJodHRwczovL3dhbGxldC1wcm92aWRlci5leGFtcGxlLmNvbSIsInN1YiI6
Imh0dHBzOi8vd2FsbGV0LmV4YW1wbGUuY29tIiwid2FsbGV0X25hbWUiOiJXYWxsZXQgU2
9sdXRpb24gWCBieSBXb25kZXJsYW5kIFN0YXRlIERlcGFydG1lbnQiLCJ3YWxsZXRfbGlu
ayI6Imh0dHBzOi8vZXhhbXBsZS5jb20vd2FsbGV0L2RldGFpbF9pbmZvLmh0bWwiLCJuYm
YiOjE3NTUwMjM1NDcsImV4cCI6MTc1NTEwMjc0NSwiY25mIjp7Imp3ayI6eyJrdHkiOiJF
QyIsInVzZSI6InNpZyIsImNydiI6IlAtMjU2IiwieCI6IjE4d0hMZUlnVzl3Vk42VkQxVH
hncHF5MkxzellrTWY2SjhualZBaWJ2aE0iLCJ5IjoiLVY0ZFM0VWFMTWdQXzRmWTRqOGly
N2NsMVRYbEZkQWdjeDU1bzdUa2NTQSJ9fX0.3rasFv7xis_VxGjm6xbyb7wjPuaEaCi0-Z
_8PzutOVTBVoPEq7dDzZT-I5gJlQrS0HY6gU_Z30bOnwhkYJQW9g
</pre><a href="#appendix-I.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="Acknowledgements">
<section id="appendix-J">
      <h2 id="name-acknowledgements">
<a href="#appendix-J" class="section-number selfRef">Appendix J. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-J-1">We would like to thank Patrick Amrein, Masayoshi Arakawa, Richard Barnes, Paul Bastian, Vittorio Bertocci, Christian Bormann, John Bradley, Brian Campbell, Lee Campbell, Tim Cappalli, Lenah Chacha, David Chadwick, Stefan Charsley, Gabe Cohen, Thomas Darimont, Andrii Deinega, Giuseppe De Marco, Rajvardhan Deshmukh, Mark Dobrinic, Daniel Fett, Pedro Felix, George Fletcher, Christian Fries, Timo Glasta, Mark Haine, Martijn Haring, Fabian Hauck, Roland Hedberg, Joseph Heenan, Bjorn Hjelm, Alen Horvat, Andrew Hughes, Jacob Ideskog, Lukasz Jaromin, Edmund Jay, Michael B. Jones, Tom Jones, Judith Kahrer, Micha Kraus, Takahiko Kawasaki, Niels Klomp, Ronald Koenig, Micha Kraus, Markus Kreusch, Philipp Lehwalder, Adam Lemmon, Dave Longley, Hicham Lozi, David Luna, Daniel McGrogan, Jeremie Miller, Mirko Mollik, Kenichi Nakamura, Andres Olave, Gareth Oliver, Nemanja Patrnogic, Dima Postnikov, Rolson Quadras, Helen Quinn, Sami Rosendahl, Babis Routis, Nat Sakimura, Sudesh Shetty, Peter Sorotokin, Oliver Terbu, Dimitri James Tsiflitzis, Mike Varley, Niels van Dijk, Arjen van Veen, Jan Vereecken, David Waite, Jacob Ward, David Zeuthen for their valuable feedback and contributions to this specification.<a href="#appendix-J-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="notices">
<section id="appendix-K">
      <h2 id="name-notices">
<a href="#appendix-K" class="section-number selfRef">Appendix K. </a><a href="#name-notices" class="section-name selfRef">Notices</a>
      </h2>
<p id="appendix-K-1">Copyright (c) 2025 The OpenID Foundation.<a href="#appendix-K-1" class="pilcrow">¶</a></p>
<p id="appendix-K-2">The OpenID Foundation (OIDF) grants to any Contributor, developer, implementer, or other interested party a non-exclusive, royalty free, worldwide copyright license to reproduce, prepare derivative works from, distribute, perform and display, this Implementers Draft, Final Specification, or Final Specification Incorporating Errata Corrections solely for the purposes of (i) developing specifications, and (ii) implementing Implementers Drafts, Final Specifications, and Final Specification Incorporating Errata Corrections based on such documents, provided that attribution be made to the OIDF as the source of the material, but that such attribution does not indicate an endorsement by the OIDF.<a href="#appendix-K-2" class="pilcrow">¶</a></p>
<p id="appendix-K-3">The technology described in this specification was made available from contributions from various sources, including members of the OpenID Foundation and others. Although the OpenID Foundation has taken steps to help ensure that the technology is available for distribution, it takes no position regarding the validity or scope of any intellectual property or other rights that might be claimed to pertain to the implementation or use of the technology described in this specification or the extent to which any license under such rights might or might not be available; neither does it represent that it has made any independent effort to identify any such rights. The OpenID Foundation and the contributors to this specification make no (and hereby expressly disclaim any) warranties (express, implied, or otherwise), including implied warranties of merchantability, non-infringement, fitness for a particular purpose, or title, related to this specification, and the entire risk as to implementing this specification is assumed by the implementer. The OpenID Intellectual Property Rights policy (found at openid.net) requires contributors to offer a patent promise not to assert certain patent claims against other contributors and against implementers. OpenID invites any interested party to bring to its attention any copyrights, patents, patent applications, or other proprietary rights that may cover technology that may be required to practice this specification.<a href="#appendix-K-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-L">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Torsten Lodderstedt</span></div>
<div dir="auto" class="left"><span class="org">SPRIND</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:torsten@lodderstedt.net" class="email">torsten@lodderstedt.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Kristina Yasuda</span></div>
<div dir="auto" class="left"><span class="org">SPRIND</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kristina.yasuda@sprind.org" class="email">kristina.yasuda@sprind.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tobias Looker</span></div>
<div dir="auto" class="left"><span class="org">Mattr</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tobias.looker@mattr.global" class="email">tobias.looker@mattr.global</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>

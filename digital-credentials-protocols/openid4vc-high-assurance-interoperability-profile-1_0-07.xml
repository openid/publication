<?xml version="1.0" encoding="utf-8"?>
<!-- name="GENERATOR" content="github.com/mmarkdown/mmark Mmark Markdown Processor - mmark.miek.nl" -->
<rfc version="3" ipr="none" docName="openid4vc-high-assurance-interoperability-profile-1_0-07" submissionType="IETF" category="std" xml:lang="en" xmlns:xi="http://www.w3.org/2001/XInclude" indexInclude="true" consensus="true">

<front>
<title abbrev="openid4vc-high-assurance-interoperability-profile">OpenID4VC High Assurance Interoperability Profile 1.0</title><seriesInfo value="openid4vc-high-assurance-interoperability-profile-1_0-07" status="standard" name="Internet-Draft"></seriesInfo>
<author initials="K." surname="Yasuda" fullname="Kristina Yasuda"><organization>SPRIND</organization><address><postal><street></street>
</postal><email>kristina.yasuda@sprind.org</email>
</address></author><author initials="T." surname="Lodderstedt" fullname="Torsten Lodderstedt"><organization>SPRIND</organization><address><postal><street></street>
</postal><email>torsten@lodderstedt.net</email>
</address></author><author initials="C." surname="Bormann" fullname="Christian Bormann"><organization>SPRIND</organization><address><postal><street></street>
</postal><email>chris.bormann@gmx.de</email>
</address></author><author initials="J." surname="Heenan" fullname="Joseph Heenan"><organization>Authlete</organization><address><postal><street></street>
</postal><email>joseph@heenan.me.uk</email>
</address></author><date/>
<area>Internet</area>
<workgroup>Digital Credentials Protocols</workgroup>
<keyword>security</keyword>
<keyword>openid4vc</keyword>
<keyword>sd-jwt</keyword>
<keyword>sd-jwt-vc</keyword>
<keyword>mdoc</keyword>

<abstract>
<t>This specification defines a profile of OpenID for Verifiable Credentials in combination with the credential formats IETF SD-JWT VC <xref target="I-D.ietf-oauth-sd-jwt-vc"></xref> and ISO mdoc <xref target="ISO.18013-5"></xref>. The aim is to select features and to define a set of requirements for the existing specifications to enable interoperability among Issuers, Wallets, and Verifiers of Credentials where a high level of security and privacy is required. The profiled specifications include OpenID for Verifiable Credential Issuance <xref target="OIDF.OID4VCI"></xref>, OpenID for Verifiable Presentations <xref target="OIDF.OID4VP"></xref>, IETF SD-JWT VC <xref target="I-D.ietf-oauth-sd-jwt-vc"></xref>, and ISO mdoc <xref target="ISO.18013-5"></xref>.</t>
</abstract>

</front>

<middle>

<section anchor="introduction"><name>Introduction</name>
<t>This specification defines a set of requirements for the existing specifications to enable interoperability among Issuers, Wallets, and Verifiers of Credentials where a high level of security and privacy is required. This specification is an interoperability profile that can be used by implementations in various contexts, be it a certain industry or a certain regulatory environment. Note that while this specification is aimed at high assurance use-cases, it can also be used for lower assurance use-cases.</t>
<t>This specification aims to achieve a level of security and privacy that includes the following properties:</t>

<ul spacing="compact">
<li>Authenticity of claims: There is strong assurance that the claims within a Credential or Presentation are valid and bound to the correct Holder. This involves the policies and procedures used to collect and maintain the claims, the authentication of the Holder during issuance, and the protection of claim authenticity both at rest (in the wallet) and during presentation. The scope for this specification is: security of the issuance process, protection of issued credentials, and mechanisms for the Verifiers to access trustworthy information about the Issuer.</li>
<li>Holder authentication: There is strong assurance that the Credential is presented by its legitimate Holder in a given transaction. This involves proof of Holder binding, which can be validated through several methods. The scope for this specification includes secure presentation of key-bound credentials and supporting Claim-based Binding when built on top of this functionality.</li>
</ul>
<t>Note: This specification defines the technical means by which holder authentication can be proven and claim authenticity can be protected using certain protocol and credential format features. Out of scope are concrete holder authentication mechanisms (which ensure only the holder can sign the presentation) and policies and procedures (as this is a technical interoperability profile and not a policy definition).</t>
<t>Note: This specification fulfils some, but not all, of the requirements to meet the &quot;High&quot; Level of Assurance (LoA) as defined in the eIDAS Regulation <xref target="eIDAS2.0"></xref>. While this specification defines features intended for scenarios targeting a high level of security, these features must be combined with additional measures outside of the scope of HAIP to achieve LoA High compliance.</t>
<t>This specification contains profiles of other specifications. It refers to the specifications required for implementations to interoperate among each other and for the optionalities mentioned in the referenced specifications, defines the set of features to be mandatory to implement.</t>
<t>The specification uses OpenID for Verifiable Credential Issuance <xref target="OIDF.OID4VCI"></xref> and OpenID for Verifiable Presentations <xref target="OIDF.OID4VP"></xref> as the base protocols for issuance and presentation of Credentials, respectively. The credential formats used are IETF SD-JWT VC as specified in <xref target="I-D.ietf-oauth-sd-jwt-vc"></xref> and ISO mdoc <xref target="ISO.18013-5"></xref>. Credentials in both IETF SD-JWT VC <xref target="I-D.ietf-oauth-sd-jwt-vc"></xref> and ISO mdoc <xref target="ISO.18013-5"></xref> formats can be issued following a single interaction with the Authorization Server.</t>
<t>A full list of the open standards used in this specification can be found in <xref target="standards-requirements"></xref>.</t>

<section anchor="target-audience-usage"><name>Target Audience/Usage</name>
<t>The target audience of this specification is implementers who require a high level of security and privacy for their solutions. A non-exhaustive list of the interested parties includes anyone implementing <eref target="https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=OJ:L_202401183">eIDAS 2.0</eref>, <eref target="https://www.dmv.ca.gov/portal/">California Department of Motor Vehicles</eref>, <eref target="https://openwallet.foundation/">Open Wallet Foundation (OWF)</eref>, <eref target="https://idunion.org/?lang=en">IDunion</eref>, <eref target="https://gainforum.org/">GAIN</eref>, and <eref target="https://trustedweb.go.jp/en">the Trusted Web project of the Japanese government</eref>, but is expected to grow to include other jurisdictions and private sector companies.</t>
</section>

<section anchor="errata-revisions"><name>Errata Revisions</name>
<t>The latest revision of this specification, incorporating any errata updates, is published at <eref target="https://openid.net/specs/openid4vc-high-assurance-interoperability-profile-1_0.html">openid4vc-high-assurance-interoperability-profile-1_0</eref>. The text of the final specification as approved will always be available at <eref target="https://openid.net/specs/openid4vc-high-assurance-interoperability-profile-1_0-final.html">openid4vc-high-assurance-interoperability-profile-1_0-final</eref>. When referring to this specification from other documents, it is recommended to reference <eref target="https://openid.net/specs/openid4vc-high-assurance-interoperability-profile-1_0.html">openid4vc-high-assurance-interoperability-profile-1_0</eref>.</t>
</section>

<section anchor="requirements-notation-and-conventions"><name>Requirements Notation and Conventions</name>
<t>The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;, &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;NOT RECOMMENDED&quot;, &quot;MAY&quot;, and &quot;OPTIONAL&quot; in this document are to be interpreted as described in BCP 14 <xref target="RFC2119"></xref> <xref target="RFC8174"></xref> when, and only when, they appear in all capitals, as shown here.</t>
</section>
</section>

<section anchor="terminology"><name>Terminology</name>
<t>This specification uses the terms &quot;Holder&quot;, &quot;Issuer&quot;, &quot;Verifier&quot;, &quot;Wallet&quot;, &quot;Wallet Attestation&quot;, &quot;Credential Type&quot; and &quot;Verifiable Credential&quot; as defined in <xref target="OIDF.OID4VCI"></xref> and <xref target="OIDF.OID4VP"></xref>.</t>
<t>This specification also defines the following term. In the case where a term has a definition that differs, the definition below is authoritative.</t>

<dl spacing="compact">
<dt>Ecosystem:</dt>
<dd>A group of Issuers, Wallets and Verifiers that have a common set of rules by which they operate. The rules may be determined, for example, by a regulation, law or domain/sector.</dd>
</dl>
</section>

<section anchor="scope"><name>Scope</name>
<t>This specification enables interoperable implementations of the following flows:</t>

<ul spacing="compact">
<li>Issuance of Credentials using OpenID for Verifiable Credential Issuance</li>
<li>Presentation of Credentials using OpenID for Verifiable Presentations with redirects</li>
<li>Presentation of Credentials using OpenID for Verifiable Presentations with the W3C Digital Credentials API</li>
</ul>
<t>Implementations of this specification do not have to implement all the flows listed above, but they MUST be compliant to all the requirements for a flow they choose to implement, as well as the requirements in the non-flow specific sections.</t>
<t>For each flow, at least one of the Credential profiles defined in <xref target="vc-profiles"></xref> MUST be supported:</t>

<ul spacing="compact">
<li>IETF SD-JWT VC</li>
<li>ISO mdocs</li>
</ul>
<t>A parameter listed as optional to be implemented in a specification that is being profiled (e.g., OpenID4VCI, OpenID4VP, W3C Digital Credentials API, IETF SD-JWT VC, and ISO mdoc) remains optional unless stated otherwise in this specification.</t>
<t>The Profile of OpenID4VCI defines Wallet Attestation and Key Attestation.</t>
<t>The Profile of IETF SD-JWT VC defines the following aspects:</t>

<ul spacing="compact">
<li>Status management of the Credentials, including revocation</li>
<li>Cryptographic Key Binding</li>
<li>Issuer key resolution</li>
<li>Issuer identification (as prerequisite for trust management)</li>
</ul>
<t>Note that when OpenID4VP is used, the Wallet and the Verifier can either be remote or in-person.</t>

<section anchor="assumptions"><name>Assumptions</name>
<t>Assumptions made are the following:</t>

<ul spacing="compact">
<li>The Issuer uses the Wallet features defined in this specification (via Wallet invocation mechanism)</li>
<li>There are mechanisms in place for Verifiers to discover Wallets' and Issuers' capabilities</li>
<li>There are mechanisms in place for Wallets to discover Verifiers' capabilities</li>
<li>There are mechanisms in place for Issuers to discover Wallets' capabilities</li>
</ul>
</section>

<section anchor="additional-scenarios"><name>Additional scenarios</name>
<t>Below is a non-exhaustive list of scenarios that can be realized with this specification:</t>

<ul spacing="compact">
<li>Combined Issuance of IETF SD-JWT VC and ISO mdoc</li>
<li>Both issuer-initiated and wallet-initiated issuance</li>
<li>Issuance and presentation of Credentials with and without cryptographic holder binding</li>
</ul>
</section>

<section anchor="standards-requirements"><name>Standards Requirements</name>
<t>The standards that are being profiled in this specification are:</t>

<ul spacing="compact">
<li>OpenID for Verifiable Credential Issuance <xref target="OIDF.OID4VCI"></xref></li>
<li>OpenID for Verifiable Presentations <xref target="OIDF.OID4VP"></xref></li>
<li>W3C Digital Credentials API <xref target="w3c.digital_credentials_api"></xref></li>
<li>SD-JWT-based Verifiable Credentials (SD-JWT VC) <xref target="I-D.ietf-oauth-sd-jwt-vc"></xref></li>
<li>ISO/IEC 18013-5:2021 Personal identification — ISO-compliant driving licence Part 5: Mobile driving licence (mDL) application <xref target="ISO.18013-5"></xref></li>
</ul>
<t>Note that these standards in turn build upon other underlying standards, and requirements in those underlying standards also need to be followed.</t>
</section>

<section anchor="out-of-scope"><name>Out of Scope</name>
<t>The following items are out of scope for the current version of this specification, but might be added in future versions:</t>

<ul spacing="compact">
<li>Trust Management refers to authorization of an Issuer to issue certain types of credentials, authorization of the Wallet to be issued certain types of credentials, authorization of the Verifier to receive certain types of credentials. Although X.509 PKI is extensively utilized in this specification, the methods for establishing trust or obtaining root certificates are out of the scope of this specification.</li>
<li>Protocol for presentation of Verifiable Credentials for offline use-cases, e.g. over BLE.</li>
</ul>
</section>
</section>

<section anchor="openid-for-verifiable-credential-issuance"><name>OpenID for Verifiable Credential Issuance</name>
<t>When implementing OpenID for Verifiable Credential Issuance, both the Wallet and the Credential Issuer:</t>

<ul spacing="compact">
<li>MUST support the authorization code flow.</li>
<li>MUST support at least one of the following Credential Format Profiles defined in <xref target="vc-profiles"></xref>: IETF SD-JWT VC or ISO mdoc. Ecosystems SHOULD clearly indicate which of these formats, IETF SD-JWT VC, ISO mdoc, or both, are required to be supported.</li>
<li>MUST comply with the provisions of <xref target="FAPI2_Security_Profile"></xref> that are applicable to this specification. This includes, but is not limited to using PKCE <xref target="RFC7636"></xref> with <tt>S256</tt> as the code challenge method, Pushed Authorization Requests (PAR) <xref target="RFC9126"></xref> (where applicable) and the <tt>iss</tt> value in the Authorization response <xref target="RFC9207"></xref>.</li>
</ul>
<t>The following aspects of <xref target="FAPI2_Security_Profile"></xref> are further profiled:</t>

<ul spacing="compact">
<li>Sender-constrained access token: MUST support DPoP as defined in <xref target="RFC9449"></xref>. Note that this requires Wallets to be prepared to handle the <tt>DPoP-Nonce</tt> HTTP response header from the Credential Issuer’s Nonce Endpoint, as well as from other applicable endpoints of the Credential Issuer and Authorization Server.</li>
</ul>
<t>The following aspects of <xref target="FAPI2_Security_Profile"></xref> do not apply to this specification:</t>

<ul spacing="compact">
<li>Client authentication: Wallet Attestation as defined in <xref target="wallet-attestation"></xref> can be used.</li>
<li>Pushed Authorization Requests (PAR): Only required when using the Authorization Endpoint as defined in Section 5 of <xref target="OIDF.OID4VCI"></xref>.</li>
<li>Cryptography and secrets: <xref target="crypto-suites"></xref> overrides the requirements in Section 5.4.1 clause 1.</li>
</ul>
<t>Note that some optional parts of <xref target="FAPI2_Security_Profile"></xref> are not applicable when using only OpenID for Verifiable Credential Issuance, e.g., MTLS or OpenID Connect.</t>
<t>Ecosystems SHOULD clearly indicate whether the Wallets and the Issuers need to support Issuer-initiated, Wallet-initiated Issuance or both, including how to send Credential Offer. If Issuer-initiated flows are supported, they MUST use the Credential Offer as defined in Section 4.1 of <xref target="OIDF.OID4VCI"></xref>.</t>
<t>Note that Ecosystems that aim for a stronger separation between the different Issuers and Wallets are expected to prefer the Issuer-initiated issuance flows and those with stronger integration into wallets (more wallet-centric Ecosystems) will likely prefer the Wallet-initiated Issuance.</t>
<t>If batch issuance is supported, the Wallet SHOULD use it rather than making consecutive requests for a single Credential of the same Credential Dataset. The Issuer MUST indicate whether batch issuance is supported by including or omitting the <tt>batch_credential_issuance</tt> metadata parameter. The Issuer’s decision may be influenced by various factors, including, but not limited to, trust framework requirements, regulatory constraints, applicable laws or internal policies.</t>
<t>Additional requirements for OpenID4VCI are defined in <xref target="crypto-suites"></xref> and <xref target="hash-algorithms"></xref>.</t>

<section anchor="issuer-metadata"><name>Issuer Metadata</name>
<t>The Authorization Server MUST support metadata according to <xref target="RFC8414"></xref>.</t>
<t>The Credential Issuer MUST support metadata retrieval according to Section 12.2.2 of <xref target="OIDF.OID4VCI"></xref>.
The Credential Issuer metadata MUST include a scope for every Credential Configuration it supports.</t>
<t>When Ecosystem policies require Issuer Authentication to a higher level than possible with TLS alone, signed Credential Issuer Metadata as specified in Section 11.2.3 in <xref target="OIDF.OID4VCI"></xref>
MUST be supported by both the Wallet and the Issuer. Key resolution to validate the signed Issuer
Metadata MUST be supported using the <tt>x5c</tt> JOSE header parameter as defined in <xref target="RFC7515"></xref>. In this case, the X.509 certificate of the trust anchor MUST NOT be included in the <tt>x5c</tt> JOSE header of the signed request. The X.509 certificate signing the request MUST NOT be self-signed.</t>
<t>Wallets that render images provided by the Credential Issuer in its metadata defined in Section 12.2.4 of <xref target="OIDF.OID4VCI"></xref> (e.g., the logo of a specific credential) have certain requirements. Such wallets MUST support both the SVG and PNG formats. They also MUST support images conveyed through both data URIs and HTTPS URLs.</t>
<t>If the Issuer supports Credential Configurations that require key binding, as indicated by the presence of <tt>cryptographic_binding_methods_supported</tt>, the <tt>nonce_endpoint</tt> MUST be present in the Credential Issuer Metadata.</t>
</section>

<section anchor="credential-offer"><name>Credential Offer</name>

<ul spacing="compact">
<li>The Grant Type <tt>authorization_code</tt> MUST be supported as defined in Section 4.1.1 in <xref target="OIDF.OID4VCI"></xref></li>
<li>For Grant Type <tt>authorization_code</tt>, the Issuer MUST include a scope value in order to allow the Wallet to identify the desired Credential Type. The Wallet MUST use that value in the <tt>scope</tt> Authorization parameter.</li>
<li>As a way to invoke the Wallet the custom URL scheme <tt>haip-vci://</tt> MAY be supported. Implementations MAY support other ways to invoke Wallets as agreed upon by trust frameworks/Ecosystems/jurisdictions, including but not limited to using other custom URL schemes or claimed &quot;https&quot; scheme URIs.</li>
</ul>
<t>Note: The Authorization Code flow does not require a Credential Offer from the Issuer to the Wallet. However, it is included in the feature set to allow for Issuer initiated Credential issuance.</t>
<t>Both Issuer and Wallet MUST support Credential Offer in both same-device and cross-device flows.</t>
</section>

<section anchor="authorization-endpoint"><name>Authorization Endpoint</name>

<ul spacing="compact">
<li>Wallets MUST authenticate themselves at the PAR endpoint using the same rules as defined in <xref target="token-endpoint"></xref> for client authentication at the token endpoint.</li>
<li>MUST use the <tt>scope</tt> parameter to communicate Credential Type(s) to be issued. The scope value MUST map to a specific Credential Type. The scope value may be pre-agreed, obtained from the Credential Offer, or the Credential Issuer Metadata.</li>
</ul>
</section>

<section anchor="token-endpoint"><name>Token Endpoint</name>

<ul spacing="compact">
<li>Refresh tokens are RECOMMENDED to be supported for Credential refresh. For details, see Section 13.5 in <xref target="OIDF.OID4VCI"></xref>.</li>
</ul>
<t>Note: Issuers SHOULD consider how long a refresh token is allowed to be used to refresh a credential, as opposed to starting the issuance flow from the beginning. For example, if the User is trying to refresh a Credential more than a year after its original issuance, the usage of the refresh tokens is NOT RECOMMENDED.</t>

<section anchor="wallet-attestation"><name>Wallet Attestation</name>
<t>Wallets MUST use, and Issuers MUST require, an OAuth2 Client authentication mechanism at OAuth2 Endpoints that support client authentication (such as the PAR and Token Endpoints).</t>
<t>Ecosystems that desire wallet-issuer interoperability on the level of Wallet Attestations SHOULD require Wallets to support the authentication mechanism and Wallet Attestation format specified in Appendix E of <xref target="OIDF.OID4VCI"></xref>. When doing so, they might need to define additional Ecosystem-specific claims contained in the attestation. Alternatively, Ecosystems MAY choose to rely on other Wallet Attestation formats.</t>
<t>Additional rules apply when using the format defined in Appendix E of <xref target="OIDF.OID4VCI"></xref>:</t>

<ul spacing="compact">
<li>the public key certificate, and optionally a trust certificate chain excluding the trust anchor, used to validate the signature on the Wallet Attestation MUST be included in the <tt>x5c</tt> JOSE header of the Client Attestation JWT</li>
<li>Wallet Attestations MUST NOT be reused across different Issuers. They MUST NOT introduce a unique identifier specific to a single Wallet instance. The subject claim for the Wallet Attestation MUST be a value that is shared by all Wallet instances using the present type of wallet implementation. See section 15.4.4 of <xref target="OIDF.OID4VCI"></xref> for details on the Wallet Attestation subject.</li>
<li>if applicable, the <tt>client_id</tt> value in the PAR request MUST be the string in the <tt>sub</tt> value in the client attestation JWT.</li>
<li>Wallets MUST perform client authentication with the Wallet Attestation at OAuth2 Endpoints that support client authentication.</li>
</ul>
</section>
</section>

<section anchor="credential-endpoint"><name>Credential Endpoint</name>

<section anchor="key-attestation"><name>Key Attestation</name>
<t>Wallets MUST support key attestations. Ecosystems that desire wallet-issuer interoperability on the level of key attestations SHOULD require Wallets to support the format specified in Appendix D of <xref target="OIDF.OID4VCI"></xref>, in combination with the following proof types:</t>

<ul spacing="compact">
<li><tt>jwt</tt> proof type using <tt>key_attestation</tt></li>
<li><tt>attestation</tt> proof type</li>
</ul>
<t>When using the format specified in Appendix D of <xref target="OIDF.OID4VCI"></xref>:</t>

<ul spacing="compact">
<li>The public key used to validate the signature on the key attestation MUST be included in the <tt>x5c</tt> JOSE header of the key attestation</li>
<li>The X.509 certificate of the trust anchor MUST NOT be included in the <tt>x5c</tt> JOSE header of the key attestation.</li>
<li>The X.509 certificate signing the key attestation MUST NOT be self-signed.</li>
<li>The X.509 certificate profiles to be used are out of scope of this specification.</li>
</ul>
<t>Alternatively, Ecosystems MAY choose to rely on other key attestation formats, meaning they would need to use a proof type other than <tt>attestation</tt>, define a new proof type, or expand the <tt>jwt</tt> proof type to support other key attestation formats.</t>
<t>If batch issuance is used and the Credential Issuer has indicated (via <tt>cryptographic_binding_methods_supported</tt> metadata parameter) that cryptographic holder binding is required, all public keys used in Credential Request SHOULD be attested within a single key attestation.</t>
</section>
</section>
</section>

<section anchor="openid-for-verifiable-presentations"><name>OpenID for Verifiable Presentations</name>
<t>The following requirements apply to OpenID for Verifiable Presentations, irrespective of the flow and Credential Format:</t>

<ul spacing="compact">
<li>The Wallet and Verifier MUST support at least one of the following Credential Format Profiles defined in <xref target="vc-profiles"></xref>: IETF SD-JWT VC or ISO mdoc. Ecosystems SHOULD clearly indicate which of these formats, IETF SD-JWT VC, ISO mdoc, or both, are required to be supported.</li>
<li>The Response type MUST be <tt>vp_token</tt>.</li>
<li>For signed requests, the Verifier MUST use, and the Wallet MUST accept the Client Identifier Prefix <tt>x509_hash</tt> as defined in Section 5.9.3 of <xref target="OIDF.OID4VP"></xref>. The X.509 certificate of the trust anchor MUST NOT be included in the <tt>x5c</tt> JOSE header of the signed request. The X.509 certificate signing the request MUST NOT be self-signed. X.509 certificate profiles to be used with <tt>x509_hash</tt> are out of scope of this specification.</li>
<li>The DCQL query and response MUST be used as defined in Section 6 of <xref target="OIDF.OID4VP"></xref>.</li>
<li>Response encryption MUST be performed as specified in <xref target="OIDF.OID4VP" sectionFormat="of" relative="#" section="8.3"></xref>. The JWE <tt>alg</tt> (algorithm) header parameter (see <xref target="RFC7516" sectionFormat="of" relative="#" section="4.1.1"></xref>)
value <tt>ECDH-ES</tt> (as defined in <xref target="RFC7518" sectionFormat="of" relative="#" section="4.6"></xref>), with key agreement utilizing keys on the <tt>P-256</tt> curve (see <xref target="RFC7518" sectionFormat="of" relative="#" section="6.2.1.1"></xref>) MUST be supported.
The JWE <tt>enc</tt> (encryption algorithm) header parameter (see <xref target="RFC7516" sectionFormat="of" relative="#" section="4.1.2"></xref>) values <tt>A128GCM</tt> and <tt>A256GCM</tt> (as defined in <xref target="RFC7518" sectionFormat="of" relative="#" section="5.3"></xref>) MUST be supported by Verifiers. Wallets MUST support <tt>A128GCM</tt> or <tt>A256GCM</tt>, or both. If both are supported, the Wallet SHOULD use <tt>A256GCM</tt> for the JWE <tt>enc</tt>. Verifiers MUST list both <tt>A128GCM</tt> and <tt>A256GCM</tt> in <tt>encrypted_response_enc_values_supported</tt> in their client metadata.</li>
<li>Verifiers MUST supply ephemeral encryption public keys specific to each Authorization Request passed via client metadata as specified in Section 8.3 of <xref target="OIDF.OID4VP"></xref>.</li>
<li>The Authority Key Identifier (<tt>aki</tt>)-based Trusted Authority Query (<tt>trusted_authorities</tt>) for DCQL, as defined in section 6.1.1.1 of <xref target="OIDF.OID4VP"></xref>, MUST be supported. Note that the Authority Key Identifiers mechanism can be used to support multiple X.509-based trust mechanisms, such as ISO mDL VICAL (as introduced in <xref target="ISO.18013-5"></xref>) or ETSI Trusted Lists <xref target="ETSI.TL"></xref>. This is achieved by collecting the relevant X.509 certificates for the trusted Issuers and including the encoded Key Identifiers from the certificates in the <tt>aki</tt> array .</li>
</ul>
<t>Additional requirements for OpenID4VP are defined in <xref target="oid4vp-redirects"></xref>, <xref target="oid4vp-dc-api"></xref>, <xref target="oid4vp-credential-formats"></xref>, <xref target="crypto-suites"></xref> and <xref target="hash-algorithms"></xref>.</t>
<t>Note that while this specification does not define profiles for X.509 certificates used in Verifier authentication (e.g., with the <tt>x509_hash</tt> Client Identifier Prefix), Ecosystems are encouraged to select suitable certificate issuing policies and certificate profiles (for example, an mDL Ecosystem can use the Reader Authentication Certificate profile defined in Annex B of ISO/IEC 18013-5 with <tt>x509_hash</tt>), or define new ones if there is a good reason to do so. Such policies and profiles MAY specify how information in the certificate corresponds to information in the presentation flows. For example, an Ecosystem might require that the Wallet verifies that the <tt>redirect_uri</tt>, <tt>response_uri</tt>, <tt>origin</tt>, or <tt>expected_origin</tt> request parameters match with information contained in the Verifier's end-entity certificate (e.g., its DNS name).</t>

<section anchor="oid4vp-redirects"><name>OpenID for Verifiable Presentations via Redirects</name>
<t>The following requirements apply to OpenID for Verifiable Presentations via redirects:</t>

<ul spacing="compact">
<li>As a way to invoke the Wallet, the custom URL scheme <tt>haip-vp://</tt> MAY be supported by the Wallet and the Verifier. Implementations MAY support other ways to invoke the Wallets as agreed upon by trust frameworks/Ecosystems/jurisdictions, including but not limited to using other custom URL schemes or claimed &quot;https&quot; scheme URIs.</li>
<li>Signed Authorization Requests MUST be used by utilizing JWT-Secured Authorization Request (JAR) <xref target="RFC9101"></xref> with the <tt>request_uri</tt> parameter.</li>
<li>Response encryption MUST be used by utilizing response mode <tt>direct_post.jwt</tt>, as defined in Section 8.3 of <xref target="OIDF.OID4VP"></xref>. Security considerations in Section 14.3 of <xref target="OIDF.OID4VP"></xref> MUST be applied.</li>
<li><t>Verifiers and Wallets MUST support the &quot;same-device&quot; flow. Verifiers are RECOMMENDED to use only the &quot;same-device&quot; flow unless the Verifier does not rely on session binding for phishing resistance, e.g. in a proximity scenario. If &quot;same-device&quot; flow is used, then:</t>

<ul spacing="compact">
<li>Verifiers MUST include <tt>redirect_uri</tt> in the HTTP response to the Wallet's HTTP POST to the <tt>response_uri</tt>, as defined in Section 8.2 of <xref target="OIDF.OID4VP"></xref>.</li>
<li>Wallets MUST follow the redirect to <tt>redirect_uri</tt>.</li>
<li>Verifiers MUST reject presentations if Wallets do not follow the redirect back or the redirect back arrives in a different user session to the one the request was initiated in.</li>
<li>Implementation considerations can be found in Section 13.3 of <xref target="OIDF.OID4VP"></xref> and security considerations in Section 14.2 of <xref target="OIDF.OID4VP"></xref>.</li>
</ul></li>
</ul>
</section>

<section anchor="oid4vp-dc-api"><name>OpenID for Verifiable Presentations via W3C Digital Credentials API</name>
<t>The following requirements apply to OpenID for Verifiable Presentations via the W3C Digital Credentials API:</t>

<ul spacing="compact">
<li>The Wallet MUST support Wallet Invocation via the W3C Digital Credentials API or an equivalent platform API. The Verifier MUST use Wallet Invocation via the W3C Digital Credentials API or an equivalent platform API.</li>
<li>The Wallet MUST support the Response Mode <tt>dc_api.jwt</tt>. The Verifier MUST use the Response Mode <tt>dc_api.jwt</tt>.</li>
<li>The Verifier and Wallet MUST use Appendix A in <xref target="OIDF.OID4VP"></xref> that defines how to use OpenID4VP over the W3C Digital Credentials API.</li>
<li>The Wallet MUST support unsigned, signed, and multi-signed requests as defined in Appendices A.3.1 and A.3.2 of <xref target="OIDF.OID4VP"></xref>. The Verifier MUST support at least one of these options.</li>
</ul>
<t>Note that unsigned requests depend on the origin information provided by the platform and the web PKI for request integrity protection and to authenticate the Verifier. Signed requests introduce a separate layer for request integrity protection and Verifier authentication that can be validated by the Wallet.</t>
</section>

<section anchor="oid4vp-credential-formats"><name>Requirements specific to Credential Formats</name>

<section anchor="iso-mobile-documents-or-mdocs-iso-iec-18013-and-iso-iec-23220-series"><name>ISO Mobile Documents or mdocs (ISO/IEC 18013 and ISO/IEC 23220 series)</name>
<t>The following requirements apply to all OpenID4VP flows when the mdoc Credential Format is used (as defined in Appendix B.2. of <xref target="OIDF.OID4VP"></xref>):</t>

<ul spacing="compact">
<li>The Credential Format identifier MUST be <tt>mso_mdoc</tt>.</li>
<li>When multiple ISO mdocs are being returned, each ISO mdoc MUST be returned in a separate <tt>DeviceResponse</tt> (as defined in 8.3.2.1.2.2 of <xref target="ISO.18013-5"></xref>), each matching to a respective DCQL query. Therefore, the resulting <tt>vp_token</tt> contains multiple <tt>DeviceResponse</tt> instances.</li>
<li>The Credential Issuer MAY include the MSO revocation mechanism in the issued mdoc. When doing so, it MUST use one of the mechanisms defined in ISO/IEC 18013-5 (<xref target="ISO.18013-5.second.edition"></xref>).</li>
</ul>
</section>

<section anchor="ietf-sd-jwt-vc"><name>IETF SD-JWT VC</name>
<t>The following requirements apply to all OpenID4VP flows when the SD-JWT VC Credential Format is used:</t>

<ul spacing="compact">
<li>The Credential Format identifier MUST be <tt>dc+sd-jwt</tt>.</li>
</ul>
</section>
</section>
</section>

<section anchor="vc-profiles"><name>OpenID4VC Credential Format Profiles</name>
<t>Credential Format Profiles are defined as follows:</t>

<ul spacing="compact">
<li><t>IETF SD-JWT VCs (as specified in <xref target="I-D.ietf-oauth-sd-jwt-vc"></xref>), subject to the additional requirements defined in <xref target="sd-jwt-vc"></xref>:</t>

<ul spacing="compact">
<li><xref target="OIDF.OID4VCI"></xref> – Appendix A.3</li>
<li><xref target="OIDF.OID4VP"></xref> – Appendix B.3</li>
</ul></li>
<li><t>ISO mdocs:</t>

<ul spacing="compact">
<li><xref target="OIDF.OID4VCI"></xref> – Appendix A.2</li>
<li><xref target="OIDF.OID4VP"></xref> – Appendix B.2</li>
</ul></li>
</ul>

<section anchor="sd-jwt-vc"><name>IETF SD-JWT VC Profile</name>
<t>This specification defines the following additional requirements for IETF SD-JWT VCs as defined in <xref target="I-D.ietf-oauth-sd-jwt-vc"></xref>.</t>

<ul spacing="compact">
<li>Compact serialization MUST be supported as defined in <xref target="RFC9901"></xref>. JSON serialization MAY be supported.</li>
<li>It is RECOMMENDED that Issuers limit the validity period when issuing SD-JWT VC. When doing so, the Issuer MUST use an <tt>exp</tt> claim, a <tt>status</tt> claim, or both.</li>
<li>The <tt>cnf</tt> claim <xref target="RFC7800"></xref> MUST conform to the definition given in <xref target="I-D.ietf-oauth-sd-jwt-vc"></xref>. Implementations conforming to this specification MUST include the JSON Web Key <xref target="RFC7517"></xref> in the <tt>jwk</tt> member if the corresponding Credential Configuration requires cryptographic holder binding.</li>
<li>The <tt>status</tt> claim, if present, MUST contain <tt>status_list</tt> as defined in <xref target="I-D.ietf-oauth-status-list"></xref></li>
<li>The public key used to validate the signature on the Status List Token defined in [I-D.ietf-oauth-status-list] MUST be included in the <tt>x5c</tt> JOSE header of the Token. The X.509 certificate of the trust anchor MUST NOT be included in the <tt>x5c</tt> JOSE header of the Status List Token. The X.509 certificate signing the request MUST NOT be self-signed.</li>
</ul>
<t>Each Credential MUST have its own unique, unpredictable status list index, even when multiple Credentials reference the same status list URI (see section 13.2 of <xref target="I-D.ietf-oauth-status-list"></xref>). Refer to section 12.5 of <xref target="I-D.ietf-oauth-status-list"></xref> for additional privacy considerations on unlinkability.</t>
<t>Note: For guidance on preventing linkability by colluding parties, such as Issuer/Verifier pairs, multiple Verifiers, or repeated interactions with the same Verifier, see Section 15.4.1 of <xref target="OIDF.OID4VCI"></xref> and Section 15.5 of <xref target="OIDF.OID4VP"></xref>.</t>
<t>Note: If there is a requirement to communicate information about the verification status and identity assurance data of the claims about the subject, the syntax defined by <xref target="OIDF.ekyc-ida"></xref> SHOULD be used. It is up to each jurisdiction and Ecosystem, whether to require it to the implementers of this specification.</t>
<t>Note: If there is a requirement to provide the Subject’s identifier assigned and maintained by the Issuer, the <tt>sub</tt> claim MAY be used. There is no requirement for a binding to exist between the <tt>sub</tt> and <tt>cnf</tt> claims. See the Implementation Considerations section in <xref target="I-D.ietf-oauth-sd-jwt-vc"></xref>.</t>
<t>Note: In some Credential Types, it is not desirable to include an expiration date (e.g., diploma attestation). Therefore, this specification leaves its inclusion to the Issuer, or the body defining the respective Credential Type.</t>

<section anchor="issuer-key-resolution"><name>Issuer identification and key resolution to validate an issued Credential</name>
<t>This specification mandates the support for X.509 certificate-based key resolution to validate the issuer signature of an SD-JWT VC. This MUST be supported by all entities (Issuer, Wallet, Verifier). The SD-JWT VC MUST contain the credential issuer's signing certificate along with a trust chain in the <tt>x5c</tt> JOSE header parameter as described in section 3.5 of <xref target="I-D.ietf-oauth-sd-jwt-vc"></xref>. The X.509 certificate of the trust anchor MUST NOT be included in the <tt>x5c</tt> JOSE header of the SD-JWT VC. The X.509 certificate signing the request MUST NOT be self-signed.</t>

<section anchor="cryptographic-holder-binding-between-vc-and-vp"><name>Cryptographic Holder Binding between VC and VP</name>

<ul spacing="compact">
<li>If the credential has cryptographic holder binding, a KB-JWT, as defined in <xref target="I-D.ietf-oauth-sd-jwt-vc"></xref>, MUST always be present when presenting an SD-JWT VC.</li>
</ul>
</section>
</section>
</section>
</section>

<section anchor="crypto-suites"><name>Requirements for Digital Signatures</name>
<t>Issuers, Verifiers, and Wallets MUST, at a minimum, support ECDSA with P-256 and SHA-256 (JOSE algorithm identifier <tt>ES256</tt>; COSE algorithm identifier <tt>-7</tt> or <tt>-9</tt>, as applicable) for the purpose of validating the following:</t>

<ul spacing="compact">
<li><t>Issuers</t>

<ul spacing="compact">
<li>Wallet Attestations (including PoP) when Appendix E of <xref target="OIDF.OID4VCI"></xref> is used.</li>
<li>Key Attestations when Appendix D of <xref target="OIDF.OID4VCI"></xref> is used.</li>
<li><tt>jwt</tt> proof type as specified in Appendix E of <xref target="OIDF.OID4VCI"></xref>.</li>
</ul></li>
<li><t>Verifiers</t>

<ul spacing="compact">
<li>the signature of the Verifiable Presentation, e.g., KB-JWT of an SD-JWT VC, or <tt>deviceSignature</tt> CBOR structure in case of ISO mdocs. Verifiers are assumed to determine in advance the cryptographic suites supported by the Ecosystem, e.g. mDL Issuers/Verifiers implementing ISO mdocs.</li>
<li>the status information of the Verifiable Credential or Wallet Attestation.</li>
</ul></li>
<li><t>Wallets</t>

<ul spacing="compact">
<li>signed presentation requests.</li>
<li>signed Issuer metadata.</li>
</ul></li>
</ul>
<t>Ecosystem-specific profiles of this specification MAY mandate additional cryptographic suites.</t>
<t>When using this specification alongside other crypto suites, each entity SHOULD make it explicit in its metadata which other algorithms and key types are supported for the cryptographic operations.</t>
</section>

<section anchor="hash-algorithms"><name>Hash Algorithms</name>
<t>The hash algorithm SHA-256 MUST be supported by all the entities to generate and validate the digests in the IETF SD-JWT VC and ISO mdoc.</t>
<t>Ecosystem-specific profiles of this specification MAY mandate additional hashing algorithms.</t>
<t>When using this specification alongside other hash algorithms, each entity SHOULD make it explicit in its metadata which other algorithms are supported.</t>
</section>

<section anchor="implementation-considerations"><name>Implementation Considerations</name>

<section anchor="requirements-for-browser-os-support-of-specific-features"><name>Requirements for browser/OS support of specific features</name>
<t>This specification relies on certain prerequisites, such as browser or operating system support for specific features. When these prerequisites are mandatory for a flow (e.g., the W3C Digital Credentials API or an equivalent platform API), an implementer might be unable to support that flow due to factors beyond their control. In other cases (e.g., custom URL schemes), the prerequisites are optional, allowing implementers to achieve the same flow through alternative mechanisms.</t>
</section>

<section anchor="interoperable-key-attestations"><name>Interoperable Key Attestations</name>
<t>Wallet implementations using the key attestation format specified in Appendix D of <xref target="OIDF.OID4VCI"></xref> might need to utilize a transformation (backend) service to create such attestations based on data as provided in other formats by the respective platform or secure key management module. The dependency on such a service might impact the availability of the wallet app as well as the performance of the issuance process. This could be mitigated by creating keys and obtaining the respective key attestations in advance.</t>
</section>

<section anchor="ecosystem-implementation-considerations"><name>Ecosystem Implementation Considerations</name>
<t>This specification intentionally leaves certain extensions for Ecosystems to define, in order to enable broad compatibility across differing or even conflicting requirements. Below are the extension points listed in this specification:</t>

<ul spacing="compact">
<li>Which flow(s) to adopt: presentation, issuance, or both (see <xref target="scope"></xref>)</li>
<li>For presentation, whether to use the W3C Digital Credentials API, Redirects with custom URL schemes, and/or Redirects with claimed <tt>https</tt> scheme URIs (see <xref target="scope"></xref>)</li>
<li>Which Credential Format to support across issuance and presentation (see <xref target="scope"></xref>)</li>
<li>Whether to use Signed Issuer Metadata or not (see <xref target="issuer-metadata"></xref>)</li>
<li>How to make a Credential Offer available to the Wallet (see <xref target="credential-offer"></xref>)</li>
<li>Which Key Attestation format to use (see <xref target="key-attestation"></xref>)</li>
<li>Which Wallet Attestation format to use (see <xref target="wallet-attestation"></xref>)</li>
<li>Which X.509 certificate profile to use (see <xref target="openid-for-verifiable-presentations"></xref>, <xref target="wallet-attestation"></xref> and <xref target="key-attestation"></xref>)</li>
<li>Support or restriction of additional cryptographic suites and hash algorithms (see <xref target="crypto-suites"></xref>)</li>
</ul>

<section anchor="non-normative-examples-of-ecosystem-specific-extensions-of-this-specification"><name>Non-normative Examples of Ecosystem-specific Extensions of this Specification</name>
<t>Below are two non-normative examples illustrating how an Ecosystem may define the above elements to achieve its specific goals and preferences.</t>

<section anchor="example-1-baseline-interoperability-without-pre-existing-relationships"><name>Example 1: Baseline Interoperability without pre-existing relationships</name>
<t>An Ecosystem that prioritizes interoperability among all Wallets, Issuers and Verifiers, without requiring any pre-existing relationships, could define the following Ecosystem-specific extensions of this specification:</t>

<ul spacing="compact">
<li><t>Use this specification for both presentation and issuance with the following requirements:</t>

<ul spacing="compact">
<li>No additional cryptographic suites and hash algorithms are defined.</li>
<li>For each Credential, Wallets support both mdoc and sd-jwt-vc Credential Formats, Issuers have a choice to issue in either format, and Verifiers accept the Credential Format that the Issuer of a requested Credential supports.</li>
</ul></li>
<li><t>For issuance, the following requirements apply:</t>

<ul spacing="compact">
<li>Issuers use and Wallets support unsigned Issuer Metadata.</li>
<li>Wallets register for the <tt>haip-vci://</tt> custom scheme, where possible. This custom scheme is also used to communicate Credential Offer.</li>
<li>Wallets and Issuers both support Key Attestations in the format specified in Appendix D of <xref target="OIDF.OID4VCI"></xref>. Both <tt>jwt</tt> proof type using <tt>key_attestation</tt> and <tt>attestation</tt> proof type are supported.</li>
<li>Wallets and Issuers both support Wallet Attestations in the format specified in Appendix E of <xref target="OIDF.OID4VCI"></xref> and <xref target="wallet-attestation"></xref> of this specification.</li>
</ul></li>
<li><t>for presentation, the following requirements apply:</t>

<ul spacing="compact">
<li>Wallets use DC API where possible and when they have credentials available. As a fallback mechanism when DC API is not available, Wallets register for the <tt>haip-vp://</tt> custom scheme, where possible.</li>
<li>No additional X.509 certificate profile is defined.</li>
</ul></li>
</ul>
<t>Making these choices maximizes interoperability between the parties in the Ecosystem while minimizing the burden on Issuers and Verifiers. This comes at the expense of an increased burden on Wallets as well as the potential privacy and security issues in <xref target="interop-key-attestations"></xref>.</t>
</section>

<section anchor="example-2-achieving-compatibility-with-existing-deployments-of-iso-iec-18013-5"><name>Example 2: Achieving Compatibility with Existing Deployments of ISO/IEC 18013-5</name>
<t>An Ecosystem that prioritizes achieving compatibility with existing deployments could define the following Ecosystem-specific extensions of this specification:</t>

<ul spacing="compact">
<li><t>Use this specification only for presentation with the following requirements:</t>

<ul spacing="compact">
<li>Wallets and Verifiers support only the mdoc Credential Format.</li>
<li>Wallets register and use the <tt>haip-vp://</tt> custom scheme, where possible.</li>
<li>As X.509 certificate profile, Wallets and Verifiers use the Reader Authentication Certificate profile defined in Annex B of <xref target="ISO.18013-5"></xref>.</li>
<li>Verifiers support all curves from Cipher Suite 1 listed in table 22 of <xref target="ISO.18013-5"></xref>.</li>
<li>Verifiers support all hash algorithms listed in table 21 of <xref target="ISO.18013-5"></xref>.</li>
</ul></li>
</ul>
<t>Making these choices ensures interoperability at the increased cost on the Verifier.</t>
</section>
</section>
</section>

<section anchor="pre-final-specifications"><name>Pre-Final Specifications</name>
<t>Implementers should be aware that this specification uses several specifications that are not yet final specifications. Those specifications are:</t>

<ul spacing="compact">
<li>SD-JWT-based Verifiable Credentials (SD-JWT VC) draft -13 <xref target="I-D.ietf-oauth-sd-jwt-vc"></xref></li>
<li>Token Status List draft -14 <xref target="I-D.ietf-oauth-status-list"></xref></li>
</ul>
<t>While breaking changes to the specifications referenced in this specification are not expected, should they occur, implementations compliant with this specification should continue to use the specifically referenced versions above in preference to the final versions, unless updated by a profile or new version of this specification.</t>
<t>Note that specification versions mentioned in this specification overwrite the versions previously mentioned in <xref target="OIDF.OID4VCI"></xref> and  <xref target="OIDF.OID4VP"></xref>.</t>
</section>
</section>

<section anchor="security_considerations"><name>Security Considerations</name>
<t>Note that security considerations for OpenID for Verifiable Credential Issuance are defined in Section 13 of <xref target="OIDF.OID4VCI"></xref> and for OpenID for Verifiable Presentations in Section 14 (for redirect based flows) or Section A.5 (for DC API) of <xref target="OIDF.OID4VP"></xref>.</t>

<section anchor="incomplete-or-incorrect-implementations-of-the-specifications-and-conformance-testing"><name>Incomplete or Incorrect Implementations of the Specifications and Conformance Testing</name>
<t>To achieve the full security benefits, it is important that the implementation of this specification, and the underlying specifications, are both complete and correct.</t>
<t>The OpenID Foundation provides tools that can be used to confirm that an implementation is correct and conformant:</t>
<t><eref target="https://openid.net/certification/conformance-testing-for-openid-for-verifiable-credential-issuance/">https://openid.net/certification/conformance-testing-for-openid-for-verifiable-credential-issuance/</eref></t>
<t><eref target="https://openid.net/certification/conformance-testing-for-openid-for-verifiable-presentations/">https://openid.net/certification/conformance-testing-for-openid-for-verifiable-presentations/</eref></t>
</section>

<section anchor="key-sizes"><name>Key sizes</name>
<t>Implementers need to ensure appropriate key sizes are used. Guidance can be found in, for example, <xref target="NIST.SP.800-131A"></xref>, <xref target="NIST.SP.800-57"></xref>, <xref target="BSI.TR-02102-1"></xref>, or <xref target="ECCG.ACM2"></xref>.</t>
</section>
</section>

<section anchor="privacy-considerations"><name>Privacy Considerations</name>
<t>Note that privacy considerations for OpenID for Verifiable Credential Issuance are defined in Section 15 of <xref target="OIDF.OID4VCI"></xref> and for OpenID for Verifiable Presentations in Section 15 (for redirect based flows) or Section A.6 (for DC API) of <xref target="OIDF.OID4VP"></xref>.</t>

<section anchor="interop-key-attestations"><name>Interoperable Key Attestations</name>
<t>Wallet implementations using the key attestation format specified in Appendix D of <xref target="OIDF.OID4VCI"></xref> might need to utilize a transformation (backend) service to create such attestations based on data as provided in other formats by the respective platform or secure key management module. Such a backend service MUST be designed considering the privacy of its users. For example, the service could be stateless and just perform the transformation of the attestation data without binding the process in any way to a unique user identifier.</t>
</section>
</section>

</middle>

<back>
<references><name>Normative References</name>
<reference anchor="FAPI2_Security_Profile" target="https://openid.net/specs/fapi-security-profile-2_0.html">
  <front>
    <title>FAPI 2.0 Security Profile</title>
    <author fullname="Daniel Fett" initials="D." surname="Fett">
      <organization>Authlete</organization>
    </author>
    <author fullname="Dave Tonge" initials="D." surname="Tonge">
      <organization>Moneyhub Financial Technology Ltd.</organization>
    </author>
    <author fullname="Joseph Heenan" initials="J." surname="Heenan">
      <organization>Authlete</organization>
    </author>
    <date year="2025" month="Feb" day="22"></date>
  </front>
</reference>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml-ids/reference.I-D.ietf-oauth-sd-jwt-vc.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml-ids/reference.I-D.ietf-oauth-status-list.xml"/>
<reference anchor="ISO.18013-5" target="https://www.iso.org/standard/69084.html">
  <front>
    <title>ISO/IEC 18013-5:2021 Personal identification — ISO-compliant driving license — Part 5: Mobile driving license (mDL)  application</title>
    <author>
      <organization>ISO/IEC JTC 1/SC 17 Cards and security devices for personal identification</organization>
    </author>
    <date year="2021"></date>
  </front>
</reference>
<reference anchor="ISO.18013-5.second.edition" target="https://www.iso.org/standard/91081.html">
  <front>
    <title>ISO/IEC 18013-5:xxxx Personal identification — ISO-compliant driving license — Part 5: Mobile driving license (mDL)  application edition 2</title>
    <author>
      <organization>ISO/IEC JTC 1/SC 17 Cards and security devices for personal identification</organization>
    </author>
  </front>
</reference>
<reference anchor="OIDF.OID4VCI" target="https://openid.net/specs/openid-4-verifiable-credential-issuance-1_0.html">
  <front>
    <title>OpenID for Verifiable Credential Issuance 1.0</title>
    <author fullname="Torsten Lodderstedt" initials="T." surname="Lodderstedt">
      <organization>SPRIND</organization>
    </author>
    <author fullname="Kristina Yasuda" initials="K." surname="Yasuda">
      <organization>SPRIND</organization>
    </author>
    <author fullname="Tobias Looker" initials="T." surname="Looker">
      <organization>Mattr</organization>
    </author>
    <author fullname="Paul P. Bastian" initials="P." surname="Bastian">
      <organization>Bundesdruckerei</organization>
    </author>
    <date year="2025" month="September" day="16"></date>
  </front>
</reference>
<reference anchor="OIDF.OID4VP" target="https://openid.net/specs/openid-4-verifiable-presentations-1_0.html">
  <front>
    <title>OpenID for Verifiable Presentations 1.0</title>
    <author fullname="Oliver Terbu" initials="O." surname="Terbu">
      <organization>Mattr</organization>
    </author>
    <author fullname="Torsten Lodderstedt" initials="T." surname="Lodderstedt">
      <organization>SPRIND</organization>
    </author>
    <author fullname="Kristina Yasuda" initials="K." surname="Yasuda">
      <organization>SPRIND</organization>
    </author>
    <author fullname="Daniel Fett" initials="D." surname="Fett">
      <organization>Authlete</organization>
    </author>
    <author fullname="Joseph Heenan" initials="J." surname="Heenan">
      <organization>Authlete</organization>
    </author>
    <date year="2025" month="July" day="9"></date>
  </front>
</reference>
<reference anchor="OIDF.ekyc-ida" target="https://openid.net/specs/openid-connect-4-identity-assurance-1_0.html">
  <front>
    <title>OpenID Connect for Identity Assurance 1.0</title>
    <author>
      <organization>yes</organization>
    </author>
    <author fullname="Daniel Fett">
      <organization>yes</organization>
    </author>
    <author fullname="Mark Haine">
      <organization>Considrd.Consulting Ltd</organization>
    </author>
    <author fullname="Alberto Pulido">
      <organization>Santander</organization>
    </author>
    <author fullname="Kai Lehmann">
      <organization>1&amp;1 Mail &amp; Media Development &amp; Technology GmbH</organization>
    </author>
    <author fullname="Kosuke Koiwai">
      <organization>KDDI Corporation</organization>
    </author>
    <date year="2024" month="October" day="1"></date>
  </front>
</reference>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7515.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7516.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7517.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7518.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7636.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7800.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8414.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.9101.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.9126.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.9207.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.9449.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.9901.xml"/>
</references>
<references><name>Informative References</name>
<reference anchor="BSI.TR-02102-1" target="https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Publications/TechGuidelines/TG02102/BSI-TR-02102-1.pdf?__blob=publicationFile">
  <front>
    <title>Cryptographic Mechanisms: Recommendations and Key Lengths</title>
    <author>
      <organization>Federal Office for Information Security (BSI)</organization>
    </author>
    <date year="2025" month="Jan"></date>
  </front>
</reference>
<reference anchor="ECCG.ACM2" target="https://certification.enisa.europa.eu/document/download/a845662b-aee0-484e-9191-890c4cfa7aaa_en">
  <front>
    <title>Agreed Cryptographic Mechanisms 2.0</title>
    <author>
      <organization>European Cybersecurity Certification Group, Sub-group on Cryptography</organization>
    </author>
    <date year="2025" month="April"></date>
  </front>
</reference>
<reference anchor="ETSI.TL" target="https://www.etsi.org/deliver/etsi_ts/119600_119699/119612/02.04.01_60/ts_119612v020401p.pdf">
  <front>
    <title>ETSI TS 119 612 V2.4.1 Electronic Signatures and Trust Infrastructures (ESI); Trusted Lists </title>
    <author>
      <organization>European Telecommunications Standards Institute (ETSI)</organization>
    </author>
    <date year="2025" month="Aug"></date>
  </front>
</reference>
<reference anchor="IANA.URI.Schemes" target="https://www.iana.org/assignments/uri-schemes">
  <front>
    <title>Uniform Resource Identifier (URI) Schemes</title>
    <author>
      <organization>IANA</organization>
    </author>
    <date></date>
  </front>
</reference>
<reference anchor="NIST.SP.800-131A" target="https://csrc.nist.gov/pubs/sp/800/131/a/r2/final">
  <front>
    <title>NIST SP 800-131A: Transitioning the Use of Cryptographic Algorithms and Key Lengths</title>
    <author fullname="Elaine Barker">
      <organization>NIST</organization>
    </author>
    <author fullname="Allen Roginsky">
      <organization>NIST</organization>
    </author>
    <date year="2019" month="Mar"></date>
  </front>
</reference>
<reference anchor="NIST.SP.800-57" target="https://csrc.nist.gov/pubs/sp/800/57/pt1/r5/final">
  <front>
    <title>NIST SP 800-57 Part 1: Recommendation for Key Management: Part 1 – General</title>
    <author fullname="Elaine Barker">
      <organization>NIST</organization>
    </author>
    <date year="2020" month="May"></date>
  </front>
</reference>
<reference anchor="eIDAS2.0" target="https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=OJ:L_202401183">
  <front>
    <title>REGULATION (EU) 2024/1183 OF THE EUROPEAN PARLIAMENT AND OF THE COUNCIL of 11 April 2024 amending Regulation (EU) No 910/2014 as regards establishing the European Digital Identity Framework</title>
    <author>
      <organization>European Union</organization>
    </author>
    <date year="2024"></date>
  </front>
</reference>
<reference anchor="w3c.digital_credentials_api" target="https://www.w3.org/TR/2025/WD-digital-credentials-20251208/">
  <front>
    <title>Digital Credentials API</title>
    <author fullname="Marcos Caceres">
      <organization>Apple Inc.</organization>
    </author>
    <author fullname="Tim Cappalli">
      <organization>Okta</organization>
    </author>
    <author fullname="Mohamed Amir Yosef">
      <organization>Google Inc.</organization>
    </author>
    <date year="2025" month="Dec" day="8"></date>
  </front>
</reference>
</references>

<section anchor="iana-considerations"><name>IANA Considerations</name>

<section anchor="uniform-resource-identifier-uri-schemes-registry"><name>Uniform Resource Identifier (URI) Schemes Registry</name>
<t>This specification registers the following URI schemes in the IANA &quot;Uniform Resource Identifier (URI) Schemes&quot; registry <xref target="IANA.URI.Schemes"></xref>.</t>

<section anchor="haip-vci"><name>haip-vci</name>

<ul spacing="compact">
<li>Scheme name: haip-vci</li>
<li>Status: Permanent</li>
<li>Applications/protocols that use this scheme name: Wallets that implement the OIDF HAIP specification to offer a Credential using OpenID for Verifiable Credential Issuance</li>
<li>Contact: OpenID Foundation Digital Credentials Protocols Working Group - openid-specs-digital-credentials-protocols@lists.openid.net</li>
<li>Change Controller: OpenID Foundation Digital Credentials Protocols Working Group - openid-specs-digital-credentials-protocols@lists.openid.net</li>
<li>Reference: <xref target="credential-offer"></xref> of this specification</li>
</ul>
</section>

<section anchor="haip-vp"><name>haip-vp</name>

<ul spacing="compact">
<li>Scheme name: haip-vp</li>
<li>Status: Permanent</li>
<li>Applications/protocols that use this scheme name: Verifiers invoking Wallets that implement the OIDF HAIP specification to request the presentation of Credentials using OpenID for Verifiable Presentations</li>
<li>Contact: OpenID Foundation Digital Credentials Protocols Working Group - openid-specs-digital-credentials-protocols@lists.openid.net</li>
<li>Change Controller: OpenID Foundation Digital Credentials Protocols Working Group - openid-specs-digital-credentials-protocols@lists.openid.net</li>
<li>Reference: <xref target="oid4vp-redirects"></xref> of this specification</li>
</ul>
</section>
</section>
</section>

<section anchor="Acknowledgements"><name>Acknowledgements</name>
<t>We would like to thank Patrick Amrein, Paul Bastian, Brian Campbell, Lee Campbell, Tim Cappalli, Stefan Charsley, Gabe Cohen, Andrii Deinega,  Rajvardhan Deshmukh, Daniel Fett, Pedro Felix, Ryan Galluzzo, Timo Glastra, Martijn Haring, Bjorn Hjelm, Alen Horvat, Łukasz Jaromin, Mike Jones, Markus Kreusch, Philipp Lehwalder, Tobias Looker, Hicham Lozi, Mirko Mollik, Andres Olave, Gareth Oliver, Oliver Terbu, Giuseppe De Marco, Mikel Pintor, Joel Posti, Dima Postnikov, Andreea Prian, Bob Reynders, Samuel Rinnetmäki, Peter Sorotokin, Jan Vereecken, Jin Wen, Hakan Yildiz and David Zeuthen for their valuable feedback and contributions to this specification.</t>
</section>

<section anchor="notices"><name>Notices</name>
<t>Copyright (c) 2025 The OpenID Foundation.</t>
<t>The OpenID Foundation (OIDF) grants to any Contributor, developer, implementer, or other interested party a non-exclusive, royalty free, worldwide copyright license to reproduce, prepare derivative works from, distribute, perform and display, this Implementers Draft, Final Specification, or Final Specification Incorporating Errata Corrections solely for the purposes of (i) developing specifications, and (ii) implementing Implementers Drafts, Final Specifications, and Final Specification Incorporating Errata Corrections based on such documents, provided that attribution be made to the OIDF as the source of the material, but that such attribution does not indicate an endorsement by the OIDF.</t>
<t>The technology described in this specification was made available from contributions from various sources, including members of the OpenID Foundation and others. Although the OpenID Foundation has taken steps to help ensure that the technology is available for distribution, it takes no position regarding the validity or scope of any intellectual property or other rights that might be claimed to pertain to the implementation or use of the technology described in this specification or the extent to which any license under such rights might or might not be available; neither does it represent that it has made any independent effort to identify any such rights. The OpenID Foundation and the contributors to this specification make no (and hereby expressly disclaim any) warranties (express, implied, or otherwise), including implied warranties of merchantability, non-infringement, fitness for a particular purpose, or title, related to this specification, and the entire risk as to implementing this specification is assumed by the implementer. The OpenID Intellectual Property Rights policy (found at openid.net) requires contributors to offer a patent promise not to assert certain patent claims against other contributors and against implementers. OpenID invites any interested party to bring to its attention any copyrights, patents, patent applications, or other proprietary rights that may cover technology that may be required to practice this specification.</t>
</section>

</back>

</rfc>

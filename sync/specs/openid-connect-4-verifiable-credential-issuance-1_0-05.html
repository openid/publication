<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>OpenID Connect for Verifiable Credential Issuance</title>
<meta content="Torsten Lodderstedt" name="author">
<meta content="Kristina Yasuda" name="author">
<meta content="Tobias Looker" name="author">
<meta content="
       This specification defines an API and corresponding OAuth-based authorization mechanisms for issuance of verifiable credentials. This specification can be combined with OpenID Connect to obtain identity assertions along with verifiable credentials. 
    " name="description">
<meta content="xml2rfc 2.40.1" name="generator">
<meta content="security" name="keyword">
<meta content="openid" name="keyword">
<meta content="ssi" name="keyword">
<meta content="openid-connect-4-verifiable-credential-issuance-1_0-05" name="ietf.draft">
<link href="./openid-connect-4-verifiable-credential-issuance-1_0-05.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Avoid wrapping of URLs in references */
@media screen {
  .references a {
    white-space: nowrap;
  }
}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin: 0 0 0.25em 0;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/*
  The margin-left: 0 on <dd> removes all distinction
  between levels from nested <dl>s.  Undo that.
*/
dl.olPercent > dd,
dd {
  margin-left: revert;
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left"></td>
<td class="center">openid-connect-4-vc-issuance</td>
<td class="right">April 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Lodderstedt, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">OpenID Connect</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">openid-connect-4-verifiable-credential-issuance-1_0-05</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-04-22" class="published">22 April 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Lodderstedt</div>
<div class="org">yes.com</div>
</div>
<div class="author">
      <div class="author-name">K. Yasuda</div>
<div class="org">Microsoft</div>
</div>
<div class="author">
      <div class="author-name">T. Looker</div>
<div class="org">Mattr</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">OpenID Connect for Verifiable Credential Issuance</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This specification defines an API and corresponding OAuth-based authorization mechanisms for issuance of verifiable credentials. This specification can be combined with OpenID Connect to obtain identity assertions along with verifiable credentials.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-use-cases" class="xref">Use Cases</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-end-user-initiated-credenti" class="xref">End-User Initiated Credential Issuance</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-end-user-initiated-credentia" class="xref">End-User Initiated Credential Issuance (with On-Demand Credential Presentation)</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-issuer-initiated-credential" class="xref">Issuer-Initiated Credential Issuance</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-issuer-initiated-credential-" class="xref">Issuer-Initiated Credential Issuance (Cross-Device / Credential Retrieval Only)</a><a href="#section-toc.1-1.3.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-issuer-initiated-credential-i" class="xref">Issuer-Initiated Credential Issuance (with information pre-submitted by the End-User)</a><a href="#section-toc.1-1.3.2.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-deferred-credential-issuanc" class="xref">Deferred Credential Issuance</a><a href="#section-toc.1-1.3.2.6.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-requirements" class="xref">Requirements</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-overview" class="xref">Overview</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-endpoints" class="xref">Endpoints</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-overview-2" class="xref">Overview</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-client-metadata" class="xref">Client Metadata</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-server-metadata" class="xref">Server Metadata</a><a href="#section-toc.1-1.6.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-issuance-initiation-endpoin" class="xref">Issuance Initiation Endpoint</a><a href="#section-toc.1-1.6.2.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.6.2.4.2.1">
                    <p id="section-toc.1-1.6.2.4.2.1.1"><a href="#section-6.4.1" class="xref">6.4.1</a>.  <a href="#name-issuance-initiation-request" class="xref">Issuance Initiation Request</a><a href="#section-toc.1-1.6.2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.4.2.2">
                    <p id="section-toc.1-1.6.2.4.2.2.1"><a href="#section-6.4.2" class="xref">6.4.2</a>.  <a href="#name-issuance-initiation-respons" class="xref">Issuance Initiation Response</a><a href="#section-toc.1-1.6.2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="xref">6.5</a>.  <a href="#name-authorization-endpoint" class="xref">Authorization Endpoint</a><a href="#section-toc.1-1.6.2.5.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.6.2.5.2.1">
                    <p id="section-toc.1-1.6.2.5.2.1.1"><a href="#section-6.5.1" class="xref">6.5.1</a>.  <a href="#name-authorization_details-reque" class="xref"><code>authorization_details</code> Request Parameter</a><a href="#section-toc.1-1.6.2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.5.2.2">
                    <p id="section-toc.1-1.6.2.5.2.2.1"><a href="#section-6.5.2" class="xref">6.5.2</a>.  <a href="#name-credential-authorization-re" class="xref">Credential Authorization Request</a><a href="#section-toc.1-1.6.2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.5.2.3">
                    <p id="section-toc.1-1.6.2.5.2.3.1"><a href="#section-6.5.3" class="xref">6.5.3</a>.  <a href="#name-successful-authorization-re" class="xref">Successful Authorization Response</a><a href="#section-toc.1-1.6.2.5.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.5.2.4">
                    <p id="section-toc.1-1.6.2.5.2.4.1"><a href="#section-6.5.4" class="xref">6.5.4</a>.  <a href="#name-authentication-error-respon" class="xref">Authentication Error Response</a><a href="#section-toc.1-1.6.2.5.2.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a href="#section-6.6" class="xref">6.6</a>.  <a href="#name-token-endpoint" class="xref">Token Endpoint</a><a href="#section-toc.1-1.6.2.6.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.6.2.6.2.1">
                    <p id="section-toc.1-1.6.2.6.2.1.1"><a href="#section-6.6.1" class="xref">6.6.1</a>.  <a href="#name-token-request" class="xref">Token Request</a><a href="#section-toc.1-1.6.2.6.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.6.2.2">
                    <p id="section-toc.1-1.6.2.6.2.2.1"><a href="#section-6.6.2" class="xref">6.6.2</a>.  <a href="#name-successful-token-response" class="xref">Successful Token Response</a><a href="#section-toc.1-1.6.2.6.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.6.2.3">
                    <p id="section-toc.1-1.6.2.6.2.3.1"><a href="#section-6.6.3" class="xref">6.6.3</a>.  <a href="#name-token-error-response" class="xref">Token Error Response</a><a href="#section-toc.1-1.6.2.6.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.7">
                <p id="section-toc.1-1.6.2.7.1"><a href="#section-6.7" class="xref">6.7</a>.  <a href="#name-credential-endpoint" class="xref">Credential Endpoint</a><a href="#section-toc.1-1.6.2.7.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.6.2.7.2.1">
                    <p id="section-toc.1-1.6.2.7.2.1.1"><a href="#section-6.7.1" class="xref">6.7.1</a>.  <a href="#name-binding-the-issued-credenti" class="xref">Binding the Issued Credential to the identifier of the End-User possessing that Credential</a><a href="#section-toc.1-1.6.2.7.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.7.2.2">
                    <p id="section-toc.1-1.6.2.7.2.2.1"><a href="#section-6.7.2" class="xref">6.7.2</a>.  <a href="#name-credential-request" class="xref">Credential Request</a><a href="#section-toc.1-1.6.2.7.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.7.2.3">
                    <p id="section-toc.1-1.6.2.7.2.3.1"><a href="#section-6.7.3" class="xref">6.7.3</a>.  <a href="#name-credential-response" class="xref">Credential Response</a><a href="#section-toc.1-1.6.2.7.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.7.2.4">
                    <p id="section-toc.1-1.6.2.7.2.4.1"><a href="#section-6.7.4" class="xref">6.7.4</a>.  <a href="#name-credential-issuer-provided-" class="xref">Credential Issuer-Provided Nonce</a><a href="#section-toc.1-1.6.2.7.2.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.8">
                <p id="section-toc.1-1.6.2.8.1"><a href="#section-6.8" class="xref">6.8</a>.  <a href="#name-deferred-credential-endpoin" class="xref">Deferred Credential Endpoint</a><a href="#section-toc.1-1.6.2.8.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.6.2.8.2.1">
                    <p id="section-toc.1-1.6.2.8.2.1.1"><a href="#section-6.8.1" class="xref">6.8.1</a>.  <a href="#name-deferred-credential-request" class="xref">Deferred Credential Request</a><a href="#section-toc.1-1.6.2.8.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.8.2.2">
                    <p id="section-toc.1-1.6.2.8.2.2.1"><a href="#section-6.8.2" class="xref">6.8.2</a>.  <a href="#name-deferred-credential-respons" class="xref">Deferred Credential Response</a><a href="#section-toc.1-1.6.2.8.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-pre-authorized-code-flow" class="xref">Pre-Authorized Code Flow</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-extension-parameters-for-in" class="xref">Extension Parameters for Initiate Issuance Request</a><a href="#section-toc.1-1.7.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-extension-parameters-for-to" class="xref">Extension Parameters for Token Request</a><a href="#section-toc.1-1.7.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-extension-to-the-token-resp" class="xref">Extension to the token response</a><a href="#section-toc.1-1.7.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-replay-prevention" class="xref">Replay Prevention</a><a href="#section-toc.1-1.7.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="xref">7.5</a>.  <a href="#name-pin-code-phishing" class="xref">PIN Code Phishing</a><a href="#section-toc.1-1.7.2.5.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-implementation-consideratio" class="xref">Implementation Considerations</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-claim-based-binding-of-the-" class="xref">Claim-based Binding of the Credential to the End-User possessing the credential</a><a href="#section-toc.1-1.9.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-binding-of-the-credential-w" class="xref">Binding of the Credential without Cryptographic Binding nor Claim-based Binding</a><a href="#section-toc.1-1.9.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-privacy-considerations" class="xref">Privacy Considerations</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-appendix.b" class="xref">Appendix B</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.14.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-appendix.c" class="xref">Appendix C</a>.  <a href="#name-notices" class="xref">Notices</a><a href="#section-toc.1-1.15.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-appendix.d" class="xref">Appendix D</a>.  <a href="#name-document-history" class="xref">Document History</a><a href="#section-toc.1-1.16.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-appendix.e" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.17.1" class="pilcrow">¶</a></p>
</li>
</ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This specification defines an API designated as Credential Endpoint and corresponding OAuth-based authorization mechanisms for issuance of verifiable credentials, e.g., in the form of W3C Verifiable Credentials. This allows existing OAuth deployments and OpenID Connect OPs to extend their service and become credential issuers. It also allows new applications built using Verifiable Credentials to utilize OAuth and OpenID Connect as integration and interoperability layer.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">OpenID Connect would be an obvious choice for this use case since it already allows Relying Parties to request identity assertions. However, early implementation experience suggests adoption is made easier if the base protocol only focuses on the credential issuance, without mandating certain <span>[<a href="#OpenID.Core" class="xref">OpenID.Core</a>]</span> features, such as asserting a stable <code>sub</code> values. Thus the working group decided to use OAuth as a base protocol. Deployments can nevertheless provide a combined implementation of OpenID Connect and the Credential Endpoint since OpenID Connect is built on top of OAuth.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Verifiable Credentials are very similar to identity assertions in that they allow an Issuer to assert End-User claims. However, in contrast to the identity assertions, a verifiable credential follows a pre-defined schema (the credential type) and is bound to key material allowing the End-User to prove the legitimate possession of the credential. This allows direct presentation of the credential from the End-User to the RP, without involvement of the credential issuer. This specification caters for those differences.<a href="#section-1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">Credential<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">A set of one or more claims made by an issuer (see <span>[<a href="#VC_DATA" class="xref">VC_DATA</a>]</span>). Note that this definition differs from that in <span>[<a href="#OpenID.Core" class="xref">OpenID.Core</a>]</span>.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">Verifiable Credential (VC)<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">A verifiable credential is a tamper-evident credential that has authorship that can be cryptographically verified. Verifiable credentials can be used to build verifiable presentations, which can also be cryptographically verified (see <span>[<a href="#VC_DATA" class="xref">VC_DATA</a>]</span>).<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">Presentation<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">Data derived from one or more verifiable credentials, issued by one or more issuers, that is shared with a specific verifier (see <span>[<a href="#VC_DATA" class="xref">VC_DATA</a>]</span>).<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7">Verified Presentation (VP)<a href="#section-2-7" class="pilcrow">¶</a></p>
<p id="section-2-8">A verifiable presentation is a tamper-evident presentation encoded in such a way that authorship of the data can be trusted after a process of cryptographic verification. Certain types of verifiable presentations might contain data that is synthesized from, but do not contain, the original verifiable credentials (for example, zero-knowledge proofs) (see <span>[<a href="#VC_DATA" class="xref">VC_DATA</a>]</span>).<a href="#section-2-8" class="pilcrow">¶</a></p>
<p id="section-2-9">W3C Verifiable Credential Objects<a href="#section-2-9" class="pilcrow">¶</a></p>
<p id="section-2-10">Both verifiable credentials and verifiable presentations<a href="#section-2-10" class="pilcrow">¶</a></p>
<p id="section-2-11">Credential Manifests<a href="#section-2-11" class="pilcrow">¶</a></p>
<p id="section-2-12">A resource format that defines preconditional requirements, Issuer style preferences, and other facets User Agents utilize to help articulate and select the inputs necessary for processing and issuance of a specified credential (see <span>[<a href="#DIF.CredentialManifest" class="xref">DIF.CredentialManifest</a>]</span>).<a href="#section-2-12" class="pilcrow">¶</a></p>
<p id="section-2-13">Deferred Credential Issuance<a href="#section-2-13" class="pilcrow">¶</a></p>
<p id="section-2-14">Issuance of credentials not directly in the response to a credential issuance request, but following a period of time that can be used to perform certain offline business processes.<a href="#section-2-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-cases">
<section id="section-3">
      <h2 id="name-use-cases">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-use-cases" class="section-name selfRef">Use Cases</a>
      </h2>
<div id="end-user-initiated-credential-issuance">
<section id="section-3.1">
        <h3 id="name-end-user-initiated-credenti">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-end-user-initiated-credenti" class="section-name selfRef">End-User Initiated Credential Issuance</a>
        </h3>
<p id="section-3.1-1">A user comes across an app where she needs to present a credential, e.g., a bank identity credential. She starts the presentation flow at this app and is sent to her wallet (e.g., via Self-Issued OpenID Provider v2 and OpenID Connect for Verifiable Presentations). The wallet determines the desired credential type(s) from the request and notifies the user that there is currently no matching credential in the wallet. The wallet now offers the user a list of suitable issuers, which might be based on an issuer list curated by the wallet publisher. The user picks one of those issuers and is sent to the issuer's user experience (web site or app). There the user authenticates and is asked for consent to issue the required credential into her wallet. She consents and is sent back to the wallet, where she is informed that a credential was successfully created and stored in the wallet.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="end-user-initiated-credential-issuance-with-on-demand-credential-presentation">
<section id="section-3.2">
        <h3 id="name-end-user-initiated-credentia">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-end-user-initiated-credentia" class="section-name selfRef">End-User Initiated Credential Issuance (with On-Demand Credential Presentation)</a>
        </h3>
<p id="section-3.2-1">A user comes across an app where she needs to present a credential, e.g., a university diploma. She starts the presentation flow at this app and is sent to her wallet (e.g., via Self-Issued OpenID Provider v2 and OpenID Connect for Verifiable Presentations). The wallet determines the desired credential type(s) from the request and notifies the user that there is currently no matching credential in the wallet. The wallet now offers the user a list of suitable issuers, which might be based on an issuer list curated by the wallet publisher. The user picks one of those issuers (her university). The user confirms and is sent to the issuer's user experience (web site or app). The user logs in to the university, which determines that the respective user account is not verified yet. The user is offered to either use a video chat for identification or to fetch a suitable identity credential from her wallet. The user decides to fetch the necessary credential from her wallet and is sent back. In the wallet, she picks a suitable credential and authorizes transfer to the university. The wallet sends her back to the university. Based on the bank identity credential, the university verifies her identity and looks up her data in its database. The university finds her diploma and offers to issue a verifiable credential. The user consents and is sent back to the wallet, where she is informed that a diploma verifiable credential was successfully created and stored in the wallet.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuer-initiated-credential-issuance">
<section id="section-3.3">
        <h3 id="name-issuer-initiated-credential">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-issuer-initiated-credential" class="section-name selfRef">Issuer-Initiated Credential Issuance</a>
        </h3>
<p id="section-3.3-1">The user browses her university's home page, searching for a way to obtain a digital diploma. She finds the respective page, which shows a link "request your digital diploma". She clicks on this link and is being sent to her digital wallet. The wallet notifies her that an issuer offered to issue a diploma credential. She confirms this inquiry and is being sent to the university's credential issuance service. She logs in with her university login and is being asked to consent to the creation of a digital diploma. She confirms and is sent back to her wallet. There, she is notified of the successful creation of the digital diploma.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuer-initiated-credential-issuance-cross-device-credential-retrieval-only">
<section id="section-3.4">
        <h3 id="name-issuer-initiated-credential-">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-issuer-initiated-credential-" class="section-name selfRef">Issuer-Initiated Credential Issuance (Cross-Device / Credential Retrieval Only)</a>
        </h3>
<p id="section-3.4-1">The user visits the administration office of her university to obtain a digital diploma. The university staff checks her student card and looks up her university diploma in the university's IT system. The office staff then starts the issuance process. The user is asked to scan a QR Code to retrieve the digital diploma. She scans the code with her smartphone, which automatically starts her wallet, where she is notified of the offer to create a digital diploma (the verifiable credential). She consents, which causes the wallet to obtain and store the verifiable credential.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuer-initiated-credential-issuance-with-information-pre-submitted-by-the-end-user">
<section id="section-3.5">
        <h3 id="name-issuer-initiated-credential-i">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-issuer-initiated-credential-i" class="section-name selfRef">Issuer-Initiated Credential Issuance (with information pre-submitted by the End-User)</a>
        </h3>
<p id="section-3.5-1">The user navigates to her university's webpage to obtain a digital diploma where she is asked to scan a QR Code to start the retrieval process. She scans the code with her smartphone, which automatically starts her wallet, where she is notified of the prerequisite to enter a PIN code for security reasons. This code was sent as a text message to her smartphone in the meantime. She enters the PIN and confirms the credential issuance, which causes the wallet to obtain and store the verifiable credential.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="deferred-credential-issuance">
<section id="section-3.6">
        <h3 id="name-deferred-credential-issuanc">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-deferred-credential-issuanc" class="section-name selfRef">Deferred Credential Issuance</a>
        </h3>
<p id="section-3.6-1">The user wants to obtain a digital criminal record certificate. She starts the journey in her wallet and is sent to the issuer service of the responsible government authority. She logs in with her eID and requests the issuance of the certificate. She is notified that the issuance of the certificate will take a couple of days due to necessary background checks by the authority. She confirms and is sent back to the wallet. The wallet shows a hint in the credential list indicating that issuance of the digital criminal record certificate is under way. A few days later, she receives a notification from her wallet app telling her that the certificate was successfully issued. She opens her wallet, where she is asked after startup whether she wants to download the certificate. She confirms and the new credential is retrieved and stored in her wallet.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="requirements">
<section id="section-4">
      <h2 id="name-requirements">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-requirements" class="section-name selfRef">Requirements</a>
      </h2>
<p id="section-4-1">This section describes the requirements this specification aims to fulfill beyond the use cases described above.<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4-2.1">
          <p id="section-4-2.1.1">Proof of possession of key material<a href="#section-4-2.1.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4-2.1.2.1">
              <p id="section-4-2.1.2.1.1">Support all kinds of proofs (e.g., signatures, blinded proofs) but also issuance w/o proof<a href="#section-4-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-4-2.1.2.2">
              <p id="section-4-2.1.2.2.1">The proof mechanisms shall be complementary to OAuth/OpenID Connect mechanisms for request signatures, client authentication, and PoP to allow for its parallel usage.<a href="#section-4-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li id="section-4-2.2">
          <p id="section-4-2.2.1">It shall be possible to request a single credential as well to request multiple credentials in the same request. Examples of the latter include:<a href="#section-4-2.2.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4-2.2.2.1">
              <p id="section-4-2.2.2.1.1">credentials containing different claims for the same user (micro/mono credentials) bound to the same key material<a href="#section-4-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-4-2.2.2.2">
              <p id="section-4-2.2.2.2.1">batch issuance of multiple credentials of the same type bound to different key material (see mDL)<a href="#section-4-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li id="section-4-2.3">
          <p id="section-4-2.3.1">It shall be possible to issue multiple credentials based on same consent (e.g., different formats and/or keys - <code>did:key</code> followed by <code>did:ebsi</code>)<a href="#section-4-2.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-4-2.4">
          <p id="section-4-2.4.1">Support for deferred issuance of credentials<a href="#section-4-2.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-4-2.5">
          <p id="section-4-2.5.1">User authentication and identification<a href="#section-4-2.5.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4-2.5.2.1">
              <p id="section-4-2.5.2.1.1">Issuer shall be able to dynamically obtain further data and be able to authenticate the user at their discretion<a href="#section-4-2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-4-2.5.2.2">
              <p id="section-4-2.5.2.2.1">Application used by the End-User shall be able to pass existing credentials (as presentations) or identity assertions to the issuance flow<a href="#section-4-2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-4-2.5.2.3">
              <p id="section-4-2.5.2.3.1">Assisted flow (utilizing credential manifest)<a href="#section-4-2.5.2.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-4-2.5.2.4">
              <p id="section-4-2.5.2.4.1">Presentations/assertions must be protected against replay<a href="#section-4-2.5.2.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li id="section-4-2.6">
          <p id="section-4-2.6.1">It shall be possible to request standard OpenID Connect claims and credentials in the same flow (to implement wallet onboarding, see EBSI/ESSIF onboarding)<a href="#section-4-2.6.1" class="pilcrow">¶</a></p>
</li>
<li id="section-4-2.7">
          <p id="section-4-2.7.1">Support for Credential metadata (Application used by the End-User shall be able to determine the types of credentials an issuer is able to issue)<a href="#section-4-2.7.1" class="pilcrow">¶</a></p>
</li>
<li id="section-4-2.8">
          <p id="section-4-2.8.1">Ensure OAuth 2.0 Authorization Server is authoritative for respective credential issuer (OP (OpenID Connect issuer URL) &lt;-&gt; Issuer ID (DID))<a href="#section-4-2.8.1" class="pilcrow">¶</a></p>
</li>
<li id="section-4-2.9">
          <p id="section-4-2.9.1">Incorporate/utilize existing specs<a href="#section-4-2.9.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4-2.9.2.1">
              <p id="section-4-2.9.2.1.1">W3C VC HTTP API(?)<a href="#section-4-2.9.2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-4-2.9.2.2">
              <p id="section-4-2.9.2.2.1">DIF Credential manifest(?)<a href="#section-4-2.9.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
</ul>
</section>
</div>
<div id="overview">
<section id="section-5">
      <h2 id="name-overview">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-5-1">This specification defines the following mechanisms to allow wallet applications (acting as OAuth and Credential Issuance API clients) used by the End-User to request credential issuers (acting as OAuth Authorization Servers and Credential Issuance API providers) to issue Verifiable Credentials via the Credential Issuance API:<a href="#section-5-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-5-2.1">
          <p id="section-5-2.1.1">An optional mechanism to pre-obtain a Credential Manifest<a href="#section-5-2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-5-2.2">
          <p id="section-5-2.2.1">An extended authorization request syntax that allows to request credential types to be issued<a href="#section-5-2.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-5-2.3">
          <p id="section-5-2.3.1">Ability to bind an issued credential to a proof submitted by the Client<a href="#section-5-2.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-5-2.4">
          <p id="section-5-2.4.1">A newly defined Credential Endpoint from which credentials can be issued one at a time<a href="#section-5-2.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-5-2.5">
          <p id="section-5-2.5.1">A mechanism that allows issuance of multiple credentials of same or different type  (<code>c_nonce</code>)<a href="#section-5-2.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-5-2.6">
          <p id="section-5-2.6.1">A mechanism for the Deferred Credential Issuance (<code>acceptance_token</code>)<a href="#section-5-2.6.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-5-3">The following figure shows the overall flow.<a href="#section-5-3" class="pilcrow">¶</a></p>
<span id="name-overall-credential-issuance"></span><figure id="figure-1">
        <div id="section-5-4.1">
<pre class="sourcecode lang-ascii-art">+--------------+   +-----------+                                         +-------------+
| User         |   |   Wallet  |                                         |   Issuer    |
+--------------+   +-----------+                                         +-------------+
        |                |             interact                                 |
        |----------------------------------------------------------------------&gt;|
        |                |          (1) initiate issuance                       |
        |                |&lt;-----------------------------------------------------|
        |    interacts   |                                                      |
        |---------------&gt;|                                                      |
        |                |  (2) [opt] obtain credential manifest                |
        |                |-----------------------------------------------------&gt;|
        |                |              credential manifest                     |
        |                |&lt;-----------------------------------------------------|
        |                |                                                      |
        |                |  (4) authorization req (claims, [opt] input, etc. )  |
        |                |-----------------------------------------------------&gt;|
        |                |                                                      |
        |     (4.1) User Login                                                  |
        |                |                                                      |
        |                |  (4.2) [opt] request additional VCs (OIDC4VP)        |
        |                |&lt;-----------------------------------------------------|
        |                |                                                      |
    (4.2.1) [opt] User selects credentials                                      |
        |                |                                                      |
        |                |  (4.2.2) VCs in Verifiable Presentations             |
        |                |-----------------------------------------------------&gt;|
        |                |                                                      |
        |   (4.3) User consents to credential issuance                          |
        |                |                                                      |
        |                |  (5) authorization res (code)                        |
        |                |&lt;-----------------------------------------------------|
        |                |                                                      |
        |                |  (6) token req (code)                                |
        |                |-----------------------------------------------------&gt;|
        |                |      access_token, id_token                          |
        |                |&lt;-----------------------------------------------------|
        |                |                                                      |
        |                |  (7) credential req (access_token, proofs, ...)      |
        |                |-----------------------------------------------------&gt;|
        |                |      credential req (credentials OR acceptance_token)|
        |                |&lt;-----------------------------------------------------|
        |                |                                                      |
        |                |  (8) [opt] poll_credentials (acceptance_token)       |
        |                |-----------------------------------------------------&gt;|
        |                |      credentials OR not_ready_yet                    |
        |                |&lt;-----------------------------------------------------|
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-overall-credential-issuance" class="selfRef">Overall Credential Issuance Flow</a>
        </figcaption></figure>
<p id="section-5-5">This flow is based on OAuth and the code grant type. Use with other grant types, such as CIBA, will be possible as well.<a href="#section-5-5" class="pilcrow">¶</a></p>
<p id="section-5-6">The starting point is an interaction of the user with her wallet. The user might, for example,<a href="#section-5-6" class="pilcrow">¶</a></p>
<ul>
<li id="section-5-7.1">
          <p id="section-5-7.1.1">want to present a credential and found out there is no suitable credential present in her wallet or<a href="#section-5-7.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-5-7.2">
          <p id="section-5-7.2.1">have visited the web site of a Credential Issuer and wants to obtain a credential from that issuer.<a href="#section-5-7.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-5-8">(1) (OPTIONAL) The issuer sends a request to the wallet to initiate the issuance flow. This request contains information about the
credential(s) the End-User wants to obtain from that issuer, e.g., in the form of credential manifest IDs or credential types, and
further data, e.g., hints about the user when the user is already logged in with the Issuer.<a href="#section-5-8" class="pilcrow">¶</a></p>
<p id="section-5-9">(2) (OPTIONAL) obtain credential manifest (as defined in <span>[<a href="#DIF.CredentialManifest" class="xref">DIF.CredentialManifest</a>]</span>) from the issuer with an information of which Verifiable Credentials the Issuer can issue, and optionally what kind of input from the user the Issuer requires to issue that credential.<a href="#section-5-9" class="pilcrow">¶</a></p>
<p id="section-5-10">Note: The wallet MAY also obtain the information about the credential issuer's capabilities using other means, which is out of scope of this specification.<a href="#section-5-10" class="pilcrow">¶</a></p>
<p id="section-5-11">(4) In this step, the wallet sends an authorization request to the issuer. This request determines
the types of verifiable credentials the wallet (on behalf of the user) wants to obtain.<a href="#section-5-11" class="pilcrow">¶</a></p>
<p id="section-5-12">The wallet SHOULD use a pushed authorization request (see <span>[<a href="#RFC9126" class="xref">RFC9126</a>]</span>) to first send the payload of
the authorization request to the issuer and subsequently use the <code>request_uri</code> returned by the issuer in the authorization
request. This ensures integrity and confidentiality of the request data and prevents any issues raised by URL length restrictions
regarding the authorization request URL.<a href="#section-5-12" class="pilcrow">¶</a></p>
<p id="section-5-13">Note: Signed and encrypted request objects would also ensure integrity and confidentiality. However, this approach would further
increase the URL size, which might decrease robustness of the process.<a href="#section-5-13" class="pilcrow">¶</a></p>
<p id="section-5-14">The issuer takes over user interface control at this point and interacts with the user. The implementation of
this step is at the discretion of the issuer.<a href="#section-5-14" class="pilcrow">¶</a></p>
<p id="section-5-15">(4.1)  The issuer will typically authenticate the user in the first step of this process. For this purpose,
the issuer might use a local or federated login, potentially informed by an <code>id_token_hint</code> (see <span>[<a href="#OpenID.Core" class="xref">OpenID.Core</a>]</span>).<a href="#section-5-15" class="pilcrow">¶</a></p>
<p id="section-5-16">(4.2) (OPTIONAL) The issuers MAY call back to the wallet to fetch verifiable credentials it needs as
prerequisite to issuing the requested credentials. The decision of what credentials are requested may depend
on the user identity determined in step 4.1.<a href="#section-5-16" class="pilcrow">¶</a></p>
<p id="section-5-17">From a protocol perspective, the issuers acts now as verifier and sends a request as defined in OpenID Connect for Verifiable Presentations
<span>[<a href="#OIDC4VP" class="xref">OIDC4VP</a>]</span> to the wallet.<a href="#section-5-17" class="pilcrow">¶</a></p>
<p id="section-5-18">(4.2.1) (CONDITIONAL) The wallet shows the content of the presentation request to the user. The user selects the
appropriate credentials and consents.<a href="#section-5-18" class="pilcrow">¶</a></p>
<p id="section-5-19">(4.2.2) (CONDITIONAL) The wallet responds with one or more verifiable presentations to the issuer.<a href="#section-5-19" class="pilcrow">¶</a></p>
<p id="section-5-20">(4.3) The issuer asks the user for consent to issue the requested credentials.<a href="#section-5-20" class="pilcrow">¶</a></p>
<p id="section-5-21">(5) The issuer responds with an authorization code to the wallet.<a href="#section-5-21" class="pilcrow">¶</a></p>
<p id="section-5-22">(6) The wallet exchanges the authorization code for an Access Token and an ID Token.<a href="#section-5-22" class="pilcrow">¶</a></p>
<p id="section-5-23">(7) This Access Token is used to request the issuance of the actual credentials. The types of credentials the
wallet can request is limited to the types approved in the authorization request in (5). The credential request
passes the key material the respective credential shall be bound to. If required by the issuer, the wallet also passes a
proof of possession for the key material. This proof of possession uses the SHA-256 hash of the Access Token
as cryptographic nonce. This ensures replay protection of the proofs. The format of key material and proof of
possession depends upon the proof scheme and is expressed in a polymorphic manner at the protocol level.<a href="#section-5-23" class="pilcrow">¶</a></p>
<p id="section-5-24">The Issuer will either directly respond with the credentials or issue an Acceptance Token, which
is used by the wallet to poll for completion of the issuance process.<a href="#section-5-24" class="pilcrow">¶</a></p>
<p id="section-5-25">(8) (OPTIONAL) The wallet polls the issuer to obtain the credentials previously requested in
step (6). The issuer either responds with the credentials or HTTP status code "202" indicating
that the issuance is not completed yet.<a href="#section-5-25" class="pilcrow">¶</a></p>
<p id="section-5-26">Note: If the issuer just wants to offer the user to retrieve a pre-existing credential, it can
encode the parameter set of step (6) in a suitable representation and allow the wallet to start
with step (6). One option would be to encode the data into a QR Code.<a href="#section-5-26" class="pilcrow">¶</a></p>
</section>
</div>
<div id="endpoints">
<section id="section-6">
      <h2 id="name-endpoints">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-endpoints" class="section-name selfRef">Endpoints</a>
      </h2>
<div id="overview-1">
<section id="section-6.1">
        <h3 id="name-overview-2">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-overview-2" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-6.1-1">This specification defines new endpoints as well as additional parameters to existing OAuth endpoints required to implement the protocol outlined in the previous section. It also introduces a new authorization details type according to <span>[<a href="#I-D.ietf-oauth-rar" class="xref">I-D.ietf-oauth-rar</a>]</span> to convey the details about the credentials the wallet wants to obtain. Aspects not defined in this specification are expected to follow <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span>. it is RECOMMENDED to use PKCE as defined in <span>[<a href="#RFC7636" class="xref">RFC7636</a>]</span> to prevent authorization code interception attacks.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">There are the following new endpoints:<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.1-3.1">
            <p id="section-6.1-3.1.1">Issuance Initiation Endpoint: An endpoint exposed by the wallet that allows an issuer to initiate the issuance flow<a href="#section-6.1-3.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.1-3.2">
            <p id="section-6.1-3.2.1">Credential Endpoint: this is the OAuth-protected API to issue verifiable credentials<a href="#section-6.1-3.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.1-3.3">
            <p id="section-6.1-3.3.1">Deferred Credential Endpoint: this endpoint is used for deferred issuance of verifiable credentials<a href="#section-6.1-3.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-6.1-4">The following endpoints are extended:<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.1-5.1">
            <p id="section-6.1-5.1.1">Client Metadata: new metadata parameter is added to allow a wallet (acting as OAuth client) to publish its issuance initiation endpoint.<a href="#section-6.1-5.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.1-5.2">
            <p id="section-6.1-5.2.1">Server Metadata: New metadata parameters are added to allow the client to determine what types of verifiable credentials a particular OAuth 2.0 Authorization Server is able to issue along with additional information about formats and prerequisites.<a href="#section-6.1-5.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.1-5.3">
            <p id="section-6.1-5.3.1">Authorization Endpoint: The <code>authorization_details</code> parameter is extended to allow clients to specify types of the credentials when requesting authorization for issuance. These extension can also be used via the Pushed Authorization Endpoint, which is recommended by this specification.<a href="#section-6.1-5.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.1-5.4">
            <p id="section-6.1-5.4.1">Token Endpoint: optional parameters are added to the token endpoint to provide the client with a nonce to be used for proof of possession of key material in a subsequent request to the credential endpoint.<a href="#section-6.1-5.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
</section>
</div>
<div id="client-metadata">
<section id="section-6.2">
        <h3 id="name-client-metadata">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-client-metadata" class="section-name selfRef">Client Metadata</a>
        </h3>
<p id="section-6.2-1">This specification defines the following new Client Metadata parameter in addition to <span>[<a href="#RFC7591" class="xref">RFC7591</a>]</span> for wallets acting as OAuth client:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.2-2.1">
            <p id="section-6.2-2.1.1"><code>initiate_issuance_endpoint</code>: OPTIONAL. URL of the issuance initation endpoint of a wallet.<a href="#section-6.2-2.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-6.2-3">If the issuer is unable to perform discovery of the Issuance Initiation Endpoint URL, the following static URL is used: <code>openid_initiate_issuance:</code>.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-metadata">
<section id="section-6.3">
        <h3 id="name-server-metadata">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-server-metadata" class="section-name selfRef">Server Metadata</a>
        </h3>
<p id="section-6.3-1">The server metadata <span>[<a href="#RFC8414" class="xref">RFC8414</a>]</span> is extended to allow the client to obtain information about the verifiable credentials an Issuer supports. This extension uses <span>[<a href="#DIF.CredentialManifest" class="xref">DIF.CredentialManifest</a>]</span>.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">This specification defines the following new Server Metadata parameter for this purpose:<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.3-3.1">
            <p id="section-6.3-3.1.1"><code>credential_manifests</code>: OPTIONAL. A JSON array containing a list of Credential Manifests. This parameter enables Issuers to pass Credential Manifests in a single self-contained parameter.<a href="#section-6.3-3.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.3-3.2">
            <p id="section-6.3-3.2.1"><code>credential_manifest_uris</code>: OPTIONAL. A JSON array containing a list of URIs referencing resources each containing a Credential Manifest. This parameter enables Issuers to list Credential Manifests by reference, rather than by value. The scheme used MUST be https.<a href="#section-6.3-3.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-6.3-4">The following example shows an OpenID Configuration containing an embedded credential manifest.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.3-5">
<pre>  HTTP/1.1 200 OK
  Content-Type: application/json

 {
   "issuer":"https://server.example.com",
   "authorization_endpoint":"https://server.example.com/connect/authorize",
   "token_endpoint":"https://server.example.com/connect/token",
   ...
   "credential_manifests":[
      {
         "id":"WA-DL-CLASS-A",
         "version":"0.1.0",
         "issuer":{
            "id":"did:example:123?linked-domains=3",
            "name":"Washington State Government"
          },
         "output_descriptors":[
            {
               "schema":"http://washington-state-schemas.org/1.0.0/driver-license.json",
               "id": "output descriptor 1"
            }
         ],
         "presentation_definition":{}
     }
   ]
  }
</pre><a href="#section-6.3-5" class="pilcrow">¶</a>
</div>
<p id="section-6.3-6">Note: The Client MAY use other mechanisms to obtain information about the verifiable credentials that an Issuer can issue.<a href="#section-6.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuance-initiation-endpoint">
<section id="section-6.4">
        <h3 id="name-issuance-initiation-endpoin">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-issuance-initiation-endpoin" class="section-name selfRef">Issuance Initiation Endpoint</a>
        </h3>
<p id="section-6.4-1">This endpoint is used by an issuer in case it is already in an interaction with a user that wishes to initate a credential issuance. It is used to pass available
information relevant for the credential issuance to ensure a convenient and secure process.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<div id="issuance_initiation_request">
<section id="section-6.4.1">
          <h4 id="name-issuance-initiation-request">
<a href="#section-6.4.1" class="section-number selfRef">6.4.1. </a><a href="#name-issuance-initiation-request" class="section-name selfRef">Issuance Initiation Request</a>
          </h4>
<p id="section-6.4.1-1">The issuer (or any other party wishing to kickstart an issuance into a certain wallet) sends the request as a HTTP GET request or a HTTP redirect to the Issuance Initiation Endpoint URL.<a href="#section-6.4.1-1" class="pilcrow">¶</a></p>
<p id="section-6.4.1-2">The following request parameters are defined:<a href="#section-6.4.1-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.4.1-3.1">
              <p id="section-6.4.1-3.1.1"><code>issuer</code>: REQUIRED. The issuer URL of the credential issuer, the wallet is requested to obtain one or more credentials from.<a href="#section-6.4.1-3.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.4.1-3.2">
              <p id="section-6.4.1-3.2.1"><code>credential_type</code>: CONDITIONAL. A JSON string denoting the type of the credential the wallet shall request. MUST be present if <code>manifest_id</code> is not present.<a href="#section-6.4.1-3.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.4.1-3.3">
              <p id="section-6.4.1-3.3.1"><code>manifest_id</code>: CONDITIONAL. A JSON String  refering to a credential manifests published by the credential issuer. MUST be present if <code>credential_type</code> is not present.<a href="#section-6.4.1-3.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.4.1-3.4">
              <p id="section-6.4.1-3.4.1"><code>op_state</code>: OPTIONAL. String value created by the Credential Issuer and opaque to the wallet that is used to bind the sub-sequent authentication request with the Credential Issuer to a context set up during previous steps. If the client receives a value for this parameter, it MUST include it in the subsequent Authentication Request to the Credential Issuer as the <code>op_state</code> parameter value.<br><a href="#section-6.4.1-3.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-6.4.1-4">The following is a non-normative example:<a href="#section-6.4.1-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.4.1-5">
<pre>  GET /initiate_issuance?
    issuer=https%3A%2F%2Fserver%2Eexample%2Ecom
    &amp;credential_type=https%3A%2F%2Fdid%2Eexample%2Eorg%2FhealthCard
    &amp;op_state=eyJhbGciOiJSU0Et...FYUaBy
</pre><a href="#section-6.4.1-5" class="pilcrow">¶</a>
</div>
<p id="section-6.4.1-6">The issuer MAY also render a QR code containing the request data in order to allow the user to scan the request using her wallet app.<a href="#section-6.4.1-6" class="pilcrow">¶</a></p>
<p id="section-6.4.1-7">The wallet MUST consider the parameter values in the initiation request as not trustworthy since the origin is not authenticated and the message
integrity is not protected. The Wallet MUST apply the same checks on the issuer that it would apply when the flow is started from the Wallet itself since the issuer is not trustworthy just because it sent the initiation request. An attacker might attempt to use an initation request to conduct a phishing or injection attack.<a href="#section-6.4.1-7" class="pilcrow">¶</a></p>
<p id="section-6.4.1-8">The wallet MUST NOT accept credentials just because this mechanism was used. All protocol steps defined in this draft MUST be performed in the same way as if
the wallet would have started the flow.<a href="#section-6.4.1-8" class="pilcrow">¶</a></p>
<p id="section-6.4.1-9">The wallet MUST be able to process multiple occurences of the URL query parameters <code>credential_type</code> and/or <code>manifest_id</code>. Multiple occurences MUST be
treated as multiple values of the respective parameter.<a href="#section-6.4.1-9" class="pilcrow">¶</a></p>
<p id="section-6.4.1-10">The AS MUST ensure the release of any privacy-sensitive data is legally based (e.g., if passing an e-mail address in the <code>login_hint</code> parameter).<a href="#section-6.4.1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuance-initiation-response">
<section id="section-6.4.2">
          <h4 id="name-issuance-initiation-respons">
<a href="#section-6.4.2" class="section-number selfRef">6.4.2. </a><a href="#name-issuance-initiation-respons" class="section-name selfRef">Issuance Initiation Response</a>
          </h4>
<p id="section-6.4.2-1">The wallet is not supposed to create a response. UX control stays with the wallet after completion of the process.<a href="#section-6.4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="authorization-endpoint">
<section id="section-6.5">
        <h3 id="name-authorization-endpoint">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-authorization-endpoint" class="section-name selfRef">Authorization Endpoint</a>
        </h3>
<p id="section-6.5-1">The Authorization Endpoint is used in the same manner as defined in <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span> taking into account the recommendations given in <span>[<a href="#I-D.ietf-oauth-security-topics" class="xref">I-D.ietf-oauth-security-topics</a>]</span> and utilizes <span>[<a href="#I-D.ietf-oauth-rar" class="xref">I-D.ietf-oauth-rar</a>]</span>.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">In addition to the required basic Authorization Request, this section also defines how pushed authorization requests can be used to protect the authorization request payload and when the requests become large.<a href="#section-6.5-2" class="pilcrow">¶</a></p>
<div id="authorization-details">
<section id="section-6.5.1">
          <h4 id="name-authorization_details-reque">
<a href="#section-6.5.1" class="section-number selfRef">6.5.1. </a><a href="#name-authorization_details-reque" class="section-name selfRef"><code>authorization_details</code> Request Parameter</a>
          </h4>
<p id="section-6.5.1-1">Request parameter <code>authorization_type</code> defined in Section 2 of <span>[<a href="#I-D.ietf-oauth-rar" class="xref">I-D.ietf-oauth-rar</a>]</span> MUST be used to convey the details about the credentials the wallet wants to obtain. This specification introduces a new authorization details type <code>openid_credential</code> and defines the following elements to be used with this authorization details type:<a href="#section-6.5.1-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.5.1-2.1">
              <p id="section-6.5.1-2.1.1"><code>type</code> REQUIRED. JSON string that determines the authorization details type. MUST be set to <code>openid_credential</code> for the purpose of this specification.<a href="#section-6.5.1-2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.5.1-2.2">
              <p id="section-6.5.1-2.2.1"><code>credential_type</code>: CONDITIONAL. JSON string denoting the type of the requested credential. MUST be present if <code>manifest_id</code> is not present.<a href="#section-6.5.1-2.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.5.1-2.3">
              <p id="section-6.5.1-2.3.1"><code>manifest_id</code>: CONDITIONAL. JSON String referring to a credential manifest published by the credential issuer. MUST be present if <code>type</code> is not present.<a href="#section-6.5.1-2.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.5.1-2.4">
              <p id="section-6.5.1-2.4.1"><code>format</code>: OPTIONAL. JSON string representing a format in which the credential is requested to be issued. Valid values defined by this specification are <code>jwt_vc</code> and <code>ldp_vc</code>. Profiles of this specification MAY define additional format values.<a href="#section-6.5.1-2.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.5.1-2.5">
              <p id="section-6.5.1-2.5.1"><code>locations</code>: OPTIONAL. An array of strings that allows a client to specify the location of the resource server(s) allowing the AS to mint audience restricted access tokens. This data field is predefined in Section 2.2 of (<span>[<a href="#I-D.ietf-oauth-rar" class="xref">I-D.ietf-oauth-rar</a>]</span>).<a href="#section-6.5.1-2.5.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-6.5.1-3">Note: <code>credential_type</code> and <code>format</code> are used when the Client has not pre-obtained a Credential Manifest. <code>manifest_id</code> is used when the Client has pre-obtained a Credential Manifest. These two approaches MAY be combined in one request in different authorization details objects.<a href="#section-6.5.1-3" class="pilcrow">¶</a></p>
<p id="section-6.5.1-4">Note: The <code>credential_application</code> element defined in <span>[<a href="#DIF.CredentialManifest" class="xref">DIF.CredentialManifest</a>]</span> is not required by this specification.<a href="#section-6.5.1-4" class="pilcrow">¶</a></p>
<p id="section-6.5.1-5">Note: Passing the <code>format</code> to the authorization request is informational and allows the credential issuer to refuse early in case it does not support the requested format/credential combination. The client MAY request issuance of credentials in other formats as well later in the process at the credential endpoint.<a href="#section-6.5.1-5" class="pilcrow">¶</a></p>
<p id="section-6.5.1-6">[TBD: <code>locations</code> could enable a single authorization server to authorize access to different credential endpoints. Might be an architectural option we want to pursue.]<a href="#section-6.5.1-6" class="pilcrow">¶</a></p>
<p id="section-6.5.1-7">A non-normative example of an <code>authorization_details</code> object.<a href="#section-6.5.1-7" class="pilcrow">¶</a></p>
<div id="section-6.5.1-8">
<pre class="sourcecode lang-json=">{
   "type":"openid_credential",
   "credential_type":"https://did.example.org/healthCard",
   "format":"ldp_vc"
}
</pre><a href="#section-6.5.1-8" class="pilcrow">¶</a>
</div>
<p id="section-6.5.1-9">Note: applications MAY combine <code>openid_credential</code> with any other authorization details type in an authorization request.<a href="#section-6.5.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credential-request">
<section id="section-6.5.2">
          <h4 id="name-credential-authorization-re">
<a href="#section-6.5.2" class="section-number selfRef">6.5.2. </a><a href="#name-credential-authorization-re" class="section-name selfRef">Credential Authorization Request</a>
          </h4>
<p id="section-6.5.2-1">A credential authorization request is an OAuth Authorization request as defined in section 4.1.1 of <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span>, which requests to grant access to the credential endpoint as defined in <a href="#credential-endpoint" class="xref">Section 6.7</a>. It also follows the recommendations given in <span>[<a href="#I-D.ietf-oauth-security-topics" class="xref">I-D.ietf-oauth-security-topics</a>]</span>.<a href="#section-6.5.2-1" class="pilcrow">¶</a></p>
<p id="section-6.5.2-2">There are two possible ways to make a credential authorization request. One way is to use of the <code>authorization_details</code> request parameter as defined in <a href="#authorization-details" class="xref">Section 6.5.1</a> with one or more authorization details objects of type <code>openid_credential</code>. The other is through the use of scopes as defined in <a href="#credential-request-using-type-specific-scope" class="xref">Section 6.5.2.1</a>.<a href="#section-6.5.2-2" class="pilcrow">¶</a></p>
<p id="section-6.5.2-3">A non-normative example of a credential authorization request using the <code>authorization_details</code> parameter  (uses PKCE as defined in <span>[<a href="#RFC7636" class="xref">RFC7636</a>]</span>) (with line wraps within values for display purposes only).<a href="#section-6.5.2-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.5.2-4">
<pre>HTTP/1.1 302 Found
Location: https://server.example.com/authorize?
  response_type=code
  &amp;client_id=s6BhdRkqt3
  &amp;code_challenge=E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM
  &amp;code_challenge_method=S256
  &amp;authorization_details=%5B%7B%22type%22:%22openid_credential%22,%22credential_type
  %22:%22https://did.example.org/healthCard%22,%22format%22:%22ldp_vc%22%7D,%7B%22ty
  pe%22:%22openid_credential%22,%22credential_type%22:%22https://did.example.org/mDL
  %22%7D%5D
  &amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
</pre><a href="#section-6.5.2-4" class="pilcrow">¶</a>
</div>
<p id="section-6.5.2-5">This particiular non-normative example requests authorization to issue two different credentials:<a href="#section-6.5.2-5" class="pilcrow">¶</a></p>
<div id="section-6.5.2-6">
<pre class="sourcecode lang-json=">[
   {
      "type":"openid_credential",
      "credential_type":"https://did.example.org/healthCard",
      "format":"ldp_vc"
   },
   {
      "type":"openid_credential",
      "credential_type":"https://did.example.org/mDL"
   }
]
</pre><a href="#section-6.5.2-6" class="pilcrow">¶</a>
</div>
<p id="section-6.5.2-7">This non-normative example shows a credential authorization request which is also a OpenID Connect authentication request  (uses PKCE as defined in <span>[<a href="#RFC7636" class="xref">RFC7636</a>]</span>).<a href="#section-6.5.2-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.5.2-8">
<pre>HTTP/1.1 302 Found
Location: https://server.example.com/authorize?
  response_type=code
  &amp;client_id=s6BhdRkqt3
  &amp;code_challenge=E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM
  &amp;code_challenge_method=S256
  &amp;scope=openid%20email
  &amp;authorization_details=%5B%7B%22type%22:%22openid_credential%...7D%5D
  &amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
</pre><a href="#section-6.5.2-8" class="pilcrow">¶</a>
</div>
<div id="credential-request-using-type-specific-scope">
<section id="section-6.5.2.1">
            <h5 id="name-credential-authorization-req">
<a href="#section-6.5.2.1" class="section-number selfRef">6.5.2.1. </a><a href="#name-credential-authorization-req" class="section-name selfRef">Credential Authorization Request using Type Specific Scope</a>
            </h5>
<p id="section-6.5.2.1-1">An alternative credential request syntax to that defined in <a href="#credential-request" class="xref">Section 6.5.2</a> involves using an OAuth2 scope following the syntax defined below.<a href="#section-6.5.2.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.5.2.1-2">
<pre>openid_credential:&lt;credential-type&gt;
</pre><a href="#section-6.5.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-6.5.2.1-3">The value of <code>&lt;credential-type&gt;</code> indicates the type of credential being requested, providers who do not understand the value of this scope in a request MUST ignore it entirely. The presence of a scope following this syntax in the request MUST be interpreted by the provider as a request for access to the credential endpoint as defined in <a href="#credential-endpoint" class="xref">Section 6.7</a> for the specific credential type. Multiple occurrences of this scope MAY be present in a single request whereby each occurrence MUST be interpreted individually.<a href="#section-6.5.2.1-3" class="pilcrow">¶</a></p>
<p id="section-6.5.2.1-4">A non-normative example of a credential request scoped to a specific credential type (uses PKCE as defined in <span>[<a href="#RFC7636" class="xref">RFC7636</a>]</span>).<a href="#section-6.5.2.1-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.5.2.1-5">
<pre>HTTP/1.1 302 Found
Location: https://server.example.com/authorize?
  response_type=code
  &amp;scope=openid_credential:healthCard
  &amp;client_id=s6BhdRkqt3
  &amp;code_challenge=E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM
  &amp;code_challenge_method=S256
  &amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
</pre><a href="#section-6.5.2.1-5" class="pilcrow">¶</a>
</div>
<p id="section-6.5.2.1-6">If a scope <code>openid_credential:&lt;credential-type&gt;</code> and <code>authorization_details</code> request parameter containing object of type <code>openid_credential</code> are both present in a single request, the provider MUST interpret these individually. However, if both request the same credential type, than the Issuer MUST follow the request as given by the authorization details object.<a href="#section-6.5.2.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="additional-request-parameters">
<section id="section-6.5.2.2">
            <h5 id="name-additional-request-paramete">
<a href="#section-6.5.2.2" class="section-number selfRef">6.5.2.2. </a><a href="#name-additional-request-paramete" class="section-name selfRef">Additional Request Parameters</a>
            </h5>
<p id="section-6.5.2.2-1">This specification defines the following additional request parameters that can be supplied in any credential authorization request:<a href="#section-6.5.2.2-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.5.2.2-2.1">
                <p id="section-6.5.2.2-2.1.1"><code>wallet_issuer</code>: OPTIONAL. JSON String containing the wallet's OpenID Connect Issuer URL. The Issuer will use the discovery process as defined in <span>[<a href="#SIOPv2" class="xref">SIOPv2</a>]</span> to determine the wallet's capabilities and endpoints. RECOMMENDED in Dynamic Credential Request.<a href="#section-6.5.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.5.2.2-2.2">
                <p id="section-6.5.2.2-2.2.1"><code>user_hint</code>: OPTIONAL. JSON String containing an opaque user hint the wallet MAY use in sub-sequent callbacks to optimize the user's experience. RECOMMENDED in Dynamic Credential Request.<a href="#section-6.5.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.5.2.2-2.3">
                <p id="section-6.5.2.2-2.3.1"><code>op_state</code>: OPTIONAL. String value identifying a certain processing context at the credential issuer. A value for this parameter is typically passed in an issuance initation request from the issuer to the wallet (see (<a href="#issuance_initiation_request" class="xref">Section 6.4.1</a>). This request parameter is used to pass the <code>op_state</code> value back to the credential issuer.<a href="#section-6.5.2.2-2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-6.5.2.2-3">Note: When processing the authorization request, the issuer MUST take into account that the <code>op_state</code> is not guaranteed to originate from this issuer. It could have been injected by an attacker.<a href="#section-6.5.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pushed-authorization-request">
<section id="section-6.5.2.3">
            <h5 id="name-pushed-authorization-reques">
<a href="#section-6.5.2.3" class="section-number selfRef">6.5.2.3. </a><a href="#name-pushed-authorization-reques" class="section-name selfRef">Pushed Authorization Request</a>
            </h5>
<p id="section-6.5.2.3-1">Use of Pushed Authorization Requests is RECOMMENDED to ensure confidentiality, integrity, and authenticity of the request data and to avoid issues due to large requests due to the query language or if message level encryption is used.<a href="#section-6.5.2.3-1" class="pilcrow">¶</a></p>
<p id="section-6.5.2.3-2">Below is a non-normative example of a Pushed Authorization Request  (uses PKCE as defined in <span>[<a href="#RFC7636" class="xref">RFC7636</a>]</span>):<a href="#section-6.5.2.3-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.5.2.3-3">
<pre>POST /op/par HTTP/1.1
    Host: as.example.com
    Content-Type: application/x-www-form-urlencoded

    &amp;response_type=code
    &amp;client_id=CLIENT1234
    &amp;code_challenge=E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM
    &amp;code_challenge_method=S256
    &amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
    &amp;authorization_details=...
</pre><a href="#section-6.5.2.3-3" class="pilcrow">¶</a>
</div>
<p id="section-6.5.2.3-4">Below is a non-normative example of a <code>authorization_details</code> parameter with <code>manifest_id</code>:<a href="#section-6.5.2.3-4" class="pilcrow">¶</a></p>
<div id="section-6.5.2.3-5">
<pre class="sourcecode lang-json=">{
   "type":"openid_credential",
   "manifest_id":"WA-DL-CLASS-A",
   "format":"jwt_vc"
}
</pre><a href="#section-6.5.2.3-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="dynamic-credential-request">
<section id="section-6.5.2.4">
            <h5 id="name-dynamic-credential-request">
<a href="#section-6.5.2.4" class="section-number selfRef">6.5.2.4. </a><a href="#name-dynamic-credential-request" class="section-name selfRef">Dynamic Credential Request</a>
            </h5>
<p id="section-6.5.2.4-1">This step is OPTIONAL. After receiving an Authorization Request from the Client, the Issuer MAY use this step to obtain additional credentials from the End-User.<a href="#section-6.5.2.4-1" class="pilcrow">¶</a></p>
<p id="section-6.5.2.4-2">The Issuer MUST utilize <span>[<a href="#OIDC4VP" class="xref">OIDC4VP</a>]</span> and <span>[<a href="#SIOPv2" class="xref">SIOPv2</a>]</span> to dynamically request additional credentials. From a protocol perspective, the Issuer acts now as a verifier and sends a presentation request to the wallet. The Client MUST have these credentials obtained prior to initiating a transaction with this Issuer.<a href="#section-6.5.2.4-2" class="pilcrow">¶</a></p>
<p id="section-6.5.2.4-3">This provides the benefit of the Issuer being able to adhere to the principle of data minimization, for example by including only minimum requirements in the Credential Manifest knowing that it can supplement additional information if needed.<a href="#section-6.5.2.4-3" class="pilcrow">¶</a></p>
<p id="section-6.5.2.4-4">To enable dynamic callbacks of the issuer to the end-user's wallet, the wallet MAY provide additional parameters <code>wallet_issuer</code> and <code>user_hint</code> defined in the Authorization Request section of this specification.<a href="#section-6.5.2.4-4" class="pilcrow">¶</a></p>
<p id="section-6.5.2.4-5">For non-normative examples of request and response, see section 11.6 in <span>[<a href="#OIDC4VP" class="xref">OIDC4VP</a>]</span>.<a href="#section-6.5.2.4-5" class="pilcrow">¶</a></p>
<p id="section-6.5.2.4-6">Note to the editors: need to sort out credential issuer's client_id with wallet and potentially add example with <code>wallet_issuer</code> and <code>user_hint</code><a href="#section-6.5.2.4-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="successful-authorization-response">
<section id="section-6.5.3">
          <h4 id="name-successful-authorization-re">
<a href="#section-6.5.3" class="section-number selfRef">6.5.3. </a><a href="#name-successful-authorization-re" class="section-name selfRef">Successful Authorization Response</a>
          </h4>
<p id="section-6.5.3-1">Authentication Responses MUST be made as defined in <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span>.<a href="#section-6.5.3-1" class="pilcrow">¶</a></p>
<p id="section-6.5.3-2">Below is a non-normative example of a successful Authentication Response:<a href="#section-6.5.3-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.5.3-3">
<pre>HTTP/1.1 302 Found
  Location: https://wallet.example.org/cb?
    code=SplxlOBeZQQYbYS6WxSbIA
</pre><a href="#section-6.5.3-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authentication-error-response">
<section id="section-6.5.4">
          <h4 id="name-authentication-error-respon">
<a href="#section-6.5.4" class="section-number selfRef">6.5.4. </a><a href="#name-authentication-error-respon" class="section-name selfRef">Authentication Error Response</a>
          </h4>
<p id="section-6.5.4-1">Authentication Error Response MUST be made as defined in <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span>.<a href="#section-6.5.4-1" class="pilcrow">¶</a></p>
<p id="section-6.5.4-2">The following is a non-normative example of an unsuccessful token response.<a href="#section-6.5.4-2" class="pilcrow">¶</a></p>
<div id="section-6.5.4-3">
<pre class="sourcecode lang-json=">HTTP/1.1 302 Found
Location: https://client.example.net/cb?
    error=invalid_request
    &amp;error_description=Unsupported%20response_type%20value
</pre><a href="#section-6.5.4-3" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="token-endpoint">
<section id="section-6.6">
        <h3 id="name-token-endpoint">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-token-endpoint" class="section-name selfRef">Token Endpoint</a>
        </h3>
<p id="section-6.6-1">The Token Endpoint issues an Access Token and, optionally, a Refresh Token in exchange for the authorization code that client obtained in a successful Authorization Response. It is used in the same manner as defined in <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span> and follows the recommendations given in <span>[<a href="#I-D.ietf-oauth-security-topics" class="xref">I-D.ietf-oauth-security-topics</a>]</span>.<a href="#section-6.6-1" class="pilcrow">¶</a></p>
<div id="token-request">
<section id="section-6.6.1">
          <h4 id="name-token-request">
<a href="#section-6.6.1" class="section-number selfRef">6.6.1. </a><a href="#name-token-request" class="section-name selfRef">Token Request</a>
          </h4>
<p id="section-6.6.1-1">Upon receiving a successful Authentication Response, a Token Request is made as defined in Section 4.1.3 of <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span>.<a href="#section-6.6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.6.1-2">Below is a non-normative example of a token request:<a href="#section-6.6.1-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.6.1-3">
<pre>POST /token HTTP/1.1
  Host: server.example.com
  Content-Type: application/x-www-form-urlencoded
  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
  grant_type=authorization_code
  &amp;code=SplxlOBeZQQYbYS6WxSbIA
  &amp;code_verifier=dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk
  &amp;redirect_uri=https%3A%2F%2Fwallet.example.org%2Fcb

</pre><a href="#section-6.6.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="successful-token-response">
<section id="section-6.6.2">
          <h4 id="name-successful-token-response">
<a href="#section-6.6.2" class="section-number selfRef">6.6.2. </a><a href="#name-successful-token-response" class="section-name selfRef">Successful Token Response</a>
          </h4>
<p id="section-6.6.2-1">Token Requests are made as defined in <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span>.<a href="#section-6.6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.6.2-2">In addition to the response parameters defined in <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span>, the AS MAY return the following parameters:<a href="#section-6.6.2-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.6.2-3.1">
              <p id="section-6.6.2-3.1.1"><code>c_nonce</code>: OPTIONAL. JSON string containing a nonce to be used to create a proof of possession of key material when requesting a credential (see <a href="#credential_request" class="xref">Section 6.7.2</a>).<a href="#section-6.6.2-3.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.6.2-3.2">
              <p id="section-6.6.2-3.2.1"><code>c_nonce_expires_in</code>: OPTIONAL. JSON integer denoting the lifetime in seconds of the <code>c_nonce</code>.<a href="#section-6.6.2-3.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-6.6.2-4">Note: Subject Identifier in the ID Token is the End-User's identifier.<a href="#section-6.6.2-4" class="pilcrow">¶</a></p>
<p id="section-6.6.2-5">Below is a non-normative example of a token response:<a href="#section-6.6.2-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.6.2-6">
<pre>HTTP/1.1 200 OK
  Content-Type: application/json
  Cache-Control: no-store
  Pragma: no-cache

  {
    "access_token": "eyJhbGciOiJSUzI1NiIsInR5cCI6Ikp..sHQ",
    "token_type": "bearer",
    "expires_in": 86400,
    "c_nonce": "tZignsnFbp",
    "c_nonce_expires_in": 86400
  }
</pre><a href="#section-6.6.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="token-error-response">
<section id="section-6.6.3">
          <h4 id="name-token-error-response">
<a href="#section-6.6.3" class="section-number selfRef">6.6.3. </a><a href="#name-token-error-response" class="section-name selfRef">Token Error Response</a>
          </h4>
<p id="section-6.6.3-1">If the Token Request is invalid or unauthorized, the Authorization Server constructs the error response as defined as in Section 5.2 of OAuth 2.0 <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span>.<a href="#section-6.6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.6.3-2">The following is a non-normative example Token Error Response:<a href="#section-6.6.3-2" class="pilcrow">¶</a></p>
<div id="section-6.6.3-3">
<pre class="sourcecode lang-json=">HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store
Pragma: no-cache
{
   "error": "invalid_request"
}
</pre><a href="#section-6.6.3-3" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="credential-endpoint">
<section id="section-6.7">
        <h3 id="name-credential-endpoint">
<a href="#section-6.7" class="section-number selfRef">6.7. </a><a href="#name-credential-endpoint" class="section-name selfRef">Credential Endpoint</a>
        </h3>
<p id="section-6.7-1">The Credential Endpoint issues a credential as approved by the End-User upon presentation of a valid Access Token representing this approval.<a href="#section-6.7-1" class="pilcrow">¶</a></p>
<p id="section-6.7-2">Communication with the Credential Endpoint MUST utilize TLS.<a href="#section-6.7-2" class="pilcrow">¶</a></p>
<p id="section-6.7-3">The client can request issuance of a credential of a certain type multiple times, e.g., to associate the credential with different DIDs/public keys or to refresh a certain credential.<a href="#section-6.7-3" class="pilcrow">¶</a></p>
<p id="section-6.7-4">If the access token is valid for requesting issuance of multiple credentials, it is at the client's discretion to decide the order in which to request issuance of multiple credentials requested in the Authorization Request.<a href="#section-6.7-4" class="pilcrow">¶</a></p>
<div id="credential-binding">
<section id="section-6.7.1">
          <h4 id="name-binding-the-issued-credenti">
<a href="#section-6.7.1" class="section-number selfRef">6.7.1. </a><a href="#name-binding-the-issued-credenti" class="section-name selfRef">Binding the Issued Credential to the identifier of the End-User possessing that Credential</a>
          </h4>
<p id="section-6.7.1-1">Issued credential SHOULD be cryptographically bound to the identifier of the End-User who possesses the credential. Cryptographic binding allows the Verifier to verify during presentation that the End-User presenting a credential is the same End-User to whom it was issued. For non-cryptographic type of binding and credentials issued without any binding, see Implementations Considerations sections {#claim-based-binding} and {#no-binding}.<a href="#section-6.7.1-1" class="pilcrow">¶</a></p>
<p id="section-6.7.1-2">Note that claims in the credential are usually about the End-User who possesses it, but can be about the other entity.<a href="#section-6.7.1-2" class="pilcrow">¶</a></p>
<p id="section-6.7.1-3">For cryptographic binding, the Client has the following options to provide cryptographic binding material for a requested credential as defined in {#credential_request}:<a href="#section-6.7.1-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.7.1-4">
            <li id="section-6.7.1-4.1">
              <p id="section-6.7.1-4.1.1">Provide proof of control alongside key material (<code>proof</code> that includes <code>sub_jwk</code> or <code>did</code>)<a href="#section-6.7.1-4.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.7.1-4.2">
              <p id="section-6.7.1-4.2.1">Provide only proof of control without the key material (<code>proof</code> that does not include <code>sub_jwk</code> or <code>did</code>)<a href="#section-6.7.1-4.2.1" class="pilcrow">¶</a></p>
</li>
</ol>
<p id="section-6.7.1-5">For more details, see {#did-binding} in the Security Considerations Section.<a href="#section-6.7.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credential_request">
<section id="section-6.7.2">
          <h4 id="name-credential-request">
<a href="#section-6.7.2" class="section-number selfRef">6.7.2. </a><a href="#name-credential-request" class="section-name selfRef">Credential Request</a>
          </h4>
<p id="section-6.7.2-1">A Client makes a Credential Request by sending a HTTP POST request to the Credential Endpoint with the following parameters:<a href="#section-6.7.2-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.7.2-2.1">
              <p id="section-6.7.2-2.1.1"><code>type</code>: REQUIRED. Type of credential being requested. It corresponds to a <code>schema</code> property in a Credential Manifest obtained in a setup phase.<a href="#section-6.7.2-2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.7.2-2.2">
              <p id="section-6.7.2-2.2.1"><code>format</code>: OPTIONAL. Format of the credential to be issued. If not present, the issuer will determine the credential
format based on the client's format default.<a href="#section-6.7.2-2.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.7.2-2.3">
              <p id="section-6.7.2-2.3.1"><code>proof</code> OPTIONAL. JSON Object containing proof of possession of the key material the issued credential shall be
bound to. The <code>proof</code> object MUST contain the following <code>proof_type</code> element which determines its structure:<a href="#section-6.7.2-2.3.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.7.2-2.3.2.1">
                  <p id="section-6.7.2-2.3.2.1.1"><code>proof_type</code>: REQUIRED. JSON String denoting the proof type.<a href="#section-6.7.2-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
</ul>
<p id="section-6.7.2-3">This specification defines the following values for <code>proof_type</code>:<a href="#section-6.7.2-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.7.2-4.1">
              <p id="section-6.7.2-4.1.1"><code>jwt</code>: objects of this type contain a single <code>jwt</code> element with a signed JWT as proof of possession. The JWT MUST contain the following elements:<a href="#section-6.7.2-4.1.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.7.2-4.1.2.1">
                  <p id="section-6.7.2-4.1.2.1.1"><code>kid</code>: CONDITIONAL. JWT header containing the key ID. If the credential shall be bound to a DID, the <code>kid</code> refers to a DID URL which identifies a particular key in the DID Document that the credential shall be bound to.<a href="#section-6.7.2-4.1.2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.7.2-4.1.2.2">
                  <p id="section-6.7.2-4.1.2.2.1"><code>jwk</code>: CONDITIONAL. JWT header containing the key material the new credential shall be bound to. MUST NOT be present if <code>kid</code> is present.<a href="#section-6.7.2-4.1.2.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.7.2-4.1.2.3">
                  <p id="section-6.7.2-4.1.2.3.1"><code>iss</code>: REQUIRED. MUST contain the client_id of the sender<a href="#section-6.7.2-4.1.2.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.7.2-4.1.2.4">
                  <p id="section-6.7.2-4.1.2.4.1"><code>aud</code>: REQUIRED. MUST contain the issuer URL of credential issuer<a href="#section-6.7.2-4.1.2.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.7.2-4.1.2.5">
                  <p id="section-6.7.2-4.1.2.5.1"><code>iat</code>: REQUIRED. MUST contain the instant when the proof was created<a href="#section-6.7.2-4.1.2.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.7.2-4.1.2.6">
                  <p id="section-6.7.2-4.1.2.6.1"><code>nonce</code>: REQUIRED. MUST contain a fresh nonce as provided by the issuer<a href="#section-6.7.2-4.1.2.6.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
</ul>
<p id="section-6.7.2-5">The <code>proof</code> element MUST incorporate a fresh nonce value generated by the credential issuer and the credential issuer's identifier (audience) to allow the credential issuer to detect replay. The way that data is incorporated depends on the proof type. In a JWT, for example, the nonce is conveyd in the <code>nonce</code> claims whereas the audience is conveyed in the <code>aud</code> claim. In a Linked Data proof, for example, the nonce is included as the <code>challenge</code> element in the proof object and the issuer (the intended audience) is included as the <code>domain</code> element.<a href="#section-6.7.2-5" class="pilcrow">¶</a></p>
<p id="section-6.7.2-6">The Issuer MUST validate that the <code>proof</code> is actually signed by a key identified in <code>kid</code> parameter.<a href="#section-6.7.2-6" class="pilcrow">¶</a></p>
<p id="section-6.7.2-7">Below is a non-normative example of a <code>proof</code> parameter (line breaks for display purposes only):<a href="#section-6.7.2-7" class="pilcrow">¶</a></p>
<div id="section-6.7.2-8">
<pre class="sourcecode lang-json">{
  "proof_type": "jwt",
  "jwt": "eyJraWQiOiJkaWQ6ZXhhbXBsZTplYmZlYjFmNzEyZWJjNmYxYzI3NmUxMmVjMjEva2V5cy8
  xIiwiYWxnIjoiRVMyNTYiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJzNkJoZFJrcXQzIiwiYXVkIjoiaHR
  0cHM6Ly9zZXJ2ZXIuZXhhbXBsZS5jb20iLCJpYXQiOiIyMDE4LTA5LTE0VDIxOjE5OjEwWiIsIm5vbm
  NlIjoidFppZ25zbkZicCJ9.ewdkIkPV50iOeBUqMXCC_aZKPxgihac0aW9EkL1nOzM"
}
</pre><a href="#section-6.7.2-8" class="pilcrow">¶</a>
</div>
<p id="section-6.7.2-9">where the JWT looks like this:<a href="#section-6.7.2-9" class="pilcrow">¶</a></p>
<div id="section-6.7.2-10">
<pre class="sourcecode lang-json">{
  "alg": "ES256",
  "typ": "JWT",
  "kid":"did:example:ebfeb1f712ebc6f1c276e12ec21/keys/1"
}.
{
  "iss": "s6BhdRkqt3",
  "aud": "https://server.example.com",
  "iat": "2018-09-14T21:19:10Z",
  "nonce": "tZignsnFbp"
}
</pre><a href="#section-6.7.2-10" class="pilcrow">¶</a>
</div>
<p id="section-6.7.2-11">Below is a non-normative example of a credential request:<a href="#section-6.7.2-11" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.7.2-12">
<pre>POST /credential HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded
Authorization: BEARER czZCaGRSa3F0MzpnWDFmQmF0M2JW

type=https%3A%2F%2Fdid%2Eexample%2Eorg%2FhealthCard
format=ldp%5Fvc
did=did%3Aexample%3Aebfeb1f712ebc6f1c276e12ec21
proof=%7B%22type%22:%22...-ace0-9c5210e16c32%22%7D
</pre><a href="#section-6.7.2-12" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="credential_response">
<section id="section-6.7.3">
          <h4 id="name-credential-response">
<a href="#section-6.7.3" class="section-number selfRef">6.7.3. </a><a href="#name-credential-response" class="section-name selfRef">Credential Response</a>
          </h4>
<p id="section-6.7.3-1">Credential Response can be Synchronous or Deferred. The Issuer may be able to immediately issue a requested credential and send it to the Client. In other cases, the Issuer may not be able to immediately issue a requested credential and would want to send a token to the Client to be used later to receive a credential when it is ready.<a href="#section-6.7.3-1" class="pilcrow">¶</a></p>
<p id="section-6.7.3-2">The following claims are used in the Credential Response:<a href="#section-6.7.3-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.7.3-3.1">
              <p id="section-6.7.3-3.1.1"><code>format</code>: REQUIRED. JSON string denoting the credential's format<a href="#section-6.7.3-3.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.7.3-3.2">
              <p id="section-6.7.3-3.2.1"><code>credential</code>: OPTIONAL. JSON string that is the base64url encoded representation of the issued credential. MUST be present when <code>acceptance_token</code> is not returned.<a href="#section-6.7.3-3.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.7.3-3.3">
              <p id="section-6.7.3-3.3.1"><code>acceptance_token</code>: OPTIONAL. A JSON string containing a token subsequently used to obtain a credential. MUST be present when <code>credential</code> is not returned.<a href="#section-6.7.3-3.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.7.3-3.4">
              <p id="section-6.7.3-3.4.1"><code>c_nonce</code>: OPTIONAL. JSON string containing a nonce to be used to create a proof of possession of key material when requesting a credential (see <a href="#credential_request" class="xref">Section 6.7.2</a>).<a href="#section-6.7.3-3.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.7.3-3.5">
              <p id="section-6.7.3-3.5.1"><code>c_nonce_expires_in</code>: OPTIONAL. JSON integer denoting the lifetime in seconds of the <code>c_nonce</code>.<a href="#section-6.7.3-3.5.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-6.7.3-4">Below is a non-normative example of a credential response in a synchronous flow:<a href="#section-6.7.3-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.7.3-5">
<pre>HTTP/1.1 200 OK
  Content-Type: application/json
  Cache-Control: no-store
  Pragma: no-cache

{
  "format": "jwt_vc"
  "credential" : "LUpixVCWJk0eOt4CXQe1NXK....WZwmhmn9OQp6YxX0a2L",
  "c_nonce": "fGFF7UkhLa",
  "c_nonce_expires_in": 86400
}
</pre><a href="#section-6.7.3-5" class="pilcrow">¶</a>
</div>
<p id="section-6.7.3-6">Below is a non-normative example of a credential response in a deferred flow:<a href="#section-6.7.3-6" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.7.3-7">
<pre>HTTP/1.1 200 OK
  Content-Type: application/json
  Cache-Control: no-store
  Pragma: no-cache

{
  "acceptance_token": "8xLOxBtZp8",
  "c_nonce": "wlbQc6pCJp",
  "c_nonce_expires_in": 86400
}
</pre><a href="#section-6.7.3-7" class="pilcrow">¶</a>
</div>
<p id="section-6.7.3-8">Note: Consider using CIBA Ping/Push callback. Another option would be the Client providing <code>client_notification_token</code> to the Issuer, so that the issuer sends a Credential response upon successfully receiving a Credential request and then no need for the client to bring an acceptance token, the Issuer will send the credential once it is issued in a response that includes <code>client_notification_token</code>.<a href="#section-6.7.3-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credential-issuer-provided-nonce">
<section id="section-6.7.4">
          <h4 id="name-credential-issuer-provided-">
<a href="#section-6.7.4" class="section-number selfRef">6.7.4. </a><a href="#name-credential-issuer-provided-" class="section-name selfRef">Credential Issuer-Provided Nonce</a>
          </h4>
<p id="section-6.7.4-1">Upon receiving a Credential Request, the credential issuer MAY require the client to send a proof of possession of the key material it wants a credential to be bound to. This proof MUST incorporate a nonce generated by the credential issuer. The credential issuer will provide the client with a nonce in an error response to any credential request not including such a proof or including an invalid proof.<a href="#section-6.7.4-1" class="pilcrow">¶</a></p>
<p id="section-6.7.4-2">Below is a non-normative example of a Credential Response when the Issuer requires a <code>proof</code> upon receiving a Credential Request:<a href="#section-6.7.4-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.7.4-3">
<pre>HTTP/1.1 400 Bad Request
  Content-Type: application/json
  Cache-Control: no-store
  Pragma: no-cache

{
  "error": "invalid_or_missing_proof"
  "error_description":
       "Credential issuer requires proof element in credential request"
  "c_nonce": "8YE9hCnyV2",
  "c_nonce_expires_in": 86400
}
</pre><a href="#section-6.7.4-3" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="deferred-credential-endpoint">
<section id="section-6.8">
        <h3 id="name-deferred-credential-endpoin">
<a href="#section-6.8" class="section-number selfRef">6.8. </a><a href="#name-deferred-credential-endpoin" class="section-name selfRef">Deferred Credential Endpoint</a>
        </h3>
<p id="section-6.8-1">This endpoint is used to issue a credential previously requested at the credential endpoint in case the Issuer was not able to immediately issue this credential.<a href="#section-6.8-1" class="pilcrow">¶</a></p>
<div id="deferred-credential-request">
<section id="section-6.8.1">
          <h4 id="name-deferred-credential-request">
<a href="#section-6.8.1" class="section-number selfRef">6.8.1. </a><a href="#name-deferred-credential-request" class="section-name selfRef">Deferred Credential Request</a>
          </h4>
<p id="section-6.8.1-1">This is a HTTP POST request, which accepts an acceptance token as only parameter. The acceptance token MUST be sent as access token in the HTTP header as shown in the following example.<a href="#section-6.8.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.8.1-2">
<pre>POST /credential_deferred HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded
Authorization: BEARER 8xLOxBtZp8

</pre><a href="#section-6.8.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="deferred-credential-response">
<section id="section-6.8.2">
          <h4 id="name-deferred-credential-respons">
<a href="#section-6.8.2" class="section-number selfRef">6.8.2. </a><a href="#name-deferred-credential-respons" class="section-name selfRef">Deferred Credential Response</a>
          </h4>
<p id="section-6.8.2-1">The deferred credential response uses the <code>format</code> and <code>credential</code> parameters as defined in <a href="#credential_response" class="xref">Section 6.7.3</a>.<a href="#section-6.8.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="pre-authorized-code-flow">
<section id="section-7">
      <h2 id="name-pre-authorized-code-flow">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-pre-authorized-code-flow" class="section-name selfRef">Pre-Authorized Code Flow</a>
      </h2>
<p id="section-7-1">This section specifies an additional flow to obtain an access token for credential issuance. It is intended to support scenarios where the user starts a process on an issuer's website that ultimately results in one or more credentials being issued to the user's wallet. The process on the issuer's website may include uploading documents and presenting verifiable credentials to the issuer. Moreover, the End-user may be accessing the issuer's website on a device different from the one with the wallet application so the credential issuance process needs to be transfered to another device where the user's wallet resides.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">In contrast to the flow specified in <a href="#endpoints" class="xref">Section 6</a>, this flows is initiated by the Issuer when the credentials are "ready" and need to be "picked up" by the wallet application. How the user provides information required for the issuance of a requested credential to the Issuer and the business processes conducted by the Issuer to issue a credential are out of scope of this specification.<a href="#section-7-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7-3">
        <li id="section-7-3.1">
          <p id="section-7-3.1.1">To initiate the flow, the Issuer needs to communicates to the wallet two parameters: the pre-authorized code and the credential type the code is valid for. The Issuer can send them in two different ways. Either the issuer sends them in an issuance initiation request to the Issuance Initiation Endpoint of the wallet as described in <a href="#issuance_initiation_request" class="xref">Section 6.4.1</a>. Or the issuer renders a QR code containing the issuance initiation request with these parameters. In this case, the user scans the QR code with her wallet on a different device in order to proceed.<a href="#section-7-3.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-7-3.2">
          <p id="section-7-3.2.1">When initiating the flow, the Issuer also indicates if the PIN is required. If it is, sends PIN to the wallet using a channel different from an issuance initiation request.<a href="#section-7-3.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-7-3.3">
          <p id="section-7-3.3.1">The wallet sends the pre-authorized code to the issuer's Token Endpoint. This request MUST contain a user PIN if requested by the issuer.<a href="#section-7-3.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-7-3.4">
          <p id="section-7-3.4.1">The issuer responds with an access token valid for credential issuance.<a href="#section-7-3.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-7-3.5">
          <p id="section-7-3.5.1">The wallet sends a credential issuance request to the credential endpoint as defined in <a href="#credential_request" class="xref">Section 6.7.2</a> using the credential type as indicated in the first step from the issuer to the wallet.<a href="#section-7-3.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-7-3.6">
          <p id="section-7-3.6.1">The issuer returns the requested credential as defined in <a href="#credential_response" class="xref">Section 6.7.3</a>.<a href="#section-7-3.6.1" class="pilcrow">¶</a></p>
</li>
</ol>
<p id="section-7-4">Steps 1 through 3 constitute a new kind of pre-authorized code flow that is implemented using an additional initiate issuance endpoint and a new OAuth grant type "urn:ietf:params:oauth:grant-type:pre-authorized_code". Steps 4 through 6 conform to the process specified in <a href="#endpoints" class="xref">Section 6</a>.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5">Note that the pre-authorized code is sent to the Token Endpoint and not to the Authorization Endpoint of the Issuer.<a href="#section-7-5" class="pilcrow">¶</a></p>
<p id="section-7-6">The following sections specify the extensions of a pre-authorized code flow.<a href="#section-7-6" class="pilcrow">¶</a></p>
<div id="extension-parameters-for-initiate-issuance-request">
<section id="section-7.1">
        <h3 id="name-extension-parameters-for-in">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-extension-parameters-for-in" class="section-name selfRef">Extension Parameters for Initiate Issuance Request</a>
        </h3>
<p id="section-7.1-1">These are the extension parameters defined for the pre-authorized code flow:<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-7.1-2.1">
            <p id="section-7.1-2.1.1"><code>pre-authorized_code</code>: REQUIRED. The code representing the issuer's authorization for the wallet to obtain credentials of a certain type. This code MUST be short lived and single-use.<a href="#section-7.1-2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-7.1-2.2">
            <p id="section-7.1-2.2.1"><code>user_pin_required</code>: OPTIONAL. Boolean value specifying whether the issuer expects presentation of a user PIN along with the token request. Default is <code>false</code>. This PIN is intended to bind the pre-authorized code to a certain transaction in order to prevent replay of this code by an attacker that, for example, scanned the QR code while standing behind the legit user.<a href="#section-7.1-2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-7.1-3">Below is a non-normative example of an initiate issuance request:<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-7.1-4">
<pre>  GET /initiate_issuance?
    issuer=https%3A%2F%2Fserver%2Eexample%2Ecom
    &amp;credential_type=https%3A%2F%2Fdid%2Eexample%2Eorg%2FhealthCard
    &amp;pre-authorized_code=SplxlOBeZQQYbYS6WxSbIA
</pre><a href="#section-7.1-4" class="pilcrow">¶</a>
</div>
<p id="section-7.1-5">The contents of a QR code could look like this:<a href="#section-7.1-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-7.1-6">
<pre>openid_initiate_issuance://?
    issuer=https%3A%2F%2Fserver%2Eexample%2Ecom
    &amp;credential_type=https%3A%2F%2Fdid%2Eexample%2Eorg%2FhealthCard
    &amp;pre-authorized_code=SplxlOBeZQQYbYS6WxSbIA
    &amp;user_pin_required=true
</pre><a href="#section-7.1-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="extension-parameters-for-token-request">
<section id="section-7.2">
        <h3 id="name-extension-parameters-for-to">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-extension-parameters-for-to" class="section-name selfRef">Extension Parameters for Token Request</a>
        </h3>
<p id="section-7.2-1">These are the extension parameters to the token request for the grant type <code>pre-authorized_code</code>:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-7.2-2.1">
            <p id="section-7.2-2.1.1"><code>pre-authorized_code</code>: REQUIRED. The code representing the authorization to obtain credentials of a certain type.<a href="#section-7.2-2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-7.2-2.2">
            <p id="section-7.2-2.2.1"><code>user_pin</code>: OPTIONAL. String value containing a user PIN. This value MUST be present if <code>user_pin_required</code> was set to <code>true</code> in the Initiate Issuance Request. The string value MUST consist of maximum 8 numeric characters (the numbers 0 - 9).<a href="#section-7.2-2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-7.2-3">Below is a non-normative example of a token request:<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-7.2-4">
<pre>POST /token HTTP/1.1
  Host: server.example.com
  Content-Type: application/x-www-form-urlencoded
  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW

  grant_type=urn:ietf:params:oauth:grant-type:pre-authorized_code
  &amp;pre-authorized_code=SplxlOBeZQQYbYS6WxSbIA
  &amp;user_pin=493536
</pre><a href="#section-7.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="pre-authz-token-response">
<section id="section-7.3">
        <h3 id="name-extension-to-the-token-resp">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-extension-to-the-token-resp" class="section-name selfRef">Extension to the token response</a>
        </h3>
<p id="section-7.3-1">Upon receiving <code>pre-authorized_code</code>, the issuer MAY decide to interact with the end-user in the course of the token request processing, which might take some time. In such a case, the issuer SHOULD respond with the error <code>authorization_pending</code> and the new return parameter <code>interval</code>:<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-7.3-2.1">
            <p id="section-7.3-2.1.1"><code>authorization_pending</code>: OPTIONAL. The token request is still pending as the issuer is waiting for end user end user interaction to complete.  The client SHOULD repeat the token request. Before each new request, the client MUST wait at least the number of seconds specified by the "interval" response parameter.<a href="#section-7.3-2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-7.3-2.2">
            <p id="section-7.3-2.2.1"><code>interval</code>: OPTIONAL. The minimum amount of time in seconds that the client SHOULD wait between polling requests to the token endpoint.  If no value is provided, clients MUST use 5 as the default.<a href="#section-7.3-2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</section>
</div>
<div id="replay-prevention">
<section id="section-7.4">
        <h3 id="name-replay-prevention">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-replay-prevention" class="section-name selfRef">Replay Prevention</a>
        </h3>
<p id="section-7.4-1">The pre-authorized code flow is vulnerable to the replay of the pre-authorized code, because by design it is not bound to a certain device (as the authorization code flow does with PKCE). This means an attacker can replay at another device the pre-authorized code meant for a victime, e.g., the attacker can scan the QR code while it is displayed on the victim's screen, and thereby getg access to the credential. Such replay attacks must be prevented using other means. The design facilitates the following options:<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-7.4-2.1">
            <p id="section-7.4-2.1.1">User PIN: the issuer might set up a PIN with the user (e.g. via text message or email), which needs to be presented in the token request.<a href="#section-7.4-2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-7.4-2.2">
            <p id="section-7.4-2.2.1">Callback to device where the transaction originated: upon receiving the token request, the issuer asks the user to confirm the originating device (device that displayed the QR code) that the issuer may proceed with the credential issuance process. While the issuer reaches out to the user on the other device to get confirmation, the issuer returns an <code>authorization_pending</code> error code to the wallet (as described in <a href="#pre-authz-token-response" class="xref">Section 7.3</a>). The wallet is required to call the token endpoint again to obtain the access token. If the user does not confirm, the token request is returned with the <code>access_denied</code> error code. This flow gives the user on the originating device more control over the issuance process.<a href="#section-7.4-2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</section>
</div>
<div id="pin-code-phishing">
<section id="section-7.5">
        <h3 id="name-pin-code-phishing">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-pin-code-phishing" class="section-name selfRef">PIN Code Phishing</a>
        </h3>
<p id="section-7.5-1">An attacker might leverage the credential issuance process and the user's trust into the wallet to phish PIN codes sent out by a different service that grant attacker access to services other than credential issuance. The attacker could setup a credential issuer site and in parallel to the issuance request trigger transmission of a PIN code to the user's phone from a service other than credential issuance, e.g. from a payment service. The user would then be asked to enter this PIN into the wallet and since the wallet sends this PIN to the token endpoint of the issuer (the attacker), the attacker would get access to the PIN code, and access to that other service.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<p id="section-7.5-2">In order to cope with that issue, the wallet is RECOMMENDED to interact with trusted issuers only. In that case, the wallet would not process an initiate issuance request with an untrusted issuer URL. The wallet MAY also show to the user the endpoint or issuer it will be sending the PIN code and ask the user for confirmation.<a href="#section-7.5-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
    </h2>
</section>
</div>
<div id="implementation-considerations">
<section id="section-9">
      <h2 id="name-implementation-consideratio">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-implementation-consideratio" class="section-name selfRef">Implementation Considerations</a>
      </h2>
<div id="claim-based-binding">
<section id="section-9.1">
        <h3 id="name-claim-based-binding-of-the-">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-claim-based-binding-of-the-" class="section-name selfRef">Claim-based Binding of the Credential to the End-User possessing the credential</a>
        </h3>
<p id="section-9.1-1">Credential not cryptographically bound to the identifier of the End-User possessing it (see <a href="#credential-binding" class="xref">Section 6.7.1</a>), should be bound to the End-User possessing the credential based on the claims included in that credential.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">In claim-based binding, no cryptographic binding material is provided. Instead, the issued credential includes user claims that can be used by the Verifier to verify possession of the credential by requesting presentation of existing forms of physical or digial identification that includes the same claims (e.g., a driver's license or other ID cards in person, or an online ID verification service).<a href="#section-9.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="no-binding">
<section id="section-9.2">
        <h3 id="name-binding-of-the-credential-w">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-binding-of-the-credential-w" class="section-name selfRef">Binding of the Credential without Cryptographic Binding nor Claim-based Binding</a>
        </h3>
<p id="section-9.2-1">Some Issuers might choose issuing bearer credentials without either cryptographic binding nor claim-based binding, because they are meant to be presented without proof of possession.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">One such use-case is low assurance credentials such as coupons or tickets.<a href="#section-9.2-2" class="pilcrow">¶</a></p>
<p id="section-9.2-3">Another use-case is when the Issuer uses cryptographic schemes that can provide binding to the End-User possessing that credential without explicit cryptographic material being supplied by the application used by that End-User. For example, in the case of the BBS Signature Scheme, the issued credential itself is a secret and only derivation of a credential is presented to the Verifier. Effectively, credential is bound to the Issuer's signature on the credential, which becomes a shared secret transferred from the Issuer to the End-User.<a href="#section-9.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-10">
      <h2 id="name-privacy-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-10-1">TBD<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-11">
      <h2 id="name-normative-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC8414">[RFC8414]</dt>
<dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor">, Sakimura, N.</span><span class="refAuthor">, and J. Bradley</span>, <span class="refTitle">"OAuth 2.0 Authorization Server Metadata"</span>, <span class="seriesInfo">RFC 8414</span>, <span class="seriesInfo">DOI 10.17487/RFC8414</span>, <time datetime="2018-06">June 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8414">https://www.rfc-editor.org/info/rfc8414</a>&gt;</span>. </dd>
<dt id="I-D.ietf-oauth-security-topics">[I-D.ietf-oauth-security-topics]</dt>
<dd>
<span class="refAuthor">Lodderstedt, T.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, Labunets, A.</span><span class="refAuthor">, and D. Fett</span>, <span class="refTitle">"OAuth 2.0 Security Best Current Practice"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-security-topics-19</span>, <time datetime="2021-12-16">16 December 2021</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-oauth-security-topics-19">https://tools.ietf.org/html/draft-ietf-oauth-security-topics-19</a>&gt;</span>. </dd>
<dt id="SIOPv2">[SIOPv2]</dt>
<dd>
<span class="refAuthor">Microsoft</span><span class="refAuthor"> and M. B. Jones</span>, <span class="refTitle">"Self-Issued OpenID Provider V2"</span>, <time datetime="2021-12-18">18 December 2021</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-self-issued-v2-1_0.html">https://openid.net/specs/openid-connect-self-issued-v2-1_0.html</a>&gt;</span>. </dd>
<dt id="RFC7636">[RFC7636]</dt>
<dd>
<span class="refAuthor">Sakimura, N., Ed.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, and N. Agarwal</span>, <span class="refTitle">"Proof Key for Code Exchange by OAuth Public Clients"</span>, <span class="seriesInfo">RFC 7636</span>, <span class="seriesInfo">DOI 10.17487/RFC7636</span>, <time datetime="2015-09">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7636">https://www.rfc-editor.org/info/rfc7636</a>&gt;</span>. </dd>
<dt id="I-D.ietf-oauth-rar">[I-D.ietf-oauth-rar]</dt>
<dd>
<span class="refAuthor">Lodderstedt, T.</span><span class="refAuthor">, Richer, J.</span><span class="refAuthor">, and B. Campbell</span>, <span class="refTitle">"OAuth 2.0 Rich Authorization Requests"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-rar-11</span>, <time datetime="2022-04-08">8 April 2022</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-oauth-rar-11">https://tools.ietf.org/html/draft-ietf-oauth-rar-11</a>&gt;</span>. </dd>
<dt id="RFC6749">[RFC6749]</dt>
<dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;</span>. </dd>
<dt id="RFC7591">[RFC7591]</dt>
<dd>
<span class="refAuthor">Richer, J., Ed.</span><span class="refAuthor">, Jones, M.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, Machulak, M.</span><span class="refAuthor">, and P. Hunt</span>, <span class="refTitle">"OAuth 2.0 Dynamic Client Registration Protocol"</span>, <span class="seriesInfo">RFC 7591</span>, <span class="seriesInfo">DOI 10.17487/RFC7591</span>, <time datetime="2015-07">July 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7591">https://www.rfc-editor.org/info/rfc7591</a>&gt;</span>. </dd>
<dt id="RFC9126">[RFC9126]</dt>
<dd>
<span class="refAuthor">Lodderstedt, T.</span><span class="refAuthor">, Campbell, B.</span><span class="refAuthor">, Sakimura, N.</span><span class="refAuthor">, Tonge, D.</span><span class="refAuthor">, and F. Skokan</span>, <span class="refTitle">"OAuth 2.0 Pushed Authorization Requests"</span>, <span class="seriesInfo">RFC 9126</span>, <span class="seriesInfo">DOI 10.17487/RFC9126</span>, <time datetime="2021-09">September 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9126">https://www.rfc-editor.org/info/rfc9126</a>&gt;</span>. </dd>
</dl>
</section>
<section id="section-12">
      <h2 id="name-informative-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="VC_DATA">[VC_DATA]</dt>
<dd>
<span class="refAuthor">Sporny, M.</span><span class="refAuthor">, Noble, G.</span><span class="refAuthor">, Longley, D.</span><span class="refAuthor">, Burnett, D. C.</span><span class="refAuthor">, Zundel, B.</span><span class="refAuthor">, and D. Chadwick</span>, <span class="refTitle">"Verifiable Credentials Data Model 1.0"</span>, <time datetime="2019-11-19">19 November 2019</time>, <span>&lt;<a href="https://www.w3.org/TR/vc-data-model">https://www.w3.org/TR/vc-data-model</a>&gt;</span>. </dd>
<dt id="DIF.CredentialManifest">[DIF.CredentialManifest]</dt>
<dd>
<span class="refAuthor">Buchner, D.</span><span class="refAuthor">, Zunde, B.</span><span class="refAuthor">, Hensley, J.</span><span class="refAuthor">, and D. McGrogan</span>, <span class="refTitle">"Presentation Exchange v1.0.0"</span>, <time></time>, <span>&lt;<a href="https://identity.foundation/credential-manifest/">https://identity.foundation/credential-manifest/</a>&gt;</span>. </dd>
<dt id="OpenID.Core">[OpenID.Core]</dt>
<dd>
<span class="refAuthor">Sakimura, N.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, Jones, M.</span><span class="refAuthor">, de Medeiros, B.</span><span class="refAuthor">, and C. Mortimore</span>, <span class="refTitle">"OpenID Connect Core 1.0 incorporating errata set 1"</span>, <time datetime="2014-11-08">8 November 2014</time>, <span>&lt;<a href="http://openid.net/specs/openid-connect-core-1_0.html">http://openid.net/specs/openid-connect-core-1_0.html</a>&gt;</span>. </dd>
<dt id="OIDC4VP">[OIDC4VP]</dt>
<dd>
<span class="refAuthor">Terbu, O.</span><span class="refAuthor">, Lodderstedt, T.</span><span class="refAuthor">, Yasuda, K.</span><span class="refAuthor">, Lemmon, A.</span><span class="refAuthor">, and T. Looker</span>, <span class="refTitle">"OpenID Connect for Verifiable Presentations"</span>, <time datetime="2021-12-17">17 December 2021</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-4-verifiable-presentations-1_0.html">https://openid.net/specs/openid-connect-4-verifiable-presentations-1_0.html</a>&gt;</span>. </dd>
</dl>
</section>
<div id="iana-considerations">
<section id="section-appendix.a">
      <h2 id="name-iana-considerations">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-appendix.a-1">register "urn:ietf:params:oauth:grant-type:pre-authorized_code"<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Acknowledgements">
<section id="section-appendix.b">
      <h2 id="name-acknowledgements">
<a href="#section-appendix.b" class="section-number selfRef">Appendix B. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-appendix.b-1">We would like to thank David Chadwick, John Bradley, Alen Horvat, Michael B. Jones, and David Waite for their valuable contributions to this specification.<a href="#section-appendix.b-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="notices">
<section id="section-appendix.c">
      <h2 id="name-notices">
<a href="#section-appendix.c" class="section-number selfRef">Appendix C. </a><a href="#name-notices" class="section-name selfRef">Notices</a>
      </h2>
<p id="section-appendix.c-1">Copyright (c) 2022 The OpenID Foundation.<a href="#section-appendix.c-1" class="pilcrow">¶</a></p>
<p id="section-appendix.c-2">The OpenID Foundation (OIDF) grants to any Contributor, developer, implementer, or other interested party a non-exclusive, royalty free, worldwide copyright license to reproduce, prepare derivative works from, distribute, perform and display, this Implementers Draft or Final Specification solely for the purposes of (i) developing specifications, and (ii) implementing Implementers Drafts and Final Specifications based on such documents, provided that attribution be made to the OIDF as the source of the material, but that such attribution does not indicate an endorsement by the OIDF.<a href="#section-appendix.c-2" class="pilcrow">¶</a></p>
<p id="section-appendix.c-3">The technology described in this specification was made available from contributions from various sources, including members of the OpenID Foundation and others. Although the OpenID Foundation has taken steps to help ensure that the technology is available for distribution, it takes no position regarding the validity or scope of any intellectual property or other rights that might be claimed to pertain to the implementation or use of the technology described in this specification or the extent to which any license under such rights might or might not be available; neither does it represent that it has made any independent effort to identify any such rights. The OpenID Foundation and the contributors to this specification make no (and hereby expressly disclaim any) warranties (express, implied, or otherwise), including implied warranties of merchantability, non-infringement, fitness for a particular purpose, or title, related to this specification, and the entire risk as to implementing this specification is assumed by the implementer. The OpenID Intellectual Property Rights policy requires contributors to offer a patent promise not to assert certain patent claims against other contributors and against implementers. The OpenID Foundation invites any interested party to bring to its attention any copyrights, patents, patent applications, or other proprietary rights that may cover technology that may be required to practice this specification.<a href="#section-appendix.c-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="section-appendix.d">
      <h2 id="name-document-history">
<a href="#section-appendix.d" class="section-number selfRef">Appendix D. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="section-appendix.d-1">[[ To be removed from the final specification ]]<a href="#section-appendix.d-1" class="pilcrow">¶</a></p>
<p id="section-appendix.d-2">-05<a href="#section-appendix.d-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-appendix.d-3.1">
          <p id="section-appendix.d-3.1.1">added support for pre-authorized code flow<a href="#section-appendix.d-3.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-appendix.d-3.2">
          <p id="section-appendix.d-3.2.1">changed base protocol to OAuth<a href="#section-appendix.d-3.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-appendix.d-4">-04<a href="#section-appendix.d-4" class="pilcrow">¶</a></p>
<ul>
<li id="section-appendix.d-5.1">
          <p id="section-appendix.d-5.1.1">added support for requesting credential authorization with scopes<a href="#section-appendix.d-5.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-appendix.d-5.2">
          <p id="section-appendix.d-5.2.1">removed support to pass VPs in the authorization request<a href="#section-appendix.d-5.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-appendix.d-5.3">
          <p id="section-appendix.d-5.3.1">reworked "proof" parameter definition and added "jwt" proof type<a href="#section-appendix.d-5.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-appendix.d-6">-03<a href="#section-appendix.d-6" class="pilcrow">¶</a></p>
<ul>
<li id="section-appendix.d-7.1">
          <p id="section-appendix.d-7.1.1">added issuance initiation endpoint<a href="#section-appendix.d-7.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-appendix.d-7.2">
          <p id="section-appendix.d-7.2.1">Applied cleanups suggested by Mike Jones post adoption<a href="#section-appendix.d-7.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-appendix.d-8">-02<a href="#section-appendix.d-8" class="pilcrow">¶</a></p>
<ul>
<li id="section-appendix.d-9.1">
          <p id="section-appendix.d-9.1.1">Adopted as WG document<a href="#section-appendix.d-9.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-appendix.d-10">-01<a href="#section-appendix.d-10" class="pilcrow">¶</a></p>
<ul>
<li id="section-appendix.d-11.1">
          <p id="section-appendix.d-11.1.1">Added Request &amp; Response syntax and descriptions<a href="#section-appendix.d-11.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-appendix.d-11.2">
          <p id="section-appendix.d-11.2.1">Reworked and extended sequence diagram<a href="#section-appendix.d-11.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-appendix.d-12">-00<a href="#section-appendix.d-12" class="pilcrow">¶</a></p>
<ul>
<li id="section-appendix.d-13.1">
          <p id="section-appendix.d-13.1.1">initial revision<a href="#section-appendix.d-13.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.e">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Torsten Lodderstedt</span></div>
<div dir="auto" class="left"><span class="org">yes.com</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:torsten@lodderstedt.net" class="email">torsten@lodderstedt.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Kristina Yasuda</span></div>
<div dir="auto" class="left"><span class="org">Microsoft</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kristina.yasuda@microsoft.com" class="email">kristina.yasuda@microsoft.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tobias Looker</span></div>
<div dir="auto" class="left"><span class="org">Mattr</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tobias.looker@mattr.global" class="email">tobias.looker@mattr.global</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>OpenID Connect MODRNA Authentication Profile 1.0</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents"/>
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction"/>
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Requirements Notation and Conventions"/>
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Terminology"/>
<link href="#rfc.section.2" rel="Chapter" title="2 Overview"/>
<link href="#rfc.section.3" rel="Chapter" title="3 Authentication Request"/>
<link href="#rfc.section.4" rel="Chapter" title="4 acr_values request values and level of assurance"/>
<link href="#rfc.section.5" rel="Chapter" title="5 Authentication Method Reference (amr)"/>
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 AMR Value Examples"/>
<link href="#rfc.section.6" rel="Chapter" title="6 login_hint_token"/>
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 login_hint_token encryption and signing"/>
<link href="#rfc.section.7" rel="Chapter" title="7 binding_message"/>
<link href="#rfc.section.8" rel="Chapter" title="8 mandatory to implement"/>
<link href="#rfc.section.9" rel="Chapter" title="9 Security Considerations"/>
<link href="#rfc.section.10" rel="Chapter" title="10 Privacy Considerations"/>
<link href="#rfc.section.11" rel="Chapter" title="11 IANA Considerations"/>
<link href="#rfc.references" rel="Chapter" title="12 References"/>
<link href="#rfc.references.1" rel="Chapter" title="12.1 Normative References"/>
<link href="#rfc.references.2" rel="Chapter" title="12.2 Informative References"/>
<link href="#rfc.appendix.A" rel="Chapter" title="A Acknowledgements"/>
<link href="#rfc.appendix.B" rel="Chapter" title="B Notices"/>
<link href="#rfc.appendix.C" rel="Chapter" title="C Document History"/>
<link href="#rfc.authors" rel="Chapter"/>


  <meta name="generator" content="xml2rfc version 2.5.2.dev0 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Connotte, J. and J. Bradley" />
  <meta name="dct.identifier" content="urn:ietf:id:openid-connect-modrna-authentication-1_0" />
  <meta name="dct.issued" scheme="ISO8601" content="2017-3-06" />
  <meta name="dct.abstract" content="RPs are keen to use high quality authentication methods, which can be provided by Mobile Network Operators (MNO).  However a RP must be able to describe its demands for an authentication request and it must be able to do this in an interoperable way.  " />
  <meta name="description" content="RPs are keen to use high quality authentication methods, which can be provided by Mobile Network Operators (MNO).  However a RP must be able to describe its demands for an authentication request and it must be able to do this in an interoperable way.  " />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
  <td class="left"></td>
  <td class="right">J. Connotte</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">Deutsche Telekom AG</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">J. Bradley</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">Ping Identity</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">March 06, 2017</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">OpenID Connect MODRNA Authentication Profile 1.0<br />
  <span class="filename">openid-connect-modrna-authentication-1_0</span></p>
  
  <h1 id="rfc.abstract">
  <a href="#rfc.abstract">Abstract</a>
</h1>
<p>RPs are keen to use high quality authentication methods, which can be provided by Mobile Network Operators (MNO).  However a RP must be able to describe its demands for an authentication request and it must be able to do this in an interoperable way.  </p>
<p>The MODRNA Authentication Profile will specify how RP's request a certain level of assurance for the authentication.  </p>
<p>In addition, the profile will specify an encrypted login hint token to allow for the transport of user identifiers to the OP in a privacy preserving fashion.  </p>
<p>Lastly, the profile will specify an additional messge parameter intended to serve as an interlock between the user's consumpution device and authentication device.  </p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a></li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Requirements Notation and Conventions</a></li>
<li>1.2.   <a href="#rfc.section.1.2">Terminology</a></li>
</ul><li>2.   <a href="#rfc.section.2">Overview</a></li>
<li>3.   <a href="#rfc.section.3">Authentication Request</a></li>
<li>4.   <a href="#rfc.section.4">acr_values request values and level of assurance</a></li>
<li>5.   <a href="#rfc.section.5">Authentication Method Reference (amr)</a></li>
<ul><li>5.1.   <a href="#rfc.section.5.1">AMR Value Examples</a></li>
</ul><li>6.   <a href="#rfc.section.6">login_hint_token</a></li>
<ul><li>6.1.   <a href="#rfc.section.6.1">login_hint_token encryption and signing</a></li>
</ul><li>7.   <a href="#rfc.section.7">binding_message</a></li>
<li>8.   <a href="#rfc.section.8">mandatory to implement</a></li>
<li>9.   <a href="#rfc.section.9">Security Considerations</a></li>
<li>10.   <a href="#rfc.section.10">Privacy Considerations</a></li>
<li>11.   <a href="#rfc.section.11">IANA Considerations</a></li>
<li>12.   <a href="#rfc.references">References</a></li>
<ul><li>12.1.   <a href="#rfc.references.1">Normative References</a></li>
<li>12.2.   <a href="#rfc.references.2">Informative References</a></li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">Acknowledgements</a></li>
<li>Appendix B.   <a href="#rfc.appendix.B">Notices</a></li>
<li>Appendix C.   <a href="#rfc.appendix.C">Document History</a></li>
<li><a href="#rfc.authors">Authors' Addresses</a></li>


  </ul>

  <h1 id="rfc.section.1"><a href="#rfc.section.1">1.</a> <a href="#Introduction" id="Introduction">Introduction</a></h1>
<p id="rfc.section.1.p.1">OpenID Connect MODRNA Authentication Profile 1.0 is a profile of the <a href="#OpenID.Core">OpenID Connect Core 1.0</a> <cite title="NONE">[OpenID.Core]</cite> specification that defines common authentication contexts and further extensions to OpenID Connect Core to be used when requesting authentication from MNO's. Moreover it defines Mandatory to Implement features for MNOs to assure interoperability of clients across MNO's.  </p>
<h1 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1.</a> <a href="#rnc" id="rnc">Requirements Notation and Conventions</a></h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<p id="rfc.section.1.1.p.2">Throughout this document, values are quoted to indicate that they are to be taken literally. When using these values in protocol messages, the quotes MUST NOT be used as part of the value.</p>
<h1 id="rfc.section.1.2"><a href="#rfc.section.1.2">1.2.</a> <a href="#terminology" id="terminology">Terminology</a></h1>
<p id="rfc.section.1.2.p.1">This specification uses the termn "OpenID Provider (OP)" and "Relying Party (RP)" as defined by <a href="#OpenID.Core">OpenID Connect Core</a> <cite title="NONE">[OpenID.Core]</cite>.  This specification also defines the following terms: </p>

<dl>
  <dt>Mobile Network Operator (MNO)</dt>
  <dd style="margin-left: 8">A provider of wireless communication services that owns or controls the wireless network elements necessary to sell and deliver services to an end user.  </dd>
  <dt>Mobile Station International Subscriber Directory Number (MSISDN)</dt>
  <dd style="margin-left: 8">A telephone number uniquely identifying a subscription in a mobile network.  </dd>
  <dt>Consumption Device (CD)</dt>
  <dd style="margin-left: 8">A user agent, most probably a browser, on which the user consumes the actual service provided by the Relying Party.  </dd>
  <dt>Authentication Device (AD)</dt>
  <dd style="margin-left: 8">A mobile device on which the user will authenticate the actual login.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a> <a href="#overview" id="overview">Overview</a></h1>
<p id="rfc.section.2.p.1">This specification serves as a profile based on OpenID Connect Core <a href="#OpenID.Core">[OpenID.Core]</a>.  It defines additional request parameters in the Authentication Request.  It also specifies authentication class reference values based on the ISO/IEC DIS 29115 <a href="#ISO.29115">[ISO.29115]</a> to be used for the "acr_values" request parameter.  </p>
<h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a> <a href="#auth_request" id="auth_request">Authentication Request</a></h1>
<p id="rfc.section.3.p.1">MODRNA supports all request parameters as specified in OpenID Connect Core 3.1.2.1 <a href="#OpenID.Core">[OpenID.Core]</a>.  </p>
<p id="rfc.section.3.p.2">In addition the following parameters are defined or made REQUIRED for clients to send. All additional paramaters are REQUIRED for OP to support.</p>
<p/>

<dl>
  <dt>acr_values</dt>
  <dd style="margin-left: 8">REQUIRED. In <a href="#OpenID.Core">[OpenID.Core]</a> this parameter is specified as OPTIONAL.  For MODRNA this parameter is REQUIRED in order to enable the Relying Party to indicate a MODRNA conform authentication request to the OP.  Allowed values are defined in <a href="#acr_values">Section 4</a>.  </dd>
  <dt>login_hint_token</dt>
  <dd style="margin-left: 8">OPTIONAL. This is a new parameter. The login_hint_token is used to transport a user identifier from the Discovery Service to the OpenID Provider without revealing this identifier to the client.  <a href="#login_hint_token_structure">Section 6</a> specifies the structure of this parameter.  Protection of the login_hint_token's content is specified in <a href="#lht_encryption_signing">Section 6.1</a>.  </dd>
  <dt>binding_message</dt>
  <dd style="margin-left: 8">OPTIONAL. This is a new parameter. An Interlock message to tie the consumption device and the authentication device together.  How to ensure that the message is actually shown on all relevant devices is out of the scope of this document.  Possible values and constraints are specified in <a href="#binding_message_details">Section 7</a>.  Ways to protect the integrity of the binding_message are discussed in <a href="#security_considerations">Section 9</a>.  </dd>
</dl>
<h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a> <a href="#acr_values" id="acr_values">acr_values request values and level of assurance</a></h1>
<p id="rfc.section.4.p.1">The service's terms of service will specify a trust framework for Identity Providers to follow for general business processes and other related account security issues.  </p>
<p id="rfc.section.4.p.2">This specification defines an initial set of <samp>acr</samp> values that clients can use to request the IdP mitigate specific authentication risks.  </p>
<p id="rfc.section.4.p.3">The initial set of <samp>acr</samp> values contain no requirements for the IdP to make any guarantee of identity proofing the subject of the authentication beyond what is required by business practices for account recovery and customer service as defined in the trust framework.  Prepaid anonymous users may be included in responses conforming to these  values.  </p>
<p id="rfc.section.4.p.4">The IANA <a href="#RFC6711">Level of Assurance (LoA) Profiles</a> <cite title="NONE">[RFC6711]</cite> Registry will be used to register the short names for these LoA, and any future additional LoA.  </p>
<p/>

<dl>
  <dt>http://schemas.openid.net/policies/modrna/phishing-resistant</dt>
  <dd style="margin-left: 8">Short-Name: mod-pr <br/> This mitigates phishing of credentials.  <br/> The user is authenticated via possession of a device (phone) containing a secret key.  The user is required to provide no additional authentication information to use the key. The user is interactively prompted to confirm the authentication. The storage mechanism for the secret key and other relevant authentication information is returned via the <samp>amr</samp>. The user is not re-prompted for credentials if the value of <samp>prompt</samp> is not login and <samp>max_age</samp> is more than the elapsed time since the user last authenticated at the requested acr.  </dd>
  <dt>http://schemas.openid.net/policies/modrna/multi-factor</dt>
  <dd style="margin-left: 8">Short-Name: mod-mf <br/> This mitigates phishing and proves the device is recently in the possession of the authorised user via pin or device unlock.  <br/> The user is authenticated via possession of a device (phone) containing a secret key. The user is required to provide additional authentication information via a biometric, pin code or other appropriate factors such as bluetooth paring with a watch. Given suitable Mobile device management unlocking the device is also sufficient along with user confirmation of desire to authenticate. The storage mechanism for the secret key and other relevant authentication information is returned via the <samp>amr</samp> value.  The user is not re-prompted for credentials if the value of <samp>prompt</samp> is not login and <samp>max_age</samp> is more than the elapsed time since the user last authenticated at the requested acr.  </dd>
</dl>
<p id="rfc.section.4.p.6">Identity Providers MUST recognize and process short registered forms of the authentication context strings. They may recognize and process long forms for custom authentication contexts. </p>
<p id="rfc.section.4.p.7">Clients MUST send the short registered forms of the authentication context strings, if the authentication context is registered.  </p>
<p id="rfc.section.4.p.8">The OP MUST support receiving <samp>acr_values</samp> as a space separated list in order of preference per OpenID Connect Core 3.1.2.1 <a href="#OpenID.Core">[OpenID.Core]</a>.  </p>
<p id="rfc.section.4.p.9">The OP MUST support receiving <samp>acr</samp> as a claim request in a signed request per OpenID Connect Core 5.5.1 <a href="#OpenID.Core">[OpenID.Core]</a>.  This method prevents the request from being modified by the user, and allows the requested <samp>acr</samp> valued to be considered essential claims causing the IdP to respond with an authentication error if no requested <samp>acr</samp> value can be fulfilled.  </p>
<p id="rfc.section.4.p.10">Depending on the authentication capabilities of the users device, the OP must attempt to match the highest requested acr value that the AD is capable of.  If the acr claim is not marked as essential in the request object, the OP may return another acr value that the device is capable of rather than an error if it cannot match any of the requested acr_values.  </p>
<h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a> <a href="#amr_values" id="amr_values">Authentication Method Reference (amr)</a></h1>
<p id="rfc.section.5.p.1">The <samp>amr</samp> claim <a href="#OpenID.Core">OpenID Connect Core Sec 2</a> <cite title="NONE">[OpenID.Core]</cite> SHOULD be returned in the id_token if a <samp>acr</samp> value is specified in the request.  <br/> The <samp>amr</samp> claim is a JSON array containing one or more string values indicating the authentication methods used in the authentication.  </p>
<p id="rfc.section.5.p.2">The values for the strings in the <samp>amr</samp> claim are registered in a IANA registry defined in <a href="#I-D.ietf-oauth-amr-values">Authentication Method Reference Values</a> <cite title="NONE">[I-D.ietf-oauth-amr-values]</cite>.  </p>
<p id="rfc.section.5.p.3">This specification recommends the use of several of the values, to provide a standard way for clients to understand the authentication </p>
<p/>

<dl>
  <dt>user</dt>
  <dd style="margin-left: 8">User presence test.  </dd>
  <dt>pin</dt>
  <dd style="margin-left: 8">A Personal Identification Number or pattern  (Not restricted to numbers only) that a user used to unlock a key on the device.  This mechanism SHOULD have a way to deter an attacker from guessing the pin by making multiple guesses.  </dd>
  <dt>fpt</dt>
  <dd style="margin-left: 8">Fingerprint biometric </dd>
  <dt>sms</dt>
  <dd style="margin-left: 8">Confirmation by responding to a SMS sent to a known device.  </dd>
  <dt>swk</dt>
  <dd style="margin-left: 8">Proof-of-possession (PoP) of a software-secured key.  </dd>
  <dt>hwk</dt>
  <dd style="margin-left: 8">Proof-of-possession (PoP) of a hardware-secured key.  </dd>
  <dt>geo</dt>
  <dd style="margin-left: 8">Geo-Location of the authentication device.  </dd>
</dl>
<h1 id="rfc.section.5.1"><a href="#rfc.section.5.1">5.1.</a> <a href="#amr_examples" id="amr_examples">AMR Value Examples</a></h1>
<p id="rfc.section.5.1.p.1">If the authentication is performed by sending the users mobile device a SMS with a URI and having the user click on the link to confirm, it SHOULD have a <samp>amr</samp> value of ["sms","user"]</p>
<p id="rfc.section.5.1.p.2">If the authentication is by sending a secure message to a hardware element in mobile device's and the HW element signs a authentication challenge only after the user has entered a local PIN then it SHOULD have a <samp>amr</samp> value of ["hpop","pin"]</p>
<p id="rfc.section.5.1.p.3">If the authentication is by sending a secure message to a software application in the mobile device that signs a authentication challenge only after the user has entered a local fingerprint biometric then it SHOULD have a <samp>amr</samp> value of ["pop","fpt"]</p>
<p id="rfc.section.5.1.p.4">If the authentication is by sending a secure message to a hardware element in mobile device's and the HW element signs a authentication challenge only after the user has entered a local fingerprint biometric, and the IdP has preformed additional passive analytics based on geo location, then it SHOULD have a <samp>amr</samp> value of ["hpop","fpt","geo"]</p>
<p id="rfc.section.5.1.p.5">Note that if two or more authentication factors are used the MNO may include the <samp>amr</samp> value <samp>mfa</samp> and optionally not include the specific factors.  <br/> Note: that the order of elements in the <samp>amr</samp> array is not significant.</p>
<h1 id="rfc.section.6"><a href="#rfc.section.6">6.</a> <a href="#login_hint_token_structure" id="login_hint_token_structure">login_hint_token</a></h1>
<p id="rfc.section.6.p.1">The <samp>login_hint_token</samp> is used to pass a user hint into the authentication process at the OP. This hint is opaque to the client by design.  There are several ways for a client to obtain a login hint token.  To start with, the <a href="#MODRNA.Discovery">MODRNA discovery service</a> <cite title="NONE">[MODRNA.Discovery]</cite> creates a hint if the user has entered their MSISDN in the course of the MNO discovery process.  </p>
<p id="rfc.section.6.p.2">In the case of a <samp>login_hint_token</samp> produced by the MODRNA Discovery Service it is an encrypted Json Web Token <a href="#RFC7519">JWT</a> <cite title="NONE">[RFC7519]</cite> that contains a user hint for the OP.  The <samp>login_hint_token</samp> SHALL be used by the client as login hint with OP identified by the <a href="#MODRNA.Discovery">MODRNA discovery service</a> <cite title="NONE">[MODRNA.Discovery]</cite>.  In this case, the login hint token is supposed to be a signed and encrypted JWT.  </p>
<p id="rfc.section.6.p.3">The Authorization server may produce <samp>login_hint_token</samp> tokens in other formats for use in Account Chooser or other discovery profiles, as long as they are confidentiality protected from the client.  </p>
<p id="rfc.section.6.p.4">The <samp>login_hint_token</samp> produced by the <a href="#MODRNA.Discovery">MODRNA discovery service</a> <cite title="NONE">[MODRNA.Discovery]</cite> has the following elements: </p>

<dl>
  <dt>iss</dt>
  <dd style="margin-left: 8">REQUIRED. The party creating the token.  This value MUST be used by the IdP receiving the token to obtain the <a href="#RFC7517">JWK</a> <cite title="NONE">[RFC7517]</cite> file required to validate the tokens's signature (see <a href="#lht_encryption_signing">Section 6.1</a>).  </dd>
  <dt>aud</dt>
  <dd style="margin-left: 8">REQUIRED. The party to receive the token, typically the users OpenID Provider.  The value MUST be the issuer URI of the OP as exposed in the IdP's openid-configuration meta-data.  </dd>
  <dt>iat</dt>
  <dd style="margin-left: 8">REQUIRED. When the token was issued.  </dd>
  <dt>MSISDN</dt>
  <dd style="margin-left: 8">REQUIRED.  The Subscriber identifier formated according to ITU-T recommendation <a href="#E.164">[E.164]</a> </dd>
</dl>

<p> </p>
<p>The following is a non-normative example of JWT body (with line wraps within values for display purposes only):</p>
<pre>
  {
   "iss": "https://discovery-provider.com",
   "aud": "https://babytel.com",
   "iat": 1311280970,
   "MSISDN": "+1999550123"
  }
                </pre>
<h1 id="rfc.section.6.1"><a href="#rfc.section.6.1">6.1.</a> <a href="#lht_encryption_signing" id="lht_encryption_signing">login_hint_token encryption and signing</a></h1>
<p id="rfc.section.6.1.p.1">The login_hint token MUST be encrypted using the public key of the OpenID Provider designated by the claim "aud" in the login_hint_token.  The appropriate public key is obtained using the rules defined in <a href="#OpenID.Discovery">OpenID Connect Discovery.</a> <cite title="NONE">[OpenID.Discovery]</cite> </p>
<p id="rfc.section.6.1.p.2">In the first step, the openid-configuration for the IdP is retrieved by performing discovery Per Section 4 of <a href="#OpenID.Discovery">[OpenID.Discovery]</a> using the issuer string for the users IdP as the input.  <br/> In the next step, the value of the "jwks_uri" claim Per Section 3 of <a href="#OpenID.Discovery">[OpenID.Discovery]</a> is used to retrieve the OP's <a href="#RFC7517">JWK</a> <cite title="NONE">[RFC7517]</cite>.  A public key in the JWK with a use paramater of "enc" per Section 4.2 of <a href="#RFC7517">JWK</a> <cite title="NONE">[RFC7517]</cite> is used as the encryption key.  The login_hint_token is then encrypted as a JWE using that key.  </p>
<p id="rfc.section.6.1.p.3">The login_hint token MUST be signed using the private key of the Discovery Service.</p>
<p id="rfc.section.6.1.p.4">It is best practice to sign then encrypt tokens, as signatures over encrypted information may leak information in the envelope, and may not be considered legally valid.</p>
<p id="rfc.section.6.1.p.5">For an example of a nested JWT that is signed and then encrypted see Appendix 2 of <a href="#RFC7519">JWT</a> <cite title="NONE">[RFC7519]</cite>.  </p>
<p id="rfc.section.6.1.p.6">NOTE:  The <samp>login_hint_token</samp> is opaque to the client by design.  The Authorization server may produce <samp>login_hint_token</samp> tokens in other formats for use in Account Chooser or other discovery profiles, as long as they are confidentiality protected from the client. </p>
<h1 id="rfc.section.7"><a href="#rfc.section.7">7.</a> <a href="#binding_message_details" id="binding_message_details">binding_message</a></h1>
<p id="rfc.section.7.p.1">The <samp>binding_message</samp> parameter is a text provided by the RP intended to be shown to the user on the consumption device as well as on the authentication device as an interlock between RP and OP.  </p>
<p id="rfc.section.7.p.2">The <samp>binding_message</samp> MUST be plain text using the "application/x-www-form-urlencoded" format as the authentication device in particular may have limited abilities to show text or formats.  </p>
<p id="rfc.section.7.p.3">The <samp>binding_message</samp> SHOULD be displayable on all participating devices. The RP SHOULD consider that some authentication devices e.g. as SIM-Applets are able to show only a very limited number of characters.  </p>
<h1 id="rfc.section.8"><a href="#rfc.section.8">8.</a> <a href="#m_t_i" id="m_t_i">mandatory to implement</a></h1>
<p/>

<dl>
  <dt>acr_values</dt>
  <dd style="margin-left: 8">All MODRNA compliant OP's MUST accept the acr_values specified in <a href="#acr_values">Section 4</a> </dd>
</dl>
<h1 id="rfc.section.9"><a href="#rfc.section.9">9.</a> <a href="#security_considerations" id="security_considerations">Security Considerations</a></h1>
<p id="rfc.section.9.p.1">The login hint token SHOULD be digitally signed by the issuer.  This ensures authenticity of the data and reduces the threat of an injection attack.  The signature allows the OP to authenicate and authorize the sender of the hint and prevent collecting of phone numbers by rogue clients.  </p>
<p id="rfc.section.9.p.2">To prevent modification of the <samp>binding_message</samp> value, the RP SHOULD send the parameter to the OP using a signed OpenID Connect Request Object (section 6.3.2 of <a href="#OpenID.Core">[OpenID.Core]</a>).  </p>
<p id="rfc.section.9.p.3">The OP MUST sanitize the <samp>binding_message</samp> value in order to prevent injection attacks.  </p>
<p id="rfc.section.9.p.4">The <samp>binding_message</samp> value being displayed on the consumption and authentication device SHOULD contain a random value (e.g. an authorization code) of reasonable entropy.  This is a countermeasure against session fixation type attacks, where the attacker initiates an authentication process on a consumption device under his control, which will result in the same text being displayed on the authentication device as for legitimate transactions.  </p>
<h1 id="rfc.section.10"><a href="#rfc.section.10">10.</a> <a href="#privacy_considerations" id="privacy_considerations">Privacy Considerations</a></h1>
<p id="rfc.section.10.p.1">The login hint token is encrypted in order to protect the user's MSISDN from being revealed to the client unintentionally.  </p>
<h1 id="rfc.section.11"><a href="#rfc.section.11">11.</a> <a href="#IANA" id="IANA">IANA Considerations</a></h1>
<p id="rfc.section.11.p.1">TBD: Find out about how to correctly add entries to IANA for: https://www.iana.org/assignment/loa-profiles/loa-profiles.xhtml </p>
<h1 id="rfc.references"><a href="#rfc.references">12.</a> References</h1>
<h1 id="rfc.references.1"><a href="#rfc.references.1">12.1.</a> Normative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="I-D.ietf-oauth-amr-values">[I-D.ietf-oauth-amr-values]</b>
      </td>
      <td class="top"><a>Jones, M.</a>, <a>Hunt, P.</a> and <a>A. Nadalin</a>, "<a href="http://tools.ietf.org/html/draft-ietf-oauth-amr-values-06">Authentication Method Reference Values</a>", Internet-Draft draft-ietf-oauth-amr-values-06, February 2017.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="OpenID.Core">[OpenID.Core]</b>
      </td>
      <td class="top"><a title="Nomura Research Institute, Ltd.">Sakimura, N.</a>, <a title="Ping Identity">Bradley, J.</a>, <a title="Microsoft">Jones, M.</a>, <a title="Google">de Medeiros, B.</a> and <a title="Salesforce">C. Mortimore</a>, "<a href="http://openid.net/specs/openid-connect-core-1_0.html">OpenID Connect Core 1.0</a>", November 2014.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="OpenID.Discovery">[OpenID.Discovery]</b>
      </td>
      <td class="top"><a title="Nomura Research Institute, Ltd.">Sakimura, N.</a>, <a title="Ping Identity">Bradley, J.</a>, <a title="Microsoft">Jones, M.</a> and <a title="Illumila">E. Jay</a>, "<a href="http://openid.net/specs/openid-connect-discovery-1_0.html">OpenID Connect Discovery 1.0</a>", November 2014.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2119">[RFC2119]</b>
      </td>
      <td class="top"><a>Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6711">[RFC6711]</b>
      </td>
      <td class="top"><a>Johansson, L.</a>, "<a href="http://tools.ietf.org/html/rfc6711">An IANA Registry for Level of Assurance (LoA) Profiles</a>", RFC 6711, DOI 10.17487/RFC6711, August 2012.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7517">[RFC7517]</b>
      </td>
      <td class="top"><a>Jones, M.</a>, "<a href="http://tools.ietf.org/html/rfc7517">JSON Web Key (JWK)</a>", RFC 7517, DOI 10.17487/RFC7517, May 2015.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7519">[RFC7519]</b>
      </td>
      <td class="top"><a>Jones, M.</a>, <a>Bradley, J.</a> and <a>N. Sakimura</a>, "<a href="http://tools.ietf.org/html/rfc7519">JSON Web Token (JWT)</a>", RFC 7519, DOI 10.17487/RFC7519, May 2015.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.references.2"><a href="#rfc.references.2">12.2.</a> Informative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="E.164">[E.164]</b>
      </td>
      <td class="top"><a title="ITU-T">N., </a>, "<a>Recommendation ITU-T E.164</a>", November 2010.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="ISO.29115">[ISO.29115]</b>
      </td>
      <td class="top"><a title="ISO">McAllister, E.</a> and <a title="ITU-T">R. Brackney</a>, "<a>ISO/IEC DIS 29115</a>", April 2013.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="MODRNA.Discovery">[MODRNA.Discovery]</b>
      </td>
      <td class="top"><a title="Deutsche Telekom AG">Lodderstedt, T.</a> and <a title="Ping Identity">J. Bradley</a>, "<a href="https://bitbucket.org/openid/mobile/raw/default/draft-mobile-discovery-01.txt">OpenID Connect Mobile Discovery Profile 1.0</a>", August 2015.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2246">[RFC2246]</b>
      </td>
      <td class="top"><a>Dierks, T.</a> and <a>C. Allen</a>, "<a href="http://tools.ietf.org/html/rfc2246">The TLS Protocol Version 1.0</a>", RFC 2246, DOI 10.17487/RFC2246, January 1999.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5246">[RFC5246]</b>
      </td>
      <td class="top"><a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, DOI 10.17487/RFC5246, August 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6749">[RFC6749]</b>
      </td>
      <td class="top"><a>Hardt, D.</a>, "<a href="http://tools.ietf.org/html/rfc6749">The OAuth 2.0 Authorization Framework</a>", RFC 6749, DOI 10.17487/RFC6749, October 2012.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6750">[RFC6750]</b>
      </td>
      <td class="top"><a>Jones, M.</a> and <a>D. Hardt</a>, "<a href="http://tools.ietf.org/html/rfc6750">The OAuth 2.0 Authorization Framework: Bearer Token Usage</a>", RFC 6750, DOI 10.17487/RFC6750, October 2012.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.appendix.A"><a href="#rfc.appendix.A">Appendix A.</a> <a href="#Acknowledgements" id="Acknowledgements">Acknowledgements</a></h1>
<p id="rfc.section.A.p.1">The following have contributed to the development of this specification.</p>
<p/>

<ul class="empty">
  <li>Matthieu Verdier (matthieu.verdier@orange.com), Orange</li>
  <li>Gonzalo Fernandez Rodriguez (gonzalo.fernandezrodriguez@telefonica.com), Telefonica</li>
</ul>
<h1 id="rfc.appendix.B"><a href="#rfc.appendix.B">Appendix B.</a> <a href="#Notices" id="Notices">Notices</a></h1>
<p id="rfc.section.B.p.1">Copyright (c) 2017 The OpenID Foundation.</p>
<p id="rfc.section.B.p.2">The OpenID Foundation (OIDF) grants to any Contributor, developer, implementer, or other interested party a non-exclusive, royalty free, worldwide copyright license to reproduce, prepare derivative works from, distribute, perform and display, this Implementers Draft or Final Specification solely for the purposes of (i) developing specifications, and (ii) implementing Implementers Drafts and Final Specifications based on such documents, provided that attribution be made to the OIDF as the source of the material, but that such attribution does not indicate an endorsement by the OIDF.  </p>
<p id="rfc.section.B.p.3">The technology described in this specification was made available from contributions from various sources, including members of the OpenID Foundation and others.  Although the OpenID Foundation has taken steps to help ensure that the technology is available for distribution, it takes no position regarding the validity or scope of any intellectual property or other rights that might be claimed to pertain to the implementation or use of the technology described in this specification or the extent to which any license under such rights might or might not be available; neither does it represent that it has made any independent effort to identify any such rights.  The OpenID Foundation and the contributors to this specification make no (and hereby expressly disclaim any) warranties (express, implied, or otherwise), including implied warranties of merchantability, non-infringement, fitness for a particular purpose, or title, related to this specification, and the entire risk as to implementing this specification is assumed by the implementer.  The OpenID Intellectual Property Rights policy requires contributors to offer a patent promise not to assert certain patent claims against other contributors and against implementers.  The OpenID Foundation invites any interested party to bring to its attention any copyrights, patents, patent applications, or other proprietary rights that may cover technology that may be required to practice this specification.  </p>
<h1 id="rfc.appendix.C"><a href="#rfc.appendix.C">Appendix C.</a> <a href="#History" id="History">Document History</a></h1>
<p id="rfc.section.C.p.1">[[ To be removed from the final specification ]]</p>
<p id="rfc.section.C.p.2">-06 </p>

<ul>
  <li>update reference to amr spec</li>
  <li>Make Date current for implementers draft</li>
</ul>
<p id="rfc.section.C.p.3">-01 </p>

<ul>
  <li>Initial draft</li>
  <li>Added OIDF Standard Notice </li>
  <li>changed references to amr specification</li>
</ul>
<h1 id="rfc.authors">
  <a href="#rfc.authors">Authors' Addresses</a>
</h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Joerg Connotte</span> 
	  <span class="n hidden">
		<span class="family-name">Connotte</span>
	  </span>
	</span>
	<span class="org vcardline">Deutsche Telekom AG</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:j.connotte@telekom.de">j.connotte@telekom.de</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">John Bradley</span> 
	  <span class="n hidden">
		<span class="family-name">Bradley</span>
	  </span>
	</span>
	<span class="org vcardline">Ping Identity</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:jbradley@pingidentity.com">jbradley@pingidentity.com</a></span>

  </address>
</div>

</body>
</html>

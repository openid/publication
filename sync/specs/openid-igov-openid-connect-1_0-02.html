<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>International Government Assurance Profile (iGov) for OpenID Connect 1.0 - Draft 02</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Requirements Notation and Conventions">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Terminology">
<link href="#rfc.section.1.3" rel="Chapter" title="1.3 Conformance">
<link href="#rfc.section.2" rel="Chapter" title="2 Relying Party Profile">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Requests to the Authorization Endpoint (Authentication Request)">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Requests to the Token Endpoint">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 ID Tokens">
<link href="#rfc.section.2.4" rel="Chapter" title="2.4 Request Objects">
<link href="#rfc.section.2.5" rel="Chapter" title="2.5 Discovery">
<link href="#rfc.section.3" rel="Chapter" title="3 OpenID Provider Profile">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 ID Tokens">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 UserInfo Endpoint">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Request Objects">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Vectors of Trust">
<link href="#rfc.section.3.5" rel="Chapter" title="3.5 Authentication Context">
<link href="#rfc.section.3.6" rel="Chapter" title="3.6 Discovery">
<link href="#rfc.section.3.7" rel="Chapter" title="3.7 Dynamic Registration">
<link href="#rfc.section.4" rel="Chapter" title="4 User Info">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Claims Supported">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Scope Profiles">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Claims Metadata">
<link href="#rfc.section.4.3.1" rel="Chapter" title="4.3.1 Claim Level of Assurance">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 Example UserInfo with Metadata">
<link href="#rfc.section.5" rel="Chapter" title="5 Privacy Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 Security Considerations">
<link href="#rfc.references" rel="Chapter" title="7 Normative References">
<link href="#rfc.appendix.A" rel="Chapter" title="A Acknowledgements">
<link href="#rfc.appendix.B" rel="Chapter" title="B Notices">
<link href="#rfc.appendix.C" rel="Chapter" title="C Document History">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.6.2 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Varley, M., Ed. and P. Grassi, Ed." />
  <meta name="dct.identifier" content="urn:ietf:id:openid-igov-openid-connect-1_0" />
  <meta name="dct.issued" scheme="ISO8601" content="2017-7-7" />
  <meta name="dct.abstract" content="The OpenID Connect protocol defines an identity federation system that allows a relying party to request and receive authentication and profile information about an end user.  " />
  <meta name="description" content="The OpenID Connect protocol defines an identity federation system that allows a relying party to request and receive authentication and profile information about an end user.  " />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left"></td>
<td class="right">M. Varley, Ed.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right"></td>
</tr>
<tr>
<td class="left"></td>
<td class="right">P. Grassi, Ed.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">July 7, 2017</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">International Government Assurance Profile (iGov) for OpenID Connect 1.0 - Draft 02<br />
  <span class="filename">openid-igov-openid-connect-1_0</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>The OpenID Connect protocol defines an identity federation system that allows a relying party to request and receive authentication and profile information about an end user.  </p>
<p>This specification profiles the OpenID Connect protocol to increase baseline security, provide greater interoperability, and structure deployments in a manner specifically applicable to (but not limited to) government and public service domains.  </p>
<p>This profile builds on top of, and inherits all properties of, the <a href="#iGov.OAuth2" class="xref">OAUTH profile for iGov.</a> </p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Requirements Notation and Conventions</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Terminology</a>
</li>
<li>1.3.   <a href="#rfc.section.1.3">Conformance</a>
</li>
</ul><li>2.   <a href="#rfc.section.2">Relying Party Profile</a>
</li>
<ul><li>2.1.   <a href="#rfc.section.2.1">Requests to the Authorization Endpoint (Authentication Request)</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Requests to the Token Endpoint</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">ID Tokens</a>
</li>
<li>2.4.   <a href="#rfc.section.2.4">Request Objects</a>
</li>
<li>2.5.   <a href="#rfc.section.2.5">Discovery</a>
</li>
</ul><li>3.   <a href="#rfc.section.3">OpenID Provider Profile</a>
</li>
<ul><li>3.1.   <a href="#rfc.section.3.1">ID Tokens</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">UserInfo Endpoint</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Request Objects</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">Vectors of Trust</a>
</li>
<li>3.5.   <a href="#rfc.section.3.5">Authentication Context</a>
</li>
<li>3.6.   <a href="#rfc.section.3.6">Discovery</a>
</li>
<li>3.7.   <a href="#rfc.section.3.7">Dynamic Registration</a>
</li>
</ul><li>4.   <a href="#rfc.section.4">User Info</a>
</li>
<ul><li>4.1.   <a href="#rfc.section.4.1">Claims Supported</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Scope Profiles</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Claims Metadata</a>
</li>
<ul><li>4.3.1.   <a href="#rfc.section.4.3.1">Claim Level of Assurance</a>
</li>
</ul><li>4.4.   <a href="#rfc.section.4.4">Example UserInfo with Metadata</a>
</li>
</ul><li>5.   <a href="#rfc.section.5">Privacy Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">Security Considerations</a>
</li>
<li>7.   <a href="#rfc.references">Normative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.A">Acknowledgements</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.B">Notices</a>
</li>
<li>Appendix C.   <a href="#rfc.appendix.C">Document History</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#Introduction" id="Introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">Government regulations for permitting users (citizens and non-citizens) online access to government resources vary greatly from region to region.  There is a strong desire to leverage federated authentication and identity services for public access to government resources online to reduce 'password fatigue', increase overall account security, reduce cost, and provide reliable identity assurances from established and trusted sources when applicable.  </p>
<p id="rfc.section.1.p.2">This specification aims to define an OpenID Connect profile that provides governments with a foundation for securing federated access to public services online.  </p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#rnc" id="rnc">Requirements Notation and Conventions</a>
</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119" class="xref">RFC 2119</a> .  </p>
<p id="rfc.section.1.1.p.2">All uses of <a href="#RFC7515" class="xref">JSON Web Signature (JWS)</a> and <a href="#RFC7516" class="xref">JSON Web Encryption (JWE)</a> data structures in this specification utilize the JWS Compact Serialization or the JWE Compact Serialization; the JWS JSON Serialization and the JWE JSON Serialization are not used.  </p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> <a href="#Terminology" id="Terminology">Terminology</a>
</h1>
<p id="rfc.section.1.2.p.1">This specification uses the terms "Access Token", "Authorization Code", "Authorization Endpoint", "Authorization Grant", "Authorization Server", "Client", "Client Authentication", "Client Identifier", "Client Secret", "Grant Type", "Protected Resource", "Redirection URI", "Refresh Token", "Resource Owner", "Resource Server", "Response Type", and "Token Endpoint" defined by <a href="#RFC6749" class="xref">OAuth 2.0</a> , the terms "Claim Name", "Claim Value", and "JSON Web Token (JWT)" defined by <a href="#RFC7519" class="xref">JSON Web Token (JWT)</a> , and the terms defined by <a href="#OpenID.Core" class="xref">OpenID Connect Core 1.0</a> .  </p>
<h1 id="rfc.section.1.3">
<a href="#rfc.section.1.3">1.3.</a> Conformance</h1>
<p id="rfc.section.1.3.p.1">This specification defines requirements for the following components: </p>
<p></p>

<ul>
<li>OpenID Connect 1.0 relying parties (also known as OpenID Clients) </li>
<li>OpenID Connect 1.0 identity providers (also known as OpenID Providers) </li>
</ul>

<p> </p>
<p id="rfc.section.1.3.p.3">The specification also defines features for interaction between these components: </p>
<p></p>

<ul><li>Relying party to identity provider</li></ul>

<p> </p>
<p id="rfc.section.1.3.p.5">When an iGov-compliant component is interacting with other iGov-compliant components, in any valid combination, all components MUST fully conform to the features and requirements of this specification. All interaction with non-iGov components is outside the scope of this specification.  </p>
<p id="rfc.section.1.3.p.6">An iGov-compliant OpenID Connect IdP MUST support all features as described in this specification. A general-purpose IdP MAY support additional features for use with non-iGov clients.  </p>
<p id="rfc.section.1.3.p.7">An iGov-compliant OpenID Connect IdP MAY also provide iGov-compliant OAuth 2.0 authorization server functionality. In such cases, the authorization server MUST fully implement the OAuth 2.0 iGov profile. If an iGov-compliant OpenID Connect IdP does not provide iGov-compliant OAuth 2.0 authorization server services, all features related to interaction between the authorization server and protected resource are therefore OPTIONAL.  </p>
<p id="rfc.section.1.3.p.8">An iGov-compliant OpenID Connect client MUST use all functions as described in this specification. A general-purpose client library MAY support additional features for use with non-iGov IdPs.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Relying Party Profile</h1>
<p></p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Requests to the Authorization Endpoint (Authentication Request)</h1>
<p id="rfc.section.2.1.p.1">The <a href="#iGov.OAuth2" class="xref">iGov OAuth2 profile</a> specifies requirements for requests to Authorization Endpoints - for example, when to use the <a href="#RFC7636" class="xref">PKCE</a> parameters to secure token exchange.  </p>
<p id="rfc.section.2.1.p.2">In addition to the requirements specified in Section 2.1.1 of the <a href="#iGov.OAuth2" class="xref">iGov OAuth2 profile</a>, the following describes the supported OpenID Connect Authorization Code Flow parameters for use with iGov compatible	IdPs.  </p>
<p id="rfc.section.2.1.p.3">Request Parameters: </p>

<dl>
<dt>client_id</dt>
<dd style="margin-left: 8">REQUIRED. OAuth 2.0 Client Identifier valid at the Authorization Server.  </dd>
<dt>response_type</dt>
<dd style="margin-left: 8">REQUIRED. MUST be set to <samp>code</samp> .  </dd>
<dt>scope</dt>
<dd style="margin-left: 8">REQUIRED. Indicates the attributes being requested.  (See below) </dd>
<dt>redirect_uri</dt>
<dd style="margin-left: 8">REQUIRED. Indicates a valid endpoint where the client will receive the authentication response. See (core section 3.1.2.1) </dd>
<dt>state</dt>
<dd style="margin-left: 8">REQUIRED. Unguessable random string generated by the RP, used to protect against CSRF attacks. Must contain a sufficient amount of entropy to avoid guessing. Returned to the RP in the authentication response.  </dd>
<dt>prompt</dt>
<dd style="margin-left: 8">REQUIRED. This value must be set to <samp>select_account</samp> .  </dd>
<dt>nonce</dt>
<dd style="margin-left: 8">REQUIRED. Unguessable random string generated by the client, used to protect against CSRF attacks. Must contain a sufficient amount of entropy to avoid guessing. Returned to the client in the ID Token.  </dd>
<dt>vtr</dt>
<dd style="margin-left: 8">OPTIONAL. MUST be set to a value as described in Section 6.1 of <a href="#I-D.richer-vectors-of-trust" class="xref">Vectors of Trust</a> <samp>vtr</samp> takes precedence over <samp>acr_values</samp>.  </dd>
<dt>acr_values</dt>
<dd style="margin-left: 8">OPTIONAL. Lists the acceptable LoAs for this authentication. See (below). MUST not be set if <samp>vtr</samp> is specified.  </dd>
<dt>code_challenge and code_challenge_method</dt>
<dd style="margin-left: 8">OPTIONAL. If the PKCE protocol is being used by the client. See <a href="#iGov.OAuth2" class="xref">OAUTH profile for iGov.</a> </dd>
</dl>

<p> </p>
<p id="rfc.section.2.1.p.4">A sample request may look like:</p>
<pre>
https://idp.government.gov/oidc/authorization?
  response_type=code
  &amp;client_id=827937609728-m2mvqffo9bsefh4di90saus4n0diar2h
  &amp;scope=d+openid
  &amp;redirect_uri=https%3A%2F%2Frp.fed1.gov%2Foidc%2FloginResponse
  &amp;state=2ca3359dfbfd0
  &amp;prompt=select_account
  &amp;acr_values=http%3A%2F%2Fidmanagement.gov%2Fns%2Fassurance%2Floa%2F1
+http%3A%2F%2Fidmanagement.gov%2Fns%2Fassurance%2Floa%2F2
+http%3A%2F%2Fidmanagement.gov%2Fns%2Fassurance%2Floa%2F3
+http%3A%2F%2Fidmanagement.gov%2Fns%2Fa
</pre>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> <a href="#RequestsToTokenEndpoint" id="RequestsToTokenEndpoint">Requests to the Token Endpoint</a>
</h1>
<p id="rfc.section.2.2.p.1">In addition to the requirements specified in Section 2.1.2 of the <a href="#iGov.OAuth2" class="xref">iGov OAuth2 profile</a> , the following claims MUST be included: </p>
<p id="rfc.section.2.2.p.2">The following parameters are specified: </p>

<dl>
<dt>grant_type</dt>
<dd style="margin-left: 8">MUST be set to <samp>authorization_code</samp> .  </dd>
<dt>code</dt>
<dd style="margin-left: 8">The value of the code parameter returned in the authorization response.</dd>
<dt>client_assertion_type</dt>
<dd style="margin-left: 8">MUST be set to <samp>urn:ietf:params:oauth:client-assertion-type:jwt-bearer</samp> .  </dd>
<dt>client_assertion</dt>
<dd style="margin-left: 8">The value of the signed client authentication JWT generated as described below. The RP must generate a new assertion JWT for each call to the token endpoint.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> ID Tokens</h1>
<p id="rfc.section.2.3.p.1">All clients MUST validate the signature of an ID Token before accepting it using the public key of the issuing server, which is published in <a href="#RFC7517" class="xref">JSON Web Key (JWK)</a> format. ID Tokens MAY be encrypted using the appropriate key of the requesting client.  </p>
<p id="rfc.section.2.3.p.2">Clients MUST verify the following in received ID tokens: </p>

<dl>
<dt>iss</dt>
<dd style="margin-left: 8">The "issuer" field is the Uniform Resource Locater (URL) of the expected issuer </dd>
<dt>aud</dt>
<dd style="margin-left: 8">The "audience" field contains the client ID of the client </dd>
<dt>exp, iat, nbf</dt>
<dd style="margin-left: 8">The "expiration", "issued at", and "not before" timestamps for the token are dates (integer number of seconds since from 1970-01-01T00:00:00Z UTC) within acceptable ranges </dd>
</dl>

<p> </p>
<h1 id="rfc.section.2.4">
<a href="#rfc.section.2.4">2.4.</a> Request Objects</h1>
<p id="rfc.section.2.4.p.1">Clients MAY optionally send requests to the authorization endpoint using the <samp>request</samp> parameter as defined by <a href="#OpenID.Core" class="xref">OpenID Connect</a> .  Clients MAY send requests to the authorization endpoint by reference using the request_uri parameter.  </p>
<p id="rfc.section.2.4.p.2">Request objects MUST be signed by the client's registered key.  Request objects MAY be encrypted to the authorization server's public key.  </p>
<h1 id="rfc.section.2.5">
<a href="#rfc.section.2.5">2.5.</a> Discovery</h1>
<p id="rfc.section.2.5.p.1">Clients and protected resources SHOULD cache OpenID provider metadata once an OP has been discovered and used by the client.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> OpenID Provider Profile</h1>
<p></p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> ID Tokens</h1>
<p id="rfc.section.3.1.p.1">All ID Tokens MUST be signed by the OpenID Provider's private signature key. ID Tokens MAY be encrypted using the appropriate key of the requesting client.  </p>
<p id="rfc.section.3.1.p.2">The ID Token MUST expire and SHOULD have an active lifetime no longer than five minutes. Since the ID token is consumed by the client and not presented to remote systems, much shorter expiration times are RECOMMENDED where possible.  </p>
<p id="rfc.section.3.1.p.3">The token response includes an access token (which can be used to make a UserInfo request) and ID token (a signed and optionally encrypted JSON Web Token). ID Token values have the following meanings: </p>

<dl>
<dt>iss</dt>
<dd style="margin-left: 8">REQUIRED. The "issuer" field is the Uniform Resource Locater (URL) of the expected issuer.  </dd>
<dt>aud</dt>
<dd style="margin-left: 8">REQUIRED. The "audience" field contains the client ID of the client.  </dd>
<dt>sub</dt>
<dd style="margin-left: 8">REQUIRED. The identifier of the user. SHOULD be a pairwize annonymous identifier, and be unique per client to prevent linkability and traceability between clients.  </dd>
<dt>vot</dt>
<dd style="margin-left: 8">OPTIONAL. The vector value as specified in <a href="#I-D.richer-vectors-of-trust" class="xref">Vectors of Trust</a> . See <a href="#vot" class="xref">Vectors of Trust</a> for more details.  <samp>vot</samp> takes precedence over acr.  </dd>
<dt>vtm</dt>
<dd style="margin-left: 8">REQUIRED if <samp>vot</samp> is provided.  The trustmark URI as specified in <a href="#I-D.richer-vectors-of-trust" class="xref">Vectors of Trust</a> . See <a href="#vot" class="xref">Vectors of Trust</a> for more details.  </dd>
<dt>acr</dt>
<dd style="margin-left: 8">OPTIONAL.  The LoA the user was authenticated at. MUST be a member of the <samp>acr_values</samp> list from the authentication request.  The OP MUST NOT include if <samp>vot</samp> is provided. See <a href="#AuthenticationContext" class="xref">Authentication Context</a> for more details.  </dd>
<dt>nonce</dt>
<dd style="margin-left: 8">The nonce value that was provided in the authentication request. MUST be Included if provided in authentication request.  </dd>
<dt>jti</dt>
<dd style="margin-left: 8">REQUIRED. A unique identifier for the token, which can be used to prevent reuse of the token.  </dd>
<dt>exp, iat, nbf</dt>
<dd style="margin-left: 8">REQUIRED. The "expiration", "issued at", and "not before" timestamps for the token are dates (integer number of seconds since from 1970-01-01T00:00:00Z UTC) within acceptable ranges.  </dd>
</dl>

<p> </p>
<p id="rfc.section.3.1.p.4">This example ID token has been signed using the server's RSA key: </p>
<pre>eyJhbGciOiJSUzI1NiJ9.eyJhdXRoX3RpbWUiOjE0
        MTg2OTg3ODIsImV4cCI6MTQxODY5OTQxMiwic3ViI
        joiNldaUVBwblF4ViIsIm5vbmNlIjoiMTg4NjM3Yj
        NhZjE0YSIsImF1ZCI6WyJjMWJjODRlNC00N2VlLTR
        iNjQtYmI1Mi01Y2RhNmM4MWY3ODgiXSwiaXNzIjoi
        aHR0cHM6XC9cL2lkcC1wLmV4YW1wbGUuY29tXC8iL
        CJpYXQiOjE0MTg2OTg4MTJ9mQc0rtL56dnJ7_zO_f
        x8-qObsQhXcn-qN-FC3JIDBuNmP8i11LRA_sgh_om
        RRfQAUhZD5qTRPAKbLuCD451lf7ALAUwoGg8zAASI
        5QNGXoBVVn7buxPd2SElbSnHxu0o8ZsUZZwNpircW
        NUlYLje6APJf0kre9ztTj-5J1hRKFbbHodR2I1m5q
        8zQR0ql-FoFlOfPhvfurXxCRGqP1xpvLLBUi0JAw3
        F8hZt_i1RUYWMqLQZV4VU3eVNeIPAD38qD1fxTXGV
        Ed2XDJpmlcxjrWxzJ8fGfJrbsiHCzmCjflhv34O22
        zb0lJpC0d0VScqxXjNTa2-ULyCoehLcezmssg</pre>
<p id="rfc.section.3.1.p.5">Its claims are as follows:</p>
<pre> {
        "auth_time": 1418698782,
        "exp": 1418699412,
        "sub": "6WZQPpnQxV",
        "nonce": "188637b3af14a",
        "aud": [
          "c1bc84e4-47ee-4b64-bb52-5cda6c81f788"
        ],
        "iss": "https:\\/\\/idp-p.example.com\\/",
        "acr":"LOA1",
        "vot":"",
        "iat": 1418698812
        }
        </pre>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#UserInfoEndpoint" id="UserInfoEndpoint">UserInfo Endpoint</a>
</h1>
<p id="rfc.section.3.2.p.1">Servers MUST support the UserInfo Endpoint and, at a minimum, the <samp>sub</samp> (subject) claim. It is expected that the <samp>sub</samp> claim will remain pseudonymous in use cases where obtaining personal information is not needed.  </p>
<p id="rfc.section.3.2.p.2">Support for a UserInfo Endpoint is important for maximum client implementation interoperability even if no additional user information is returned.  Clients are not required to call the UserInfo Endpoint, but should not receive an error if they do.  </p>
<p id="rfc.section.3.2.p.3">In an example transaction, the client sends a request to the UserInfo Endpoint like the following: </p>
<pre>GET /userinfo HTTP/1.1
Authorization: Bearer eyJhbGciOiJSUzI1NiJ9.eyJleHAiOjE0MTg3MDI0MTIsIm
F1ZCI6WyJjMWJjODRlNC00N2VlLTRiNjQtYmI1Mi01Y2RhNmM4MWY3ODgiXSwiaXNzIjo
iaHR0cHM6XC9cL2lkcC1wLmV4YW1wbGUuY29tXC8iLCJqdGkiOiJkM2Y3YjQ4Zi1iYzgx
LTQwZWMtYTE0MC05NzRhZjc0YzRkZTMiLCJpYXQiOjE0MTg2OTg4MTJ9i.HMz_tzZ90_b
0QZS-AXtQtvclZ7M4uDAs1WxCFxpgBfBanolW37X8h1ECrUJexbXMD6rrj_uuWEqPD738
oWRo0rOnoKJAgbF1GhXPAYnN5pZRygWSD1a6RcmN85SxUig0H0e7drmdmRkPQgbl2wMhu
-6h2Oqw-ize4dKmykN9UX_2drXrooSxpRZqFVYX8PkCvCCBuFy2O-HPRov_SwtJMk5qjU
WMyn2I4Nu2s-R20aCA-7T5dunr0iWCkLQnVnaXMfA22RlRiU87nl21zappYb1_EHF9ePy
q3Q353cDUY7vje8m2kKXYTgc_bUAYuW-W3SMSw5UlKaHtSZ6PQICoA
Accept: text/plain, application/json, application/*+json, */*
Host: idp-p.example.com
Connection: Keep-Alive
User-Agent: Apache-HttpClient/4.2.3 (java 1.5)
</pre>
<p id="rfc.section.3.2.p.4">And receives a document in response like the following:</p>
<pre>HTTP/1.1 200 OK
Date: Tue, 16 Dec 2014 03:00:12 GMT
Access-Control-Allow-Origin: *
Content-Type: application/json;charset=ISO-8859-1
Content-Language: en-US
Content-Length: 333
Connection: close

{
   "sub": "6WZQPpnQxV",
   "iss": "https://idp-p.example.com"
   "given_name": "Stephen",
   "family_name": "Emeritus",
}
</pre>
<p id="rfc.section.3.2.p.5">Servers MUST support the generation of <a href="#RFC7519" class="xref">JWT</a> encoded responses from the UserInfo Endpoint in addition to unsigned JSON objects. Signed responses MUST be signed by the OpenID Provider's key, and encrypted responses MUST be encrypted with the authorized client's public key. The OpenID Provider MUST support the RS256 signature method (the Rivest, Shamir, and Adleman (RSA) signature algorithm with a 256-bit hash) and MAY use other asymmetric signature and encryption methods listed in the JSON Web Algorithms ( <a href="#RFC7518" class="xref">JWA</a> ) specification.  </p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> <a href="#RequestObjects" id="RequestObjects">Request Objects</a>
</h1>
<p id="rfc.section.3.3.p.1">Authorization servers MUST accept requests containing a request object signed by the client's private key. Servers MUST validate the signature on such requests against the client's registered public key.  Servers MUST accept request objects encrypted with the server's public key.  </p>
<p id="rfc.section.3.3.p.2">Servers MAY accept request objects by reference using the <samp>request_uri</samp> parameter.  </p>
<p id="rfc.section.3.3.p.3">Both of these methods allow for clients to create a request that is protected from tampering through the browser, allowing for a higher security mode of operation for clients and applications that require it. Clients are not required to use request objects, but authorization servers are required to support requests using them.  </p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> <a href="#vot" id="vot">Vectors of Trust</a>
</h1>
<p id="rfc.section.3.4.p.1">Servers MUST check for the presence of the <samp>vtr</samp> parameter before <samp>acr</samp> in Requests. If both parameters are present the server will default to <samp>vtr</samp> as the request to respond to.  <samp>acr</samp> MUST then be ignored.  </p>
<p id="rfc.section.3.4.p.2">OpenID Providers MAY provide the <samp>vot</samp> and contain valid values from the <a href="#I-D.richer-vectors-of-trust" class="xref">Vectors of Trust</a> standard.  </p>
<p id="rfc.section.3.4.p.3">The <samp>vtr</samp> and contain valid values from the <a href="#I-D.richer-vectors-of-trust" class="xref">Vectors of Trust</a> standard.  </p>
<p id="rfc.section.3.4.p.4">It is out of scope of this document to determine how an organization maps their digital identity practices to valid VOT component values.  </p>
<h1 id="rfc.section.3.5">
<a href="#rfc.section.3.5">3.5.</a> <a href="#AuthenticationContext" id="AuthenticationContext">Authentication Context</a>
</h1>
<p id="rfc.section.3.5.p.1">OpenID Providers MAY provide <samp>acr</samp> (authentication context class reference, equivalent to the Security Assertion Markup Language (SAML) element of the same name) and <samp>amr</samp> (authentication methods reference) values in ID tokens if vtr is not used.  </p>
<h1 id="rfc.section.3.6">
<a href="#rfc.section.3.6">3.6.</a> <a href="#Discovery" id="Discovery">Discovery</a>
</h1>
<p><a href="#OpenID.Discovery" class="xref">OpenID Connect Discovery standard</a> provides a standard, programatic way for Clients to obtain configuration details for communicating with Providers. Discovery is an important part of building scalable federation ecosystsems.  </p>
<p id="rfc.section.3.6.p.2">Exposing a Discovery endpoint does NOT inherently put the Provider at risk to attack. Endpoints and parameters specified in the Discovery document SHOULD be considered public information regardless of the existence of the Doscovery document.  </p>
<p id="rfc.section.3.6.p.3">Access to the Discovery document MAY be protected with existing web authentication methods if required by the Provider. Credentials for the Discovery document are then managed by the Provider. Support for these authentication methods is outside the scope of this specification.  </p>
<p id="rfc.section.3.6.p.4">Endpoints described in the Discovery document MUST be secured in accordance with this specification and MAY have additonal controls the Provider wishes to support.  </p>
<p id="rfc.section.3.6.p.5">All OpenID Connect servers are uniquely identified by a URL known as the 	<samp>issuer</samp>. This URL serves as the prefix of a service discovery endpoint as	specified in the <a href="#OpenID.Discovery" class="xref">OpenID Connect Discovery standard</a> . The discovery document MUST contain at minimum the following fields: </p>
<p></p>

<dl>
<dt>issuer</dt>
<dd style="margin-left: 8">The fully qualified issuer URL of the server </dd>
<dt>authorization_endpoint</dt>
<dd style="margin-left: 8">The fully qualified URL of the server's authorization endpoint defined by <a href="#RFC6749" class="xref">[RFC6749]</a> </dd>
<dt>token_endpoint</dt>
<dd style="margin-left: 8">The fully qualified URL of the server's token endpoint defined by <a href="#RFC6749" class="xref">[RFC6749]</a> </dd>
<dt>introspection_endpoint</dt>
<dd style="margin-left: 8">The fully qualified URL of the server's introspection endpoint defined by <a href="#RFC7662" class="xref">OAuth Token Introspection</a> </dd>
<dt>revocation_endpoint</dt>
<dd style="margin-left: 8">The fully qualified URL of the server's revocation endpoint defined by <a href="#RFC7009" class="xref">OAuth Token Revocation</a> </dd>
<dt>jwks_uri</dt>
<dd style="margin-left: 8">The fully qualified URI of the server's public key in <a href="#RFC7517" class="xref">JWK Set</a> format </dd>
<dt>scopes_supported</dt>
<dd style="margin-left: 8">The list of iGov scopes the server supports </dd>
<dt>claims_supported</dt>
<dd style="margin-left: 8">The list of claims available in the supported scopes.  See below </dd>
<dt>vot</dt>
<dd style="margin-left: 8">The vectors supported.  </dd>
</dl>

<p> </p>
<p id="rfc.section.3.6.p.7">The following example shows the JSON document found at a discovery endpoint for an authorization server: </p>
<pre>{
  "request_parameter_supported": true,
  "id_token_encryption_alg_values_supported": [
    "RSA-OAEP", "RSA1_5", "RSA-OAEP-256"
  ],
  "registration_endpoint": "https://idp-p.example.com/register",
  "userinfo_signing_alg_values_supported": [
    "HS256", "HS384", "HS512", "RS256", "RS384", "RS512"
  ],
  "token_endpoint": "https://idp-p.example.com/token",
  "request_uri_parameter_supported": false,
  "request_object_encryption_enc_values_supported": [
    "A192CBC-HS384", "A192GCM", "A256CBC+HS512",
    "A128CBC+HS256", "A256CBC-HS512",
    "A128CBC-HS256", "A128GCM", "A256GCM"
  ],
  "token_endpoint_auth_methods_supported": [
    "private_key_jwt",
  ],
  "userinfo_encryption_alg_values_supported": [
    "RSA-OAEP", "RSA1_5",
    "RSA-OAEP-256"
  ],
  "subject_types_supported": [
    "public", "pairwise"
  ],
  "id_token_encryption_enc_values_supported": [
    "A192CBC-HS384", "A192GCM", "A256CBC+HS512",
    "A128CBC+HS256", "A256CBC-HS512", "A128CBC-HS256",
    "A128GCM", "A256GCM"
  ],
  "claims_parameter_supported": false,
  "jwks_uri": "https://idp-p.example.com/jwk",
  "id_token_signing_alg_values_supported": [
    "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "none"
  ],
  "authorization_endpoint": "https://idp-p.example.com/authorize",
  "require_request_uri_registration": false,
  "introspection_endpoint": "https://idp-p.example.com/introspect",
  "request_object_encryption_alg_values_supported": [
    "RSA-OAEP", ?RSA1_5", "RSA-OAEP-256"
  ],
  "service_documentation": "https://idp-p.example.com/about",
  "response_types_supported": [
    "code", "token"
  ],
  "token_endpoint_auth_signing_alg_values_supported": [
    "HS256", "HS384", "HS512", "RS256", "RS384", "RS512"
  ],
  "revocation_endpoint": "https://idp-p.example.com/revoke",
  "request_object_signing_alg_values_supported": [
    "HS256", "HS384", "HS512", "RS256", "RS384", "RS512"
  ],
  "claim_types_supported": [
    "normal"
  ],
  "grant_types_supported": [
    "authorization_code",
  ],
  "scopes_supported": [
    "profile", "openid"
  ],
  "userinfo_endpoint": "https://idp-p.example.com/userinfo",
  "userinfo_encryption_enc_values_supported": [
    "A192CBC-HS384", "A192GCM", "A256CBC+HS512","A128CBC+HS256",
    "A256CBC-HS512", "A128CBC-HS256", "A128GCM", "A256GCM"
  ],
  "op_tos_uri": "https://idp-p.example.com/about",
  "issuer": "https://idp-p.example.com/",
  "op_policy_uri": "https://idp-p.example.com/about",
  "claims_supported": [
    "sub", "name", "vot", "acr"
  ]
}
</pre>
<p id="rfc.section.3.6.p.8">It is RECOMMENDED that servers provide cache information through HTTP headers and make the cache valid for at least one week.  </p>
<p id="rfc.section.3.6.p.9">The server MUST provide its public key in <a href="#RFC7517" class="xref">JWK Set</a> format, such as the following 2048-bit RSA key: </p>
<pre>{
  "keys": [
    {
      "alg": "RS256",
      "e": "AQAB",
      "n": "o80vbR0ZfMhjZWfqwPUGNkcIeUcweFyzB2S2T-hje83IOVct8gVg9Fx
            vHPK1ReEW3-p7-A8GNcLAuFP_8jPhiL6LyJC3F10aV9KPQFF-w6Eq6V
            tpEgYSfzvFegNiPtpMWd7C43EDwjQ-GrXMVCLrBYxZC-P1ShyxVBOze
            R_5MTC0JGiDTecr_2YT6o_3aE2SIJu4iNPgGh9MnyxdBo0Uf0TmrqEI
            abquXA1-V8iUihwfI8qjf3EujkYi7gXXelIo4_gipQYNjr4DBNl
            E0__RI0kDU-27mb6esswnP2WgHZQPsk779fTcNDBIcYgyLujlcUATEq
            fCaPDNp00J6AbY6w",
      "kty": "RSA",
      "kid": "rsa1"
    }
  ]
}
</pre>
<h1 id="rfc.section.3.7">
<a href="#rfc.section.3.7">3.7.</a> <a href="#DynamicRegistration" id="DynamicRegistration">Dynamic Registration</a>
</h1>
<p id="rfc.section.3.7.p.1">If the OP is acting as an iGov OAuth Authorization Server (<a href="#iGov.OAuth2" class="xref">iGov OAuth2 profile</a>), then Dynamic Registration MUST be supported in accordance with that specification (see section 3.13).  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#UserInfo" id="UserInfo">User Info</a>
</h1>
<p id="rfc.section.4.p.1">The availability, quality, and reliability of an individual's identity attributes will vary greatly across jurisdictions and Provider systems. The following recommendations ensure maximum cross-jurisdictional interoperability, while setting Client expectations on the type of data they may acquire.  </p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#ClaimsSupported" id="ClaimsSupported">Claims Supported</a>
</h1>
<p id="rfc.section.4.1.p.1">Discovery mandates the inclusion of the <samp>claims_supported</samp> field that defines the claims a client MAY expect to receive for the supported scopes.  Servers MUST return claims on a best effort basis.  However, a server asserting it can provide a user claim does not imply that this data is available for all its users: clients MUST be prepared to receive partial data. Servers MAY return claims outside of the <samp>claims_supported</samp> list, but they MUST still ensure that the extra claims to not violate the privacy policies set out by the federation.  </p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#ScopeProfiles" id="ScopeProfiles">Scope Profiles</a>
</h1>
<p id="rfc.section.4.2.p.1">In the interests of data minimization balanced with the requirement to successfully identify the individual signing in to a service, the default OpenID Connect profiles may not be appropriate.  </p>
<p id="rfc.section.4.2.p.2">Matching of the identity assertion based on claims to a local identifier or &#8216;account&#8217; related to the individual identity at a level of assurance is a requirement where the government in question is not able to provide a single identifier for all citizens based on an authoritative register of citizens.  </p>
<p id="rfc.section.4.2.p.3">The requirement for matching is also of importance where a cross-border or cross-jurisdiction authentication is required and therefore the availability of a single identifier (e.g. social security number) cannot be guaranteed for the individual wishing to authenticate.  </p>
<p id="rfc.section.4.2.p.4">This standard defines a set of common <samp>scope</samp> values that aim to provide maximum cross-jurisdictional identity matching while not being perscriptive on the exact attributes shared, as every jurisdiction will likely have varius levels of information available, and different policies for sharing personal data even if it is on file.  </p>
<p></p>

<dl>
<dt>profile</dt>
<dd style="margin-left: 8">The <a href="#OpenID.Core" class="xref">OpenID Connect Core</a> defined profile provides baseline identity information. It is HIGHLY RECOMMENDED that the attributes for <samp>given_name, family_name, address, birthdate</samp> be supported by iGov Providers if possible, unless data quality requirements or privacy considerations prevent it.  It is left to the Provider and the federation to set any further limitations on this profile data - see Privacy Considerations below.  </dd>
<dt>doc</dt>
<dd style="margin-left: 8">The identity document type(s) and associated "number" the Provider is capable of providing. Mutliple document types MAY be returned. This could be passport, driver's license, national ID card, health insurance no., and so on. The response should include: <dl>
<dt>type</dt>
<dd style="margin-left: 8">The document type.  </dd>
<dt>num</dt>
<dd style="margin-left: 8">The value of the document identifier. Note that not all values are technically numeric.  </dd>
</dl>
<p> </p>
</dd>
<dt>bio</dt>
<dd style="margin-left: 8">Biometric data related to the subject for physical verification at the Client side. This can include simple descriptions for eye and hair color, height, or may include a photograph: <samp>picture</samp> from  <a href="#OpenID.Core" class="xref">OpenID Connect Core</a>.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> <a href="#ClaimsMetadata" id="ClaimsMetadata">Claims Metadata</a>
</h1>
<p id="rfc.section.4.3.p.1">To support maximum interoperability and trust across (potentially) unassociated jurisdictions, the information regarding the claim type MUST be communicated within the protocol, so clients may properly interpret the claims they have been given. This is referred to as Claims Metadata.  </p>
<p id="rfc.section.4.3.p.2">Claims Metadata is captured in a <samp>_claims_metadata</samp> member of the JSON object containing the Claims.  </p>

<dl>
<dt>_claim_names</dt>
<dd style="margin-left: 8">As defined in <a href="#OpenID.Core" class="xref">OpenID Connect Core</a> section 5.6.2. The list of claims that have metadata.  </dd>
<dt>_claims_metadata</dt>
<dd style="margin-left: 8">A JSON Object containing the associated metadata for the claims listed in <samp>_claim_names</samp>.  Metadata fields are defined below.  </dd>
</dl>

<p> </p>
<p id="rfc.section.4.3.p.3">The following defines the types of claims metadata that iGov supports: </p>

<dl>
<dt>locale</dt>
<dd style="margin-left: 8">The locale format of the claim, indicating where the attribute originates from, represented as a space-separated list of BCP47 [RFC5646] language tag values: for example "en-US" or "ja" or "fr-CA" and so on.  </dd>
<dt>encoding</dt>
<dd style="margin-left: 8">How the claim is encoded: <samp>raw, jwt</samp>.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.4.3.1">
<a href="#rfc.section.4.3.1">4.3.1.</a> <a href="#CLOA" id="CLOA">Claim Level of Assurance</a>
</h1>
<p id="rfc.section.4.3.1.p.1">In addition to the <samp>scope</samp> of the data provided, the UserInfo data must return some concept of the quality level of the attribute. This quality level is referred to as attribute meta data, and follows the guidelines in <a href="#I-D.richer-vectors-of-trust" class="xref">Vectors of Trust</a> .  </p>
<p id="rfc.section.4.3.1.p.2">The following must be considered when evaluating the quality of an attribute: </p>
<p></p>

<dl>
<dt>vot</dt>
<dd style="margin-left: 8">The attribute Vector of Trust.</dd>
<dt>vtm</dt>
<dd style="margin-left: 8">The Trustmark Provider URL for the <samp>vot</samp> claim.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> Example UserInfo with Metadata</h1>
<p id="rfc.section.4.4.p.1">This example represents a request to a Department of Motor Vehicles (DMV) OP that is returning driver's license related information. The requested scope was <samp>profile, doc, bio</samp>. Only the driver's license related information is subject to this metadata: the <samp>email_address</samp> does not meet the same level of assurance.  </p>
<pre>{
   "sub": "6WZQPpnQxV",
   "iss": "https://dmv.a-nice-place.gov"
   "name": "Jane Doe",
   "given_name": "Jane",
   "family_name": "Doe",
   "birthdate": "0000-03-22",
   "email": "janedoe@example.com",
   "eye_color": "blue",
   "document" : {
       "type" : "driver's license",
       "num"  : "V5648-746280-0ZTX"
   }

   "_claim_names": {
     "name": "src1",
     "given_name": "src1",
     "family_name": "src1",
     "birthdate": "src1",
     "eye_color" : "src1",
     "document" : "src1"
   },
   "_claim_metadata": {
     "src1": {
        "locale" : "en-US",
        "encoding" : "raw",
        "vot" : "P2.Cc",
        "vtm": "https://dmv.a-nice-place.gov"
     }
   }

}
  </pre>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#PrivacyConsiderations" id="PrivacyConsiderations">Privacy Considerations</a>
</h1>
<p id="rfc.section.5.p.1">This section covers recommendations and guidelines for protecting a user's right to privacy in circumstances where this is required.  </p>
<p id="rfc.section.5.p.2">Government policies that protect an individual's right to privacy across jurisdictional boundires vary from geography to geography.  Some geographies are looking to establish a global registry of basic citizen identity for digital use cases, and other geographies aim to supply only the bare minimum of an authentication assurances, ensuring participant systems cannot link or trace a citizen's actions across the federation. Most will fall somewhere in between these two extremes.  </p>
<p id="rfc.section.5.p.3">This specification supports this wide range of scenarios and therefore the following are NOT REQUIRED by Providers to implement, but HIGHLY RECOMMENDED for Providers that implement some level of user privacy.  </p>
<p></p>

<ul><li>
<samp>sub</samp> fields MUST be "pairwise" as defined in <a href="#OpenID.Core" class="xref">OpenID Connect Core</a> section 8.  </li></ul>

<p> </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Security Considerations</h1>
<p id="rfc.section.6.p.1">All transactions MUST be protected in transit by TLS as described in <a href="#BCP195" class="xref">BCP195</a> .  </p>
<p id="rfc.section.6.p.2">All clients MUST conform to applicable recommendations found in the Security Considerations sections of <a href="#RFC6749" class="xref">[RFC6749]</a> and those found in the <a href="#RFC6819" class="xref">OAuth 2.0 Threat Model and Security Considerations document</a> .  </p>
<h1 id="rfc.references">
<a href="#rfc.references">7.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="BCP195">[BCP195]</b></td>
<td class="top">
<a>Sheffer, Y.</a>, <a>Holz, R.</a> and <a>P. Saint-Andre</a>, "<a href="http://tools.ietf.org/html/rfc7525">Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)</a>", BCP 195, RFC 7525, DOI 10.17487/RFC7525, May 2015.</td>
</tr>
<tr>
<td class="reference"><b id="HEART.OAuth2">[HEART.OAuth2]</b></td>
<td class="top">
<a href="mailto:openid@justin.richer.org">Richer, J.</a>, "<a href="http://openid.net/specs/openid-heart-oauth2-1_0.html">Health Relationship Trust Profile for OAuth 2.0</a>", February 2016.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-oauth-pop-architecture">[I-D.ietf-oauth-pop-architecture]</b></td>
<td class="top">
<a>Hunt, P.</a>, <a>Richer, J.</a>, <a>Mills, W.</a>, <a>Mishra, P.</a> and <a>H. Tschofenig</a>, "<a href="http://tools.ietf.org/html/draft-ietf-oauth-pop-architecture-08">OAuth 2.0 Proof-of-Possession (PoP) Security Architecture</a>", Internet-Draft draft-ietf-oauth-pop-architecture-08, July 2016.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.richer-vectors-of-trust">[I-D.richer-vectors-of-trust]</b></td>
<td class="top">
<a>Richer, J.</a> and <a>L. Johansson</a>, "<a href="http://tools.ietf.org/html/draft-richer-vectors-of-trust-05">Vectors of Trust</a>", Internet-Draft draft-richer-vectors-of-trust-05, April 2017.</td>
</tr>
<tr>
<td class="reference"><b id="iGov.OAuth2">[iGov.OAuth2]</b></td>
<td class="top">
<a href="mailto:openid@justin.richer.org">Richer, J.</a>, <a href="mailto:pag3@nist.gov">Grassi, P.</a> and <a href="mailto:mike.varley@securekey.com">M. Varley</a>, "<a href="http://openid.net/specs/openid-igov-oauth2-1_0.html">iGov Profile for OAuth 2.0</a>", July 2017.</td>
</tr>
<tr>
<td class="reference"><b id="OpenID.Core">[OpenID.Core]</b></td>
<td class="top">
<a title="Nomura Research Institute, Ltd.">Sakimura, N.</a>, <a title="Ping Identity">Bradley, J.</a>, <a title="Microsoft">Jones, M.</a>, <a title="Google">de Medeiros, B.</a> and <a title="Salesforce">C. Mortimore</a>, "<a href="http://openid.net/specs/openid-connect-core-1_0.html">OpenID Connect Core 1.0</a>", August 2015.</td>
</tr>
<tr>
<td class="reference"><b id="OpenID.Discovery">[OpenID.Discovery]</b></td>
<td class="top">
<a title="Nomura Research Institute, Ltd.">Sakimura, N.</a>, <a title="Ping Identity">Bradley, J.</a>, <a title="Microsoft">Jones, M.</a> and <a title="Illumila">E. Jay</a>, "<a href="http://openid.net/specs/openid-connect-discovery-1_0.html">OpenID Connect Discovery 1.0</a>", August 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2246">[RFC2246]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>C. Allen</a>, "<a href="http://tools.ietf.org/html/rfc2246">The TLS Protocol Version 1.0</a>", RFC 2246, DOI 10.17487/RFC2246, January 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3986">[RFC3986]</b></td>
<td class="top">
<a>Berners-Lee, T.</a>, <a>Fielding, R.</a> and <a>L. Masinter</a>, "<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>", STD 66, RFC 3986, DOI 10.17487/RFC3986, January 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5246">[RFC5246]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, DOI 10.17487/RFC5246, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5322">[RFC5322]</b></td>
<td class="top">
<a>Resnick, P.</a>, "<a href="http://tools.ietf.org/html/rfc5322">Internet Message Format</a>", RFC 5322, DOI 10.17487/RFC5322, October 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5646">[RFC5646]</b></td>
<td class="top">
<a>Phillips, A.</a> and <a>M. Davis</a>, "<a href="http://tools.ietf.org/html/rfc5646">Tags for Identifying Languages</a>", BCP 47, RFC 5646, DOI 10.17487/RFC5646, September 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5785">[RFC5785]</b></td>
<td class="top">
<a>Nottingham, M.</a> and <a>E. Hammer-Lahav</a>, "<a href="http://tools.ietf.org/html/rfc5785">Defining Well-Known Uniform Resource Identifiers (URIs)</a>", RFC 5785, DOI 10.17487/RFC5785, April 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6125">[RFC6125]</b></td>
<td class="top">
<a>Saint-Andre, P.</a> and <a>J. Hodges</a>, "<a href="http://tools.ietf.org/html/rfc6125">Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)</a>", RFC 6125, DOI 10.17487/RFC6125, March 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6749">[RFC6749]</b></td>
<td class="top">
<a>Hardt, D.</a>, "<a href="http://tools.ietf.org/html/rfc6749">The OAuth 2.0 Authorization Framework</a>", RFC 6749, DOI 10.17487/RFC6749, October 2012.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6750">[RFC6750]</b></td>
<td class="top">
<a>Jones, M.</a> and <a>D. Hardt</a>, "<a href="http://tools.ietf.org/html/rfc6750">The OAuth 2.0 Authorization Framework: Bearer Token Usage</a>", RFC 6750, DOI 10.17487/RFC6750, October 2012.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6819">[RFC6819]</b></td>
<td class="top">
<a>Lodderstedt, T.</a>, <a>McGloin, M.</a> and <a>P. Hunt</a>, "<a href="http://tools.ietf.org/html/rfc6819">OAuth 2.0 Threat Model and Security Considerations</a>", RFC 6819, DOI 10.17487/RFC6819, January 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7009">[RFC7009]</b></td>
<td class="top">
<a>Lodderstedt, T.</a>, <a>Dronia, S.</a> and <a>M. Scurtescu</a>, "<a href="http://tools.ietf.org/html/rfc7009">OAuth 2.0 Token Revocation</a>", RFC 7009, DOI 10.17487/RFC7009, August 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7033">[RFC7033]</b></td>
<td class="top">
<a>Jones, P.</a>, <a>Salgueiro, G.</a>, <a>Jones, M.</a> and <a>J. Smarr</a>, "<a href="http://tools.ietf.org/html/rfc7033">WebFinger</a>", RFC 7033, DOI 10.17487/RFC7033, September 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7515">[RFC7515]</b></td>
<td class="top">
<a>Jones, M.</a>, <a>Bradley, J.</a> and <a>N. Sakimura</a>, "<a href="http://tools.ietf.org/html/rfc7515">JSON Web Signature (JWS)</a>", RFC 7515, DOI 10.17487/RFC7515, May 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7516">[RFC7516]</b></td>
<td class="top">
<a>Jones, M.</a> and <a>J. Hildebrand</a>, "<a href="http://tools.ietf.org/html/rfc7516">JSON Web Encryption (JWE)</a>", RFC 7516, DOI 10.17487/RFC7516, May 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7517">[RFC7517]</b></td>
<td class="top">
<a>Jones, M.</a>, "<a href="http://tools.ietf.org/html/rfc7517">JSON Web Key (JWK)</a>", RFC 7517, DOI 10.17487/RFC7517, May 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7518">[RFC7518]</b></td>
<td class="top">
<a>Jones, M.</a>, "<a href="http://tools.ietf.org/html/rfc7518">JSON Web Algorithms (JWA)</a>", RFC 7518, DOI 10.17487/RFC7518, May 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7519">[RFC7519]</b></td>
<td class="top">
<a>Jones, M.</a>, <a>Bradley, J.</a> and <a>N. Sakimura</a>, "<a href="http://tools.ietf.org/html/rfc7519">JSON Web Token (JWT)</a>", RFC 7519, DOI 10.17487/RFC7519, May 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7636">[RFC7636]</b></td>
<td class="top">
<a>Sakimura, N.</a>, <a>Bradley, J.</a> and <a>N. Agarwal</a>, "<a href="http://tools.ietf.org/html/rfc7636">Proof Key for Code Exchange by OAuth Public Clients</a>", RFC 7636, DOI 10.17487/RFC7636, September 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7662">[RFC7662]</b></td>
<td class="top">
<a>Richer, J.</a>, "<a href="http://tools.ietf.org/html/rfc7662">OAuth 2.0 Token Introspection</a>", RFC 7662, DOI 10.17487/RFC7662, October 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7800">[RFC7800]</b></td>
<td class="top">
<a>Jones, M.</a>, <a>Bradley, J.</a> and <a>H. Tschofenig</a>, "<a href="http://tools.ietf.org/html/rfc7800">Proof-of-Possession Key Semantics for JSON Web Tokens (JWTs)</a>", RFC 7800, DOI 10.17487/RFC7800, April 2016.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.A">
<a href="#rfc.appendix.A">Appendix A.</a> <a href="#Acknowledgements" id="Acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.A.p.1">The OpenID Community would like to thank the following people for their contributions to this specification: Justin Ritcher, Paul Grassi, John Bradley, Adam Cooper, ...  </p>
<h1 id="rfc.appendix.B">
<a href="#rfc.appendix.B">Appendix B.</a> <a href="#Notices" id="Notices">Notices</a>
</h1>
<p id="rfc.section.B.p.1">Copyright (c) 2017 The OpenID Foundation.</p>
<p id="rfc.section.B.p.2">The OpenID Foundation (OIDF) grants to any Contributor, developer, implementer, or other interested party a non-exclusive, royalty free, worldwide copyright license to reproduce, prepare derivative works from, distribute, perform and display, this Implementers Draft or Final Specification solely for the purposes of (i) developing specifications, and (ii) implementing Implementers Drafts and Final Specifications based on such documents, provided that attribution be made to the OIDF as the source of the material, but that such attribution does not indicate an endorsement by the OIDF.  </p>
<p id="rfc.section.B.p.3">The technology described in this specification was made available from contributions from various sources, including members of the OpenID Foundation and others. Although the OpenID Foundation has taken steps to help ensure that the technology is available for distribution, it takes no position regarding the validity or scope of any intellectual property or other rights that might be claimed to pertain to the implementation or use of the technology described in this specification or the extent to which any license under such rights might or might not be available; neither does it represent that it has made any independent effort to identify any such rights. The OpenID Foundation and the contributors to this specification make no (and hereby expressly disclaim any) warranties (express, implied, or otherwise), including implied warranties of merchantability, non-infringement, fitness for a particular purpose, or title, related to this specification, and the entire risk as to implementing this specification is assumed by the implementer. The OpenID Intellectual Property Rights policy requires contributors to offer a patent promise not to assert certain patent claims against other contributors and against implementers. The OpenID Foundation invites any interested party to bring to its attention any copyrights, patents, patent applications, or other proprietary rights that may cover technology that may be required to practice this specification.  </p>
<h1 id="rfc.appendix.C">
<a href="#rfc.appendix.C">Appendix C.</a> <a href="#History" id="History">Document History</a>
</h1>
<p id="rfc.section.C.p.1">-2017-05-29</p>
<p id="rfc.section.C.p.2">-02 </p>

<ul>
<li>Removed Verifiable Claims definition (will go in another spec).  </li>
<li>Clarified Scope and Metadata.  </li>
</ul>

<p> </p>
<p id="rfc.section.C.p.3">-2016-07-25</p>
<p id="rfc.section.C.p.4">-01 </p>

<ul><li>Imported content from OpenID HEART 1.0 profile and Connect.Gov integration guide v 1.4 </li></ul>

<p> </p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Michael Varley</span> (editor)
	  <span class="n hidden">
		<span class="family-name">Varley</span>
	  </span>
	</span>
	<span class="org vcardline"></span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:mike.varley@securekey.com">mike.varley@securekey.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Paul Grassi</span> (editor)
	  <span class="n hidden">
		<span class="family-name">Grassi</span>
	  </span>
	</span>
	<span class="org vcardline"></span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:pag3@nist.gov">pag3@nist.gov</a></span>

  </address>
</div>

</body>
</html>

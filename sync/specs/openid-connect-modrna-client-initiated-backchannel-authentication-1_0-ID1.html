<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>OpenID Connect MODRNA Client initiated Backchannel Authentication Flow 1.0</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents"/>
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction"/>
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Requirements Notation and Conventions"/>
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology"/>
<link href="#rfc.section.3" rel="Chapter" title="3 Overview"/>
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Polling versus Notification"/>
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Examples of Use Cases"/>
<link href="#rfc.section.4" rel="Chapter" title="4 Backchannel Authentication Endpoint"/>
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Authentication Request"/>
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Authentication Request Validation"/>
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Successful Authentication Request Acknowledgement"/>
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 Authentication Request Acknowledgment Validation"/>
<link href="#rfc.section.5" rel="Chapter" title="5 OpenID Provider Obtains End-user Consent/Authorization"/>
<link href="#rfc.section.6" rel="Chapter" title="6 Getting the Transaction Result"/>
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Token Request Using Polling Mechanism"/>
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 Successful Token Polling Response"/>
<link href="#rfc.section.6.3" rel="Chapter" title="6.3 Token Notification"/>
<link href="#rfc.section.6.3.1" rel="Chapter" title="6.3.1 Successful Token Notification"/>
<link href="#rfc.section.6.3.2" rel="Chapter" title="6.3.2 Client Notification Endpoint"/>
<link href="#rfc.section.6.4" rel="Chapter" title="6.4 Token Error Response"/>
<link href="#rfc.section.6.5" rel="Chapter" title="6.5 Authentication Error Response"/>
<link href="#rfc.section.7" rel="Chapter" title="7 Security Considerations"/>
<link href="#rfc.section.8" rel="Chapter" title="8 Privacy Considerations"/>
<link href="#rfc.references" rel="Chapter" title="9 References"/>
<link href="#rfc.references.1" rel="Chapter" title="9.1 Normative References"/>
<link href="#rfc.references.2" rel="Chapter" title="9.2 Informative References"/>
<link href="#rfc.appendix.A" rel="Chapter" title="A Acknowledgements"/>
<link href="#rfc.appendix.B" rel="Chapter" title="B Notices"/>
<link href="#rfc.appendix.C" rel="Chapter" title="C Document History"/>
<link href="#rfc.authors" rel="Chapter"/>


  <meta name="generator" content="xml2rfc version 2.5.2.dev0 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Fernandez, G., Walter, F., and A. Nennker" />
  <meta name="dct.identifier" content="urn:ietf:id:openid-connect-modrna-client-initiated-backchannel-authentication-1_0" />
  <meta name="dct.issued" scheme="ISO8601" content="2017-3-6" />
  <meta name="dct.abstract" content="OpenID Connect MODRNA Client initiated Backchannel Authentication Flow 1.0 is an authentication flow like OpenID Connect. Unlike OpenID Connect there is a direct Relying Party to OpenID Provider communication without redirects through the user's browser.  This specification allows an Relying Party that knows the user's identitfier to obtain tokens from the OpenID Provider. The user consent is given at the user's Authentication Device mediated by the OpenID Provider.  " />
  <meta name="description" content="OpenID Connect MODRNA Client initiated Backchannel Authentication Flow 1.0 is an authentication flow like OpenID Connect. Unlike OpenID Connect there is a direct Relying Party to OpenID Provider communication without redirects through the user's browser.  This specification allows an Relying Party that knows the user's identitfier to obtain tokens from the OpenID Provider. The user consent is given at the user's Authentication Device mediated by the OpenID Provider.  " />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
  <td class="left"></td>
  <td class="right">G. Fernandez</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">Telefonica</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">F. Walter</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">A. Nennker</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">Deutsche Telekom AG</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">March 6, 2017</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">OpenID Connect MODRNA Client initiated Backchannel Authentication Flow 1.0<br />
  <span class="filename">openid-connect-modrna-client-initiated-backchannel-authentication-1_0</span></p>
  
  <h1 id="rfc.abstract">
  <a href="#rfc.abstract">Abstract</a>
</h1>
<p>OpenID Connect MODRNA Client initiated Backchannel Authentication Flow 1.0 is an authentication flow like OpenID Connect. Unlike OpenID Connect there is a direct Relying Party to OpenID Provider communication without redirects through the user's browser.  This specification allows an Relying Party that knows the user's identitfier to obtain tokens from the OpenID Provider. The user consent is given at the user's Authentication Device mediated by the OpenID Provider.  </p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a></li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Requirements Notation and Conventions</a></li>
</ul><li>2.   <a href="#rfc.section.2">Terminology</a></li>
<li>3.   <a href="#rfc.section.3">Overview</a></li>
<ul><li>3.1.   <a href="#rfc.section.3.1">Polling versus Notification</a></li>
<li>3.2.   <a href="#rfc.section.3.2">Examples of Use Cases</a></li>
</ul><li>4.   <a href="#rfc.section.4">Backchannel Authentication Endpoint</a></li>
<ul><li>4.1.   <a href="#rfc.section.4.1">Authentication Request</a></li>
<li>4.2.   <a href="#rfc.section.4.2">Authentication Request Validation</a></li>
<li>4.3.   <a href="#rfc.section.4.3">Successful Authentication Request Acknowledgement</a></li>
<li>4.4.   <a href="#rfc.section.4.4">Authentication Request Acknowledgment Validation</a></li>
</ul><li>5.   <a href="#rfc.section.5">OpenID Provider Obtains End-user Consent/Authorization</a></li>
<li>6.   <a href="#rfc.section.6">Getting the Transaction Result</a></li>
<ul><li>6.1.   <a href="#rfc.section.6.1">Token Request Using Polling Mechanism</a></li>
<li>6.2.   <a href="#rfc.section.6.2">Successful Token Polling Response</a></li>
<li>6.3.   <a href="#rfc.section.6.3">Token Notification</a></li>
<ul><li>6.3.1.   <a href="#rfc.section.6.3.1">Successful Token Notification</a></li>
<li>6.3.2.   <a href="#rfc.section.6.3.2">Client Notification Endpoint</a></li>
</ul><li>6.4.   <a href="#rfc.section.6.4">Token Error Response</a></li>
<li>6.5.   <a href="#rfc.section.6.5">Authentication Error Response</a></li>
</ul><li>7.   <a href="#rfc.section.7">Security Considerations</a></li>
<li>8.   <a href="#rfc.section.8">Privacy Considerations</a></li>
<li>9.   <a href="#rfc.references">References</a></li>
<ul><li>9.1.   <a href="#rfc.references.1">Normative References</a></li>
<li>9.2.   <a href="#rfc.references.2">Informative References</a></li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">Acknowledgements</a></li>
<li>Appendix B.   <a href="#rfc.appendix.B">Notices</a></li>
<li>Appendix C.   <a href="#rfc.appendix.C">Document History</a></li>
<li><a href="#rfc.authors">Authors' Addresses</a></li>


  </ul>

  <h1 id="rfc.section.1"><a href="#rfc.section.1">1.</a> <a href="#Introduction" id="Introduction">Introduction</a></h1>
<p><a href="#OpenID.Core">OpenID Connect</a> <cite title="NONE">[OpenID.Core]</cite> allows Relying Parties (RP) to authenticate their users for clients of all types, including browser-based JavaScript and native mobile apps, to launch sign-in flows and receive verifiable assertions about the identity of signed-in users.  </p>
<p id="rfc.section.1.p.2">In all of these flows initiated by the RP, the end-user interaction from the consumption device is required and, they are based on HTTP redirection mechanisms. However, some use cases not covered by these flows have been raised, where the RP needs to be the initiator of the user authentication flow and the end-user interaction from the consumption device is not needed.  </p>
<p id="rfc.section.1.p.3">The MODRNA Client initiated Backchannel Authentication Flow specifies a new authentication flow, by means of which the RP's that know the user identifier they want to authenticate (e-mail, phone number), will be able to initiate an interaction flow to authenticate their users without having end-user interaction from the consumption device. The flow is a direct communication from the Client to the OpenID Provider without redirect through the user's browser (consumption device).  </p>
<p id="rfc.section.1.p.4">This specification does not change the semantic of the OpenID Connect Authentication flow.  It introduces a new endpoint to which the authentication request is posted.  It indroduces a new asynchronous method for authentication result delivery.  It does no introduce new scope values nor does it change the semantic of standard OpenID Connect parameters.  Some OpenID Connect parameters which are required in a redirect based protocol are meaningless in this server-to-server communication.  A few new parameters are introduced e.g. those required for the asynchronous authentication result delivery.  </p>
<p><strong>Remark:</strong> As the user has no consumption device through which the user is interacting with the Client, this flow will not cause any user credentials to go through the RP. So it should be highlighted that traditional username/password authentication could not be used because only out-band mechanisms will work in conjunction with this flow.  </p>
<h1 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1.</a> <a href="#rnc" id="rnc">Requirements Notation and Conventions</a></h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.  </p>
<p id="rfc.section.1.1.p.2">Throughout this document, values are quoted to indicate that they are to be taken literally. When using these values in protocol messages, the quotes MUST NOT be used as part of the value.  </p>
<h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a> <a href="#terminology" id="terminology">Terminology</a></h1>
<p id="rfc.section.2.p.1">This specification uses the terms "OpenID Provider (OP)" and "Relying Party (RP)" as defined by <a href="#OpenID.Core">OpenID Connect Core</a> <cite title="NONE">[OpenID.Core]</cite>. Furthermore it uses the term "client" as defined by <a href="#RFC6749">OAuth 2.0</a> <cite title="NONE">[RFC6749]</cite>. OAuth 2.0 Authentication Servers implementing OpenID Connect and CIBA are also referred to as OpenID Providers (OPs).  OAuth 2.0 Clients using OpenID Connect and CIBA are also referred to as Relying Parties (RPs).  This specification also uses the following terms: </p>
<p/>

<dl>
  <dt>Consumption Device (CD)</dt>
  <dd style="margin-left: 8">A user agent, most probably a browser, on which the user consumes the actual service provided by the Client.  </dd>
  <dt>Authentication Device (AD)</dt>
  <dd style="margin-left: 8">A mobile device on which the user will authenticate the actual login.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a> <a href="#overview" id="overview">Overview</a></h1>
<p id="rfc.section.3.p.1">Client Initiated Backchannel Authentication (CIBA) enables a Client to initiate the authentication of an end-user by means of out-band mechanisms.  </p>
<p/>

<ol>
  <li>The Client shall make an "HTTP POST" request to a new endpoint called bc-authorize to ask for the end-user authentication.  </li>
  <li>The OP will respond inmediatly with a unique identifier that identifies that authentication while it tries to authenticate the user in the background.  </li>
  <li>The Client will receive the id_token, access_token and refresh_token by means of either Polling or Notification mechanisms, this choice MUST be established by the Client at the registration time.  <dl><dt>Notification mode</dt><dd style="margin-left: 8">When using Notification mode, the OP will sent a request with the tokens to a callback uri previously registered by the Client.  </dd><dt>Polling mode</dt><dd style="margin-left: 8">If Polling mode has been set, the Client will poll the token endpoint to get a response with the tokens.  Clients MUST take the "interval" attribute into account that they received in the authentication response.  </dd></dl><p> </p></li>
</ol>

<p> </p>
<h1 id="rfc.section.3.1"><a href="#rfc.section.3.1">3.1.</a> Polling versus Notification</h1>
<p id="rfc.section.3.1.p.1">This specification allows the Client to get the authentication result in two ways: polling and notification.  </p>
<p id="rfc.section.3.1.p.2">If the Client expects to be notified about the authentication result asynchronously then it has to specify a <a href="#client_notification_endpoint">Client Notification Endpoint</a> during its registration at the OpenID Provider.  </p>
<p id="rfc.section.3.1.p.3">Otherwise the authentication response is retrieved by the Client by polling the OP's token endpoint using a new grant type.  </p>
<p>CIBA polling is illustrated in the following diagram: </p>
<pre>
        +--------+                                               +--------+
        |        |                                               |        |
        |        |&lt;---(1) CIBA Request--------------------------&gt;|        |
        |        |                                               |        |
        |        |  +--------+                                   |        |
        |        |  |        |                                   |        |
        | Client |  |  AD    |&lt;--(2) User interactions ---------&gt;|   OP   |
        |        |  |        |                                   |        |
        |        |  +--------+                                   |        |
        |        |                                               |        |
        |        |----(3a) CIBA Polling Request-----------------&gt;|        |
        |        |&lt;---(3b) CIBA Polling Response-----------------|        |
        |        |                                               |        |
        +--------+                                               +--------+
        </pre>
<p>CIBA notification is illustrated in the following diagram: </p>
<pre>
        +--------+                                               +--------+
        |        |                                               |        |
        |        |&lt;---(1) CIBA Request--------------------------&gt;|        |
        |        |                                               |        |
        |        |  +--------+                                   |        |
        |        |  |        |                                   |        |
        | Client |  |  AD    |&lt;--(2) User interactions ---------&gt;|   OP   |
        |        |  |        |                                   |        |
        |        |  +--------+                                   |        |
        |        |                                               |        |
        |        |&lt;---(3) CIBA Notification Callback ------------|        |
        |        |                                               |        |
        +--------+                                               +--------+
        </pre>
<h1 id="rfc.section.3.2"><a href="#rfc.section.3.2">3.2.</a> Examples of Use Cases</h1>
<p id="rfc.section.3.2.p.1">The following use cases are non-normative examples to illustrate the usage of this specification.</p>
<p/>

<ol>
  <li>A call center agent wants to authenticate a caller.  Using additional scopes like e.g. "profile" or "phone" the call center agent would get access to claims about the user like "phone_number" and "phone_number_verified".  </li>
  <li>A bank teller wants to authenticate a customer in a bank branch - so it is using CIBA for auth in a face-to-face scenario.  </li>
</ol>

<p> </p>
<h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a> <a href="#auth_backchannel_endpoint" id="auth_backchannel_endpoint">Backchannel Authentication Endpoint</a></h1>
<p id="rfc.section.4.p.1">The Backchannel Authentication Endpoint performs Authentication of the End-User. This is done by sending an HTTP POST message directly from the Client to the OpenID Provider's Backchannel Authentication Endpoint, using request parameters defined by OAuth 2.0 and additional parameters and parameter values defined by OpenID Connect.  </p>
<p id="rfc.section.4.p.2">Communication with the Backchannel Authentication Endpoint MUST utilize TLS. See Section 16.17 <a href="#OpenID.Core">[OpenID.Core]</a> for more information on using TLS.  </p>
<h1 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1.</a> <a href="#auth_request" id="auth_request">Authentication Request</a></h1>
<p id="rfc.section.4.1.p.1">An Authentication Request uses most of the parameters of an <a href="#RFC6749">OAuth 2.0</a> <cite title="NONE">[RFC6749]</cite> Authorization Request. The parameters used are not changed in their meaning and no new values for those parameters are introduced. Some of an OAuth 2.0 Authorization Request parameters make no sense in a server to server communication and are therefore not part of a CIBA Authentication Request.  </p>
<p id="rfc.section.4.1.p.2">MODRNA Client initiated Backchannel Authentication defines an authentication request that is requested directly from the Client to the OpenID Provider without going through the user's browser. The Client MUST send an authentication request to the OpenID Provider by building an "HTTP POST" request that will take to the OpenID Provider all the information needed to authenticate the user without asking them for their identifier.  </p>
<p id="rfc.section.4.1.p.3">The Client MUST authenticate to the Backchannel Authentication Endpoint using the authentication method registered for its client_id, as described in Section 9 of  <a href="#OpenID.Core">[OpenID.Core]</a>.  </p>
<p id="rfc.section.4.1.p.4">Authentication Requests are made using <a href="#MODRNA.Authentication">OpenID Connect MODRNA Authentication Profile 1.0</a>. Only the following parameters are taken into consideration in the Client initiated Backchannel Authentication flow. The rest of the request parameters defined in <a href="#RFC6749">OAuth 2.0</a> <cite title="NONE">[RFC6749]</cite> MUST be ignored by the OpenID Provider.  </p>
<p/>

<dl>
  <dt>scope</dt>
  <dd style="margin-left: 8">REQUIRED. OpenID Connect implements authentication as an extension to the OAuth 2.0 by including the "openid" scope value in the Authorization Request.  </dd>
  <dt>client_notification_token</dt>
  <dd style="margin-left: 8">REQUIRED if the Client is registered to be notified. It is a unique id provided by the Client that will be used by the OpenID Provider as a bearer token to authenticate the callback request to send the tokens to the Client (Notification Mode).  </dd>
  <dt></dt>
  <dd style="margin-left: 8">At the time of registering the Client at the OpenID Provider, the Client must provide the information about whether receiving the token response through a callback to the "client_notification_endpoint" (Notification mode) or through a polling mechanism (Polling mode) where the Client MUST poll the OpenID Provider repeatedly as defined in <a href="#successful_authentication_request_acknowdlegment">Successful Authentication Request Acknowledgement</a> until the end-user completes the approval process.  </dd>
  <dt>acr_values</dt>
  <dd style="margin-left: 8">REQUIRED. As defined in <a href="#MODRNA.Authentication">OpenID Connect MODRNA Authentication Profile 1.0</a>.  </dd>
  <dt>login_hint_token</dt>
  <dd style="margin-left: 8">OPTIONAL. As defined in <a href="#MODRNA.Authentication">OpenID Connect MODRNA Authentication Profile 1.0</a>.  </dd>
  <dt>id_token_hint</dt>
  <dd style="margin-left: 8">OPTIONAL. As defined in Section 3.1.2.1 of <a href="#OpenID.Core">[OpenID.Core]</a>.  </dd>
  <dt>login_hint</dt>
  <dd style="margin-left: 8">OPTIONAL. As defined in Section 3.1.2.1 of <a href="#OpenID.Core">[OpenID.Core]</a>.  </dd>
  <dt>binding_message</dt>
  <dd style="margin-left: 8">OPTIONAL. As defined in <a href="#MODRNA.Authentication">OpenID Connect MODRNA Authentication Profile 1.0</a>.  </dd>
</dl>

<p> </p>
<p id="rfc.section.4.1.p.6">As the Client initiated Backchannel Authentication flow does not have an interaction with the end-user through a consumption device, it is REQUIRED that the Client provides one (and only one) of the hints specified above in the authentication request, that is "login_hint_token", "id_token_hint" or "login_hint".  </p>
<p>The following is a non-normative example from an authentication request (with line wraps within values for display purposes only): </p>
<pre>
       
         POST /bc-authorize HTTP/1.1
         Host: server.example.com
         Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
         Content-Type: application/json
              
         {
          "scope": "openid",
          "client_notification_token": "8d67dc78-7faa-4d41-aabd-67707b374255",
          "acr_values": "mod-mf",
          "login_hint_token": "eyJhbGciOiJSU0EtT0FFUCIsImVuYyI6IkEyNTZHQ00ifQ.
             OKOawDo13gRp2ojaHV7LFpZcgV7T6DVZKTyKOMTYUmKoTCVJRgckCL9kiMT03JGe
             ipsEdY3mx_etLbbWSrFr05kLzcSr4qKAq7YN7e9jwQRb23nfa6c9d-StnImGyFDb
             Sv04uVuxIp5Zms1gNxKKK2Da14B8S4rzVRltdYwam_lDp5XnZAYpQdb76FdIKLaV
             mqgfwX7XWRxv2322i-vDxRfqNzo_tETKzpVLzfiwQyeyPGLBIO56YJ7eObdv0je8
             1860ppamavo35UgoRdbYaBcoh9QcfylQr66oc6vFWXRcZ_ZT2LawVCWTIy3brGPi
             6UklfCpIMfIjf7iGdXKHzg.
             48V1_ALb6US04U3b.
             5eym8TW_c8SuK0ltJ3rpYIzOeDQz7TALvtu6UG9oMo4vpzs9tX_EFShS8iB7j6ji
             SdiwkIr3ajwQzaBtQD_A.
             XFBoMYUZodetZdvTiFvSkQ"
         }
       
          </pre>
<h1 id="rfc.section.4.2"><a href="#rfc.section.4.2">4.2.</a> <a href="#auth_request_validation" id="auth_request_validation">Authentication Request Validation</a></h1>
<p id="rfc.section.4.2.p.1">The OpenID Provider MUST validate the request received as follows: </p>
<p/>

<ol>
  <li>Authenticate the Client.  <br/> e.g.: by validating the Client Credentials as described in Section 9 on <a href="#OpenID.Core">[OpenID.Core]</a>.  </li>
  <li>The OpenID Provider MUST validate all the OAuth 2.0 parameters according to <a href="#MODRNA.Authentication">OpenID Connect MODRNA Authentication Profile 1.0</a>.  </li>
  <li>In the event of a request contains more than one of this hints specified in <a href="#auth_request">Authentication Request</a> <cite title="NONE">[auth_request]</cite>, the OpenID Provider MUST return an "invalid_request" error response as per Section 3.1.2.6 of <a href="#OpenID.Core">[OpenID.Core]</a>.  </li>
  <li>The OpenID Provider MUST validate the hint provided (login_hint, login_token_hint or id_token_hint).  <br/> e.g.: If a signature is provided it MUST be checked. If a validity date is provided it MUST be checked.  <br/> If the hint is not valid or if the OP is not able to determine the user then an error should be returned to the Client as per section <a href="#auth_error_response">Authentication Error Response</a>.  </li>
  <li>The OpenID Provider MUST verify that all the REQUIRED parameters are present and their usage conforms to this specification.  </li>
</ol>

<p> </p>
<p id="rfc.section.4.2.p.3">As specified in OAuth 2.0 <a href="#RFC6749">[RFC6749]</a>, OpenID Providers SHOULD ignore unrecognized request parameters.  </p>
<p id="rfc.section.4.2.p.4">If the OpenID Provider encounters any error, it MUST return an error response, per Section 3.1.2.6 of <a href="#OpenID.Core">[OpenID.Core]</a>.  </p>
<h1 id="rfc.section.4.3"><a href="#rfc.section.4.3">4.3.</a> <a href="#successful_authentication_request_acknowdlegment" id="successful_authentication_request_acknowdlegment">Successful Authentication Request Acknowledgement</a></h1>
<p id="rfc.section.4.3.p.1">If the <a href="#auth_request">Authentication Request</a> is validated as per Section <a href="#auth_request_validation">Authentication Request Validation</a>, the OpenID Provider will return an HTTP 200 OK response to the Client to indicate that the authentication request has been accepted and it is going to be processed. The body of this response will contain: </p>
<p/>

<dl>
  <dt>auth_req_id</dt>
  <dd style="margin-left: 8">REQUIRED. It is a unique id to identify the authentication request (transaction) made by the Client.  The <samp>auth_req_id</samp> will be included too in the token notification when Notification mode is used to allow the Client correlate the authentication request and the received tokens.  It will not be included in the token response when using Polling Mode.  </dd>
  <dt>expires in</dt>
  <dd style="margin-left: 8">REQUIRED. Expiration time of the "auth_req_id" in seconds since the auth_request was received. When using the Polling mode, the auth_req_id will be considered overdue and the OpenID Provider will return an error to indicate it, see <a href="#token_error_response">Token Error Response</a>.  </dd>
  <dt>interval</dt>
  <dd style="margin-left: 8">OPTIONAL. The minimum amount of time in seconds that the Client SHOULD wait between polling requests to the token endpoint.  This parameter will only be present in case of there is not any callback URI registered as "client_notification_endpoint", that is in case the Client is using the Polling mode.  </dd>
</dl>

<p> </p>
<p>The following is a non-normative example from an authentication response </p>
<pre>
            
              HTTP/1.1 200 OK
              Content-Type: application/json
              Cache-Control: no-store

              {
                "auth_req_id": "1c266114-a1be-4252-8ad1-04986c5b9ac1",
                "expires_in": 3600,
                "interval": 2
              }
            
          </pre>
<h1 id="rfc.section.4.4"><a href="#rfc.section.4.4">4.4.</a> <a href="#auth_request_acknowdlegment_validation" id="auth_request_acknowdlegment_validation">Authentication Request Acknowledgment Validation</a></h1>
<p id="rfc.section.4.4.p.1">If the Client receives an HTTP 200 OK, it MUST validate that all the required parameters are received. The Client should keep the authentication request identifier <samp>auth_req_id</samp> in order to match it with token response.  </p>
<p id="rfc.section.4.4.p.2">The Client will have to keep the expiration time as well to be able to discard the authentication request acknowledgment.  </p>
<h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a> <a href="#auth_server_obtains_consent" id="auth_server_obtains_consent">OpenID Provider Obtains End-user Consent/Authorization</a></h1>
<p id="rfc.section.5.p.1">After the OP has validated the Authentication Request and the OP identifies the user's Authentication Device.  The OP chooses a channel to best contact the AD and fullfil the Client's requirements regarding acr_values.  </p>
<p id="rfc.section.5.p.2">Once the End-User is authenticated, the OpenID Provider MUST obtain an authorization decision before releasing information to the Client. As in OAuth2 and as in OpenID Connect the OP informs the user about the current Authentication Request e.g.: Which Client is requesting which information and which access.  </p>
<p id="rfc.section.5.p.3">When using the Client initiated Backchannel Authentication flow, there is not any interactive dialogue between the OpenID Provider and the end-user through the user's consumption device.  There might be an agent of the Client involved who transfers the binding_message to the user.  </p>
<p id="rfc.section.5.p.4">The consent establishing only can take place via the authentication device or by establishing consent via conditions for processing the request or other means (for example, via previous administrative consent).  Sections 2 and 5.3 of <a href="#OpenID.Core">[OpenID.Core]</a> describe information release mechanisms.  </p>
<p id="rfc.section.5.p.5">NOTE: the current version of the Client initiated Backchannel Authentication Flow spec. does not specify any mechanism to use the authentication device to obtain the end-user consent.  </p>
<h1 id="rfc.section.6"><a href="#rfc.section.6">6.</a> <a href="#getting_transaction_result" id="getting_transaction_result">Getting the Transaction Result</a></h1>
<h1 id="rfc.section.6.1"><a href="#rfc.section.6.1">6.1.</a> <a href="#token_request" id="token_request">Token Request Using Polling Mechanism</a></h1>
<p id="rfc.section.6.1.p.1">If the Client didn't register any callback URI for the "client_notification_endpoint" with the OpenID Provider, the Polling mode to get the token is set.  The Client must poll the token endpoint until the end-user grants or denies the request.  </p>
<p id="rfc.section.6.1.p.2">The Client polls at reasonable interval which MUST NOT exceed the minimum interval provided by the OpenID Provider via the "interval" parameter (if provided).  </p>
<p id="rfc.section.6.1.p.3">The Client makes a "POST" request to the token endpoint by sending the following parameters using the "application/x-www-form-urlencoded" format with a character encoding of UTF-8 in the HTTP request entity-body: </p>
<p/>

<dl>
  <dt>grant_type</dt>
  <dd style="margin-left: 8">REQUIRED.  Value MUST be set to "urn:openid:params:modrna:grant&#8209;type:backchannel_request".  </dd>
  <dt>auth_req_id</dt>
  <dd style="margin-left: 8">REQUIRED. It is a unique id to identify the authentication request (transaction) made by the Client.  </dd>
</dl>

<p> </p>
<p>The following is a non-normative example of a token request (with line wraps within values for display purposes only).  </p>
<pre>
    
        POST /token HTTP/1.1
        Host: server.example.com
        Content-Type: application/x-www-form-urlencoded
        Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
                
        grant_type=urn%3Aopenid%3Aparams%3Amodrna%3Agrant-type%3Abackchannel_request
          &amp;auth_req_id=1c266114-a1be-4252-8ad1-04986c5b9ac1

    
          </pre>
<h1 id="rfc.section.6.2"><a href="#rfc.section.6.2">6.2.</a> <a href="#token_response" id="token_response">Successful Token Polling Response</a></h1>
<p id="rfc.section.6.2.p.1">The OpenID Provider will return the token as an HTTP response to the Client's poll request. If the user is well authenticated, the OpenID Provider will return a succesful response that includes an ID Token and an Access Token. Otherwise it responses with an error as defined in <a href="#token_error_response">Token Error Response</a>.  </p>
<p>The following is a non-normative example of a token response sending as an HTTP 200 OK Response to the Client's poll request (with line wraps within values for display purposes only).  </p>
<pre>
            
                HTTP/1.1 200 OK
                Content-Type: application/json
                Cache-Control: no-store

                {
                 "access_token": "SlAV32hkKG",
                 "token_type": "Bearer",
                 "refresh_token": "8xLOxBtZp8",
                 "expires_in": 3600,
                 "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjFlOWdkazcifQ.ewogImlzc
                   yI6ICJodHRwOi8vc2VydmVyLmV4YW1wbGUuY29tIiwKICJzdWIiOiAiMjQ4Mjg5
                   NzYxMDAxIiwKICJhdWQiOiAiczZCaGRSa3F0MyIsCiAibm9uY2UiOiAibi0wUzZ
                   fV3pBMk1qIiwKICJleHAiOiAxMzExMjgxOTcwLAogImlhdCI6IDEzMTEyODA5Nz
                   AKfQ.ggW8hZ1EuVLuxNuuIJKX_V8a_OMXzR0EHR9R6jgdqrOOF4daGU96Sr_P6q
                   Jp6IcmD3HP99Obi1PRs-cwh3LO-p146waJ8IhehcwL7F09JdijmBqkvPeB2T9CJ
                   NqeGpe-gccMg4vfKjkM8FcGvnzZUN4_KSP0aAp1tOJ1zZwgjxqGByKHiOtX7Tpd
                   QyHE5lcMiKPXfEIQILVq0pc_E2DzL7emopWoaoZTF_m0_N0YzFC6g6EJbOEoRoS
                   K5hoDalrcvRYLSrQAZZKflyuVCyixEoV9GfNQC3_osjzw2PAithfubEEBLuVVk4
                   XUVrWOLrLl0nx7RkKU8NXNHq-rvKMzqg"
                }              
            
          </pre>
<h1 id="rfc.section.6.3"><a href="#rfc.section.6.3">6.3.</a> <a href="#token_notification" id="token_notification">Token Notification</a></h1>
<h1 id="rfc.section.6.3.1"><a href="#rfc.section.6.3.1">6.3.1.</a> <a href="#issuing_successful_token" id="issuing_successful_token">Successful Token Notification</a></h1>
<p id="rfc.section.6.3.1.p.1">If the Client is registered for Client notifications (Notification mode), the OpenID Provider will send the token response making a "POST HTTP Request" to the Client's client_notification_endpoint. If the user is well authenticated, the OpenID Provider returns a successful response that includes an ID Token and an Access Token and a Refresh Token. If the request failed Client authentication or is invalid, the OpenID Provider sends an error_message as described in <a href="#token_error_response">Token Error Response</a>.  </p>
<p id="rfc.section.6.3.1.p.2">All the parameters in the successful response are defined in Section 4.1.4 of OAuth 2.0 [RFC6749] except the new one "auth_req_id" that will be the same received in the request as defined in <a href="#successful_authentication_request_acknowdlegment">Successful Authentication Response</a> <cite title="NONE">[successful_authentication_request_acknowdlegment]</cite>. The response uses the application/json media type.  </p>
<p>The following is a non-normative example of a token response sending as a HTTP POST request to the callback uri specified in the "client_notification_endpoint" parameter by the Client (with line wraps within values for display purposes only).  The request is authenticated through a bearer token that is the value of the "client_notification_token" provided by the Client in the Authentication Request.  </p>
<pre>
              
                  POST /cb HTTP/1.1
                  Host: client.example.com
                  Authorization: Bearer 8d67dc78-7faa-4d41-aabd-67707b374255
                  Content-Type: application/json
                  
                  { 
                   "auth_req_id": "1c266114-a1be-4252-8ad1-04986c5b9ac1",
                   "access_token": "SlAV32hkKG",
                   "token_type": "Bearer",
                   "refresh_token": "8xLOxBtZp8",
                   "expires_in": 3600,
                   "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjFlOWdkazcifQ.ewogImlzc
                     yI6ICJodHRwOi8vc2VydmVyLmV4YW1wbGUuY29tIiwKICJzdWIiOiAiMjQ4Mjg5
                     NzYxMDAxIiwKICJhdWQiOiAiczZCaGRSa3F0MyIsCiAibm9uY2UiOiAibi0wUzZ
                     fV3pBMk1qIiwKICJleHAiOiAxMzExMjgxOTcwLAogImlhdCI6IDEzMTEyODA5Nz
                     AKfQ.ggW8hZ1EuVLuxNuuIJKX_V8a_OMXzR0EHR9R6jgdqrOOF4daGU96Sr_P6q
                     Jp6IcmD3HP99Obi1PRs-cwh3LO-p146waJ8IhehcwL7F09JdijmBqkvPeB2T9CJ
                     NqeGpe-gccMg4vfKjkM8FcGvnzZUN4_KSP0aAp1tOJ1zZwgjxqGByKHiOtX7Tpd
                     QyHE5lcMiKPXfEIQILVq0pc_E2DzL7emopWoaoZTF_m0_N0YzFC6g6EJbOEoRoS
                     K5hoDalrcvRYLSrQAZZKflyuVCyixEoV9GfNQC3_osjzw2PAithfubEEBLuVVk4
                     XUVrWOLrLl0nx7RkKU8NXNHq-rvKMzqg"
                  }              
              
            </pre>
<h1 id="rfc.section.6.3.2"><a href="#rfc.section.6.3.2">6.3.2.</a> <a href="#client_notification_endpoint" id="client_notification_endpoint">Client Notification Endpoint</a></h1>
<p id="rfc.section.6.3.2.p.1">The Client Notification Endpoint is set by the Client during the registration phase. This endpoint is intended to receive the result of the authentication (id_token, access_token and refresh token) and it requires the request to be authenticated using a "bearer token" created by the Client and sent to the OP in the Authentication request as the value of the parameter "client_notification_token".  </p>
<p id="rfc.section.6.3.2.p.2">Communication with the Client Notification Authentication Endpoint MUST utilize TLS. See Section 16.17 <a href="#OpenID.Core">[OpenID.Core]</a> for more information on using TLS.  </p>
<h1 id="rfc.section.6.4"><a href="#rfc.section.6.4">6.4.</a> <a href="#token_error_response" id="token_error_response">Token Error Response</a></h1>
<p id="rfc.section.6.4.p.1">If the Token Request is invalid or unauthorized, the OpenID Provider constructs the error response according to the section 3.1.3.4 Token Error Response of <a href="#OpenID.Core">[OpenID.Core]</a>.  In addition to the error codes defined in Section 5.2 of <a href="#RFC6749">[RFC6749]</a>, the following error codes are specific for the Client Initiated Backchannel flow: </p>
<p/>

<dl>
  <dt>unknown_auth_req_id</dt>
  <dd style="margin-left: 8">The OP doesn't know the auth_req_id that the Client is asking for. It only applies when using Polling mode.  </dd>
  <dt>authorization_pending</dt>
  <dd style="margin-left: 8">The authorization request is still pending as the end-user hasn't yet been authenticated. It only applies when using Polling mode.  </dd>
  <dt>slow_down</dt>
  <dd style="margin-left: 8">The Client is polling too quickly and should back off at a reasonable rate. It only applies when using Polling mode.  </dd>
  <dt>expired_token</dt>
  <dd style="margin-left: 8">The auth_req_id has expired. The Client will need to make a new Authentication Request.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.6.5"><a href="#rfc.section.6.5">6.5.</a> <a href="#auth_error_response" id="auth_error_response">Authentication Error Response</a></h1>
<p id="rfc.section.6.5.p.1">An Authentication Error Response is an OAuth 2.0 Authorization Error Response message returned from the OP's Authorization Endpoint in response to the Authorization Request message sent by the Client.  </p>
<p id="rfc.section.6.5.p.2">If the End-User denies the request or the End-User authentication fails, the OP (Authorization Server) informs the Client by using the follow Error Responses, many of them are defined in Section 4.1.2.1 of <a href="#RFC6749">OAuth 2.0</a> <cite title="NONE">[RFC6749]</cite>, however they cannot be sent using a redirection as OAuth 2.0 does because there isn't any User Agent through which send the error to the Client.  </p>
<p id="rfc.section.6.5.p.3">Errors will be sent directly to the client as HTTP Error Responses, whose body will contain a json with two parameters </p>

<dl>
  <dt>error_description</dt>
  <dd style="margin-left: 8">OPTIONAL.  Human-readable ASCII [USASCII] text providing additional information, used to assist the client developer in understanding the error that occurred.  Values for the "error_description" parameter MUST NOT include characters outside the set %x20-21 / %x23-5B / %x5D-7E </dd>
  <dt>error</dt>
  <dd style="margin-left: 8">REQUIRED. A single ASCII error code from one of the present in the list below.  </dd>
</dl>

<p> </p>
<p id="rfc.section.6.5.p.4">List of authentication error codes associated to a HTTP Errors.  </p>
<p/>

<dl>
  <dt>HTTP 400 Bad Request</dt>
  <dd style="margin-left: 8">
    <dl>
      <dt>invalid_request</dt>
      <dd style="margin-left: 8">The request is missing a required parameter, includes an invalid parameter value, includes a parameter more than once, or is otherwise malformed.  </dd>
      <dt>invalid_scope</dt>
      <dd style="margin-left: 8">The requested scope is invalid, unknown, or malformed.  </dd>
      <dt>expired_token</dt>
      <dd style="margin-left: 8">The login_hint_token or the id_token_hint provided in the authentication request is expired, so not valid.  </dd>
    </dl>
    <p> </p>
  </dd>
  <dt>HTTP 403 Forbidden</dt>
  <dd style="margin-left: 8">
    <dl>
      <dt>unauthorized_client</dt>
      <dd style="margin-left: 8">The client is not authorized to request an authentication using this method.  </dd>
      <dt>access_denied</dt>
      <dd style="margin-left: 8">The resource owner or authorization server denied the request.  </dd>
    </dl>
    <p> </p>
  </dd>
  <dt>HTTP 404 Not Found</dt>
  <dd style="margin-left: 8">
    <dl>
      <dt>unknown_user_id</dt>
      <dd style="margin-left: 8">The OpenID Provider is not able to figure out which user has to be authenticated by means of the hint provided in the request (login_hint_token, id_token_hint or login_hint).  </dd>
    </dl>
    <p> </p>
  </dd>
</dl>

<p> </p>
<p>The following is a non-normative example from an authentication error response: </p>
<pre>
            
              HTTP/1.1 403 Forbidden 
              Content-Type: application/json
              {
                "error": "unauthorized_client",
                "error_description": "The client 'client.example.org' is not allowed to use Client Backchannel Authentication."
              }
            
          </pre>
<h1 id="rfc.section.7"><a href="#rfc.section.7">7.</a> <a href="#security_considerations" id="security_considerations">Security Considerations</a></h1>
<p id="rfc.section.7.p.1">The login hint token SHOULD be digitally signed by the issuer.  This ensures authenticity of the data and reduces the threat of an injection attack.  The signature allows the OP to authenicate and authorize the sender of the hint and prevent collecting of phone numbers by rogue Clients.  </p>
<p id="rfc.section.7.p.2">The OP SHOULD ensure that the "client_notification_endpoint" configured at registration time is in the administrativ authority of the Client.  Otherwise the OP would post authentication results to the wrong Client.  </p>
<p id="rfc.section.7.p.3">How this check in done is outside the scope of this specification.  </p>
<h1 id="rfc.section.8"><a href="#rfc.section.8">8.</a> <a href="#privacy_considerations" id="privacy_considerations">Privacy Considerations</a></h1>
<p id="rfc.section.8.p.1">Using MODRNA Client initiated Backchannel Authentication it is possible for the Client to authenticate a user without knowing e.g. the MSISDN of the user.  Users might be reluctant to provide their MSISDN to Clients because they fear misuse through automated calls or theirs number being leaked.  The login hint token is encrypted in order to protect the user's MSISDN from being revealed to the Client unintentionally.  </p>
<h1 id="rfc.references"><a href="#rfc.references">9.</a> References</h1>
<h1 id="rfc.references.1"><a href="#rfc.references.1">9.1.</a> Normative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="I-D.ietf-oauth-amr-values">[I-D.ietf-oauth-amr-values]</b>
      </td>
      <td class="top"><a>Jones, M.</a>, <a>Hunt, P.</a> and <a>A. Nadalin</a>, "<a href="http://tools.ietf.org/html/draft-ietf-oauth-amr-values-06">Authentication Method Reference Values</a>", Internet-Draft draft-ietf-oauth-amr-values-06, February 2017.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="MODRNA.Authentication">[MODRNA.Authentication]</b>
      </td>
      <td class="top"><a href="mailto:j.connotte@telekom.de" title="Deutsche Telekom AG">Connotte, J.</a> and <a href="mailto:jbradley@pingidentity.com" title="Ping Identity">J. Bradley</a>, "<a href="http://openid.net/specs/openid-connect-modrna-authentication-1_0.html">OpenID Connect MODRNA Authentication Profile 1.0</a>", March 2017.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="OpenID.Core">[OpenID.Core]</b>
      </td>
      <td class="top"><a href="mailto:n-sakimura@nri.co.jp" title="Nomura Research Institute, Ltd.">Sakimura, N.</a>, <a href="mailto:ve7jtb@ve7jtb.com" title="Ping Identity">Bradley, J.</a>, <a href="mailto:mbj@microsoft.com" title="Microsoft">Jones, M.</a>, <a href="mailto:breno@google.com" title="Google">de Medeiros, B.</a> and <a href="mailto:cmortimore@salesforce.com" title="Salesforce">C. Mortimore</a>, "<a href="http://openid.net/specs/openid-connect-core-1_0.html">OpenID Connect Core 1.0</a>", August 2015.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2119">[RFC2119]</b>
      </td>
      <td class="top"><a>Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.references.2"><a href="#rfc.references.2">9.2.</a> Informative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="RFC3986">[RFC3986]</b>
      </td>
      <td class="top"><a>Berners-Lee, T.</a>, <a>Fielding, R.</a> and <a>L. Masinter</a>, "<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>", STD 66, RFC 3986, DOI 10.17487/RFC3986, January 2005.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6749">[RFC6749]</b>
      </td>
      <td class="top"><a>Hardt, D.</a>, "<a href="http://tools.ietf.org/html/rfc6749">The OAuth 2.0 Authorization Framework</a>", RFC 6749, DOI 10.17487/RFC6749, October 2012.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.appendix.A"><a href="#rfc.appendix.A">Appendix A.</a> <a href="#Acknowledgements" id="Acknowledgements">Acknowledgements</a></h1>
<p id="rfc.section.A.p.1">The following have contributed to the development of this specification.</p>
<h1 id="rfc.appendix.B"><a href="#rfc.appendix.B">Appendix B.</a> <a href="#Notices" id="Notices">Notices</a></h1>
<p id="rfc.section.B.p.1">Copyright (c) 2017 The OpenID Foundation.</p>
<p id="rfc.section.B.p.2">The OpenID Foundation (OIDF) grants to any Contributor, developer, implementer, or other interested party a non-exclusive, royalty free, worldwide copyright license to reproduce, prepare derivative works from, distribute, perform and display, this Implementers Draft or Final Specification solely for the purposes of (i) developing specifications, and (ii) implementing Implementers Drafts and Final Specifications based on such documents, provided that attribution be made to the OIDF as the source of the material, but that such attribution does not indicate an endorsement by the OIDF.  </p>
<p id="rfc.section.B.p.3">The technology described in this specification was made available from contributions from various sources, including members of the OpenID Foundation and others.  Although the OpenID Foundation has taken steps to help ensure that the technology is available for distribution, it takes no position regarding the validity or scope of any intellectual property or other rights that might be claimed to pertain to the implementation or use of the technology described in this specification or the extent to which any license under such rights might or might not be available; neither does it represent that it has made any independent effort to identify any such rights.  The OpenID Foundation and the contributors to this specification make no (and hereby expressly disclaim any) warranties (express, implied, or otherwise), including implied warranties of merchantability, non-infringement, fitness for a particular purpose, or title, related to this specification, and the entire risk as to implementing this specification is assumed by the implementer.  The OpenID Intellectual Property Rights policy requires contributors to offer a patent promise not to assert certain patent claims against other contributors and against implementers.  The OpenID Foundation invites any interested party to bring to its attention any copyrights, patents, patent applications, or other proprietary rights that may cover technology that may be required to practice this specification.  </p>
<h1 id="rfc.appendix.C"><a href="#rfc.appendix.C">Appendix C.</a> <a href="#History" id="History">Document History</a></h1>
<p id="rfc.section.C.p.1">[[ To be removed from the final specification ]]</p>
<p id="rfc.section.C.p.2">-01 </p>

<ul>
  <li>Initial draft</li>
</ul>

<p> </p>
<p id="rfc.section.C.p.3">-02 </p>

<ul>
  <li>Second draft</li>
  <li>Authentication Request Section: Improving the definition of <samp>client_req_id</samp></li>
  <li>Successful Authentication Request Acknowledgement: a.  <samp>auth_req_id</samp>: to explain that it will not be present in token when using Polling mode b.  interval: fixing a misleading description </li>
  <li>Token Request Using Polling Mechanism: a.  Fixing a misleading description about the inclusion of <samp>client_notification_endpoint</samp> in the authentication request.  It does not  make sense since Notification or Polling mode is defined at the registration time and <samp>client_notification_endpoint</samp>.  is not sent in the authentication request anymore.  b. <samp>auth_req_id</samp>: fixing misleading description.  </li>
  <li>Changing Successful Token Polling to Successful Token Polling Response</li>
  <li>Improving descriptions in Successful Token Polling Response and Successful Token Notification</li>
  <li><samp>expires_in</samp> parameter from Successful Authentication Request Acknowledgement refers to the <samp>auth_req_id</samp> that will be considered overdue to make new polling requests after that time.  </li>
  <li>New <samp>unknown_auth_req_id</samp> and <samp>expired_token</samp> erros in Token Error Response</li>
  <li>Authentication Error Response section is defined and incorporates two new errors: <samp>unknown_user_id</samp> when OP cannot figure out the user to be authenticated by means of the hint and <samp>expired_token</samp> to indicate that the login_hint_token or id_token_hint provided is expired.  </li>
  <li>Changing <samp>client_req_id</samp>to <samp>client_notification_token</samp></li>
  <li>New overview section</li>
</ul>

<p> </p>
<p id="rfc.section.C.p.4">-03 </p>

<ul>
  <li>Following the lead of user questioning remove the term Relying Party in most places.</li>
</ul>

<p> </p>
<h1 id="rfc.authors">
  <a href="#rfc.authors">Authors' Addresses</a>
</h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Gonzalo Fernandez Rodriguez</span> 
	  <span class="n hidden">
		<span class="family-name">Fernandez</span>
	  </span>
	</span>
	<span class="org vcardline">Telefonica I+D</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:gonzalo.fernandezrodriguez@telefonica.com">gonzalo.fernandezrodriguez@telefonica.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Florian Walter</span> 
	  <span class="n hidden">
		<span class="family-name">Walter</span>
	  </span>
	</span>
	<span class="org vcardline">Deutsche Telekom AG</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:F.Walter@telekom.de">F.Walter@telekom.de</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Axel Nennker</span> 
	  <span class="n hidden">
		<span class="family-name">Nennker</span>
	  </span>
	</span>
	<span class="org vcardline">Deutsche Telekom AG</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:axel.nennker@telekom.de">axel.nennker@telekom.de</a></span>

  </address>
</div>

</body>
</html>

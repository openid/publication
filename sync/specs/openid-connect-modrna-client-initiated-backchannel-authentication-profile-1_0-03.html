<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>MODRNA: Client Initiated Backchannel Authentication Profile 1.0 draft-03</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Requirements Notation and Conventions">
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 Overview">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Examples of Use Cases">
<link href="#rfc.section.4" rel="Chapter" title="4 Authentication Request">
<link href="#rfc.section.5" rel="Chapter" title="5 Security Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 Privacy Considerations">
<link href="#rfc.references" rel="Chapter" title="7 References">
<link href="#rfc.references.1" rel="Chapter" title="7.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="7.2 Informative References">
<link href="#rfc.appendix.A" rel="Chapter" title="A Example Flow">
<link href="#rfc.appendix.B" rel="Chapter" title="B Acknowledgements">
<link href="#rfc.appendix.C" rel="Chapter" title="C Notices">
<link href="#rfc.appendix.D" rel="Chapter" title="D Document History">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.44.0 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Fernandez, G., Walter, F., Nennker, A., Tonge, D., and B. Hjelm" />
  <meta name="dct.identifier" content="urn:ietf:id:openid-connect-modrna-client-initiated-backchannel-authentication-profile-03" />
  <meta name="dct.issued" scheme="ISO8601" content="2020-04-30" />
  <meta name="dct.abstract" content="OpenID Connect Client Initiated Backchannel Authentication Flow [CIBA Core] is an authentication flow like OpenID Connect but with a direct Relying Party to OpenID Provider communication without redirects through the user's browser. The MODRNA Client Initiated Backchannel Authentication (CIBA) Profile is a profile of OpenID Connect Client Initiated Backchannel Authentication Flow [CIBA Core] to be used when requesting authentication from Mobile Network Operators (MNOs).   " />
  <meta name="description" content="OpenID Connect Client Initiated Backchannel Authentication Flow [CIBA Core] is an authentication flow like OpenID Connect but with a direct Relying Party to OpenID Provider communication without redirects through the user's browser. The MODRNA Client Initiated Backchannel Authentication (CIBA) Profile is a profile of OpenID Connect Client Initiated Backchannel Authentication Flow [CIBA Core] to be used when requesting authentication from Mobile Network Operators (MNOs).   " />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left"></td>
<td class="right">G. Fernandez</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Telefonica</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">F. Walter</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">A. Nennker</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Deutsche Telekom AG</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">D. Tonge</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Moneyhub</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">B. Hjelm</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Verizon</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">April 30, 2020</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">MODRNA: Client Initiated Backchannel Authentication Profile 1.0 draft-03<br />
  <span class="filename">openid-connect-modrna-client-initiated-backchannel-authentication-profile-03</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p><a href="#CIBA.Core" class="xref">OpenID Connect Client Initiated Backchannel Authentication Flow</a> [CIBA Core] is an authentication flow like OpenID Connect but with a direct Relying Party to OpenID Provider communication without redirects through the user's browser. The MODRNA Client Initiated Backchannel Authentication (CIBA) Profile is a profile of <a href="#CIBA.Core" class="xref">OpenID Connect Client Initiated Backchannel Authentication Flow</a> [CIBA Core] to be used when requesting authentication from Mobile Network Operators (MNOs).  </p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Requirements Notation and Conventions</a>
</li>
</ul><li>2.   <a href="#rfc.section.2">Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">Overview</a>
</li>
<ul><li>3.1.   <a href="#rfc.section.3.1">Examples of Use Cases</a>
</li>
</ul><li>4.   <a href="#rfc.section.4">Authentication Request</a>
</li>
<li>5.   <a href="#rfc.section.5">Security Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">Privacy Considerations</a>
</li>
<li>7.   <a href="#rfc.references">References</a>
</li>
<ul><li>7.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>7.2.   <a href="#rfc.references.2">Informative References</a>
</li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">Example Flow</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.B">Acknowledgements</a>
</li>
<li>Appendix C.   <a href="#rfc.appendix.C">Notices</a>
</li>
<li>Appendix D.   <a href="#rfc.appendix.D">Document History</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#Introduction" id="Introduction">Introduction</a>
</h1>
<p><a href="#CIBA.Core" class="xref">OpenID Connect Client Initiated Backchannel Authentication Flow</a> [CIBA Core] is an authentication flow like OpenID Connect in which a Relying Party, that can obtain a valid identifier for the user they want to authenticate, will be able to initiate an interaction flow to authenticate their users without having end-user interaction from the consumption device. The flow involves direct communication from the Client to the OpenID Provider without redirect through the user's browser (consumption device).  </p>
<p id="rfc.section.1.p.2">This specification is a MODRNA profile of the <a href="#CIBA.Core" class="xref">OpenID Connect Client Initiated Backchannel Authentication Flow</a> [CIBA.Core] to be used when requesting authentication from Mobile Network Operators (MNOs) and includes guidance specific to that context.  </p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#rnc" id="rnc">Requirements Notation and Conventions</a>
</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119" class="xref">[RFC2119]</a>.  </p>
<p id="rfc.section.1.1.p.2">Throughout this document, values are quoted to indicate that they are to be taken literally. When using these values in protocol messages, the quotes MUST NOT be used as part of the value.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#terminology" id="terminology">Terminology</a>
</h1>
<p id="rfc.section.2.p.1">This specification uses the terms "OpenID Provider (OP)" and "Relying Party (RP)" as defined by <a href="#OpenID.Core" class="xref">OpenID Connect Core</a> [OpenID.Core]. Furthermore, it uses the term "Client" as defined by <a href="#RFC6749" class="xref">OAuth 2.0</a>. OAuth 2.0 Authorization Servers implementing OpenID Connect and CIBA are also referred to as OpenID Providers (OPs).  OAuth 2.0 Clients using OpenID Connect and CIBA are also referred to as Relying Parties (RPs).  This specification also uses the following terms: </p>
<p></p>

<dl>
<dt>Mobile Network Operator (MNO)</dt>
<dd style="margin-left: 8">A provider of wireless communication services that owns or controls the wireless network elements necessary to sell and deliver services to an end user.  </dd>
<dt>Mobile Station International Subscriber Directory Number (MSISDN)</dt>
<dd style="margin-left: 8">A telephone number uniquely identifying a subscription in a mobile network.  </dd>
<dt>Consumption Device (CD)</dt>
<dd style="margin-left: 8">The Consumption Device is the device that helps the user consume the service.  In the CIBA use case, the user is not necessarily in control of the CD. For example, the CD may be in the control of an RP agent (e.g. at a bank teller) or may be an RP controlled device (e.g. a petrol pump).  </dd>
<dt>Authentication Device (AD)</dt>
<dd style="margin-left: 8">The device on which the user will authenticate and authorize the request, often a smartphone.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#overview" id="overview">Overview</a>
</h1>
<p id="rfc.section.3.p.1">Client Initiated Backchannel Authentication (CIBA) enables a Client to initiate the authentication of an end-user by means of out-of-band mechanisms. The <a href="#CIBA.Core" class="xref">OpenID Connect Client Initiated Backchannel Authentication Flow</a> [CIBA Core] defines three ways to deliver the tokens and step 3 will cover the requirements for this profile.  </p>
<p></p>

<ol>
<li>The Client shall make an "HTTP POST" request to the Backchannel Authentication Endpoint to ask for end-user authentication.  </li>
<li>The OP will respond immediately with a unique identifier that identifies that authentication while it tries to authenticate the user in the background.  </li>
<li>The Client will receive the ID Token, Access Token and optionally Refresh Token by means of either the Poll or Push modes. This choice MUST be established by the Client at registration time.  <dl>
<dt>Poll Mode</dt>
<dd style="margin-left: 8">When configured in Poll mode, the Client will poll the token endpoint to get a response with the tokens.  </dd>
<dt>Push Mode</dt>
<dd style="margin-left: 8">When configured in Push mode, the OP will send a request with the tokens to a callback URI previously registered by the Client.  </dd>
</dl>
<p> </p>
</li>
</ol>

<p> </p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#use_cases" id="use_cases">Examples of Use Cases</a>
</h1>
<p id="rfc.section.3.1.p.1">The following use cases are non-normative examples to illustrate the usage of this specification.</p>
<p></p>

<ol>
<li>A call center agent wants to authenticate a caller.  Using additional scopes like e.g. "profile" or "phone" the call center agent would get access to claims about the user like "phone_number" and "phone_number_verified".  </li>
<li>An IDP wants to offer the ability for its relying parties to request "step-up" authorisation via a decoupled device </li>
</ol>

<p> </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#auth_request" id="auth_request">Authentication Request</a>
</h1>
<p id="rfc.section.4.p.1">The Authentication Request has the following differences from the <a href="#CIBA.Core" class="xref">OpenID Connect Client Initiated Backchannel Authentication Flow</a> [CIBA Core]: </p>
<p></p>

<dl>
<dt>acr_values</dt>
<dd style="margin-left: 8">REQUIRED. This value is required as defined in <a href="#MODRNA.Authentication" class="xref">OpenID Connect MODRNA Authentication Profile</a> [MODRNA.Authentication].  </dd>
</dl>

<p> </p>
<p id="rfc.section.4.p.3">Note: While the structure of a <samp>login_hint</samp> is undefined, in a mobile context a login_hint is likely to contain a MSISDN.  </p>
<p id="rfc.section.4.p.4">Note: An ecosystem can protect the pricacy of a user's MSISDN and other personally identifiable information through the use of a discovery service. The discovery service can return an encrypted <samp>login_hint_token</samp> for use in a CIBA flow.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#security_considerations" id="security_considerations">Security Considerations</a>
</h1>
<p id="rfc.section.5.p.1">While this profile suports CIBA push mode, implementers should only implement that mode if the constraints of an environment require it, e.g. high latency environments. Poll mode is preferred as this method of token delivery is the same as other OAuth 2.0 based flows, and therefore more likely to have had appropriate security review.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#privacy_considerations" id="privacy_considerations">Privacy Considerations</a>
</h1>
<p id="rfc.section.6.p.1">Using MODRNA CIBA Profile it is possible for the Client to authenticate a user without knowing e.g. the MSISDN of the user.  Users might be reluctant to provide their MSISDN to Clients because they fear misuse through automated calls or their number being leaked.  The login hint token can be encrypted in order to protect the user's MSISDN from being revealed to the Client unintentionally.  </p>
<p id="rfc.section.6.p.2">The section <a href="#SimAppletExample" class="xref">Example Flow</a> shows an example to illustrate the usage of MODRNA CIBA Profile specification to authenticate a user with a SIM Applet Authenticator.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">7.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">7.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="CIBA.Core">[CIBA.Core]</b></td>
<td class="top">
<a title="Telefonica I+D">Fernandez, G.</a>, <a title="Deutsche Telekom AG">Walter, F.</a>, <a title="Deutsche Telekom AG">Nennker, A.</a>, <a title="Moneyhub">Tonge, D.</a> and <a title="Ping Identity">B. Campbell</a>, "<a href="https://openid.net/specs/openid-client-initiated-backchannel-authentication-core-1_0.html">OpenID Client Initiated Backchannel Authentication Flow - Core 1.0</a>", January 2020.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-oauth-mtls">[I-D.ietf-oauth-mtls]</b></td>
<td class="top">
<a>Campbell, B.</a>, <a>Bradley, J.</a>, <a>Sakimura, N.</a> and <a>T. Lodderstedt</a>, "<a href="https://tools.ietf.org/html/draft-ietf-oauth-mtls-12">OAuth 2.0 Mutual TLS Client Authentication and Certificate Bound Access Tokens</a>", Internet-Draft draft-ietf-oauth-mtls-12, October 2018.</td>
</tr>
<tr>
<td class="reference"><b id="MODRNA.Authentication">[MODRNA.Authentication]</b></td>
<td class="top">
<a title="Deutsche Telekom">Connotte, J.</a> and <a title="Ping Identity">J. Bradley</a>, "<a href="https://openid.net/specs/openid-connect-modrna-authentication-1_0.html">OpenID Connect Mobile Authentication Profile 1.0</a>", March 2017.</td>
</tr>
<tr>
<td class="reference"><b id="OpenID.Core">[OpenID.Core]</b></td>
<td class="top">
<a href="mailto:n-sakimura@nri.co.jp" title="Nomura Research Institute, Ltd.">Sakimura, N.</a>, <a href="mailto:ve7jtb@ve7jtb.com" title="Ping Identity">Bradley, J.</a>, <a href="mailto:mbj@microsoft.com" title="Microsoft">Jones, M.</a>, <a href="mailto:breno@google.com" title="Google">de Medeiros, B.</a> and <a href="mailto:cmortimore@salesforce.com" title="Salesforce">C. Mortimore</a>, "<a href="http://openid.net/specs/openid-connect-core-1_0.html">OpenID Connect Core 1.0</a>", November 2014.</td>
</tr>
<tr>
<td class="reference"><b id="OpenID.Registration">[OpenID.Registration]</b></td>
<td class="top">
<a href="mailto:n-sakimura@nri.co.jp" title="Nomura Research Institute, Ltd.">Sakimura, N.</a>, <a href="mailto:ve7jtb@ve7jtb.com" title="Ping Identity">Bradley, J.</a> and <a href="mailto:mbj@microsoft.com" title="Microsoft">M. Jones</a>, "<a href="http://openid.net/specs/openid-connect-registration-1_0.html">OpenID Connect Dynamic Client Registration 1.0</a>", November 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6750">[RFC6750]</b></td>
<td class="top">
<a>Jones, M.</a> and <a>D. Hardt</a>, "<a href="https://tools.ietf.org/html/rfc6750">The OAuth 2.0 Authorization Framework: Bearer Token Usage</a>", RFC 6750, DOI 10.17487/RFC6750, October 2012.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7519">[RFC7519]</b></td>
<td class="top">
<a>Jones, M.</a>, <a>Bradley, J.</a> and <a>N. Sakimura</a>, "<a href="https://tools.ietf.org/html/rfc7519">JSON Web Token (JWT)</a>", RFC 7519, DOI 10.17487/RFC7519, May 2015.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">7.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="ETSI102204">[ETSI102204]</b></td>
<td class="top">
<a title="European Telecommunications Standards Institute">(2003-08), ETSI.</a>, "<a href="https://www.etsi.org/deliver/etsi_ts/102200_102299/102204/01.01.04_60/ts_102204v010104p.pdf">Mobile Commerce (M-COMM) Mobile Signature Service; Web Service Interface</a>", 2003.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-oauth-device-flow">[I-D.ietf-oauth-device-flow]</b></td>
<td class="top">
<a>Denniss, W.</a>, <a>Bradley, J.</a>, <a>Jones, M.</a> and <a>H. Tschofenig</a>, "<a href="https://tools.ietf.org/html/draft-ietf-oauth-device-flow-13">OAuth 2.0 Device Flow for Browserless and Input Constrained Devices</a>", Internet-Draft draft-ietf-oauth-device-flow-13, October 2018.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6749">[RFC6749]</b></td>
<td class="top">
<a>Hardt, D.</a>, "<a href="https://tools.ietf.org/html/rfc6749">The OAuth 2.0 Authorization Framework</a>", RFC 6749, DOI 10.17487/RFC6749, October 2012.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7591">[RFC7591]</b></td>
<td class="top">
<a>Richer, J.</a>, <a>Jones, M.</a>, <a>Bradley, J.</a>, <a>Machulak, M.</a> and <a>P. Hunt</a>, "<a href="https://tools.ietf.org/html/rfc7591">OAuth 2.0 Dynamic Client Registration Protocol</a>", RFC 7591, DOI 10.17487/RFC7591, July 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8414">[RFC8414]</b></td>
<td class="top">
<a>Jones, M.</a>, <a>Sakimura, N.</a> and <a>J. Bradley</a>, "<a href="https://tools.ietf.org/html/rfc8414">OAuth 2.0 Authorization Server Metadata</a>", RFC 8414, DOI 10.17487/RFC8414, June 2018.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.A">
<a href="#rfc.appendix.A">Appendix A.</a> <a href="#SimAppletExample" id="SimAppletExample">Example Flow</a>
</h1>
<p id="rfc.section.A.p.1">This is a non-normative example where a challenge authentication is launched by the OP to an applet that is running in the end-user device's SIM. Such applet implements an authenticator that validates a Pin Code entered by the end-user.  </p>
<p id="rfc.section.A.p.2">This authenticator would be implemented through the so-called MSSP (Mobile Signature Subscriber Provider) Server.  When the Backchannel Authentication Endpoint receives the request to authenticate the user and once it knows the user's MSISDN, it makes a call to the MSSP Server which builds a binary Class 2 SMS that is sent to the SIM card of the user where the applet is located.  </p>
<p id="rfc.section.A.p.3">This Class 2 SMS is not really sent directly from the MSSP but through the OTA (Over the air) platform which in turn signs and encrypts the message using a pair of keys (kyc, kyd) unique per each SIM Card.  </p>
<p id="rfc.section.A.p.4">Once the message reaches the SIM Card, it is decrypted by the CardManager and the signature is verified (thanks to the same pair of keys: kyc, kyd).  If everything is ok, the CardManager gives the message to the applet that checks the signature (the another one made by the MSSP) and displays the challenge through a popup using the mobile phone native interface) and the user is prompted to enter a Pin Code that is validated locally.  If the Pin Code is correct, the applet builds an OK response and signs it with the same key used by the MSSP to sign the request, this response is sent as a Class 3 message to the MSSP that checks the signature, and builds the id_token and the access_token to be returned to the Client.  </p>
<pre>
          

+-----+                    +-----+                      +-------+                 +-----------+          +-------+
| RP  |                    | OP  |                      | MSSP  |                 | SIMApplet |          | User  |
+-----+                    +-----+                      +-------+                 +-----------+          +-------+
   |                          |                             |                           |                    |
   | 1. POST /bc-authorize    |                             |                           |                    |
   |-------------------------&gt;|                             |                           |                    |
   |                          |                             |                           |                    |
   |           2. HTTP 200 OK |                             |                           |                    |
   |&lt;-------------------------|                             |                           |                    |
   |                          |                             |                           |                    |
   |                          | 3. Authenticate(MSISDN)     |                           |                    |
   |                          |----------------------------&gt;|                           |                    |
   |                          |                             |                           |                    |
   |                          |                             | 4. Challenge              |                    |
   |                          |                             |--------------------------&gt;|                    |
   |                          |                             |                           |                    |
   |                          |                             |                           | 7. Verify Req      |
   |                          |                             |                           |--------------      |
   |                          |                             |                           |             |      |
   |                          |                             |                           |&lt;-------------      |
   |                          |                             |                           |                    |
   |                          |                             |                           | 8. Challenge       |
   |                          |                             |                           |-------------------&gt;|
   |                          |                             |                           |                    |
   |                          |                             |                           |        9. Pin Code |
   |                          |                             |                           |&lt;-------------------|
   |                          |                             |                           |                    |
   |                          |                             |                           | 10. Verify Pin     |
   |                          |                             |                           |---------------     |
   |                          |                             |                           |              |     |
   |                          |                             |                           |&lt;--------------     |
   |                          |                             |                           |                    |
   |                          |                             |           11. Response OK |                    |
   |                          |                             |&lt;--------------------------|                    |
   |                          |                             |                           |                    |
   |                          |                             | 13. Verify Response       |                    |
   |                          |                             |--------------------       |                    |
   |                          |                             |                   |       |                    |
   |                          |                             |&lt;-------------------       |                    |
   |                          |                             |                           |                    |
   |                          |       14. Authentication OK |                           |                    |
   |                          |&lt;----------------------------|                           |                    |
   |                          |                             |                           |                    |
   |                          | 15. Generate Tokens         |                           |                    |
   |                          |--------------------         |                           |                    |
   |                          |                   |         |                           |                    |
   |                          |&lt;-------------------         |                           |                    |
   |                          |                             |                           |                    |
   |             16. POST /cb |                             |                           |                    |
   |&lt;-------------------------|                             |                           |                    |
   |                          |                             |                           |                    |


          
        </pre>
<p id="rfc.section.A.p.5">Many of the details have advisedly been excluded in order to simplify the flow described. To go into details of how to implement a Mobile Signature Service look at <a href="#ETSI102204" class="xref">Mobile Commerce (M-COMM) Mobile Signature Service; Web Service Interface</a>.  </p>
<h1 id="rfc.appendix.B">
<a href="#rfc.appendix.B">Appendix B.</a> <a href="#Acknowledgements" id="Acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.B.p.1">The following have contributed to the development of this specification.</p>
<h1 id="rfc.appendix.C">
<a href="#rfc.appendix.C">Appendix C.</a> <a href="#Notices" id="Notices">Notices</a>
</h1>
<p id="rfc.section.C.p.1">Copyright (c) 2020 The OpenID Foundation.</p>
<p id="rfc.section.C.p.2">The OpenID Foundation (OIDF) grants to any Contributor, developer, implementer, or other interested party a non-exclusive, royalty free, worldwide copyright license to reproduce, prepare derivative works from, distribute, perform and display, this Implementers Draft or Final Specification solely for the purposes of (i) developing specifications, and (ii) implementing Implementers Drafts and Final Specifications based on such documents, provided that attribution be made to the OIDF as the source of the material, but that such attribution does not indicate an endorsement by the OIDF.  </p>
<p id="rfc.section.C.p.3">The technology described in this specification was made available from contributions from various sources, including members of the OpenID Foundation and others.  Although the OpenID Foundation has taken steps to help ensure that the technology is available for distribution, it takes no position regarding the validity or scope of any intellectual property or other rights that might be claimed to pertain to the implementation or use of the technology described in this specification or the extent to which any license under such rights might or might not be available; neither does it represent that it has made any independent effort to identify any such rights.  The OpenID Foundation and the contributors to this specification make no (and hereby expressly disclaim any) warranties (express, implied, or otherwise), including implied warranties of merchantability, non-infringement, fitness for a particular purpose, or title, related to this specification, and the entire risk as to implementing this specification is assumed by the implementer.  The OpenID Intellectual Property Rights policy requires contributors to offer a patent promise not to assert certain patent claims against other contributors and against implementers.  The OpenID Foundation invites any interested party to bring to its attention any copyrights, patents, patent applications, or other proprietary rights that may cover technology that may be required to practice this specification.  </p>
<h1 id="rfc.appendix.D">
<a href="#rfc.appendix.D">Appendix D.</a> <a href="#History" id="History">Document History</a>
</h1>
<p id="rfc.section.D.p.1">[[ To be removed from the final specification ]]</p>
<p id="rfc.section.D.p.2">-01 </p>

<ul><li>Initial draft of mobile profile</li></ul>

<p> </p>
<p id="rfc.section.D.p.3">-02 </p>

<ul><li>Tidied up draft, removing todos</li></ul>

<p> </p>
<p id="rfc.section.D.p.4">-03 </p>

<ul>
<li>Updated title, version numbering and authors.</li>
<li>Updated text in the abstract and introduction sections.</li>
<li>Added terminology section.</li>
<li>Updated reference section with CIBA Core and MODRNA spec. and added the references throughout the spec.</li>
<li>Added Overview section and included examples of use cases.</li>
<li>Removed ping mode based on initial version of CIBA.</li>
</ul>

<p> </p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Gonzalo Fernandez Rodriguez</span> 
	  <span class="n hidden">
		<span class="family-name">Fernandez</span>
	  </span>
	</span>
	<span class="org vcardline">Telefonica I+D</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:gonzalo.fernandezrodriguez@telefonica.com">gonzalo.fernandezrodriguez@telefonica.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Florian Walter</span> 
	  <span class="n hidden">
		<span class="family-name">Walter</span>
	  </span>
	</span>
	<span class="org vcardline">Deutsche Telekom AG</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:F.Walter@telekom.de">F.Walter@telekom.de</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Axel Nennker</span> 
	  <span class="n hidden">
		<span class="family-name">Nennker</span>
	  </span>
	</span>
	<span class="org vcardline">Deutsche Telekom AG</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:axel.nennker@telekom.de">axel.nennker@telekom.de</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Dave Tonge</span> 
	  <span class="n hidden">
		<span class="family-name">Tonge</span>
	  </span>
	</span>
	<span class="org vcardline">Moneyhub</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:dave.tonge@moneyhub.com">dave.tonge@moneyhub.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Bjorn Hjelm</span> 
	  <span class="n hidden">
		<span class="family-name">Hjelm</span>
	  </span>
	</span>
	<span class="org vcardline">Verizon</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:bjorn.hjelm@verizon.com">bjorn.hjelm@verizon.com</a></span>

  </address>
</div>

</body>
</html>

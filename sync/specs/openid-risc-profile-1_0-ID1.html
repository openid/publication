<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>OpenID RISC Profile of IETF Security Events 1.0</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents"/>
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction"/>
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Notational Conventions"/>
<link href="#rfc.section.2" rel="Chapter" title="2 Subject Identifiers"/>
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Subject Identifier Types"/>
<link href="#rfc.section.2.1.1" rel="Chapter" title="2.1.1 Email Subject Identifier Type"/>
<link href="#rfc.section.2.1.2" rel="Chapter" title="2.1.2 Phone Number Subject Identifier Type"/>
<link href="#rfc.section.2.1.3" rel="Chapter" title="2.1.3 Issuer and Subject Subject Identifier Type"/>
<link href="#rfc.section.2.1.4" rel="Chapter" title="2.1.4 ID Token Claims Subject Identifier Type"/>
<link href="#rfc.section.3" rel="Chapter" title="3 Transmitter Configuration Discovery"/>
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Transmitter Configuration Metadata"/>
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Obtaining Transmitter Configuration Information"/>
<link href="#rfc.section.3.2.1" rel="Chapter" title="3.2.1 Transmitter Configuration Request"/>
<link href="#rfc.section.3.2.2" rel="Chapter" title="3.2.2 Transmitter Configuration Response"/>
<link href="#rfc.section.3.2.3" rel="Chapter" title="3.2.3 Transmitter Configuration Validation"/>
<link href="#rfc.section.4" rel="Chapter" title="4 Management API for SET Event Streams"/>
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Event Stream Management"/>
<link href="#rfc.section.4.1.1" rel="Chapter" title="4.1.1 Stream Status"/>
<link href="#rfc.section.4.1.1.1" rel="Chapter" title="4.1.1.1 Reading a Stream&#x2019;s Status"/>
<link href="#rfc.section.4.1.1.2" rel="Chapter" title="4.1.1.2 Updating a Stream's Status"/>
<link href="#rfc.section.4.1.2" rel="Chapter" title="4.1.2 Stream Configuration"/>
<link href="#rfc.section.4.1.2.1" rel="Chapter" title="4.1.2.1 Reading a Stream&#x2019;s Configuration"/>
<link href="#rfc.section.4.1.2.2" rel="Chapter" title="4.1.2.2 Updating a Stream&#x2019;s Configuration"/>
<link href="#rfc.section.4.1.2.3" rel="Chapter" title="4.1.2.3 Removing a Stream Configuration"/>
<link href="#rfc.section.4.1.3" rel="Chapter" title="4.1.3 Subjects"/>
<link href="#rfc.section.4.1.3.1" rel="Chapter" title="4.1.3.1 Adding a Subject to a Stream"/>
<link href="#rfc.section.4.1.3.2" rel="Chapter" title="4.1.3.2 Removing a Subject"/>
<link href="#rfc.section.4.1.4" rel="Chapter" title="4.1.4 Verification"/>
<link href="#rfc.section.4.1.4.1" rel="Chapter" title="4.1.4.1 Verification Event"/>
<link href="#rfc.section.4.1.4.2" rel="Chapter" title="4.1.4.2 Triggering a Verification Event."/>
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Authorization"/>
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Security Considerations"/>
<link href="#rfc.section.4.3.1" rel="Chapter" title="4.3.1 Subject Probing"/>
<link href="#rfc.section.4.3.2" rel="Chapter" title="4.3.2 Information Harvesting"/>
<link href="#rfc.section.4.3.3" rel="Chapter" title="4.3.3 Malicious Subject Removal"/>
<link href="#rfc.section.5" rel="Chapter" title="5 Profiles"/>
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Security Event Token Profle"/>
<link href="#rfc.section.5.1.1" rel="Chapter" title="5.1.1 Signature Key Resolution"/>
<link href="#rfc.section.5.1.2" rel="Chapter" title="5.1.2 RISC Event Subject"/>
<link href="#rfc.section.5.1.3" rel="Chapter" title="5.1.3 Explicit Typing of SETs"/>
<link href="#rfc.section.5.1.4" rel="Chapter" title="5.1.4 The &quot;exp&quot; Claim"/>
<link href="#rfc.section.5.1.5" rel="Chapter" title="5.1.5 The &quot;aud&quot; Claim"/>
<link href="#rfc.section.5.1.6" rel="Chapter" title="5.1.6 The &quot;events&quot; claim"/>
<link href="#rfc.section.5.1.7" rel="Chapter" title="5.1.7 Security Considerations"/>
<link href="#rfc.section.5.1.7.1" rel="Chapter" title="5.1.7.1 Distingushing SETs from other Kinds of JWTs"/>
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 SET Token Delivery Using HTTP Profile"/>
<link href="#rfc.section.5.2.1" rel="Chapter" title="5.2.1 Stream Configuration Metadata"/>
<link href="#rfc.section.5.2.1.1" rel="Chapter" title="5.2.1.1 Push Delivery using HTTP"/>
<link href="#rfc.section.5.2.1.2" rel="Chapter" title="5.2.1.2 Polling Delivery using HTTP"/>
<link href="#rfc.section.6" rel="Chapter" title="6 IANA Considerations"/>
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Security Event Subject Identifier Types Registry"/>
<link href="#rfc.section.6.1.1" rel="Chapter" title="6.1.1 Registration Template"/>
<link href="#rfc.section.6.1.2" rel="Chapter" title="6.1.2 Initial Registry Contents"/>
<link href="#rfc.section.6.1.3" rel="Chapter" title="6.1.3 Guidance for Expert Reviewers"/>
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 Well-Known URI Registry"/>
<link href="#rfc.section.6.2.1" rel="Chapter" title="6.2.1 Registry Contents"/>
<link href="#rfc.section.7" rel="Chapter" title="7 Privacy Considerations"/>
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 Subject Information Leakage"/>
<link href="#rfc.references" rel="Chapter" title="8 Normative References"/>
<link href="#rfc.appendix.A" rel="Chapter" title="A Acknowledgements"/>
<link href="#rfc.authors" rel="Chapter"/>


  <meta name="generator" content="xml2rfc version 2.5.1 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Scurtescu, M., Backman, A., and J. Bradley" />
  <meta name="dct.identifier" content="urn:ietf:id:openid-risc-profile-1_0" />
  <meta name="dct.issued" scheme="ISO8601" content="2018-4-24" />
  <meta name="dct.abstract" content="This spec is a general profile for " />
  <meta name="description" content="This spec is a general profile for " />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
  <td class="left"></td>
  <td class="right">M. Scurtescu</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">Google</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">A. Backman</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">Amazon</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">J. Bradley</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">Yubico</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">April 24, 2018</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">OpenID RISC Profile of IETF Security Events 1.0<br />
  <span class="filename">openid-risc-profile-1_0</span></p>
  
  <h1 id="rfc.abstract">
  <a href="#rfc.abstract">Abstract</a>
</h1>
<p>This spec is a general profile for <a href="https://datatracker.ietf.org/wg/secevent/about/">IETF Security Events</a> and it defines:</p>

<ul>
  <li>Subject Identifiers</li>
  <li>a configuration information discovery method for Transmitters</li>
  <li>a Management API for Event Streams</li>
</ul>
<p>This spec also directly profiles several IETF Security Events drafts:</p>

<ul>
  <li><a href="#SET">Security Event Token (SET)</a> <cite title="NONE">[SET]</cite></li>
  <li><a href="#DELIVERYPUSH">Push-Based SET Token Delivery Using HTTP</a> <cite title="NONE">[DELIVERYPUSH]</cite></li>
  <li><a href="#DELIVERYPOLL">Poll-Based SET Token Delivery Using HTTP</a> <cite title="NONE">[DELIVERYPOLL]</cite></li>
</ul>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a></li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Notational Conventions</a></li>
</ul><li>2.   <a href="#rfc.section.2">Subject Identifiers</a></li>
<ul><li>2.1.   <a href="#rfc.section.2.1">Subject Identifier Types</a></li>
<ul><li>2.1.1.   <a href="#rfc.section.2.1.1">Email Subject Identifier Type</a></li>
<li>2.1.2.   <a href="#rfc.section.2.1.2">Phone Number Subject Identifier Type</a></li>
<li>2.1.3.   <a href="#rfc.section.2.1.3">Issuer and Subject Subject Identifier Type</a></li>
<li>2.1.4.   <a href="#rfc.section.2.1.4">ID Token Claims Subject Identifier Type</a></li>
</ul></ul><li>3.   <a href="#rfc.section.3">Transmitter Configuration Discovery</a></li>
<ul><li>3.1.   <a href="#rfc.section.3.1">Transmitter Configuration Metadata</a></li>
<li>3.2.   <a href="#rfc.section.3.2">Obtaining Transmitter Configuration Information</a></li>
<ul><li>3.2.1.   <a href="#rfc.section.3.2.1">Transmitter Configuration Request</a></li>
<li>3.2.2.   <a href="#rfc.section.3.2.2">Transmitter Configuration Response</a></li>
<li>3.2.3.   <a href="#rfc.section.3.2.3">Transmitter Configuration Validation</a></li>
</ul></ul><li>4.   <a href="#rfc.section.4">Management API for SET Event Streams</a></li>
<ul><li>4.1.   <a href="#rfc.section.4.1">Event Stream Management</a></li>
<ul><li>4.1.1.   <a href="#rfc.section.4.1.1">Stream Status</a></li>
<ul><li>4.1.1.1.   <a href="#rfc.section.4.1.1.1">Reading a Stream&#8217;s Status</a></li>
<li>4.1.1.2.   <a href="#rfc.section.4.1.1.2">Updating a Stream's Status</a></li>
</ul><li>4.1.2.   <a href="#rfc.section.4.1.2">Stream Configuration</a></li>
<ul><li>4.1.2.1.   <a href="#rfc.section.4.1.2.1">Reading a Stream&#8217;s Configuration</a></li>
<li>4.1.2.2.   <a href="#rfc.section.4.1.2.2">Updating a Stream&#8217;s Configuration</a></li>
<li>4.1.2.3.   <a href="#rfc.section.4.1.2.3">Removing a Stream Configuration</a></li>
</ul><li>4.1.3.   <a href="#rfc.section.4.1.3">Subjects</a></li>
<ul><li>4.1.3.1.   <a href="#rfc.section.4.1.3.1">Adding a Subject to a Stream</a></li>
<li>4.1.3.2.   <a href="#rfc.section.4.1.3.2">Removing a Subject</a></li>
</ul><li>4.1.4.   <a href="#rfc.section.4.1.4">Verification</a></li>
<ul><li>4.1.4.1.   <a href="#rfc.section.4.1.4.1">Verification Event</a></li>
<li>4.1.4.2.   <a href="#rfc.section.4.1.4.2">Triggering a Verification Event.</a></li>
</ul></ul><li>4.2.   <a href="#rfc.section.4.2">Authorization</a></li>
<li>4.3.   <a href="#rfc.section.4.3">Security Considerations</a></li>
<ul><li>4.3.1.   <a href="#rfc.section.4.3.1">Subject Probing</a></li>
<li>4.3.2.   <a href="#rfc.section.4.3.2">Information Harvesting</a></li>
<li>4.3.3.   <a href="#rfc.section.4.3.3">Malicious Subject Removal</a></li>
</ul></ul><li>5.   <a href="#rfc.section.5">Profiles</a></li>
<ul><li>5.1.   <a href="#rfc.section.5.1">Security Event Token Profle</a></li>
<ul><li>5.1.1.   <a href="#rfc.section.5.1.1">Signature Key Resolution</a></li>
<li>5.1.2.   <a href="#rfc.section.5.1.2">RISC Event Subject</a></li>
<li>5.1.3.   <a href="#rfc.section.5.1.3">Explicit Typing of SETs</a></li>
<li>5.1.4.   <a href="#rfc.section.5.1.4">The "exp" Claim</a></li>
<li>5.1.5.   <a href="#rfc.section.5.1.5">The "aud" Claim</a></li>
<li>5.1.6.   <a href="#rfc.section.5.1.6">The "events" claim</a></li>
<li>5.1.7.   <a href="#rfc.section.5.1.7">Security Considerations</a></li>
<ul><li>5.1.7.1.   <a href="#rfc.section.5.1.7.1">Distingushing SETs from other Kinds of JWTs</a></li>
</ul></ul><li>5.2.   <a href="#rfc.section.5.2">SET Token Delivery Using HTTP Profile</a></li>
<ul><li>5.2.1.   <a href="#rfc.section.5.2.1">Stream Configuration Metadata</a></li>
<ul><li>5.2.1.1.   <a href="#rfc.section.5.2.1.1">Push Delivery using HTTP</a></li>
<li>5.2.1.2.   <a href="#rfc.section.5.2.1.2">Polling Delivery using HTTP</a></li>
</ul></ul></ul><li>6.   <a href="#rfc.section.6">IANA Considerations</a></li>
<ul><li>6.1.   <a href="#rfc.section.6.1">Security Event Subject Identifier Types Registry</a></li>
<ul><li>6.1.1.   <a href="#rfc.section.6.1.1">Registration Template</a></li>
<li>6.1.2.   <a href="#rfc.section.6.1.2">Initial Registry Contents</a></li>
<li>6.1.3.   <a href="#rfc.section.6.1.3">Guidance for Expert Reviewers</a></li>
</ul><li>6.2.   <a href="#rfc.section.6.2">Well-Known URI Registry</a></li>
<ul><li>6.2.1.   <a href="#rfc.section.6.2.1">Registry Contents</a></li>
</ul></ul><li>7.   <a href="#rfc.section.7">Privacy Considerations</a></li>
<ul><li>7.1.   <a href="#rfc.section.7.1">Subject Information Leakage</a></li>
</ul><li>8.   <a href="#rfc.references">Normative References</a></li>
<li>Appendix A.   <a href="#rfc.appendix.A">Acknowledgements</a></li>
<li><a href="#rfc.authors">Authors' Addresses</a></li>


  </ul>

  <h1 id="rfc.section.1"><a href="#rfc.section.1">1.</a> <a href="#intro" id="intro">Introduction</a></h1>
<h1 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1.</a> <a href="#conv" id="conv">Notational Conventions</a></h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <a href="#RFC2119">[RFC2119]</a> <a href="#RFC8174">[RFC8174]</a> when, and only when, they appear in all capitals, as shown here.</p>
<h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a> <a href="#subject-ids" id="subject-ids">Subject Identifiers</a></h1>
<p id="rfc.section.2.p.1">The RISC profile defines a structure called a Subject Identifier: a <a href="#RFC7159">JSON</a> <cite title="NONE">[RFC7159]</cite> object containing a set of claims that collectively uniquely identify a subject, according to a simple schema called a Subject Identifier Type. Every Subject Identifier MUST contain a <samp>subject_type</samp> claim, whose value MUST be a name that uniquely identifies the Subject Identifier Type of the Subject Identifier. Any remaining claims within the Subject Identifier MUST be interpreted according to the definition of the Subject Identifier Type. A Subject Identifier MUST conform to the Subject Identifier Type identified by its <samp>subject_type</samp> claim, and MUST NOT contain any claims not defined by its Subject Identifier Type.</p>
<div id="rfc.figure.1"/>
<div id="subject-ids-ex-email"/>
<pre>
{
  "iss": "https://idp.example.com/",
  "jti": "756E69717565206964656E746966696572",
  "iat": 1520364019,
  "aud": "636C69656E745F6964",
  "events": {
    "https://schemas.openid.net/secevent/risc/event-type/account-\
enabled": {
      "subject": {
        "subject_type": "email",
        "email": "foo@example.com"
      }
    }
  }
}
        </pre>
<p>A Subject Identifier that identifies a subject by email address.</p>
<p class="figure">Figure 1: Example: SET Containing a RISC Event with an Email Subject Identifier</p>
<div id="rfc.figure.2"/>
<div id="subject-ids-ex-iss_sub"/>
<pre>
{
  "iss": "https://idp.example.com/",
  "jti": "756E69717565206964656E746966696572",
  "iat": 1520364019,
  "aud": "636C69656E745F6964",
  "events": {
    "https://schemas.openid.net/secevent/risc/event-type/account-\
enabled": {
      "subject": {
        "subject_type": "iss_sub",
        "iss": "https://issuer.example.com/",
        "sub": "abc1234"
      }
    }
  }
}
        </pre>
<p>A Subject Identifier that identifies a subject by an identifier provided by an issuer.</p>
<p class="figure">Figure 2: Example: SET Containing a RISC Event with an Issuer and Subject Subject Identifier</p>
<h1 id="rfc.section.2.1"><a href="#rfc.section.2.1">2.1.</a> <a href="#sub-id-types" id="sub-id-types">Subject Identifier Types</a></h1>
<p id="rfc.section.2.1.p.1">A Subject Identifier Type is a light-weight schema that describes a set of claims that uniquely identifies a subject. Every Subject Identifier Type MUST have a unique name registered in the IANA "Security Event Subject Identifier Types" registry established by <a href="#iana-sub-id-types">Section 6.1</a>. A Subject Identifier Type MAY contain more claims than are strictly necessary to uniquely identify a subject, however a Subject Identifier MUST contain all of the claims required by its type (See <a href="#privacy">Privacy Considerations</a>).</p>
<p id="rfc.section.2.1.p.2">The following Subject Identifier Types are registered in the IANA "Security Event Subject Identifier Types" registry established by <a href="#iana-sub-id-types">Section 6.1</a>.</p>
<h1 id="rfc.section.2.1.1"><a href="#rfc.section.2.1.1">2.1.1.</a> <a href="#sub-id-email" id="sub-id-email">Email Subject Identifier Type</a></h1>
<p id="rfc.section.2.1.1.p.1">The Email Subject Identifier Type describes a subject by email address. Subject Identifiers of this type MUST contain an <samp>email</samp> claim whose value is a string containing the email address of the subject. The <samp>email</samp> claim MUST NOT be null or empty. The Email Subject Identifier Type is identified by the name <samp>email</samp>.</p>
<h1 id="rfc.section.2.1.2"><a href="#rfc.section.2.1.2">2.1.2.</a> <a href="#sub-id-phone" id="sub-id-phone">Phone Number Subject Identifier Type</a></h1>
<p id="rfc.section.2.1.2.p.1">The Phone Number Subject Identifier Type describes a subject by telephone number.  Subject Identifiers of this type MUST contain a <samp>phone</samp> claim whose value is a string containing the full telephone number of the subject, including international dialing prefix, formatted according to <a href="#E164">E.164</a> <cite title="NONE">[E164]</cite>. The <samp>phone</samp> claim MUST NOT be null or empty. The Phone Number Subject Identifier Type is identified by the name <samp>phone</samp>.</p>
<h1 id="rfc.section.2.1.3"><a href="#rfc.section.2.1.3">2.1.3.</a> <a href="#sub-id-iss_sub" id="sub-id-iss_sub">Issuer and Subject Subject Identifier Type</a></h1>
<p id="rfc.section.2.1.3.p.1">The Issuer and Subject Subject Identifier Type describes a subject by an issuer and a subject. Subject Identifiers of this type MUST contain an <samp>iss</samp> claim whose value identifies the issuer, and a <samp>sub</samp> claim whose value identifies the subject with respect to the issuer. These claims MUST follow the formats of the <samp>iss</samp> claim and <samp>sub</samp> claim defined by <a href="#RFC7519">[RFC7519]</a>, respectively. Both the <samp>iss</samp> claim and the <samp>sub</samp> claim MUST NOT be null or empty. The Issuer and Subject Subject Identifier Type is identified by the name <samp>iss_sub</samp>.</p>
<h1 id="rfc.section.2.1.4"><a href="#rfc.section.2.1.4">2.1.4.</a> <a href="#sub-id-id_token_claims" id="sub-id-id_token_claims">ID Token Claims Subject Identifier Type</a></h1>
<p id="rfc.section.2.1.4.p.1">The ID Token Claims Subject Identifier Type describes a subject by a subset of the claims from an ID token. Subject Identifiers of this type MUST contain at least one of the following claims:</p>

<dl>
  <dt>email</dt>
  <dd style="margin-left: 8"><br/>An <samp>email</samp> claim, as defined in <a href="#IDTOKEN">[IDTOKEN]</a>.</dd>
  <dt>phone_number</dt>
  <dd style="margin-left: 8"><br/>An <samp>phone_number</samp> claim, as defined in <a href="#IDTOKEN">[IDTOKEN]</a>.</dd>
  <dt>sub</dt>
  <dd style="margin-left: 8"><br/>A <samp>sub</samp> claim, as defined in <a href="#RFC7519">[RFC7519]</a>.</dd>
</dl>
<p id="rfc.section.2.1.4.p.2">If the Subject Identifier contains a <samp>sub</samp> claim, it MUST also contain an <samp>iss</samp> claim, as defined in <a href="#RFC7519">[RFC7519]</a>.  The ID Token Claims Subject Identifier Type is identified by the name <samp>id_token_claims</samp>.</p>
<h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a> <a href="#discovery" id="discovery">Transmitter Configuration Discovery</a></h1>
<p id="rfc.section.3.p.1">This section defines a mechanism for Receivers to obtain Transmitter configuration information.</p>
<h1 id="rfc.section.3.1"><a href="#rfc.section.3.1">3.1.</a> <a href="#discovery-meta" id="discovery-meta">Transmitter Configuration Metadata</a></h1>
<p id="rfc.section.3.1.p.1">Transmitters have metadata describing their configuration:</p>

<dl>
  <dt>issuer</dt>
  <dd style="margin-left: 8">REQUIRED. URL using the https scheme with no query or fragment component that the Transmitter asserts as its Issuer Identifier. This MUST be identical to the iss Claim value in Security Event Tokens issued from this Transmitter.</dd>
  <dt>jwks_uri</dt>
  <dd style="margin-left: 8">REQUIRED. URL of the Transmitter's <a href="#RFC7517">JSON Web Key Set</a> <cite title="NONE">[RFC7517]</cite> document. This contains the signing key(s) the Receiver uses to validate signatures from the Transmitter.</dd>
  <dt>delivery_methods_supported</dt>
  <dd style="margin-left: 8">RECOMMENDED. List of supported delivery method URIs.</dd>
  <dt>configuration_endpoint</dt>
  <dd style="margin-left: 8">OPTIONAL. The URL of the Configuration Endpoint.</dd>
  <dt>status_endpoint</dt>
  <dd style="margin-left: 8">OPTIONAL. The URL of the Status Endpoint.</dd>
  <dt>add_subject_endpoint</dt>
  <dd style="margin-left: 8">OPTIONAL. The URL of the Add Subject Endpoint.</dd>
  <dt>remove_subject_endpoint</dt>
  <dd style="margin-left: 8">OPTIONAL. The URL of the Remove Subject Endpoint.</dd>
  <dt>verification_endpoint</dt>
  <dd style="margin-left: 8">OPTIONAL. The URL of the Verification Endpoint.</dd>
</dl>
<p id="rfc.section.3.1.p.2">TODO: consider adding a IANA Registry for metadata, similar to Section 7.1.1 of <a href="#OAUTH-DISCOVERY">[OAUTH-DISCOVERY]</a>.  This would allow other specs to add to the metadata.</p>
<h1 id="rfc.section.3.2"><a href="#rfc.section.3.2">3.2.</a> Obtaining Transmitter Configuration Information</h1>
<p id="rfc.section.3.2.p.1">Using the Issuer as documented by the Transmitter, the Transmitter Configuration Information can be retrieved.</p>
<p id="rfc.section.3.2.p.2">Transmitters supporting Discovery MUST make a JSON document available at the path formed by inserting the string <samp>/.well-known/risc-configuration</samp> into the Issuer between the host component and the path component, if any. The syntax and semantics of <samp>.well-known</samp> are defined in <a href="#RFC5785">[RFC5785]</a>.  <samp>risc-configuration</samp> MUST point to a JSON document compliant with this specification and MUST be returned using the <samp>application/json</samp> content type.</p>
<h1 id="rfc.section.3.2.1"><a href="#rfc.section.3.2.1">3.2.1.</a> Transmitter Configuration Request</h1>
<p id="rfc.section.3.2.1.p.1">A Transmitter Configuration Document MUST be queried using an HTTP <samp>GET</samp> request at the previously specified path.</p>
<div id="rfc.figure.3"/>
<div id="figdiscoveryrequest"/>
<pre>
GET /.well-known/risc-configuration HTTP/1.1
Host: tr.example.com
</pre>
<p class="figure">Figure 3: Example: Transmitter Configuration Request (without path)</p>
<p id="rfc.section.3.2.1.p.2">The Receiver would make the following request to the Issuer <samp>https://tr.example.com</samp> to obtain its Configuration information, since the Issuer contains no path component: </p>
<div id="rfc.figure.4"/>
<div id="figdiscoveryrequestpath"/>
<pre>
GET /.well-known/risc-configuration/issuer1 HTTP/1.1
Host: tr.example.com
</pre>
<p class="figure">Figure 4: Example: Transmitter Configuration Request (with path)</p>
<p id="rfc.section.3.2.1.p.3">If the  Issuer value contains a path component, any terminating <samp>/</samp> MUST be removed before inserting <samp>/.well-known/risc-configuration</samp> between the host component and the path component. The Receiver would make the following request to the Issuer <samp>https://tr.example.com/issuer1</samp> to obtain its Configuration information, since the Issuer contains a path component: </p>
<p id="rfc.section.3.2.1.p.4">Using path components enables supporting multiple issuers per host. This is required in some multi-tenant hosting configurations. This use of <samp>.well-known</samp> is for supporting multiple issuers per host; unlike its use in <a href="#RFC5785">[RFC5785]</a>, it does not provide general information about the host.  </p>
<h1 id="rfc.section.3.2.2"><a href="#rfc.section.3.2.2">3.2.2.</a> Transmitter Configuration Response</h1>
<p id="rfc.section.3.2.2.p.1">The response is a set of Claims about the Transmitter's configuration, including all necessary endpoints and public key location information. A successful response MUST use the 200 OK HTTP status code and return a JSON object using the <samp>application/json</samp> content type that contains a set of Claims as its members that are a subset of the Metadata values defined in <a href="#discovery-meta">Section 3.1</a>.  Other Claims MAY also be returned.</p>
<p id="rfc.section.3.2.2.p.2">Claims that return multiple values are represented as JSON arrays. Claims with zero elements MUST be omitted from the response.</p>
<p id="rfc.section.3.2.2.p.3">An error response uses the applicable HTTP status code value.</p>
<div id="rfc.figure.5"/>
<div id="figdiscoveryresponse"/>
<pre>
HTTP/1.1 200 OK
Content-Type: application/json

{
  "issuer":
    "https://tr.example.com",
  "jwks_uri":
    "https://tr.example.com/jwks.json",
  "delivery_methods_supported": [
    "https://schemas.openid.net/secevent/risc/delivery-method/push", 
    "https://schemas.openid.net/secevent/risc/delivery-method/poll"],
  "configuration_endpoint":
    "https://tr.example.com/risc/mgmt/stream",
  "status_endpoint":
    "https://tr.example.com/risc/mgmt/status",
  "add_subject_endpoint":
    "https://tr.example.com/risc/mgmt/subject:add",
  "remove_subject_endpoint":
    "https://tr.example.com/risc/mgmt/subject:remove",
  "verification_endpoint":
    "https://tr.example.com/risc/mgmt/verification"
}
</pre>
<p class="figure">Figure 5: Example: Transmitter Configuration Response</p>
<p/>
<h1 id="rfc.section.3.2.3"><a href="#rfc.section.3.2.3">3.2.3.</a> Transmitter Configuration Validation</h1>
<p id="rfc.section.3.2.3.p.1">If any of the validation procedures defined in this specification fail, any operations requiring the information that failed to correctly validate MUST be aborted and the information that failed to validate MUST NOT be used.</p>
<p id="rfc.section.3.2.3.p.2">The <samp>issuer</samp> value returned MUST be identical to the Issuer URL that was directly used to retrieve the configuration information. This MUST also be identical to the <samp>iss</samp> Claim value in Security Event Tokens issued from this Transmitter.  </p>
<h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a> <a href="#management" id="management">Management API for SET Event Streams</a></h1>
<p id="rfc.section.4.p.1">This section defines an HTTP API to be implemented by Event Transmitters and that can be used by Event Receivers to query and update the Event Stream configuration and status, to add and remove subjects and to trigger verification.</p>
<p id="rfc.section.4.p.2">This section is based on <a href="#MGMTAPI">Management API for SET Event Streams</a> <cite title="NONE">[MGMTAPI]</cite>.</p>
<div id="rfc.figure.6"/>
<div id="figintro"/>
<pre>
+------------+                +------------+
|            | Stream Config  |            |
| Event      &lt;----------------+ Event      |
| Stream     |                | Receiver   |
| Management | Stream Status  |            |
| API        &lt;----------------+            |
|            |                |            |
|            | Add Subject    |            |
|            &lt;----------------+            |
|            |                |            |
|            | Remove Subject |            |
|            &lt;----------------+            |
|            |                |            |
|            | Verification   |            |
|            &lt;----------------+            |
|            |                |            |
+------------+                +------------+
</pre>
<p class="figure">Figure 6: Event Stream Management API</p>
<p id="rfc.section.4.p.3">It is OPTIONAL for Transmitters to implement a Management API, but it is RECOMMENDED that they implement it, especially the endpoints for querying the Stream Status and for triggering Verification.</p>
<h1 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1.</a> <a href="#management-api" id="management-api">Event Stream Management</a></h1>
<p id="rfc.section.4.1.p.1">Event Receivers manage how they receive events, and the subjects about which they want to receive events over an Event Stream by making HTTP requests to endpoints in the Event Stream Management API.</p>
<p id="rfc.section.4.1.p.2">The Event Stream Management API is implemented by the Event Transmitter and consists of the following endpoints:</p>
<p/>

<dl>
  <dt>Configuration Endpoint</dt>
  <dd style="margin-left: 8"><br/> An endpoint used to read the Event Stream&#8217;s current configuration.</dd>
  <dt>Status Endpoint</dt>
  <dd style="margin-left: 8"><br/> An endpoint used to read the Event Stream&#8217;s current status.</dd>
  <dt>Add Subject Endpoint</dt>
  <dd style="margin-left: 8"><br/> An endpoint used to add subjects to an Event Stream.</dd>
  <dt>Remove Subject Endpoint</dt>
  <dd style="margin-left: 8"><br/> An endpoint used to remove subjects from an Event Stream.</dd>
  <dt>Verification Endpoint</dt>
  <dd style="margin-left: 8"><br/> An endpoint used to request the Event Transmitter transmit a Verification Event over the Event Stream.</dd>
</dl>
<p id="rfc.section.4.1.p.4">An Event Transmitter MAY use the same URLs as endpoints for multiple streams, provided that the Event Transmitter has some mechanism through which they can identify the applicable Event Stream for any given request, e.g. from authentication credentials. The definition of such mechanisms is outside the scope of this specification.</p>
<h1 id="rfc.section.4.1.1"><a href="#rfc.section.4.1.1">4.1.1.</a> <a href="#status" id="status">Stream Status</a></h1>
<h1 id="rfc.section.4.1.1.1"><a href="#rfc.section.4.1.1.1">4.1.1.1.</a> <a href="#reading-a-streams-status" id="reading-a-streams-status">Reading a Stream&#8217;s Status</a></h1>
<p id="rfc.section.4.1.1.1.p.1">An Event Receiver checks the current status of an event stream by making an HTTP GET request to the stream&#8217;s Status Endpoint. On receiving a valid request the Event Transmitter responds with a 200 OK response containing a <a href="#RFC7159">JSON</a> <cite title="NONE">[RFC7159]</cite> object with a single attribute <samp>status</samp>, whose string value MUST have one of the following values:</p>

<dl>
  <dt>enabled</dt>
  <dd style="margin-left: 8"><br/> The transmitter will transmit events over the stream, according to the stream&#8217;s configured delivery method.</dd>
  <dt>paused</dt>
  <dd style="margin-left: 8"><br/> The transmitter will not transmit events over the stream. The transmitter will hold any events it would have transmitted while paused, and will transmit them when the stream&#8217;s status becomes <samp>enabled</samp>.</dd>
  <dt>disabled</dt>
  <dd style="margin-left: 8"><br/> The transmitter will not transmit events over the stream, and will not hold any events for later transmission.</dd>
</dl>
<p id="rfc.section.4.1.1.1.p.2">The following is a non-normative example request to check an event stream&#8217;s status:</p>
<div id="rfc.figure.7"/>
<div id="figstatusreq"/>
<pre>
GET /set/status HTTP/1.1
Host: transmitter.example.com
Authorization: Bearer eyJ0b2tlbiI6ImV4YW1wbGUifQo=
</pre>
<p class="figure">Figure 7: Example: Check Stream Status Request</p>
<p id="rfc.section.4.1.1.1.p.3">The following is a non-normative example response:</p>
<div id="rfc.figure.8"/>
<div id="figstatusresp"/>
<pre>
HTTP/1.1 200 OK
Content-Type: application/json; charset=UTF-8
Cache-Control: no-store
Pragma: no-cache

{
  "status": "enabled"
}
</pre>
<p class="figure">Figure 8: Example: Check Stream Status Response</p>
<p id="rfc.section.4.1.1.1.p.4">Errors are signaled with HTTP status codes as follows:</p>
<div id="rfc.table.1"/>
<div id="tabreadstatus"/>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Read Stream Status Errors</caption>
  <thead>
    <tr>
      <th class="left">Code</th>
      <th class="left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="left">401</td>
      <td class="left">if authorization failed or it is missing</td>
    </tr>
    <tr>
      <td class="left">403</td>
      <td class="left">if the Event Receiver is not allowed to read the stream status</td>
    </tr>
    <tr>
      <td class="left">404</td>
      <td class="left">if there is no Event Stream configured for this Event Receiver</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.section.4.1.1.2"><a href="#rfc.section.4.1.1.2">4.1.1.2.</a> <a href="#updating-a-streams-status" id="updating-a-streams-status">Updating a Stream's Status</a></h1>
<p id="rfc.section.4.1.1.2.p.1">An Event Receiver updates the current status of a stream by making an HTTP POST request to the Status Endpoint. The POST body contains a <a href="#RFC7159">JSON</a> <cite title="NONE">[RFC7159]</cite> representation of the updated status. On receiving a valid request the Event Transmitter responds with a <samp>200 OK</samp> response containing a <a href="#RFC7159">JSON</a> <cite title="NONE">[RFC7159]</cite> representation of the updated stream status in the body.</p>
<p id="rfc.section.4.1.1.2.p.2">The following is a non-normative example request to update an Event Stream&#8217;s status:</p>
<div id="rfc.figure.9"/>
<div id="figupdatestatusreq"/>
<pre>
POST /set/status HTTP/1.1
Host: transmitter.example.com
Authorization: Bearer eyJ0b2tlbiI6ImV4YW1wbGUifQo=

{
  "status": "paused",
}
</pre>
<p class="figure">Figure 9: Example: Update Stream Status Request</p>
<p id="rfc.section.4.1.1.2.p.3">The following is a non-normative example response:</p>
<div id="rfc.figure.10"/>
<div id="figupdatestatusresp"/>
<pre>
HTTP/1.1 200 OK
Content-Type: application/json; charset=UTF-8
Cache-Control: no-store
Pragma: no-cache

{
  "status": "paused"
}
</pre>
<p class="figure">Figure 10: Example: Update Stream Status Response</p>
<p id="rfc.section.4.1.1.2.p.4">Errors are signaled with HTTP status codes as follows:</p>
<div id="rfc.table.2"/>
<div id="tabupdatestatus"/>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Update Stream Status Errors</caption>
  <thead>
    <tr>
      <th class="left">Code</th>
      <th class="left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="left">400</td>
      <td class="left">if the request body cannot be parsed or if the request is otherwise invalid</td>
    </tr>
    <tr>
      <td class="left">401</td>
      <td class="left">if authorization failed or it is missing</td>
    </tr>
    <tr>
      <td class="left">403</td>
      <td class="left">if the Event Receiver is not allowed to update the stream status</td>
    </tr>
    <tr>
      <td class="left">404</td>
      <td class="left">if there is no Event Stream configured for this Event Receiver</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.section.4.1.2"><a href="#rfc.section.4.1.2">4.1.2.</a> <a href="#stream" id="stream">Stream Configuration</a></h1>
<p id="rfc.section.4.1.2.p.1">An Event Stream&#8217;s configuration is represented as a <a href="#RFC7159">JSON</a> <cite title="NONE">[RFC7159]</cite> object with the following properties:</p>
<p/>

<dl>
  <dt>iss</dt>
  <dd style="margin-left: 8"><br/> <strong>Read-Only</strong>, A URL using the https scheme with no query or fragment component that the Transmitter asserts as its Issuer Identifier. This MUST be identical to the <samp>iss</samp> Claim value in Security Event Tokens issued from this Transmitter.</dd>
  <dt>aud</dt>
  <dd style="margin-left: 8"><br/> <strong>Read-Only</strong>, A string or an array of strings containing an audience claim as defined in <a href="#RFC7519">JSON Web Token (JWT)</a> <cite title="NONE">[RFC7519]</cite> that identifies the Event Receiver(s) for the Event Stream. This property cannot be updated. If multiple Receivers are specified then the Transmitter SHOULD know that these Receivers are the same entity.</dd>
  <dt>events_supported</dt>
  <dd style="margin-left: 8"><br/>  <strong>Read-Only</strong>, An array of URIs identifying the set of events supported by the Transmitter for this Receiver. If omitted, Event Transmitters SHOULD make this set available to the Event Receiver via some other means (e.g. publishing it in online documentation).</dd>
  <dt>events_requested</dt>
  <dd style="margin-left: 8"><br/>  <strong>Read-Write</strong>, An array of URIs identifying the set of events that the Receiver requested. A Receiver should request only the events that it understands and it can act on. This is configurabel by the Receuver.</dd>
  <dt>events_delivered</dt>
  <dd style="margin-left: 8"><br/> <strong>Read-Only</strong>, An array of URIs which is the intersection of <samp>events_supported</samp> and <samp>events_requested</samp>. These events MAY be delivered over the Event Stream.</dd>
  <dt>delivery</dt>
  <dd style="margin-left: 8"><br/> <strong>Read-Write</strong>, A JSON object containing a set of name/value pairs specifying configuration parameters for the SET delivery method.  The actual delivery method is identified by the special key <samp>method</samp> with the value being a URI as defined in <a href="#delivery-meta">Section 5.2.1</a>.</dd>
  <dt>min_verification_interval</dt>
  <dd style="margin-left: 8"><br/> <strong>Read-Only</strong>, An integer indicating the minimum amount of time in seconds that must pass in between verification requests. If an Event Receiver submits verification requests more frequently than this, the Event Transmitter MAY respond with a 429 status code. An Event Transmitter SHOULD NOT respond with a 429 status code if an Event Receiver is not exceeding this frequency.</dd>
  <dt>subject_type</dt>
  <dd style="margin-left: 8"><br/> <strong>Read-Write</strong>, The Subject Identifier Type that the Receiver wants for the events.  If not set then the Transmitter might decide to use a type that discloses more information than necessary.</dd>
</dl>
<p id="rfc.section.4.1.2.p.3">TODO: consider adding a IANA Registry for stream configuration metadata, similar to Section 7.1.1 of <a href="#OAUTH-DISCOVERY">[OAUTH-DISCOVERY]</a>. This would allow other specs to add to the stream configuration.</p>
<h1 id="rfc.section.4.1.2.1"><a href="#rfc.section.4.1.2.1">4.1.2.1.</a> <a href="#reading-a-streams-configuration" id="reading-a-streams-configuration">Reading a Stream&#8217;s Configuration</a></h1>
<p id="rfc.section.4.1.2.1.p.1">An Event Receiver gets the current configuration of a stream by making an HTTP GET request to the Configuration Endpoint. On receiving a valid request the Event Transmitter responds with a <samp>200 OK</samp> response containing a <a href="#RFC7159">JSON</a> <cite title="NONE">[RFC7159]</cite> representation of the stream&#8217;s configuration in the body.</p>
<p id="rfc.section.4.1.2.1.p.2">The following is a non-normative example request to read an Event Stream&#8217;s configuration:</p>
<div id="rfc.figure.11"/>
<div id="figreadconfigreq"/>
<pre>
GET /set/stream HTTP/1.1
Host: transmitter.example.com
Authorization: Bearer eyJ0b2tlbiI6ImV4YW1wbGUifQo=
</pre>
<p class="figure">Figure 11: Example: Read Stream Configuration Request</p>
<p id="rfc.section.4.1.2.1.p.3">The following is a non-normative example response:</p>
<div id="rfc.figure.12"/>
<div id="figreadconfigresp"/>
<pre>
HTTP/1.1 200 OK
Content-Type: application/json; charset=UTF-8
Cache-Control: no-store
Pragma: no-cache

{
  "iss": "https://tr.example.com",
  "aud": [
      "http://receiver.example.com/web", 
      "http://receiver.example.com/mobile"
    ],
  "delivery": {
    "delivery_method": 
      "https://schemas.openid.net/secevent/risc/delivery-method/push",
    "url": "https://receiver.example.com/events"
  },
  "events_supported": [
    "urn:example:secevent:events:type_1",
    "urn:example:secevent:events:type_2",
    "urn:example:secevent:events:type_3"
  ],
  "events_requested": [
    "urn:example:secevent:events:type_2",
    "urn:example:secevent:events:type_3",
    "urn:example:secevent:events:type_4"
  ],
  "events_delivered": [
    "urn:example:secevent:events:type_2",
    "urn:example:secevent:events:type_3"
  ]
}
</pre>
<p class="figure">Figure 12: Example: Read Stream Configuration Response</p>
<p id="rfc.section.4.1.2.1.p.4">Errors are signaled with HTTP status codes as follows:</p>
<div id="rfc.table.3"/>
<div id="tabreadconfig"/>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Read Stream Configuration Errors</caption>
  <thead>
    <tr>
      <th class="left">Code</th>
      <th class="left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="left">401</td>
      <td class="left">if authorization failed or it is missing</td>
    </tr>
    <tr>
      <td class="left">403</td>
      <td class="left">if the Event Receiver is not allowed to read the stream configuration</td>
    </tr>
    <tr>
      <td class="left">404</td>
      <td class="left">if there is no Event Stream configured for this Event Receiver</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.section.4.1.2.2"><a href="#rfc.section.4.1.2.2">4.1.2.2.</a> <a href="#updating-a-streams-configuration" id="updating-a-streams-configuration">Updating a Stream&#8217;s Configuration</a></h1>
<p id="rfc.section.4.1.2.2.p.1">An Event Receiver updates the current configuration of a stream by making an HTTP POST request to the Configuration Endpoint. The POST body contains a <a href="#RFC7159">JSON</a> <cite title="NONE">[RFC7159]</cite> representation of the updated configuration. On receiving a valid request the Event Transmitter responds with a <samp>200 OK</samp> response containing a <a href="#RFC7159">JSON</a> <cite title="NONE">[RFC7159]</cite> representation of the updated stream configuration in the body.</p>
<p id="rfc.section.4.1.2.2.p.2">The full set of editable properties must be present in the POST body, not only the ones that are specifically intended to be changed. Missing properties SHOULD be interpreted as requested to be deleted. Event Receivers should read the configuration first, modify the <a href="#RFC7159">JSON</a> <cite title="NONE">[RFC7159]</cite> representation, then make an update request.</p>
<p id="rfc.section.4.1.2.2.p.3">Properties that cannot be updated MAY be present, but they MUST match the expected value.</p>
<p id="rfc.section.4.1.2.2.p.4">The following is a non-normative example request to update an Event Stream&#8217;s configuration:</p>
<div id="rfc.figure.13"/>
<div id="figupdateconfigreq"/>
<pre>
POST /set/stream HTTP/1.1
Host: transmitter.example.com
Authorization: Bearer eyJ0b2tlbiI6ImV4YW1wbGUifQo=

{
  "iss": "https://tr.example.com",
  "aud": [
    "http://receiver.example.com/web", 
    "http://receiver.example.com/mobile"
  ],
  "delivery": {
    "delivery_method":
      "https://schemas.openid.net/secevent/risc/delivery-method/push",
    "url": "https://receiver.example.com/events"
  },
  "events_requested": [
    "urn:example:secevent:events:type_2",
    "urn:example:secevent:events:type_3",
    "urn:example:secevent:events:type_4"
  ]
}
</pre>
<p class="figure">Figure 13: Example: Update Stream Configuration Request</p>
<p id="rfc.section.4.1.2.2.p.5">The following is a non-normative example response:</p>
<div id="rfc.figure.14"/>
<div id="figupdateconfigresp"/>
<pre>
HTTP/1.1 200 OK
Content-Type: application/json; charset=UTF-8
Cache-Control: no-store
Pragma: no-cache

{
  "iss": "https://tr.example.com",
  "aud": [
    "http://receiver.example.com/web", 
    "http://receiver.example.com/mobile"
  ],
  "delivery": {
    "delivery_method": 
      "https://schemas.openid.net/secevent/risc/delivery-method/push",
    "url": "https://receiver.example.com/events"
  },
  "events_supported": [
    "urn:example:secevent:events:type_1",
    "urn:example:secevent:events:type_2",
    "urn:example:secevent:events:type_3"
  ],
  "events_requested": [
    "urn:example:secevent:events:type_2",
    "urn:example:secevent:events:type_3",
    "urn:example:secevent:events:type_4"
  ],
  "events_delivered": [
    "urn:example:secevent:events:type_2",
    "urn:example:secevent:events:type_3"
  ]
}
</pre>
<p class="figure">Figure 14: Example: Update Stream Configuration Response</p>
<p id="rfc.section.4.1.2.2.p.6">Errors are signaled with HTTP status codes as follows:</p>
<div id="rfc.table.4"/>
<div id="tabupdateconfig"/>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Update Stream Configuration Errors</caption>
  <thead>
    <tr>
      <th class="left">Code</th>
      <th class="left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="left">400</td>
      <td class="left">if the request body cannot be parsed or if the request is otherwise invalid</td>
    </tr>
    <tr>
      <td class="left">401</td>
      <td class="left">if authorization failed or it is missing</td>
    </tr>
    <tr>
      <td class="left">403</td>
      <td class="left">if the Event Receiver is not allowed to update the stream configuration</td>
    </tr>
    <tr>
      <td class="left">404</td>
      <td class="left">if there is no Event Stream configured for this Event Receiver</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.section.4.1.2.3"><a href="#rfc.section.4.1.2.3">4.1.2.3.</a> <a href="#removing-a-stream-configuration" id="removing-a-stream-configuration">Removing a Stream Configuration</a></h1>
<p id="rfc.section.4.1.2.3.p.1">An Event Receiver removes the configuration of a stream by making an HTTP DELETE request to the Configuration Endpoint. On receiving a request the Event Transmitter responds with a <samp>200 OK</samp> response if the configuration was successfully removed.</p>
<p id="rfc.section.4.1.2.3.p.2">The following is a non-normative example request to remove an Event Stream&#8217;s configuration:</p>
<div id="rfc.figure.15"/>
<div id="figremoveconfigreq"/>
<pre>
DELETE /set/stream HTTP/1.1
Host: transmitter.example.com
Authorization: Bearer eyJ0b2tlbiI6ImV4YW1wbGUifQo=
</pre>
<p class="figure">Figure 15: Example: Remove Stream Configuration Request</p>
<p id="rfc.section.4.1.2.3.p.3">Errors are signaled with HTTP status codes as follows:</p>
<div id="rfc.table.5"/>
<div id="tabremoveconfig"/>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Update Stream Configuration Errors</caption>
  <thead>
    <tr>
      <th class="left">Code</th>
      <th class="left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="left">401</td>
      <td class="left">if authorization failed or it is missing</td>
    </tr>
    <tr>
      <td class="left">403</td>
      <td class="left">if the Event Receiver is not allowed to update the stream configuration</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.section.4.1.3"><a href="#rfc.section.4.1.3">4.1.3.</a> <a href="#subjects" id="subjects">Subjects</a></h1>
<p id="rfc.section.4.1.3.p.1">An Event Receiver can indicate to an Event Transmitter whether or not the receiver wants to receive events about a particular subject by &#8220;adding&#8221; or &#8220;removing&#8221; that subject to the Event Stream, respectively.</p>
<h1 id="rfc.section.4.1.3.1"><a href="#rfc.section.4.1.3.1">4.1.3.1.</a> <a href="#adding-a-subject-to-a-stream" id="adding-a-subject-to-a-stream">Adding a Subject to a Stream</a></h1>
<p id="rfc.section.4.1.3.1.p.1">To add a subject to an Event Stream, the Event Receiver makes an HTTP POST request to the Add Subject Endpoint, containing in the body a JSON object the following claims:</p>

<dl>
  <dt>subject</dt>
  <dd style="margin-left: 8"><br/>REQUIRED.  A Subject Identifier identifying the subject to be added.</dd>
  <dt>verified</dt>
  <dd style="margin-left: 8"><br/>OPTIONAL.  A boolean value; when true, it indicates that the Event Receiver has verified the Subject Identifier. When false, it indicates that the Event Receiver has not verified the Subject Identifier. If omitted, Event Transmitters SHOULD NOT assume that verification has not occurred.</dd>
</dl>
<p id="rfc.section.4.1.3.1.p.2">On a successful response, the Event Transmitter responds with an empty <samp>200 OK</samp> response.  The Event Transmitter MAY choose to silently ignore the request, for example if the subject has previously indicated to the transmitter that they do not want events to be transmitted to the Event Receiver. In this case, the transmitter MAY return an empty <samp>200 OK</samp> response or an appropriate error code. See <a href="#management-sec">Security Considerations</a> <cite title="NONE">[management-sec]</cite>.</p>
<p id="rfc.section.4.1.3.1.p.3">Errors are signaled with HTTP status codes as follows:</p>
<div id="rfc.table.6"/>
<div id="tabadderr"/>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Add Subject Errors</caption>
  <thead>
    <tr>
      <th class="left">Code</th>
      <th class="left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="left">400</td>
      <td class="left">if the request body cannot be parsed or if the request is otherwise invalid</td>
    </tr>
    <tr>
      <td class="left">401</td>
      <td class="left">if authorization failed or it is missing</td>
    </tr>
    <tr>
      <td class="left">403</td>
      <td class="left">if the Event Receiver is not allowed to add this particular subject, or not allowed to add in general</td>
    </tr>
    <tr>
      <td class="left">404</td>
      <td class="left">if the subject is not recognized by the Event Transmitter, the Event Transmitter may chose to stay silent in this case and respond with <samp>200</samp></td>
    </tr>
    <tr>
      <td class="left">429</td>
      <td class="left">if the Event Receiver is sending too many requests in a gvien amount of time</td>
    </tr>
  </tbody>
</table>
<p id="rfc.section.4.1.3.1.p.4">The following is a non-normative example request to add a subject to a stream, where the subject is identified by an Email Subject Identifier.</p>
<div id="rfc.figure.16"/>
<div id="figaddreq"/>
<pre>
POST /set/subjects:add HTTP/1.1
Host: transmitter.example.com
Authorization: Bearer eyJ0b2tlbiI6ImV4YW1wbGUifQo=

{
  "subject": {
    "subject_type": "email",
    "email": "example.user@example.com"
  },
  "verified": true
}
</pre>
<p class="figure">Figure 16: Example: Add Subject Request</p>
<p id="rfc.section.4.1.3.1.p.5">The following is a non-normative example response to a successful request:</p>
<div id="rfc.figure.17"/>
<div id="figaddresp"/>
<pre>
HTTP/1.1 200 OK
Server: transmitter.example.com
Cache-Control: no-store
Pragma: no-cache
</pre>
<p class="figure">Figure 17: Example: Add Subject Response</p>
<h1 id="rfc.section.4.1.3.2"><a href="#rfc.section.4.1.3.2">4.1.3.2.</a> <a href="#removing-a-subject" id="removing-a-subject">Removing a Subject</a></h1>
<p id="rfc.section.4.1.3.2.p.1">To remove a subject from an Event Stream, the Event Receiver makes an HTTP POST request to the Remove Subject Endpoint, containing in the body a JSON object with the following claims:</p>

<dl>
  <dt>subject</dt>
  <dd style="margin-left: 8"><br/>A Subject Identifier identifying the subject to be removed.  REQUIRED.</dd>
</dl>
<p id="rfc.section.4.1.3.2.p.2">On a successful response, the Event Transmitter responds with a <samp>204 No Content</samp> response.</p>
<p id="rfc.section.4.1.3.2.p.3">Errors are signaled with HTTP status codes as follows:</p>
<div id="rfc.table.7"/>
<div id="tabremoveerr"/>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Remove Subject Errors</caption>
  <thead>
    <tr>
      <th class="left">Code</th>
      <th class="left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="left">400</td>
      <td class="left">if the request body cannot be parsed or if the request is otherwise invalid</td>
    </tr>
    <tr>
      <td class="left">401</td>
      <td class="left">if authorization failed or it is missing</td>
    </tr>
    <tr>
      <td class="left">403</td>
      <td class="left">if the Event Receiver is not allowed to remove this particular subject, or not allowed to remove in general</td>
    </tr>
    <tr>
      <td class="left">404</td>
      <td class="left">if the subject is not recognized by the Event Transmitter, the Event Transmitter may chose to stay silent in this case and respond with <samp>204</samp></td>
    </tr>
    <tr>
      <td class="left">429</td>
      <td class="left">if the Event Receiver is sending too many requests in a gvien amount of time</td>
    </tr>
  </tbody>
</table>
<p id="rfc.section.4.1.3.2.p.4">The following is a non-normative example request where the subject is identified by a Phone Number Subject Identifier:</p>
<div id="rfc.figure.18"/>
<div id="figremovereq"/>
<pre>
POST /set/subjects:remove HTTP/1.1
Host: transmitter.example.com
Authorization: Bearer eyJ0b2tlbiI6ImV4YW1wbGUifQo=

{
  "subject": {
    "subject_type": "phone",
    "phone_number": "+1 206 555 0123"
  }
}
</pre>
<p class="figure">Figure 18: Example: Remove Subject Request</p>
<p id="rfc.section.4.1.3.2.p.5">The following is a non-normative example response to a successful request:</p>
<div id="rfc.figure.19"/>
<div id="figremoveresp"/>
<pre>
HTTP/1.1 204 No Content
Server: transmitter.example.com
Cache-Control: no-store
Pragma: no-cache
</pre>
<p class="figure">Figure 19: Example: Remove Subject Response</p>
<h1 id="rfc.section.4.1.4"><a href="#rfc.section.4.1.4">4.1.4.</a> <a href="#verification" id="verification">Verification</a></h1>
<p id="rfc.section.4.1.4.p.1">In some cases, the frequency of event transmission on an Event Stream will be very low, making it difficult for an Event Receiver to tell the difference between expected behavior and event transmission failure due to a misconfigured stream. Event Receivers can request that a verification event be transmitted over the Event Stream, allowing the receiver to confirm that the stream is configured correctly upon successful receipt of the event. The acknowledgment of a Verification Event also confirms to the Event Transmitter that end-to-end delivery is working, including signature verification and encryption.</p>
<p id="rfc.section.4.1.4.p.2">An Event Transmitter MAY send a Verification Event at any time, even if one was not requested by the Event Receiver.</p>
<h1 id="rfc.section.4.1.4.1"><a href="#rfc.section.4.1.4.1">4.1.4.1.</a> <a href="#verification-event" id="verification-event">Verification Event</a></h1>
<p id="rfc.section.4.1.4.1.p.1">The Verification Event is a standard SET with the following attributes:</p>
<p/>

<dl>
  <dt>event type</dt>
  <dd style="margin-left: 8"><br/> The Event Type URI is: <samp>https://schemas.openid.net/secevent/risc/event-type/verification</samp>.</dd>
  <dt>state</dt>
  <dd style="margin-left: 8"><br/> OPTIONAL An opaque value provided by the Event Receiver when the event is triggered. This is a nested attribute in the event payload.</dd>
</dl>
<p id="rfc.section.4.1.4.1.p.3">Upon receiving a Verification Event, the Event Receiver SHALL parse the SET and validate its claims. In particular, the Event Receiver SHALL confirm that the value for <samp>state</samp> is as expected. If the value of <samp>state</samp> does not match, an error response of <samp>setData</samp> SHOULD be returned (see Section 2.3 of <a href="#DELIVERYPUSH">[DELIVERYPUSH]</a> or <a href="#DELIVERYPOLL">[DELIVERYPOLL]</a>).</p>
<p id="rfc.section.4.1.4.1.p.4">In many cases, Event Transmitters MAY disable or suspend an Event Stream that fails to successfully verify based on the acknowledgement or lack of acknowledgement by the Event Receiver.</p>
<h1 id="rfc.section.4.1.4.2"><a href="#rfc.section.4.1.4.2">4.1.4.2.</a> <a href="#triggering-a-verification-event" id="triggering-a-verification-event">Triggering a Verification Event.</a></h1>
<p id="rfc.section.4.1.4.2.p.1">To request that a verification event be sent over an Event Stream, the Event Receiver makes an HTTP POST request to the Verification Endpoint, with a <a href="#RFC7159">JSON</a> <cite title="NONE">[RFC7159]</cite> object containing the parameters of the verification request, if any. On a successful request, the event transmitter responds with an empty <samp>204 No Content</samp> response.</p>
<p id="rfc.section.4.1.4.2.p.2">Verification requests have the following properties:</p>
<p/>

<dl>
  <dt>state</dt>
  <dd style="margin-left: 8"><br/> OPTIONAL. An arbitrary string that the Event Transmitter MUST echo back to the Event Receiver in the verification event&#8217;s payload. Event Receivers MAY use the value of this parameter to correlate a verification event with a verification request. If the verification event is initiated by the transmitter then this parameter MUST not be set.</dd>
</dl>
<p id="rfc.section.4.1.4.2.p.4">A successful response from a POST to the Verification Endpoint does not indicate that the verification event was transmitted successfully, only that the Event Transmitter has transmitted the event or will do so at some point in the future.  Event Transmitters MAY transmit the event via an asynchronous process, and SHOULD publish an SLA for verification event transmission times. Event Receivers MUST NOT depend on the verification event being transmitted synchronously or in any particular order relative to the current queue of events.</p>
<p id="rfc.section.4.1.4.2.p.5">Errors are signaled with HTTP status codes as follows:</p>
<div id="rfc.table.8"/>
<div id="taberifyerr"/>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <caption>Verification Errors</caption>
  <thead>
    <tr>
      <th class="left">Code</th>
      <th class="left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="left">400</td>
      <td class="left">if the request body cannot be parsed or if the request is otherwise invalid</td>
    </tr>
    <tr>
      <td class="left">401</td>
      <td class="left">if authorization failed or it is missing</td>
    </tr>
    <tr>
      <td class="left">429</td>
      <td class="left">if the Event Receiver is sending too many requests in a gvien amount of time; see related <samp>min_verification_interval</samp> in <a href="#stream">Section 4.1.2</a></td>
    </tr>
  </tbody>
</table>
<p id="rfc.section.4.1.4.2.p.6">The following is a non-normative example request to trigger a verification event:</p>
<div id="rfc.figure.20"/>
<div id="figverifyreq"/>
<pre>
POST /set/verify HTTP/1.1
Host: transmitter.example.com
Authorization: Bearer eyJ0b2tlbiI6ImV4YW1wbGUifQo=
Content-Type: application/json; charset=UTF-8

{
  "state": "VGhpcyBpcyBhbiBleGFtcGxlIHN0YXRlIHZhbHVlLgo="
}
</pre>
<p class="figure">Figure 20: Example: Trigger Verification Request</p>
<p id="rfc.section.4.1.4.2.p.7">The following is a non-normative example response to a successful request:</p>
<div id="rfc.figure.21"/>
<div id="figverifyresp"/>
<pre>
HTTP/1.1 204 No Content
Server: transmitter.example.com
Cache-Control: no-store
Pragma: no-cache
</pre>
<p class="figure">Figure 21: Example: Trigger Verification Response</p>
<p id="rfc.section.4.1.4.2.p.8">And the following is a non-normative example of a verification event sent to the Event Receiver as a result of the above request:</p>
<div id="rfc.figure.22"/>
<div id="figverifyset"/>
<pre>
{
  "jti": "123456",
  "iss": "https://transmitter.example.com",
  "aud": "receiver.example.com",
  "iat": "1493856000",
  "events": [
    "https://schemas.openid.net/secevent/risc/event-type/verification":{
      "state": "VGhpcyBpcyBhbiBleGFtcGxlIHN0YXRlIHZhbHVlLgo="
    }
  ]
}
</pre>
<p class="figure">Figure 22: Example: Verification SET</p>
<h1 id="rfc.section.4.2"><a href="#rfc.section.4.2">4.2.</a> <a href="#management-api-auth" id="management-api-auth">Authorization</a></h1>
<p id="rfc.section.4.2.p.1">HTTP API calls from a Receiver to a Transmitter SHOULD be authorized by providing an OAuth 2 Access Token as defined by <a href="#RFC6750">[RFC6750]</a>.</p>
<p id="rfc.section.4.2.p.2">The receiver may obtain an access token using the <a href="#CLIENTCRED">Client Credential Grant</a> <cite title="NONE">[CLIENTCRED]</cite>, or any other method suitable for the Receiver and the Transmitter.</p>
<p id="rfc.section.4.2.p.3">Other authorization methods MAY be used if the Transmitter and the Receiver have agreement on the method.</p>
<h1 id="rfc.section.4.3"><a href="#rfc.section.4.3">4.3.</a> <a href="#management-sec" id="management-sec">Security Considerations</a></h1>
<h1 id="rfc.section.4.3.1"><a href="#rfc.section.4.3.1">4.3.1.</a> <a href="#management-sec-subject-probing" id="management-sec-subject-probing">Subject Probing</a></h1>
<p id="rfc.section.4.3.1.p.1">It may be possible for an Event Transmitter to leak information about subjects through their responses to add subject requests. A <samp>404</samp> response may indicate to the Event Receiver that the subject does not exist, which may inadvertantly reveal information about the subject (e.g. that a particular individual does or does not use the Event Transmitter&#8217;s service).</p>
<p id="rfc.section.4.3.1.p.2">Event Transmitters SHOULD carefully evaluate the conditions under which they will return error responses to add subject requests. Event Transmitters MAY return a <samp>204</samp> response even if they will not actually send any events related to the subject, and Event Receivers MUST NOT assume that a 204 response means that they will receive events related to the subject.</p>
<h1 id="rfc.section.4.3.2"><a href="#rfc.section.4.3.2">4.3.2.</a> <a href="#management-sec-information-harvesting" id="management-sec-information-harvesting">Information Harvesting</a></h1>
<p id="rfc.section.4.3.2.p.1">SETs may contain personally identifiable information (PII) or other non-public information about the event transmitter, the subject (of an event in the SET), or the relationship between the two. It is important for Event Transmitters to understand what information they are revealing to Event Receivers when transmitting events to them, lest the event stream become a vector for unauthorized access to private information.</p>
<p id="rfc.section.4.3.2.p.2">Event Transmitters SHOULD interpret add subject requests as statements of interest in a subject by an Event Receiver, and ARE NOT obligated to transmit events related to every subject an Event Receiver adds to the stream. Event Transmitters MAY choose to transmit some, all, or no events related to any given subject and SHOULD validate that they are permitted to share the information contained within an event with the Event Receiver before transmitting the event. The mechanisms by which such validation is performed are outside the scope of this specification.</p>
<h1 id="rfc.section.4.3.3"><a href="#rfc.section.4.3.3">4.3.3.</a> <a href="#management-sec-malicious-subject-removal" id="management-sec-malicious-subject-removal">Malicious Subject Removal</a></h1>
<p id="rfc.section.4.3.3.p.1">A malicious party may find it advantageous to remove a particular subject from a stream, in order to reduce the Event Receiver&#8217;s ability to detect malicious activity related to the subject, inconvenience the subject, or for other reasons. Consequently it may be in the best interests of the subject for the Event Transmitter to continue to send events related to the subject for some time after the subject has been removed from a stream.</p>
<p id="rfc.section.4.3.3.p.2">Event Transmitters MAY continue sending events related to a subject for some amount of time after that subject has been removed from the stream. Event Receivers MUST tolerate receiving events for subjects that have been removed from the stream, and MUST NOT report these events as errors to the Event Transmitter.</p>
<h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a> <a href="#profiles" id="profiles">Profiles</a></h1>
<p id="rfc.section.5.p.1">This section is a profile of the following IETF SecEvent specifications:</p>

<ul>
  <li><a href="#SET">"Security Event Token (SET)"</a> <cite title="NONE">[SET]</cite></li>
  <li><a href="#DELIVERYPUSH">Push-Based SET Token Delivery Using HTTP</a> <cite title="NONE">[DELIVERYPUSH]</cite></li>
  <li><a href="#DELIVERYPOLL">Poll-Based SET Token Delivery Using HTTP</a> <cite title="NONE">[DELIVERYPOLL]</cite></li>
</ul>
<p id="rfc.section.5.p.2">The RISC use cases that set the requirements are described in <a href="#USECASES">Security Events RISC Use Cases</a> <cite title="NONE">[USECASES]</cite>.</p>
<h1 id="rfc.section.5.1"><a href="#rfc.section.5.1">5.1.</a> <a href="#set-profle" id="set-profle">Security Event Token Profle</a></h1>
<p id="rfc.section.5.1.p.1">This section provides RISC profiling specifications for the <a href="#SET">"Security Event Token (SET)"</a> <cite title="NONE">[SET]</cite> spec.</p>
<h1 id="rfc.section.5.1.1"><a href="#rfc.section.5.1.1">5.1.1.</a> <a href="#signature-key-resolution" id="signature-key-resolution">Signature Key Resolution</a></h1>
<p id="rfc.section.5.1.1.p.1">The signature key can be obtained through <samp>jwks_uri</samp>, see <a href="#discovery">Section 3</a>.</p>
<h1 id="rfc.section.5.1.2"><a href="#rfc.section.5.1.2">5.1.2.</a> <a href="#event-subjects" id="event-subjects">RISC Event Subject</a></h1>
<p id="rfc.section.5.1.2.p.1">The subject of a RISC event is identified by the <samp>subject</samp> claim within the event payload, whose value is a Subject Identifier. The <samp>subject</samp> claim is REQUIRED for all RISC events. The JWT <samp>sub</samp> claim MUST NOT be present in any SET containing a RISC event.</p>
<div id="rfc.figure.23"/>
<div id="risc-event-subject-example"/>
<pre>
{
  "iss": "https://idp.example.com/",
  "jti": "756E69717565206964656E746966696572",
  "iat": 1520364019,
  "aud": "636C69656E745F6964",
  "events": {
    "https://schemas.openid.net/secevent/risc/event-type/account-\
disabled": {
      "subject": {
        "subject_type": "phone",
        "phone_number": "+1 206 555 0123"
      }, 
      "reason": "hijacking",
      "cause-time": 1508012752
    }
  }
}
              </pre>
<p class="figure">Figure 23: Example: SET Containing a RISC Event with a Phone Number Subject</p>
<h1 id="rfc.section.5.1.3"><a href="#rfc.section.5.1.3">5.1.3.</a> <a href="#explicit-typing" id="explicit-typing">Explicit Typing of SETs</a></h1>
<p id="rfc.section.5.1.3.p.1">RISC events MUST use explicit typing as defined in Section 2.3 of <a href="#SET">[SET]</a>.</p>
<div id="rfc.figure.24"/>
<div id="explicit-type-header"/>
<pre>
{
  "typ":"secevent+jwt",
  "alg":"HS256"
}
</pre>
<p class="figure">Figure 24: Explicitly Typed JOSE Header</p>
<p id="rfc.section.5.1.3.p.2">The purpose is defense against confusion with other JWTs, as described in Sections 4.5, 4.6 and 4.7 of <a href="#SET">[SET]</a>. While current <a href="#IDTOKEN">Id Token</a> <cite title="NONE">[IDTOKEN]</cite> validators may not be using the <samp>typ</samp> header parameter, by requiring it for RISC SETs a distinct value is guaranteed for future validators.</p>
<h1 id="rfc.section.5.1.4"><a href="#rfc.section.5.1.4">5.1.4.</a> <a href="#exp-claim" id="exp-claim">The "exp" Claim</a></h1>
<p id="rfc.section.5.1.4.p.1">The <samp>exp</samp> claim MUST NOT be used in RISC SETs.</p>
<p id="rfc.section.5.1.4.p.2">The purpose is defense in depth against confusion with other JWTs, as described in Sections 4.5 and 4.6 of <a href="#SET">[SET]</a>.</p>
<h1 id="rfc.section.5.1.5"><a href="#rfc.section.5.1.5">5.1.5.</a> <a href="#aud-claim" id="aud-claim">The "aud" Claim</a></h1>
<p id="rfc.section.5.1.5.p.1">The <samp>aud</samp> claim can be a single value or an array. Each value SHOULD be the OAuth 2 client id.  Other values that uniquely identifies the Receiver to the Transmitter MAY be used, if the two parties have agreement on the format.</p>
<p id="rfc.section.5.1.5.p.2">More than one values can be present if the corresponding Receivers are known to the Transmitter to be the same entity, for example a web client and I mobile client of the same application. All the Receivers in this case MUST use the exact same delivery method.</p>
<p id="rfc.section.5.1.5.p.3">If multiple Receivers have the exact same delivery configuration but the Transmitter does not know if they belong to the same entity then the Transmitter SHOULD issue distinct SETs for each Receiver and deliver them separately. In this case the multiple Receivers might use the same service to process SETs, and this service might reroute SETs to respective Receivers, an <samp>aud</samp> claim with multiple Receivers would lead to unintended data disclosure.</p>
<div id="rfc.figure.25"/>
<div id="figarrayaud"/>
<pre>
{
  "jti": "123456",
  "iss": "https://transmitter.example.com",
  "aud": ["receiver.example.com/web", "receiver.example.com/mobile"],
  "iat": "1493856000",
  "events": [
    "https://schemas.openid.net/secevent/risc/event-type/verification":{
      "state": "VGhpcyBpcyBhbiBleGFtcGxlIHN0YXRlIHZhbHVlLgo="
    }
  ]
}
</pre>
<p class="figure">Figure 25: Example: SET with array 'aud' claim</p>
<h1 id="rfc.section.5.1.6"><a href="#rfc.section.5.1.6">5.1.6.</a> <a href="#events-claim" id="events-claim">The "events" claim</a></h1>
<p id="rfc.section.5.1.6.p.1">The <samp>events</samp> claim SHOULD contain only one event. Multiple event type URIs are permitted only if they are alternative URIs defining the exact same event type.</p>
<h1 id="rfc.section.5.1.7"><a href="#rfc.section.5.1.7">5.1.7.</a> Security Considerations</h1>
<h1 id="rfc.section.5.1.7.1"><a href="#rfc.section.5.1.7.1">5.1.7.1.</a> Distingushing SETs from other Kinds of JWTs</h1>
<p id="rfc.section.5.1.7.1.p.1">Of particular concern is the possibility that SETs are confused for other kinds of JWTs. The Security Considerations sesction of <a href="#SET">[SET]</a> has several sub-sections on this subject. The RISC Profile is asking for further restrioctons:</p>

<ul>
  <li>The <samp>sub</samp> claim MUST NOT be present, as described in <a href="#event-subjects">Section 5.1.2</a>.</li>
  <li>RISC SETs MUST use explicit typing, as described in <a href="#explicit-typing">Section 5.1.3</a>.</li>
  <li>The <samp>exp</samp> claim MUST NOT be present, as described in <a href="#exp-claim">Section 5.1.4</a>.</li>
</ul>
<h1 id="rfc.section.5.2"><a href="#rfc.section.5.2">5.2.</a> <a href="#set-token-delivery-using-http-profile" id="set-token-delivery-using-http-profile">SET Token Delivery Using HTTP Profile</a></h1>
<p id="rfc.section.5.2.p.1">This section provides RISC profiling specifications for the <a href="#DELIVERYPUSH">[DELIVERYPUSH]</a> and <a href="#DELIVERYPOLL">[DELIVERYPOLL]</a> specs.</p>
<h1 id="rfc.section.5.2.1"><a href="#rfc.section.5.2.1">5.2.1.</a> <a href="#delivery-meta" id="delivery-meta">Stream Configuration Metadata</a></h1>
<p id="rfc.section.5.2.1.p.1">Each delivery method is identified by a URI, specified below by the <samp>method</samp> metadata.</p>
<h1 id="rfc.section.5.2.1.1"><a href="#rfc.section.5.2.1.1">5.2.1.1.</a> Push Delivery using HTTP</h1>
<p id="rfc.section.5.2.1.1.p.1">This section provides RISC profiling specifications for the <a href="#DELIVERYPUSH">[DELIVERYPUSH]</a> spec.</p>
<p/>

<dl>
  <dt>method</dt>
  <dd style="margin-left: 8">
    <samp>https://schemas.openid.net/secevent/risc/delivery-method/push</samp>
  </dd>
  <dt>endpoint_url</dt>
  <dd style="margin-left: 8">The URL where events are pushed through HTTP POST.  This is set by the Receiver.</dd>
  <dt>authorization_header</dt>
  <dd style="margin-left: 8">The HTTP Authorization header that the Transmitter MUST set with each event delivery, if the configuration is present. The value is optional and it is set by the Receiver.</dd>
</dl>
<h1 id="rfc.section.5.2.1.2"><a href="#rfc.section.5.2.1.2">5.2.1.2.</a> Polling Delivery using HTTP</h1>
<p id="rfc.section.5.2.1.2.p.1">This section provides RISC profiling specifications for the <a href="#DELIVERYPOLL">[DELIVERYPOLL]</a> spec.</p>
<p/>

<dl>
  <dt>method</dt>
  <dd style="margin-left: 8">
    <samp>https://schemas.openid.net/secevent/risc/delivery-method/poll</samp>
  </dd>
  <dt>endpoint_url</dt>
  <dd style="margin-left: 8">The URL where events can be retrieved from. This is specified by the Transmitter.</dd>
</dl>
<h1 id="rfc.section.6"><a href="#rfc.section.6">6.</a> <a href="#iana" id="iana">IANA Considerations</a></h1>
<h1 id="rfc.section.6.1"><a href="#rfc.section.6.1">6.1.</a> <a href="#iana-sub-id-types" id="iana-sub-id-types">Security Event Subject Identifier Types Registry</a></h1>
<p id="rfc.section.6.1.p.1">This document defines Subject Identifier Types, for which IANA is asked to create and maintain a new registry titled "Security Event Subject Identifier Types". Initial values for the Security Event Subject Identifier Types registry are given in <a href="#iana-sub-id-types-init">Section 6.1.2</a>.  Future assignments are to be made through the Expert Review registration policy <a href="#BCP26">[BCP26]</a> and shall follow the template presented in <a href="#iana-sub-id-types-template">Section 6.1.1</a>.</p>
<h1 id="rfc.section.6.1.1"><a href="#rfc.section.6.1.1">6.1.1.</a> <a href="#iana-sub-id-types-template" id="iana-sub-id-types-template">Registration Template</a></h1>
<p/>

<dl>
  <dt>Type Name:</dt>
  <dd style="margin-left: 8"><br/>The name of the Subject Identifier Type, as described in <a href="#sub-id-types">Section 2.1</a>. The name MUST be an ASCII string consisting only of lower-case characters ("a" - "z"), digits ("0" - "9"), and hyphens ("-"), and SHOULD NOT exceed 20 characters in length.</dd>
  <dt>Type Description:</dt>
  <dd style="margin-left: 8"><br/>A brief description of the Subject Identifier Type.</dd>
  <dt>Change Controller:</dt>
  <dd style="margin-left: 8"><br/>For types defined in documents published by the OpenID Foundation or its working groups, list "OIDF RISC Working Group".  For all other types, list the name of the party responsible for the registration. Contact information such as mailing address, email address, or phone number may also be provided.</dd>
  <dt>Defining Document(s):</dt>
  <dd style="margin-left: 8"><br/>A reference to the document or documents that define the Subject Identifier Type.  The definition MUST specify the name, format, and meaning of each claim that may occur within a Subject Identifier of the defined type, as well as whether each claim is optional or required, or the circumstances under which the claim is optional or required. URIs that can be used to retrieve copies of each document SHOULD be included.</dd>
</dl>
<h1 id="rfc.section.6.1.2"><a href="#rfc.section.6.1.2">6.1.2.</a> <a href="#iana-sub-id-types-init" id="iana-sub-id-types-init">Initial Registry Contents</a></h1>
<p/>

<ul>
  <li>Type Name: <samp>email</samp></li>
  <li>Type Description: Subject identifier based on email address.</li>
  <li>Change Controller: OIDF RISC Working Group</li>
  <li>Defining Document(s): <a href="#sub-id-email">Section 2.1.1</a> of this document.</li>
</ul>
<p/>

<ul>
  <li>Type Name: <samp>id_token_claims</samp></li>
  <li>Type Description: Subject identifier based on OpenID Connect ID Token claims.</li>
  <li>Change Controller: OIDF RISC Working Group</li>
  <li>Defining Document(s): <a href="#sub-id-id_token_claims">Section 2.1.4</a> of this document.</li>
</ul>
<p/>

<ul>
  <li>Type Name: <samp>iss_sub</samp></li>
  <li>Type Description: Subject identifier based on issuer and subject.</li>
  <li>Change Controller: OIDF RISC Working Group</li>
  <li>Defining Document(s): <a href="#sub-id-iss_sub">Section 2.1.3</a> of this document.</li>
</ul>
<p/>

<ul>
  <li>Type Name: <samp>phone</samp></li>
  <li>Type Description: Subject identifier based on phone number.</li>
  <li>Change Controller: OIDF RISC Working Group</li>
  <li>Defining Document(s): <a href="#sub-id-phone">Section 2.1.2</a> of this document.</li>
</ul>
<h1 id="rfc.section.6.1.3"><a href="#rfc.section.6.1.3">6.1.3.</a> <a href="#iana-sub-id-types-expert" id="iana-sub-id-types-expert">Guidance for Expert Reviewers</a></h1>
<p id="rfc.section.6.1.3.p.1">The Expert Reviewer is expected to review the documentation referenced in a registration request to verify its completeness. The Expert Reviewer must base their decision to accept or reject the request on a fair and impartial assessment of the request. If the Expert Reviewer has a conflict of interest, such as being an author of a defining document referenced by the request, they must recuse themselves from the approval process for that request. In the case where a request is rejected, the Expert Reviewer should provide the requesting party with a written statement expressing the reason for rejection, and be prepared to cite any sources of information that went into that decision.</p>
<p id="rfc.section.6.1.3.p.2">Subject Identifier Types need not be generally applicable and may be highly specific to a particular domain; it is expected that types may be registered for niche or industry-specific use cases. The Expert Reviewer should focus on whether the type is thoroughly documented, and whether its registration will promote or harm interoperability.  In most cases, the Expert Reviewer should not approve a request if the registration would contribute to confusion, or amount to a synonym for an existing type.</p>
<h1 id="rfc.section.6.2"><a href="#rfc.section.6.2">6.2.</a> <a href="#iana-well-known" id="iana-well-known">Well-Known URI Registry</a></h1>
<p id="rfc.section.6.2.p.1">TODO: follow steps in Section 5.1 of <a href="#RFC5785">[RFC5785]</a> to send a registration request.</p>
<p id="rfc.section.6.2.p.2">This specification registers the well-known URI defined in <a href="#discovery">Section 3</a> in the IANA Well-Known URI registry defined in <a href="#RFC5785">[RFC5785]</a>.</p>
<h1 id="rfc.section.6.2.1"><a href="#rfc.section.6.2.1">6.2.1.</a> <a href="#iana-well-known-contents" id="iana-well-known-contents">Registry Contents</a></h1>
<p/>

<ul>
  <li>URI suffix: <samp>risc-configuration</samp></li>
  <li>Change controller: OpenID Foundation RISC Working Group - openid-specs-risc@lists.openid.net</li>
  <li>Specification document: <a href="#discovery">Section 3</a> of this document</li>
  <li>Related information: (none)</li>
</ul>
<h1 id="rfc.section.7"><a href="#rfc.section.7">7.</a> <a href="#privacy" id="privacy">Privacy Considerations</a></h1>
<h1 id="rfc.section.7.1"><a href="#rfc.section.7.1">7.1.</a> <a href="#sub-info-leakage" id="sub-info-leakage">Subject Information Leakage</a></h1>
<p id="rfc.section.7.1.p.1">Event issuers and recipients SHOULD take precautions to ensure that they do not leak information about subjects via Subject Identifiers, and choose appropriate Subject Identifier Types accordingly. Parties SHOULD NOT identify a subject using a given Subject Identifier Type if doing so will allow the recipient to correlate different claims about the subject that they are not known to already have knowledge of. Issuers and recipients SHOULD always use the same Subject Identifier Type and the same claim values to identify a given subject when communicating with a given party in order to reduce the possibility of information leakage.</p>
<h1 id="rfc.references"><a href="#rfc.references">8.</a> Normative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="BCP26">[BCP26]</b>
      </td>
      <td class="top"><a title="PTI, an affiliate of ICANN">Cotton, M.</a>, <a title="Huawei Technologies">Leiba, B.</a> and <a title="IBM Corporation">T. Narten</a>, "<a href="http://tools.ietf.org/html/rfc8126">Guidelines for Writing an IANA Considerations Section in RFCs</a>", BCP 26, RFC 8126, DOI 10.17487/RFC8126, June 2017.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="CLIENTCRED">[CLIENTCRED]</b>
      </td>
      <td class="top"><a>Hardt, D.</a>, "<a href="http://tools.ietf.org/html/rfc6749">The OAuth 2.0 Authorization Framework - Client Credentials Grant</a>", RFC 6749, DOI 10.17487/RFC6749, October 2012.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="DELIVERYPOLL">[DELIVERYPOLL]</b>
      </td>
      <td class="top"><a>Backman, A.</a>, <a>Jones, M.</a>, <a>Hunt, P.</a>, <a>Scurtescu, M.</a>, <a>Ansari, M.</a> and <a>A. Nadalin</a>, "<a href="https://tools.ietf.org/html/draft-ietf-secevent-http-poll-00">Poll-Based SET Token Delivery Using HTTP</a>", April 2018.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="DELIVERYPUSH">[DELIVERYPUSH]</b>
      </td>
      <td class="top"><a>Backman, A.</a>, <a>Jones, M.</a>, <a>Hunt, P.</a>, <a>Scurtescu, M.</a>, <a>Ansari, M.</a> and <a>A. Nadalin</a>, "<a href="https://tools.ietf.org/html/draft-ietf-secevent-http-push-00">Push-Based SET Token Delivery Using HTTP</a>", April 2018.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="E164">[E164]</b>
      </td>
      <td class="top"><a>International Telecommunication Union</a>, "<a href="http://www.itu.int/rec/T-REC-E.164-201011-I/en">The international public telecommunication numbering plan</a>", 2010.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="IDTOKEN">[IDTOKEN]</b>
      </td>
      <td class="top"><a>Sakimura, N.</a>, <a>Bradley, J.</a>, <a>Jones, M.</a>, <a>de Medeiros, B.</a> and <a>C. Mortimore</a>, "<a href="http://openid.net/specs/openid-connect-core-1_0.html#IDToken">OpenID Connect Core 1.0 - ID Token</a>", April 2017.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="MGMTAPI">[MGMTAPI]</b>
      </td>
      <td class="top"><a>Scurtescu, M.</a> and <a>A. Backman</a>, "<a href="https://tools.ietf.org/html/draft-scurtescu-secevent-simple-control-plane">Management API for SET Event Streams</a>", June 2017.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="OAUTH-DISCOVERY">[OAUTH-DISCOVERY]</b>
      </td>
      <td class="top"><a title="Microsoft">Jones, M.</a>, <a title="Nomura Research Institute, Ltd.">Sakimura, N.</a> and <a title="Ping Identity">J. Bradley</a>, "<a href="https://tools.ietf.org/html/draft-ietf-oauth-discovery-10">OAuth 2.0 Authorization Server Metadata - Version 10</a>", March 2018.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="OIDC-DISCOVERY">[OIDC-DISCOVERY]</b>
      </td>
      <td class="top"><a title="Nomura Research Institute, Ltd.">Sakimura, N.</a>, <a title="Ping Identity">Bradley, J.</a>, <a title="Microsoft">Jones, M.</a> and <a title="Illumila">E. Jay</a>, "<a href="https://openid.net/specs/openid-connect-discovery-1_0.html">OpenID Connect Discovery 1.0</a>", November 2014.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2119">[RFC2119]</b>
      </td>
      <td class="top"><a>Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5785">[RFC5785]</b>
      </td>
      <td class="top"><a>Nottingham, M.</a> and <a>E. Hammer-Lahav</a>, "<a href="http://tools.ietf.org/html/rfc5785">Defining Well-Known Uniform Resource Identifiers (URIs)</a>", RFC 5785, DOI 10.17487/RFC5785, April 2010.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6750">[RFC6750]</b>
      </td>
      <td class="top"><a>Jones, M.</a> and <a>D. Hardt</a>, "<a href="http://tools.ietf.org/html/rfc6750">The OAuth 2.0 Authorization Framework: Bearer Token Usage</a>", RFC 6750, DOI 10.17487/RFC6750, October 2012.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7159">[RFC7159]</b>
      </td>
      <td class="top"><a>Bray, T.</a>, "<a href="http://tools.ietf.org/html/rfc7159">The JavaScript Object Notation (JSON) Data Interchange Format</a>", RFC 7159, DOI 10.17487/RFC7159, March 2014.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7517">[RFC7517]</b>
      </td>
      <td class="top"><a>Jones, M.</a>, "<a href="http://tools.ietf.org/html/rfc7517">JSON Web Key (JWK)</a>", RFC 7517, DOI 10.17487/RFC7517, May 2015.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7519">[RFC7519]</b>
      </td>
      <td class="top"><a>Jones, M.</a>, <a>Bradley, J.</a> and <a>N. Sakimura</a>, "<a href="http://tools.ietf.org/html/rfc7519">JSON Web Token (JWT)</a>", RFC 7519, DOI 10.17487/RFC7519, May 2015.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC8174">[RFC8174]</b>
      </td>
      <td class="top"><a>Leiba, B.</a>, "<a href="http://tools.ietf.org/html/rfc8174">Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</a>", BCP 14, RFC 8174, DOI 10.17487/RFC8174, May 2017.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="SET">[SET]</b>
      </td>
      <td class="top"><a>Hunt, P.</a>, <a>Jones, M.</a>, <a>Denniss, W.</a> and <a>M. Ansari</a>, "<a href="https://tools.ietf.org/html/draft-ietf-secevent-token-09">Security Event Token (SET)</a>", April 2018.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="USECASES">[USECASES]</b>
      </td>
      <td class="top"><a>Scurtescu, M.</a>, "<a href="https://tools.ietf.org/html/draft-scurtescu-secevent-risc-use-cases-00">Security Events RISC Use Cases</a>", June 2017.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.appendix.A"><a href="#rfc.appendix.A">Appendix A.</a> <a href="#ack" id="ack">Acknowledgements</a></h1>
<p><a href="#discovery">Transmitter Configuration Discovery</a> <cite title="NONE">[discovery]</cite> is based on both <a href="#OIDC-DISCOVERY">OpenID Connect Discovery 1.0</a> <cite title="NONE">[OIDC-DISCOVERY]</cite> and <a href="#OAUTH-DISCOVERY">OAuth 2.0 Authorization Server Metadata</a> <cite title="NONE">[OAUTH-DISCOVERY]</cite>.</p>
<h1 id="rfc.authors">
  <a href="#rfc.authors">Authors' Addresses</a>
</h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Marius Scurtescu</span> 
	  <span class="n hidden">
		<span class="family-name">Scurtescu</span>
	  </span>
	</span>
	<span class="org vcardline">Google</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:mscurtescu@google.com">mscurtescu@google.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Annabelle Backman</span> 
	  <span class="n hidden">
		<span class="family-name">Backman</span>
	  </span>
	</span>
	<span class="org vcardline">Amazon</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:richanna@amazon.com">richanna@amazon.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">John Bradley</span> 
	  <span class="n hidden">
		<span class="family-name">Bradley</span>
	  </span>
	</span>
	<span class="org vcardline">Yubico</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:secevemt@ve7jtb.com">secevemt@ve7jtb.com</a></span>

  </address>
</div>

</body>
</html>

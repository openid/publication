<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>FastFed Enterprise SCIM Profile 1.0 - draft 03</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Requirements Notation and Conventions">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Terminology">
<link href="#rfc.section.2" rel="Chapter" title="2 Overview">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Roles and Responsibilities">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Client Authentication">
<link href="#rfc.section.3" rel="Chapter" title="3 Protocol Extensions">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 FastFed Metadata">
<link href="#rfc.section.3.1.1" rel="Chapter" title="3.1.1 Provisioning Profile URN">
<link href="#rfc.section.3.1.2" rel="Chapter" title="3.1.2 Application Metadata">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 FastFed Handshake">
<link href="#rfc.section.3.2.1" rel="Chapter" title="3.2.1 FastFed Registration Request">
<link href="#rfc.section.3.2.1.1" rel="Chapter" title="3.2.1.1 Usage of the OAuth-2.0 JWT Profile">
<link href="#rfc.section.3.2.2" rel="Chapter" title="3.2.2 FastFed Registration Response">
<link href="#rfc.section.3.2.2.1" rel="Chapter" title="3.2.2.1 Usage of the OAuth-2.0 JWT Profile">
<link href="#rfc.section.4" rel="Chapter" title="4 Interoperability Requirements">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 General Requirements">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 User Provisioning">
<link href="#rfc.section.4.2.1" rel="Chapter" title="4.2.1 Create User">
<link href="#rfc.section.4.2.2" rel="Chapter" title="4.2.2 Update User">
<link href="#rfc.section.4.2.3" rel="Chapter" title="4.2.3 Deactivate or Reactivate User">
<link href="#rfc.section.4.2.4" rel="Chapter" title="4.2.4 Delete User">
<link href="#rfc.section.4.2.5" rel="Chapter" title="4.2.5 Get User By Id">
<link href="#rfc.section.4.2.6" rel="Chapter" title="4.2.6 List Users By Alternate Identifier">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Group Provisioning">
<link href="#rfc.section.4.3.1" rel="Chapter" title="4.3.1 Create Group">
<link href="#rfc.section.4.3.2" rel="Chapter" title="4.3.2 Update Group Metadata">
<link href="#rfc.section.4.3.3" rel="Chapter" title="4.3.3 Deactivate Group">
<link href="#rfc.section.4.3.4" rel="Chapter" title="4.3.4 Delete Group">
<link href="#rfc.section.4.3.5" rel="Chapter" title="4.3.5 Get Group By Id">
<link href="#rfc.section.4.3.6" rel="Chapter" title="4.3.6 List Groups By Alternate Identifier">
<link href="#rfc.section.4.3.7" rel="Chapter" title="4.3.7 Add or Remove Group Members">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 Metadata Endpoints">
<link href="#rfc.section.4.4.1" rel="Chapter" title="4.4.1 ResourceTypes">
<link href="#rfc.section.4.4.2" rel="Chapter" title="4.4.2 ServiceProviderConfig">
<link href="#rfc.section.4.4.3" rel="Chapter" title="4.4.3 Schemas">
<link href="#rfc.section.5" rel="Chapter" title="5 Example Usage of the OAuth 2.0 JWT Profile">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Identity Provider       Shares Public Key">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Application Provider Shares SCIM and OAuth Endpoints">
<link href="#rfc.section.5.3" rel="Chapter" title="5.3 Identity Provider Acquires an OAuth Access Token">
<link href="#rfc.section.5.4" rel="Chapter" title="5.4 Identity Provider Uses the OAuth Access Token">
<link href="#rfc.section.6" rel="Chapter" title="6 Security Considerations">
<link href="#rfc.section.7" rel="Chapter" title="7 IANA Considerations">
<link href="#rfc.references" rel="Chapter" title="8 Normative References">
<link href="#rfc.appendix.A" rel="Chapter" title="A Acknowledgements">
<link href="#rfc.appendix.B" rel="Chapter" title="B Notices">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.47.0 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="McAdams, D." />
  <meta name="dct.identifier" content="urn:ietf:id:fastfed-scim-1_0" />
  <meta name="dct.issued" scheme="ISO8601" content="2020-10-07" />
  <meta name="dct.abstract" content="This specification defines the requirements to implement the FastFed Profile for SCIM 2.0 Enterprise provisioning. This profile supports continual provisioning, update, and deprovisioning of end-users between the Identity Provider and Application Provider.   " />
  <meta name="description" content="This specification defines the requirements to implement the FastFed Profile for SCIM 2.0 Enterprise provisioning. This profile supports continual provisioning, update, and deprovisioning of end-users between the Identity Provider and Application Provider.   " />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left"></td>
<td class="right">D. McAdams</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Amazon</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 7, 2020</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">FastFed Enterprise SCIM Profile 1.0 - draft 03<br />
  <span class="filename">fastfed-scim-1_0</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This specification defines the requirements to implement the FastFed Profile for SCIM 2.0 Enterprise provisioning. This profile supports continual provisioning, update, and deprovisioning of end-users between the Identity Provider and Application Provider.  </p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Requirements Notation and Conventions</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Terminology</a>
</li>
</ul><li>2.   <a href="#rfc.section.2">Overview</a>
</li>
<ul><li>2.1.   <a href="#rfc.section.2.1">Roles and Responsibilities</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Client Authentication</a>
</li>
</ul><li>3.   <a href="#rfc.section.3">Protocol Extensions</a>
</li>
<ul><li>3.1.   <a href="#rfc.section.3.1">FastFed Metadata</a>
</li>
<ul><li>3.1.1.   <a href="#rfc.section.3.1.1">Provisioning Profile URN</a>
</li>
<li>3.1.2.   <a href="#rfc.section.3.1.2">Application Metadata</a>
</li>
</ul><li>3.2.   <a href="#rfc.section.3.2">FastFed Handshake</a>
</li>
<ul><li>3.2.1.   <a href="#rfc.section.3.2.1">FastFed Registration Request</a>
</li>
<ul><li>3.2.1.1.   <a href="#rfc.section.3.2.1.1">Usage of the OAuth-2.0 JWT Profile</a>
</li>
</ul><li>3.2.2.   <a href="#rfc.section.3.2.2">FastFed Registration Response</a>
</li>
<ul><li>3.2.2.1.   <a href="#rfc.section.3.2.2.1">Usage of the OAuth-2.0 JWT Profile</a>
</li>
</ul></ul></ul><li>4.   <a href="#rfc.section.4">Interoperability Requirements</a>
</li>
<ul><li>4.1.   <a href="#rfc.section.4.1">General Requirements</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">User Provisioning</a>
</li>
<ul><li>4.2.1.   <a href="#rfc.section.4.2.1">Create User</a>
</li>
<li>4.2.2.   <a href="#rfc.section.4.2.2">Update User</a>
</li>
<li>4.2.3.   <a href="#rfc.section.4.2.3">Deactivate or Reactivate User</a>
</li>
<li>4.2.4.   <a href="#rfc.section.4.2.4">Delete User</a>
</li>
<li>4.2.5.   <a href="#rfc.section.4.2.5">Get User By Id</a>
</li>
<li>4.2.6.   <a href="#rfc.section.4.2.6">List Users By Alternate Identifier</a>
</li>
</ul><li>4.3.   <a href="#rfc.section.4.3">Group Provisioning</a>
</li>
<ul><li>4.3.1.   <a href="#rfc.section.4.3.1">Create Group</a>
</li>
<li>4.3.2.   <a href="#rfc.section.4.3.2">Update Group Metadata</a>
</li>
<li>4.3.3.   <a href="#rfc.section.4.3.3">Deactivate Group</a>
</li>
<li>4.3.4.   <a href="#rfc.section.4.3.4">Delete Group</a>
</li>
<li>4.3.5.   <a href="#rfc.section.4.3.5">Get Group By Id</a>
</li>
<li>4.3.6.   <a href="#rfc.section.4.3.6">List Groups By Alternate Identifier</a>
</li>
<li>4.3.7.   <a href="#rfc.section.4.3.7">Add or Remove Group Members</a>
</li>
</ul><li>4.4.   <a href="#rfc.section.4.4">Metadata Endpoints</a>
</li>
<ul><li>4.4.1.   <a href="#rfc.section.4.4.1">ResourceTypes</a>
</li>
<li>4.4.2.   <a href="#rfc.section.4.4.2">ServiceProviderConfig</a>
</li>
<li>4.4.3.   <a href="#rfc.section.4.4.3">Schemas</a>
</li>
</ul></ul><li>5.   <a href="#rfc.section.5">Example Usage of the OAuth 2.0 JWT Profile</a>
</li>
<ul><li>5.1.   <a href="#rfc.section.5.1">Identity Provider       Shares Public Key</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">Application Provider Shares SCIM and OAuth Endpoints</a>
</li>
<li>5.3.   <a href="#rfc.section.5.3">Identity Provider Acquires an OAuth Access Token</a>
</li>
<li>5.4.   <a href="#rfc.section.5.4">Identity Provider Uses the OAuth Access Token</a>
</li>
</ul><li>6.   <a href="#rfc.section.6">Security Considerations</a>
</li>
<li>7.   <a href="#rfc.section.7">IANA Considerations</a>
</li>
<li>8.   <a href="#rfc.references">Normative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.A">Acknowledgements</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.B">Notices</a>
</li>
<li><a href="#rfc.authors">Author's Address</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#Introduction" id="Introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">This specification defines the functionality which a provider must implement to satisfy the FastFed Profile for SCIM 2.0 Enterprise provisioning.  </p>
<p id="rfc.section.1.p.2">It consists of the following extensions to the <a href="#FastFed.Core" class="xref">FastFed Core</a> specification: </p>

<ul>
<li>Additional metadata in the FastFed Handshake Flows to exchange SCIM provisioning information and authentication credentials.  </li>
<li>An interoperability profile describing the subset of the SCIM specifications which must be implemented.  </li>
</ul>

<p> </p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#rnc" id="rnc">Requirements Notation and Conventions</a>
</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119" class="xref">RFC 2119</a>.  </p>
<p id="rfc.section.1.1.p.2">In the .txt version of this specification, values are quoted to indicate that they are to be taken literally.  When using these values in protocol messages, the quotes MUST NOT be used as part of the value.  In the HTML version of this specification, values to be taken literally are indicated by the use of <samp>this fixed-width font</samp>.  </p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> <a href="#Terminology" id="Terminology">Terminology</a>
</h1>
<p id="rfc.section.1.2.p.1">This FastFed Profile uses the terminology defined in Section 1.2 of the <a href="#FastFed.Core" class="xref">FastFed Core</a> specification.  </p>
<p id="rfc.section.1.2.p.2">The terms <samp>"SCIM"</samp>, <samp>"SCIM client"</samp>, and <samp>"SCIM service"</samp> refer to the terminology defined in <a href="#RFC7644" class="xref">RFC 7644</a>.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#Overview" id="Overview">Overview</a>
</h1>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> <a href="#RolesAndResponsibilities" id="RolesAndResponsibilities">Roles and Responsibilities</a>
</h1>
<p id="rfc.section.2.1.p.1">In this profile, the Identity Provider plays the role of a SCIM client, pushing user and group information to the Application Provider who hosts the SCIM service.  </p>
<p id="rfc.section.2.1.p.2">The result is to maintain a copy of user and group information in the Application by communicating, via calls the to the SCIM APIs, the creation, update, and deletion of these records.  </p>
<p id="rfc.section.2.1.p.3">To perform these responsibilities, this specification defines the subset of SCIM capabilities that each party must implement to fulfill the FastFed interoperability requirements.  </p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> <a href="#ClientAuthentication" id="ClientAuthentication">Client Authentication</a>
</h1>
<p id="rfc.section.2.2.p.1">SCIM <a href="#RFC7644" class="xref">[RFC7644]</a> does not prescribe a mechanism for client authentication. However, for interoperability purposes, it is necessary for Providers to agree on an authentication method. To fill the gap, this specification prescribes an OAuth 2.0 authentication profile for SCIM services, while also leaving extension points available for alternative authentication methods.  </p>
<p id="rfc.section.2.2.p.2">As described in Section 6 of the <a href="#FastFed.Core" class="xref">FastFed Core</a> specification, the use of asymmetric key pairs is preferred over long-lived shared secrets. As a result, this profile uses <a href="#RFC7523" class="xref">RFC 7523</a> which defines a mechanism to exchange a signed JWT for an OAuth 2.0 access token.  </p>
<p id="rfc.section.2.2.p.3">An end-to-end example of SCIM client authentication via <a href="#RFC7523" class="xref">RFC 7523</a> is provided in <a href="#AuthenticationExample" class="xref">Section 5</a>.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#ProtocolExtensions" id="ProtocolExtensions">Protocol Extensions</a>
</h1>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#FastFedMetadata" id="FastFedMetadata">FastFed Metadata</a>
</h1>
<h1 id="rfc.section.3.1.1">
<a href="#rfc.section.3.1.1">3.1.1.</a> <a href="#FastFedMetadataProvisioningProfile" id="FastFedMetadataProvisioningProfile">Provisioning Profile URN</a>
</h1>
<p id="rfc.section.3.1.1.p.1">This specification extends the <a href="#FastFed.Core" class="xref">FastFed Core</a> metadata (Section 3.3.1) with the following value for <samp>provisioning_profiles</samp>: </p>

<dl>
<dt>urn:ietf:params:fastfed:1.0:provisioning:scim:2.0:enterprise</dt>
<dd style="margin-left: 8">A Provider who includes this URN in their list of capabilities MUST comply with the requirements described in this specification.  </dd>
</dl>

<p> </p>
<p id="rfc.section.3.1.1.p.2">The following is a non-normative example of Provider Metadata showing the usage of the value: </p>
<pre>
 {
   "application_provider": {
     "capabilities": {
       "provisioning_profiles": ["urn:ietf:params:fastfed:1.0:provisioning:scim:2.0:enterprise"],
   ...
 }
</pre>
<h1 id="rfc.section.3.1.2">
<a href="#rfc.section.3.1.2">3.1.2.</a> <a href="#FastFedMetadataApplicationMetadata" id="FastFedMetadataApplicationMetadata">Application Metadata</a>
</h1>
<p id="rfc.section.3.1.2.p.1">This specification extends the Application Provider Metadata defined in Section 3.3.9 of <a href="#FastFed.Core" class="xref">FastFed Core</a> with an additional member having the name: <br><br><samp>"urn:ietf:params:fastfed:1.0:provisioning:scim:2.0:enterprise"</samp>.  </p>
<p id="rfc.section.3.1.2.p.2">The value of the element is a structure containing the following members: </p>

<dl>
<dt>desired_attributes</dt>
<dd style="margin-left: 8">REQUIRED. A structure specifying the attributes to be provisioned, as described in Section 3.3.5 of <a href="#FastFed.Core" class="xref">FastFed Core</a>.  <br><br>When using this profile, the Application Provider MUST include the following SCIM Core User attribute in the list of <samp>required_user_attributes</samp>: <ul>
<li>
<samp>externalId</samp> </li>
<li>
<samp>userName</samp> </li>
<li>
<samp>active</samp> </li>
</ul>
<p> If the Application Provider supports Group provisioning, it MUST: </p>
<ul>
<li>Include the SCIM Core Group attributes <samp>displayName</samp> and <samp>externalId</samp> in the list of <samp>required_group_attributes</samp>.  </li>
<li>Include the SCIM Core Group attribute <samp>members</samp> in the list of <samp>optional_group_attributes</samp>.  <br>As a reference, <samp>members</samp> is optional is because it is acceptable to create an empty group, or to remove all members from an existing group. For example, see <a href="#SCIMInteroperabilityGroupProvisioningDeactivateGroup" class="xref">Section 4.3.3</a>.  </li>
</ul>
<p> If the Application Provider does not support Group provisioning, it MUST omit the following from the desired attributes: </p>
<ul>
<li>
<samp>required_group_attributes</samp> </li>
<li>
<samp>optional_group_attributes</samp> </li>
</ul>
<p> </p>
</dd>
<dt>can_support_nested_groups</dt>
<dd style="margin-left: 8">OPTIONAL. Boolean value indicating whether the Application Provider supports provisioning of nested Group memberships. The default value is <samp>false</samp>. See <a href="#SCIMInteroperabilityGroupProvisioningUpdateGroupMembership" class="xref">Section 4.3.7</a> for details on Group membership provisioning.  </dd>
<dt>max_group_membership_changes</dt>
<dd style="margin-left: 8">OPTIONAL. Number indicating the maximum number of Group membership changes that can be included in a single PATCH request. The minimum value is 100. The maximum value is 1000. The default value is 100. See <a href="#SCIMInteroperabilityGroupProvisioningUpdateGroupMembership" class="xref">Section 4.3.7</a> for details on Group membership provisioning.  </dd>
</dl>

<p> </p>
<p id="rfc.section.3.1.2.p.3">The following is a non-normative example of Application Provider Metadata with the profile extensions: </p>
<pre>
 {
   "application_provider": {
     "entity_id": "https://tenant-67890.app.example.com/"
     "provider_domain": "example.com",
     "provider_contact_information": {
       "organization": "Example Inc.",
       "phone": "+1-800-555-5555",
       "email": "support@example.com"
     },
     "display_settings": {
       "display_name": "Example Application Provider",
       "logo_uri": "https://app.example.com/images/logo.png",
       "icon_uri": "https://app.example.com/images/icon.png",
       "license": "https://openid.net/intellectual-property/licenses/fastfed/1.0/"
     }
     "capabilities": {
       "provisioning_profiles": [
         "urn:ietf:params:fastfed:1.0:provisioning:scim:2.0:enterprise"
       ],
       "schema_grammars": [
         "urn:ietf:params:fastfed:1.0:schemas:scim:2.0"
       ],
       "signing_algorithms": [
         "ES512",
         "RS256"
       ]
     },
     "fastfed_handshake_register_uri": "https://tenant-67890.app.example.com/fastfed/register",

     "urn:ietf:params:fastfed:1.0:provisioning:scim:2.0:enterprise": {
       "can_support_nested_groups": true,
       "max_group_membership_changes": 1000,
       "desired_attributes": {
         "urn:ietf:params:fastfed:1.0:schemas:scim:2.0": {
           "required_user_attributes": [
             "externalId",
             "userName",
             "active"
           ],
           "optional_user_attributes": [
             "displayName",
             "emails[primary eq true]"
           ],
           "required_group_attributes": [
             "displayName",
             "externalId"
           ],
           "optional_group_attributes": [
             "members"
           ]
         }
      }
   }
 }
</pre>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#FastFedHandshake" id="FastFedHandshake">FastFed Handshake</a>
</h1>
<p id="rfc.section.3.2.p.1">When using this SCIM provisioning profile, the FastFed Identity Provider and Application Provider have various responsibilities to comply with the protocol.  </p>
<p id="rfc.section.3.2.p.2">The Identity Provider fulfills the role of a SCIM Client. It has a responsibility to provision user information into the Application Provider as described in <a href="#SCIMInteroperability" class="xref">Section 4</a>.  </p>
<p id="rfc.section.3.2.p.3">The Application Provider fulfills the role of a SCIM Service.  It has a responsibility to host a SCIM Endpoint and handle provisioning messages from the Identity Provider as described in described in <a href="#SCIMInteroperability" class="xref">Section 4</a> </p>
<p id="rfc.section.3.2.p.4">This specification extends the <a href="#FastFed.Core" class="xref">FastFed Core</a> handshake messages with the additional attributes necessary for each party to fulfill their respective obligations under SCIM.  </p>
<h1 id="rfc.section.3.2.1">
<a href="#rfc.section.3.2.1">3.2.1.</a> <a href="#FastFedHandshakeRegistrationRequest" id="FastFedHandshakeRegistrationRequest">FastFed Registration Request</a>
</h1>
<p id="rfc.section.3.2.1.p.1">This specification extends the contents of the FastFed Registration Request (Section 7.2.3.1 of <a href="#FastFed.Core" class="xref">FastFed Core</a>) with an additional member sharing the same name as the profile:<br><br><samp>"urn:ietf:params:fastfed:1.0:provisioning:scim:2.0:enterprise"</samp>.  </p>
<p id="rfc.section.3.2.1.p.2">The value of the element is a structure with the following members: </p>

<dl>
<dt>provider_contact_information</dt>
<dd style="margin-left: 8">REQUIRED. A structure containing the contact information for the provisioning provider, as defined in Section 3.3.3 of <a href="#FastFed.Core" class="xref">FastFed Core</a>.  <br><br>The <samp>provider_contact_information</samp> MAY be the same party who hosted the FastFed Handshake (as defined in the Identity Provider FastFed Metadata). Alternatively, SCIM provisioning may be delegated to a distinct sub-system which authenticates with its own identity and key materials. By specifying protocol-specific <samp>provider_contact_information</samp> for SCIM provisioning, both scenarios are supported.  </dd>
<dt>provider_authentication_methods</dt>
<dd style="margin-left: 8">REQUIRED. A list of supported authentication methods for client authentication to the SCIM service, along with any additional metadata specified by each method. Providers SHOULD support the JWT Profile for OAuth-2.0 (defined in <a href="#FastFedHandshakeRegistrationRequestOAuth" class="xref">Section 3.2.1.1</a>) and MAY support additional methods.  </dd>
</dl>

<p> </p>
<p id="rfc.section.3.2.1.p.3">The following is a non-normative example of the contents of a registration request message: </p>
<pre>
 {
   "iss": "https://tenant-12345.idp.example.com",
   "aud": "https://tenant-67890.app.example.com",
   "exp": 1234567890,
   "provisioning_profiles": [
     "urn:ietf:params:fastfed:1.0:provisioning:scim:2.0:enterprise"
   ],
   "urn:ietf:params:fastfed:1.0:provisioning:scim:2.0:enterprise": {
     "provider_contact_information": {
       "organization": "Example Inc.",
       "phone": "+1-800-555-5555",
       "email": "support@example.com"
     },
     "provider_authentication_methods_supported": [
       {...protocol-specific values...}
     ]
   }
 }
</pre>
<h1 id="rfc.section.3.2.1.1">
<a href="#rfc.section.3.2.1.1">3.2.1.1.</a> <a href="#FastFedHandshakeRegistrationRequestOAuth" id="FastFedHandshakeRegistrationRequestOAuth">Usage of the OAuth-2.0 JWT Profile</a>
</h1>
<p id="rfc.section.3.2.1.1.p.1">Support for this authentication method is indicated by including an additional member in the <samp>provider_authentication_methods</samp> with the name: <br><br><samp>"urn:ietf:params:fastfed:1.0:provider_authentication:oauth:2.0:jwt_profile"</samp> </p>
<p id="rfc.section.3.2.1.1.p.2">The value of the element is a structure with the following members: </p>

<dl>
<dt>jwks_uri</dt>
<dd style="margin-left: 8">REQUIRED. URL of the SCIM client's JSON Web Key Set <a href="#RFC7517" class="xref">[JWK]</a> containing the signing key(s) used by the Provider.  <br><br>If the same entity hosts both the FastFed Handshake and performs SCIM provisioning, then the same <samp>jwks_uri</samp> MAY be used for both purposes. Alternatively, if SCIM provisioning is delegated to a distinct sub-system which authenticates with its own key materials, then a different key set can be used. By specifying a protocol-specific <samp>jwks_uri</samp> for SCIM provisioning, both scenarios are supported.  </dd>
</dl>

<p> </p>
<p id="rfc.section.3.2.1.1.p.3">The following is a non-normative example of the contents of a registration request message containing this authentication method: </p>
<pre>
 {
   "iss": "https://tenant-12345.idp.example.com",
   "aud": "https://tenant-67890.app.example.com",
   "exp": 1234567890,
   "provisioning_profiles": [
     "urn:ietf:params:fastfed:1.0:provisioning:scim:2.0:enterprise"
   ],
   "urn:ietf:params:fastfed:1.0:provisioning:scim:2.0:enterprise": {
     "provider_contact_information": {
       "organization": "Example Inc.",
       "phone": "+1-800-555-5555",
       "email": "support@example.com"
     },
     "provider_authentication_methods_supported": [
       {
         "urn:ietf:params:fastfed:1.0:provider_authentication:oauth:2.0:jwt_profile": {
           "jwks_uri": "https://provisioning.example.com/keys"
         }
       }
     ]
   }
 }
</pre>
<h1 id="rfc.section.3.2.2">
<a href="#rfc.section.3.2.2">3.2.2.</a> <a href="#FastFedHandshakeRegistrationResponse" id="FastFedHandshakeRegistrationResponse">FastFed Registration Response</a>
</h1>
<p id="rfc.section.3.2.2.p.1">This specification extends the contents of the FastFed Registration Response (Section 7.2.3.3 of <a href="#FastFed.Core" class="xref">FastFed Core</a>) with an additional member sharing the same name as the profile:<br><br><samp>"urn:ietf:params:fastfed:1.0:provisioning:scim:2.0:enterprise"</samp> </p>
<p id="rfc.section.3.2.2.p.2">The value of the element is a structure with the following members: </p>

<dl>
<dt>scim_service_uri</dt>
<dd style="margin-left: 8">REQUIRED. Contains the URL of the Application Provider's SCIM Endpoint.  </dd>
<dt>provider_authentication_method</dt>
<dd style="margin-left: 8">REQUIRED. Contains the URN of the chosen authentication method, selected by the Application Provider from amongst the set of compatible methods shared by both the Identity Provider and the Application Provider.  </dd>
</dl>

<p> </p>
<p id="rfc.section.3.2.2.p.3">The following is a non-normative example of the contents of a registration response message: </p>
<pre>
 {
   "urn:ietf:params:fastfed:1.0:provisioning:scim:2.0:enterprise": {
     "scim_service_uri": "https://tenant-56789.app.example.com/scim",
     "provider_authentication_method": ...,
   }
 }
</pre>
<h1 id="rfc.section.3.2.2.1">
<a href="#rfc.section.3.2.2.1">3.2.2.1.</a> <a href="#FastFedHandshakeRegistrationResponseOAuth" id="FastFedHandshakeRegistrationResponseOAuth">Usage of the OAuth-2.0 JWT Profile</a>
</h1>
<p id="rfc.section.3.2.2.1.p.1">The selection of this authentication method is indicated by setting the value of <samp>provider_authentication_method</samp> to be: <br><br><samp>"urn:ietf:params:fastfed:1.0:provider_authentication:oauth:2.0:jwt_profile"</samp> </p>
<p id="rfc.section.3.2.2.1.p.2">In addition, a member with the same name as this URN is included in the response. The value of the element is a structure with the following members: </p>

<dl>
<dt>token_endpoint</dt>
<dd style="margin-left: 8">REQUIRED. Contains the URL of the Application Provider's OAuth 2.0 token endpoint.  </dd>
<dt>scope</dt>
<dd style="margin-left: 8">REQUIRED. Contains the OAuth scope parameter to be provided to the OAuth 2.0 token endpoint when requesting an access token. The OAuth scope MUST authorize the SCIM client to perform all provisioning activities specified by this profile.  </dd>
</dl>

<p> </p>
<p id="rfc.section.3.2.2.1.p.3">The following is a non-normative example of the contents of a registration response message using the OAuth 2.0 JWT Profile: </p>
<pre>
 {
   "urn:ietf:params:fastfed:1.0:provisioning:scim:2.0:enterprise": {
     "scim_service_uri": "https://tenant-56789.app.example.com/scim",
     "provider_authentication_method": "urn:ietf:params:fastfed:1.0:provider_authentication:oauth:2.0:jwt_profile",
     "urn:ietf:params:fastfed:1.0:provider_authentication:oauth:2.0:jwt_profile": {
       "token_endpoint": "https://tenant-56789.app.example.com/oauth",
       "scope": "scim"
     }
   }
 }
</pre>
<p id="rfc.section.3.2.2.1.p.4">See <a href="#AuthenticationExample" class="xref">Section 5</a> for an end-to-end example of authenticating via the OAuth 2.0 JWT profile.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#SCIMInteroperability" id="SCIMInteroperability">Interoperability Requirements</a>
</h1>
<p id="rfc.section.4.p.1">Each identity standard defines a set of optional features to enable usage in a wide variety of circumstances.  </p>
<p id="rfc.section.4.p.2">However, a consequence of the flexibility is that two Providers may find themselves incompatible despite sharing the same protocols.  </p>
<p id="rfc.section.4.p.3">To deliver the simplified experience that is the goal of FastFed, it is important that two FastFed-enabled Providers have confidence that they can interoperate when sharing the same protocols.  </p>
<p id="rfc.section.4.p.4">The following sections describe the subset of the SCIM Protocol specifications that Providers MUST implement to be FastFed Compatible for this profile. Providers MAY support additional functionality, but MUST NOT require the additional functionality when configuring federation with another Provider using the FastFed specifications.  </p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#SCIMInteroperabilityGeneral" id="SCIMInteroperabilityGeneral">General Requirements</a>
</h1>
<p id="rfc.section.4.1.p.1">The Identity Provider MUST: </p>

<ul>
<li>Implement the required functionality of a SCIM Client as defined in <a href="#RFC7643" class="xref">RFC 7643</a> and <a href="#RFC7644" class="xref">RFC 7644</a>.  </li>
<li>Authenticate to the SCIM endpoint using the method negotiated during the FastFed registration exchange.  (<a href="#FastFedHandshakeRegistrationRequest" class="xref">Section 3.2.1</a> and <a href="#FastFedHandshakeRegistrationResponse" class="xref">Section 3.2.2</a>).  </li>
</ul>

<p> </p>
<p id="rfc.section.4.1.p.2">The Application Provider MUST: </p>

<ul>
<li>Implement the required functionality of a SCIM Service Provider as defined in <a href="#RFC7643" class="xref">RFC 7643</a> and <a href="#RFC7644" class="xref">RFC 7644</a>.  </li>
<li>Authenticate the client using the method negotiated during the FastFed registration exchange.  (<a href="#FastFedHandshakeRegistrationRequest" class="xref">Section 3.2.1</a> and <a href="#FastFedHandshakeRegistrationResponse" class="xref">Section 3.2.2</a>).  </li>
</ul>

<p> </p>
<p id="rfc.section.4.1.p.3">The <samp>groups</samp> attribute on the User resource is not used in this FastFed Profile. Any SCIM operation containing a User resource in the contents MUST NOT include the <samp>groups</samp> attribute on the User entity.  </p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#SCIMInteroperabilityUserProvisioning" id="SCIMInteroperabilityUserProvisioning">User Provisioning</a>
</h1>
<p id="rfc.section.4.2.p.1">Application Providers MUST support all the User provisioning operations defined in this section.  </p>
<p id="rfc.section.4.2.p.2">Identity Providers SHOULD replicate User information to the Application Provider within 60 minutes of the User being created or updated, and MAY use any combination of the operations to accomplish the User provisioning.  </p>
<h1 id="rfc.section.4.2.1">
<a href="#rfc.section.4.2.1">4.2.1.</a> <a href="#SCIMInteroperabilityUserProvisioningCreateUser" id="SCIMInteroperabilityUserProvisioningCreateUser">Create User</a>
</h1>
<p id="rfc.section.4.2.1.p.1">User creation is performed via the SCIM operation: <samp>PUT /Users</samp> </p>
<p id="rfc.section.4.2.1.p.2">If multiple values are provided for the User attributes <samp>"emails"</samp>, <samp>"phoneNumbers"</samp>, or <samp>"addresses"</samp>, then the Identity Provider MUST specify one value in the list as <samp>"primary=true"</samp>. If only a single value is provided, the Application Provider MAY treat the single value as the primary if not explicitly labeled as such.  </p>
<p id="rfc.section.4.2.1.p.3">The following is a non-normative example of creating a User: </p>
<pre>
 POST /Users  HTTP/1.1
 Host: example.com
 Accept: application/scim+json
 Content-Type: application/scim+json
 Authorization: Bearer h480djs93hd8
 Content-Length: ...

 {
   "schemas":[
     "urn:ietf:params:scim:schemas:core:2.0:User",
     "urn:ietf:params:scim:schemas:extension:enterprise:2.0:User"
   ],
   "externalId": "98d78581-dd0d-4361-ab61-9511c6e5f035",
   "userName":"bjensen",
   "name":{
     "formatted":"Ms. Barbara J Jensen III",
     "familyName":"Jensen",
     "givenName":"Barbara"
   }
   "urn:ietf:params:scim:schemas:extension:enterprise:2.0:User": {
     "costCenter":"12345",
     "manager":{"value": "0cca76a8-090a-4944-8e61-e7791e619d48"}
   }
 }
</pre>
<h1 id="rfc.section.4.2.2">
<a href="#rfc.section.4.2.2">4.2.2.</a> <a href="#SCIMInteroperabilityUserProvisioningUpdateUser" id="SCIMInteroperabilityUserProvisioningUpdateUser">Update User</a>
</h1>
<p id="rfc.section.4.2.2.p.1">User updates are performed via the SCIM operation: <samp>PATCH /Users/{id}</samp> </p>
<p id="rfc.section.4.2.2.p.2">The following is a non-normative example of updating a User: </p>
<pre>
 PATCH /Users/{id}  HTTP/1.1
 Host: example.com
 Accept: application/scim+json
 Content-Type: application/scim+json
 Authorization: Bearer h480djs93hd8
 Content-Length: ...

 {
   "schemas": ["urn:ietf:params:scim:api:messages:2.0:PatchOp"],
   "Operations": [
     {
       "op": "replace"
       "path": "name.formatted"
       "value": "Babs Jensen"
     },
     {
       "op": "replace"
       "path": "addresses[type eq \"work\"].streetAddress"
       "value": "1010 Broadway Ave"
     },
   ]
 }
</pre>
<h1 id="rfc.section.4.2.3">
<a href="#rfc.section.4.2.3">4.2.3.</a> <a href="#SCIMInteroperabilityUserProvisioningDeactivateUser" id="SCIMInteroperabilityUserProvisioningDeactivateUser">Deactivate or Reactivate User</a>
</h1>
<p id="rfc.section.4.2.3.p.1">Changes to the user activation status are performed via the SCIM operation: <samp>PATCH /Users/{id}</samp> </p>
<p id="rfc.section.4.2.3.p.2">The Identity Provider SHOULD propagate user deactivation events to the Application Provider within 5 minutes of the user being deactivated.  </p>
<p id="rfc.section.4.2.3.p.3">The Application Provider SHOULD respond to user deactivation events by revoking the ability for the user to continue accessing the Application, including the revocation of currently active sessions.  The revocation mechanism is an implementation detail outside the scope of this specification. Revocation SHOULD occur within 5 minutes of receiving the deactivation.  </p>
<p id="rfc.section.4.2.3.p.4">The Application Provider MUST allow reactivation of a deactivated user.  </p>
<p id="rfc.section.4.2.3.p.5">The following is a non-normative example of deactivating a User: </p>
<pre>
 PATCH /Users/{id}  HTTP/1.1
 Host: example.com
 Accept: application/scim+json
 Content-Type: application/scim+json
 Authorization: Bearer h480djs93hd8
 Content-Length: ...

 {
   "schemas": ["urn:ietf:params:scim:api:messages:2.0:PatchOp"],
   "Operations": [{
       "op": "replace"
       "path": "active"
       "value": false
    }]
 }
</pre>
<p id="rfc.section.4.2.3.p.6">The following is a non-normative example of reactivating a User: </p>
<pre>
 PATCH /Users/{id}  HTTP/1.1
 Host: example.com
 Accept: application/scim+json
 Content-Type: application/scim+json
 Authorization: Bearer h480djs93hd8
 Content-Length: ...

 {
   "schemas": ["urn:ietf:params:scim:api:messages:2.0:PatchOp"],
   "Operations": [{
       "op": "replace"
       "path": "active"
       "value": true
    }]
}
</pre>
<h1 id="rfc.section.4.2.4">
<a href="#rfc.section.4.2.4">4.2.4.</a> <a href="#SCIMInteroperabilityUserProvisioningDeleteUser" id="SCIMInteroperabilityUserProvisioningDeleteUser">Delete User</a>
</h1>
<p id="rfc.section.4.2.4.p.1">User deletions are performed via the SCIM operation: <samp>DELETE /Users/{id}</samp> </p>
<p id="rfc.section.4.2.4.p.2">Identity Providers SHOULD delete users when they have reason to believe the User will not be reactivated in the future. This may occur, for example, when a userName is recycled and given to a new actor, necessitating removal of the prior record.  </p>
<p id="rfc.section.4.2.4.p.3">After a user is deleted, Application Providers MUST allow the creation of a new user with the same userName.  </p>
<p></p>
<p id="rfc.section.4.2.4.p.5">The following is a non-normative example of deleting a User: </p>
<pre>
 DELETE /Users/{id}
 Host: example.com
 Authorization: Bearer h480djs93hd8
</pre>
<h1 id="rfc.section.4.2.5">
<a href="#rfc.section.4.2.5">4.2.5.</a> <a href="#SCIMInteroperabilityUserProvisioningGetUserById" id="SCIMInteroperabilityUserProvisioningGetUserById">Get User By Id</a>
</h1>
<p id="rfc.section.4.2.5.p.1">User lookups by id are performed via the SCIM operation: <samp>GET /Users/{id}</samp> </p>
<p id="rfc.section.4.2.5.p.2">The following is a non-normative example of retrieving a User by id: </p>
<pre>
 GET /Users/{id}
 Host: example.com
 Accept: application/scim+json
 Authorization: Bearer h480djs93hd8
</pre>
<pre>
 HTTP/1.1 200 OK
 Content-Type: application/scim+json

 {
   "schemas":["urn:ietf:params:scim:schemas:core:2.0:User"],
   "meta":{
     "resourceType":"User",
     "created":"2011-08-01T18:29:49.793Z",
     "lastModified":"2011-08-01T18:29:49.793Z",
     "version":"W\/\"f250dd84f0671c3\""
   },
   "id":"2819c223-7f76-453a-919d-413861904646",
   "externalId": "98d78581-dd0d-4361-ab61-9511c6e5f035",
   "userName":"bjensen",
   "name":{
     "formatted":"Ms. Barbara J Jensen III",
     "familyName":"Jensen",
     "givenName":"Barbara"
   },
   "emails":[
     {
       "value":"bjensen@example.com",
       "type":"work"
       "primary":true
     }
   ]   
 }
</pre>
<h1 id="rfc.section.4.2.6">
<a href="#rfc.section.4.2.6">4.2.6.</a> <a href="#SCIMInteroperabilityUserProvisioningSearchUsersByAlternateIds" id="SCIMInteroperabilityUserProvisioningSearchUsersByAlternateIds">List Users By Alternate Identifier</a>
</h1>
<p id="rfc.section.4.2.6.p.1">User lookups by alternate identifier are performed via the SCIM operation: <samp>GET /Users?filter={filterExpression}</samp> </p>
<p id="rfc.section.4.2.6.p.2">Application Providers MUST support the following filter expressions: </p>

<ul>
<li><samp>userName eq {userName}</samp></li>
<li><samp>externalId eq {externalId}</samp></li>
<li><samp>emails[value eq {email}]</samp></li>
</ul>

<p> </p>
<p id="rfc.section.4.2.6.p.3">The following is a non-normative example of retrieving Users by username: </p>
<pre>
 GET /Users?filter=userName+eq+bjensen
 Host: example.com
 Accept: application/scim+json
 Authorization: Bearer h480djs93hd8
</pre>
<pre>
 HTTP/1.1 200 OK
 Content-Type: application/scim+json

 {
   "schemas":["urn:ietf:params:scim:api:messages:2.0:ListResponse"],
   "totalResults":1,
   "Resources":[
     {
       "schemas":["urn:ietf:params:scim:schemas:core:2.0:User"],
       "meta":{
         "resourceType":"User",
         "created":"2011-08-01T18:29:49.793Z",
         "lastModified":"2011-08-01T18:29:49.793Z",
         "version":"W\/\"f250dd84f0671c3\""
       },
       "id":"2819c223-7f76-453a-919d-413861904646",
       "externalId": "98d78581-dd0d-4361-ab61-9511c6e5f035",
       "userName":"bjensen",
       "name":{
         "formatted":"Ms. Barbara J Jensen III",
         "familyName":"Jensen",
         "givenName":"Barbara"
       },
       "emails":[
         {
           "value":"bjensen@example.com",
           "type":"work"
         }
       ]
     }     
   ]
 }
</pre>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> <a href="#SCIMInteroperabilityGroupProvisioning" id="SCIMInteroperabilityGroupProvisioning">Group Provisioning</a>
</h1>
<p id="rfc.section.4.3.p.1">Application Providers MAY support Group Provisioning. Support is indicated by including values for <samp>required_group_attributes</samp> and <samp>optional_group_attributes</samp> in the desired attributes, as specified in <a href="#FastFedMetadataApplicationMetadata" class="xref">Section 3.1.2</a>. In addition, the Application Provider must include Groups as a supported resource type in the response from the SCIM /ResourceTypes endpoint, as defined in Section 4 of the SCIM Protocol <a href="#RFC7644" class="xref">[RFC7644]</a>.  </p>
<p id="rfc.section.4.3.p.2">If the Application Provider supports Groups, it MUST implement all the Group provisioning operations defined in this section.  </p>
<p id="rfc.section.4.3.p.3">If an Identity Provider holds information about Groups, then it MUST implement provisioning of the Group information to Applications who support it.  </p>
<p id="rfc.section.4.3.p.4">Before initiating Group provisioning, the Identity Provider MUST query the Application Provider's SCIM /ResourceTypes endpoint to confirm Groups are supported by the Application. As a reference to implementors, this check can occur when the FastFed Handshake completes, on-or-after Section 7.2.4.4 of the <a href="#FastFed.Core" class="xref">FastFed Core</a> specification.  </p>
<p id="rfc.section.4.3.p.5">If both the Identity Provider and the Application Provider support Group provisioning, the Identity Provider SHOULD replicate Group information to the Application Provider within 60 minutes of the Group being created or updated. Identity Providers MAY use any combination of the operations to perform Group provisioning.  </p>
<h1 id="rfc.section.4.3.1">
<a href="#rfc.section.4.3.1">4.3.1.</a> <a href="#SCIMInteroperabilityGroupProvisioningCreateGroup" id="SCIMInteroperabilityGroupProvisioningCreateGroup">Create Group</a>
</h1>
<p id="rfc.section.4.3.1.p.1">Group creation is performed via the SCIM operation: <samp>POST /Groups </samp> </p>
<p id="rfc.section.4.3.1.p.2">The Identity Provider MUST NOT include a value for the <samp>members</samp> attribute.  See <a href="#SCIMInteroperabilityGroupProvisioningUpdateGroupMembership" class="xref">Section 4.3.7</a> for information on Group membership changes.  </p>
<p id="rfc.section.4.3.1.p.3">The following is a non-normative example of creating a Group: </p>
<pre>
 POST /Groups  HTTP/1.1
 Host: example.com
 Accept: application/scim+json
 Content-Type: application/scim+json
 Authorization: Bearer h480djs93hd8
 Content-Length: ...

 {
   "schemas": ["urn:ietf:params:scim:schemas:core:2.0:Group"],
   "externalId": "e5a41517-bcd6-4b8b-8590-487ae996de44",
   "displayName": "ExampleGroup"
 }
</pre>
<h1 id="rfc.section.4.3.2">
<a href="#rfc.section.4.3.2">4.3.2.</a> <a href="#SCIMInteroperabilityGroupProvisioningUpdateGroupMetadata" id="SCIMInteroperabilityGroupProvisioningUpdateGroupMetadata">Update Group Metadata</a>
</h1>
<p id="rfc.section.4.3.2.p.1">Group updates are performed via the SCIM operation: <samp>PATCH </samp> </p>
<p id="rfc.section.4.3.2.p.2">The Identity Provider MUST NOT update the <samp>members</samp> attribute of a Group in the same PATCH request that updates other Group attributes. See <a href="#SCIMInteroperabilityGroupProvisioningUpdateGroupMembership" class="xref">Section 4.3.7</a> for information on Group membership changes.  </p>
<p id="rfc.section.4.3.2.p.3">The following is a non-normative example of updating a Group: </p>
<pre>
 PATCH /Groups/{id}  HTTP/1.1
 Host: example.com
 Accept: application/scim+json
 Content-Type: application/scim+json
 Authorization: Bearer h480djs93hd8
 Content-Length: ...
 
 {
   "schemas": ["urn:ietf:params:scim:api:messages:2.0:PatchOp"],
   "Operations": [
     {
       "op": "replace",
       "path": "externalId",
       "value": "{newExternalId}"
     },
     {
       "op": "replace",
       "path": "displayName",
       "value": "{newDisplayName}"
     }
   ]
 }
</pre>
<h1 id="rfc.section.4.3.3">
<a href="#rfc.section.4.3.3">4.3.3.</a> <a href="#SCIMInteroperabilityGroupProvisioningDeactivateGroup" id="SCIMInteroperabilityGroupProvisioningDeactivateGroup">Deactivate Group</a>
</h1>
<p id="rfc.section.4.3.3.p.1">Unlike User resources, SCIM does not define a mechanism to softly deactivate a Group prior to permanent deletion. However, experience has demonstrated that jumping straight to permanent deletion can have undesired repercussions for user entitlements in an Application that are based on group membership. If the Group deletion was in error, it cannot be easily undone. The end-users have lost access and the entitlements inside the Application must be re-established from scratch under a new group id.  </p>
<p id="rfc.section.4.3.3.p.2">To provide increased safety, and simulate an undo window, it is RECOMMENDED that Identity Providers first remove all group members, wait a period of time, and then permanently delete the group when comfortable with the action. The wait period is an implementation detail.  </p>
<p id="rfc.section.4.3.3.p.3">Identity Providers MAY also allow the empty group to exist for a longer duration and delete only when necessary, such as when a new group is being created with a recycled name that requires cleanup of the prior record.  </p>
<p id="rfc.section.4.3.3.p.4">To allow this behavior, Application Providers MUST support removing all Group members via the SCIM operation <samp>PATCH Groups/{id}</samp> with an <samp>Operation</samp> element containing the following contents: </p>

<ul>
<li>The <samp>op</samp> attribute set to <samp>"remove"</samp>.  </li>
<li>The <samp>path</samp> attribute set to <samp>"members"</samp>.  </li>
<li>The <samp>value</samp> attribute unspecified.  </li>
</ul>

<p> </p>
<p id="rfc.section.4.3.3.p.5">The following is a non-normative example of removing all Group members: </p>
<pre>
 PATCH /Groups/{id}  HTTP/1.1
 Host: example.com
 Accept: application/scim+json
 Content-Type: application/scim+json
 Authorization: Bearer h480djs93hd8
 Content-Length: ...

 {
   "schemas": ["urn:ietf:params:scim:api:messages:2.0:PatchOp"],
   "Operations": [{
       "op": "remove"
       "path": "members"
    }]
}
</pre>
<h1 id="rfc.section.4.3.4">
<a href="#rfc.section.4.3.4">4.3.4.</a> <a href="#SCIMInteroperabilityGroupProvisioningDeleteGroup" id="SCIMInteroperabilityGroupProvisioningDeleteGroup">Delete Group</a>
</h1>
<p id="rfc.section.4.3.4.p.1">Group deletions are performed via the SCIM operation: <samp>DELETE Group/{id}</samp> </p>
<p></p>
<p id="rfc.section.4.3.4.p.3">The following is a non-normative example of deleting a Group: </p>
<pre>
 DELETE /Groups/{id}  HTTP/1.1
 Host: example.com
 Accept: application/scim+json
 Content-Type: application/scim+json
 Authorization: Bearer h480djs93hd8
</pre>
<h1 id="rfc.section.4.3.5">
<a href="#rfc.section.4.3.5">4.3.5.</a> <a href="#SCIMInteroperabilityUserProvisioningGetGroupById" id="SCIMInteroperabilityUserProvisioningGetGroupById">Get Group By Id</a>
</h1>
<p id="rfc.section.4.3.5.p.1">Group lookups by id are performed via the SCIM operation: <samp>GET /Group/{id}?excludedAttributes=members</samp> </p>
<p id="rfc.section.4.3.5.p.2">The following is a non-normative example of retrieving a Group by id: </p>
<pre>
 GET /Groups/{id}?excludedAttributes=members
 Host: example.com
 Accept: application/scim+json
 Authorization: Bearer h480djs93hd8
</pre>
<pre>
 HTTP/1.1 200 OK
 Content-Type: application/scim+json

 {
   "schemas":["urn:ietf:params:scim:schemas:core:2.0:Group"],
   "meta":{
     "resourceType":"Group",
     "created":"2011-08-01T18:29:49.793Z",
     "lastModified":"2011-08-01T18:29:49.793Z",
     "version":"W\/\"f250dd84f0671c3\""
   },
   "id":"d637f86b-9171-4b2b-9fa8-15d552604e6f",
   "externalId": "530eb5eb-0ccf-4312-85d8-db1423a10b2a",
   "displayName":"ExampleGroup"
 }
</pre>
<h1 id="rfc.section.4.3.6">
<a href="#rfc.section.4.3.6">4.3.6.</a> <a href="#SCIMInteroperabilityUserProvisioningSearchGroupsByAlternateIds" id="SCIMInteroperabilityUserProvisioningSearchGroupsByAlternateIds">List Groups By Alternate Identifier</a>
</h1>
<p id="rfc.section.4.3.6.p.1">Group lookups by alternate identifier are performed via the SCIM operation: <samp>GET /Groups?filter={filterExpression}&amp;excludedAttributes=members</samp> </p>
<p id="rfc.section.4.3.6.p.2">Application Providers MUST support the following filter expressions: </p>

<ul><li><samp>displayName eq {displayName}</samp></li></ul>

<p> </p>
<p id="rfc.section.4.3.6.p.3">The following is a non-normative example of retrieving Groups by displayName: </p>
<pre>
 GET /Groups?filter=displayName+eq+ExampleGroup&amp;excludedAttributes=members
 Host: example.com
 Accept: application/scim+json
 Authorization: Bearer h480djs93hd8
</pre>
<pre>
 HTTP/1.1 200 OK
 Content-Type: application/scim+json

 {
   "schemas":["urn:ietf:params:scim:api:messages:2.0:ListResponse"],
   "totalResults":1,
   "Resources":[
     {
       "schemas":["urn:ietf:params:scim:schemas:core:2.0:Group"],
       "meta":{
         "resourceType":"Group",
         "created":"2011-08-01T18:29:49.793Z",
         "lastModified":"2011-08-01T18:29:49.793Z",
         "version":"W\/\"f250dd84f0671c3\""
       },
       "id":"d637f86b-9171-4b2b-9fa8-15d552604e6f",
       "externalId": "530eb5eb-0ccf-4312-85d8-db1423a10b2a",
       "displayName":"ExampleGroup"
     }
   ]
 }
</pre>
<h1 id="rfc.section.4.3.7">
<a href="#rfc.section.4.3.7">4.3.7.</a> <a href="#SCIMInteroperabilityGroupProvisioningUpdateGroupMembership" id="SCIMInteroperabilityGroupProvisioningUpdateGroupMembership">Add or Remove Group Members</a>
</h1>
<p id="rfc.section.4.3.7.p.1">Members are added or removed from Groups via the SCIM operation: <samp>PATCH /Groups/{id}</samp> </p>
<p id="rfc.section.4.3.7.p.2">For each <samp>Operation</samp> in the PATCH: </p>

<ul>
<li>The <samp>op</samp> attribute MUST contain either <samp>"add"</samp> or <samp>"remove"</samp>.  </li>
<li>When the <samp>op</samp> is <samp>"add"</samp>: <ul>
<li>The <samp>path</samp> attribute MUST be <samp>"members"</samp>.  </li>
<li>The <samp>value</samp> attribute MUST be an array of Group <samp>member</samp> elements, as defined in Section 4.2 of the SCIM Core Schema <a href="#RFC7643" class="xref">[RFC7643]</a>. Each member MUST contain a <samp>value</samp> subattribute with the <samp>id</samp> of the resource being added to the group.  </li>
</ul>
<p> </p>
</li>
<li>When the <samp>op</samp> is <samp>"remove"</samp>: <ul>
<li>The <samp>path</samp> attribute MUST be either: <ul>
<li>
<samp>"members"</samp> (to remove all members) </li>
<li>
<samp>"members[value eq \"{id}\"]"</samp> (to remove a single member) </li>
</ul>
<p> </p>
</li>
<li>The <samp>value</samp> attribute MUST be unspecified.  </li>
</ul>
<p> </p>
</li>
</ul>

<p> </p>
<p id="rfc.section.4.3.7.p.3">The number of membership changes in a PATCH request MUST NOT exceed the value of <samp>max_group_membership_changes</samp>, as defined in <a href="#FastFedMetadataApplicationMetadata" class="xref">Section 3.1.2</a>. The number of changes is determined by counting the total members being added/removed, summed across all operations in the PATCH. The truncation of all members in the group via the <samp>remove</samp> operation on the <samp>members</samp> attribute is counted as one change, and if included, MUST be the first operation in the PATCH.  </p>
<p id="rfc.section.4.3.7.p.4">If the Application Provider supports nested groups, as indicated by the attribute <samp>can_support_nested_groups</samp> defined in <a href="#FastFedMetadataApplicationMetadata" class="xref">Section 3.1.2</a>, the resource being added to the Group members MAY be either a User or Group. Alternatively, if the Application Provider does not support nested groups, the resource type MUST be a User.  </p>
<p id="rfc.section.4.3.7.p.5">If an Administrator seeks to provision a nested group to an Application Provider that does not support nested groups, the handling of this scenario is an implementation detail outside the scope of the specification. As a reference to implementors, the Identity Provider can consider signaling an error to the Administrator, or flattening the nested group memberships into a single array for provisioning.  </p>
<p id="rfc.section.4.3.7.p.6">The same resource <samp>id</samp> MUST NOT appear more than once in a single PATCH request. For example, a resource should not be added and removed in a single PATCH, or added multiple times.  </p>
<p id="rfc.section.4.3.7.p.7">If any membership change in the PATCH results in an error, the Application Provider SHOULD stop processing and return the error response.  </p>
<p id="rfc.section.4.3.7.p.8">If the Identity Provider receives an error response from the PATCH request, it SHOULD assume that none of the changes in the PATCH were committed and retry as appropriate.  </p>
<p id="rfc.section.4.3.7.p.9">If the Application Provider receives a PATCH request to add a resource to a group to which the resource already belongs, or remove a resource from a group from which it doesn't belong, the Application Provider MUST behave idempotently and return a successful response.  </p>
<p id="rfc.section.4.3.7.p.10">The following is a non-normative example of adding and removing members of a Group: </p>
<pre>
 PATCH /Groups/{id}  HTTP/1.1
 Host: example.com
 Accept: application/scim+json
 Content-Type: application/scim+json
 Authorization: Bearer h480djs93hd8
 Content-Length: ...
 
 {
   "schemas": ["urn:ietf:params:scim:api:messages:2.0:PatchOp"],
   "Operations": [
     {
       "op": "remove",
       "path": "members[value eq \"{user_id_1}\"]",
     },
     {
       "op": "remove",
       "path": "members[value eq \"{user_id_2}\"]",
     },
     {
       "op": "add",
       "path": "members",
       "value": [
         {"value": "{user_id_3}"},
         {"value": "{user_id_4}"}
       ]
     }
   ] 
 }
</pre>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> <a href="#SCIMInteroperabilityMetadataEndpoints" id="SCIMInteroperabilityMetadataEndpoints">Metadata Endpoints</a>
</h1>
<h1 id="rfc.section.4.4.1">
<a href="#rfc.section.4.4.1">4.4.1.</a> <a href="#SCIMInteroperabilityMetadataResourceTypes" id="SCIMInteroperabilityMetadataResourceTypes">ResourceTypes</a>
</h1>
<p id="rfc.section.4.4.1.p.1">Application Providers MUST host a /ResourceTypes endpoint, as defined in Section 4 of <a href="#RFC7644" class="xref">RFC 7644</a>.  </p>
<p id="rfc.section.4.4.1.p.2">The supported ResourceTypes MUST include Users. It MAY include Groups.  </p>
<h1 id="rfc.section.4.4.2">
<a href="#rfc.section.4.4.2">4.4.2.</a> <a href="#SCIMInteroperabilityMetadataServiceProviderConfig" id="SCIMInteroperabilityMetadataServiceProviderConfig">ServiceProviderConfig</a>
</h1>
<p id="rfc.section.4.4.2.p.1">Application Providers MUST host a /ServiceProviderConfig endpoint to describe the operations they support, as defined in Section 4 of <a href="#RFC7644" class="xref">RFC 7644</a>.  </p>
<p id="rfc.section.4.4.2.p.2">The operations MUST include, at minimum, the set of SCIM capabilities required for compatibility with this FastFed Profile.  </p>
<p id="rfc.section.4.4.2.p.3">Additional capabilities MAY be supported, but are not required for FastFed compatibility.  </p>
<h1 id="rfc.section.4.4.3">
<a href="#rfc.section.4.4.3">4.4.3.</a> <a href="#SCIMInteroperabilityMetadataSchemas" id="SCIMInteroperabilityMetadataSchemas">Schemas</a>
</h1>
<p id="rfc.section.4.4.3.p.1">Application Providers MUST host a /Schemas endpoint to describe the supported schemas, as defined in Section 4 of <a href="#RFC7644" class="xref">RFC 7644</a>.  </p>
<p id="rfc.section.4.4.3.p.2">There MUST exist a schema definition for every attribute listed in the <samp>desired_attributes</samp>, as described in <a href="#FastFedMetadataApplicationMetadata" class="xref">Section 3.1.2</a>.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#AuthenticationExample" id="AuthenticationExample">Example Usage of the OAuth 2.0 JWT Profile</a>
</h1>
<p id="rfc.section.5.p.1">The following end-to-end example illustrates the message flows when using the authentication method <samp>"urn:ietf:params:fastfed:1.0:provider_authentication:oauth:2.0:jwt_profile"</samp>.  </p>
<p id="rfc.section.5.p.2">This method enables a SCIM client to invoke a SCIM service using OAuth access tokens derived from public/private key pairs.  </p>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> <a href="#IdentityProviderSharesPublicKey" id="IdentityProviderSharesPublicKey">Identity Provider       Shares Public Key</a>
</h1>
<p id="rfc.section.5.1.p.1">As a first-step, the Identity Provider shares a public key with the Application Provider in the form of a JSON Web key Set <a href="#RFC7517" class="xref">[JWK]</a>. This occurs during the FastFed Handshake (see "jwks_uri", below) and is described in <a href="#FastFedHandshakeRegistrationRequest" class="xref">Section 3.2.1</a> of this specification.  </p>
<pre>
 {
   "iss": "https://tenant-12345.idp.example.com",
   "aud": "https://tenant-67890.app.example.com",
   "exp": 1234567890,
   "provisioning_profiles": [
     "urn:ietf:params:fastfed:1.0:provisioning:scim:2.0:enterprise"
   ],
   "urn:ietf:params:fastfed:1.0:provisioning:scim:2.0:enterprise": {
     "provider_contact_information": {
       "organization": "Example Inc.",
       "phone": "+1-800-555-5555",
       "email": "support@example.com"
     },
     "provider_authentication_methods": {
       "urn:ietf:params:fastfed:1.0:provider_authentication:oauth:2.0:jwt_profile": {
         "jwks_uri": "https://provisioning.example.com/keys"
       }
     }
   }
 }
</pre>
<p id="rfc.section.5.1.p.2">Upon receiving this information, the Application Provider may internally perform an OAuth client registration in order to capture the provider's contact information and <samp>jwks_uri</samp>, and authorize the Provider to perform SCIM provisioning activities. This is an implementation detail. FastFed does not require the exchange of an OAuth clientID.  </p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> <a href="#ApplicationProviderSharesEndpoints" id="ApplicationProviderSharesEndpoints">Application Provider Shares SCIM and OAuth Endpoints</a>
</h1>
<p id="rfc.section.5.2.p.1">Subsequently in the FastFed Handshake, the Application Provider returns SCIM and OAuth metadata back to the Identity Provider. This is described in <a href="#FastFedHandshakeRegistrationResponse" class="xref">Section 3.2.2</a> of this specification.  </p>
<pre>
 {
   "urn:ietf:params:fastfed:1.0:provisioning:scim:2.0:enterprise": {
     "scim_service_uri": "https://tenant-56789.app.example.com/scim",
     "provider_authentication_method": "urn:ietf:params:fastfed:1.0:provider_authentication:oauth:2.0:jwt_profile",
     "urn:ietf:params:fastfed:1.0:provider_authentication:oauth:2.0:jwt_profile": {
       "token_endpoint": "https://tenant-56789.app.example.com/oauth",
       "scope": "scim"
     }
   }
 }
</pre>
<h1 id="rfc.section.5.3">
<a href="#rfc.section.5.3">5.3.</a> <a href="#IdentityProviderAcquiresOAuthToken" id="IdentityProviderAcquiresOAuthToken">Identity Provider Acquires an OAuth Access Token</a>
</h1>
<p id="rfc.section.5.3.p.1">After the FastFed Handshake is complete and the Identity Provider is ready to begin calling the SCIM endpoint, it must first acquire an OAuth <samp>access_token</samp>. This will be used to authenticate to the SCIM endpoint.  </p>
<p id="rfc.section.5.3.p.2">The <samp>access_token</samp> is acquired by using the JWT Authorization Grant Type. This grant type is defined in <a href="#RFC7523" class="xref">RFC 7523</a>, and its usage within FastFed is specified in Section 6.6 of the <a href="#FastFed.Core" class="xref">FastFed Core</a> specification.  </p>
<p id="rfc.section.5.3.p.3">In essence, the Identity Provider sends a signed JWT to the OAuth endpoint hosted by the Application Provider. If the JWT is valid and is signed by an authorized party, an OAuth access_token is returned.  </p>
<p id="rfc.section.5.3.p.4">This is illustrated in the following steps. First, a JWT is constructed with the following contents: </p>
<pre>
 {                                                                                                                 
   "iss": "https://tenant-12345.idp.example.com",                                                                                       
   "aud": "https://tenant-56789.app.example.com",                                                                                       
   "exp": 1234567890,            
 }
</pre>
<p id="rfc.section.5.3.p.5">Next, a request is made to the OAuth token endpoint, using the signed and serialized JWT as the value of the <samp>assertion</samp>.  </p>
<pre>
 {
     POST /oauth HTTP/1.1
     Host: tenant-56789.app.example.com
     Content-Type: application/x-www-form-urlencoded

     grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-bearer
     &amp;assertion=eyJhbGciOiJFUzI1NiIsImtpZCI6IjE2In0.
     eyJpc3Mi[...omitted for brevity...].
     J9l-ZhwP[...omitted for brevity...]
 }
</pre>
<p id="rfc.section.5.3.p.6">In response, an OAuth token is returned: </p>
<pre>
     HTTP/1.1 200 OK
     Content-Type: application/json;charset=UTF-8
     Cache-Control: no-store
     Pragma: no-cache

     {
       "access_token":"2YotnFZFEjr1zCsicMWpAA",
       "token_type":"Bearer",
       "expires_in":3600
     }
</pre>
<h1 id="rfc.section.5.4">
<a href="#rfc.section.5.4">5.4.</a> <a href="#IdentityProviderUsesOAuthToken" id="IdentityProviderUsesOAuthToken">Identity Provider Uses the OAuth Access Token</a>
</h1>
<p id="rfc.section.5.4.p.1">Finally, the token can be used to authenticate to the SCIM endpoint: </p>
<pre>
   POST scim/Users  HTTP/1.1
   Host: tenant-56789.app.example.com
   Accept: application/scim+json
   Content-Type: application/scim+json
   Authorization: Bearer 2YotnFZFEjr1zCsicMWpAA
   Content-Length: ...

   {
     "schemas":["urn:ietf:params:scim:schemas:core:2.0:User"],
     "userName":"bjensen",
     "externalId":"bjensen",
     "name":{
       "formatted":"Ms. Barbara J Jensen III",
       "familyName":"Jensen",
       "givenName":"Barbara"
     }
   }
</pre>
<p id="rfc.section.5.4.p.2">When the access token expires, the SCIM service returns an HTTP 401 response code. The JWT Authorization Grant flow may then be re-executed to acquire a new access token.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.6.p.1">For SCIM security considerations, see <a href="#RFC7643" class="xref">RFC 7643</a> and <a href="#RFC7644" class="xref">RFC 7644</a>.  </p>
<p id="rfc.section.6.p.2">For FastFed security considerations, see Section 8 of <a href="#FastFed.Core" class="xref">FastFed Core</a>.  </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.7.p.1">Pending </p>
<h1 id="rfc.references">
<a href="#rfc.references">8.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="FastFed.Core">[FastFed.Core]</b></td>
<td class="top">
<a title="Amazon">McAdams, K.</a>, "<a href="http://openid.net/specs/fastfed-core-1_0.html">FastFed Core 1.0</a>", October 2020.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7517">[RFC7517]</b></td>
<td class="top">
<a>Jones, M.</a>, "<a href="https://tools.ietf.org/html/rfc7517">JSON Web Key (JWK)</a>", RFC 7517, DOI 10.17487/RFC7517, May 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7523">[RFC7523]</b></td>
<td class="top">
<a>Jones, M.</a>, <a>Campbell, B.</a> and <a>C. Mortimore</a>, "<a href="https://tools.ietf.org/html/rfc7523">JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants</a>", RFC 7523, DOI 10.17487/RFC7523, May 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7643">[RFC7643]</b></td>
<td class="top">
<a>Hunt, P.</a>, <a>Grizzle, K.</a>, <a>Wahlstroem, E.</a> and <a>C. Mortimore</a>, "<a href="https://tools.ietf.org/html/rfc7643">System for Cross-domain Identity Management: Core Schema</a>", RFC 7643, DOI 10.17487/RFC7643, September 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7644">[RFC7644]</b></td>
<td class="top">
<a>Hunt, P.</a>, <a>Grizzle, K.</a>, <a>Ansari, M.</a>, <a>Wahlstroem, E.</a> and <a>C. Mortimore</a>, "<a href="https://tools.ietf.org/html/rfc7644">System for Cross-domain Identity Management: Protocol</a>", RFC 7644, DOI 10.17487/RFC7644, September 2015.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.A">
<a href="#rfc.appendix.A">Appendix A.</a> <a href="#Acknowledgements" id="Acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.A.p.1">The OpenID Community would like to thank the following people for their contributions to this specification: </p>
<p></p>

<ul class="empty">
<li>Brian Campbell (bcampbell@pingidentity.com), Ping Identity </li>
<li>Zhen Chien Chia (chiazhenchien@outlook.com), Microsoft </li>
<li>Pamela Dingle (pamela.dingle@microsoft.com), Microsoft </li>
<li>Matt Domsch (matt.domsch@sailpoint.com), SailPoint </li>
<li>Wesley Dunnington (wesleydunnington@pingidentity.com), Ping Identity </li>
<li>Erik Gustavson (erikgustavson@google.com), Google </li>
<li>Dick Hardt (dick.hardt@gmail.com), Independent </li>
<li>Romain Lenglet (rlenglet@google.com), Google </li>
<li>Karl McGuinness (kmcguinness@okta.com), Okta </li>
<li>Chuck Mortimore (cmortimore@salesforce.com), Salesforce </li>
<li>Brian Rose (brian.rose@sailpoint.com), SailPoint </li>
</ul>

<p> </p>
<h1 id="rfc.appendix.B">
<a href="#rfc.appendix.B">Appendix B.</a> <a href="#Notices" id="Notices">Notices</a>
</h1>
<p id="rfc.section.B.p.1">Copyright (c) 2020 The OpenID Foundation.</p>
<p id="rfc.section.B.p.2">The OpenID Foundation (OIDF) grants to any Contributor, developer, implementer, or other interested party a non-exclusive, royalty free, worldwide copyright license to reproduce, prepare derivative works from, distribute, perform and display, this Implementers Draft or Final Specification solely for the purposes of (i) developing specifications, and (ii) implementing Implementers Drafts and Final Specifications based on such documents, provided that attribution be made to the OIDF as the source of the material, but that such attribution does not indicate an endorsement by the OIDF.</p>
<p id="rfc.section.B.p.3">The technology described in this specification was made available from contributions from various sources, including members of the OpenID Foundation and others. Although the OpenID Foundation has taken steps to help ensure that the technology is available for distribution, it takes no position regarding the validity or scope of any intellectual property or other rights that might be claimed to pertain to the implementation or use of the technology described in this specification or the extent to which any license under such rights might or might not be available; neither does it represent that it has made any independent effort to identify any such rights. The OpenID Foundation and the contributors to this specification make no (and hereby expressly disclaim any) warranties (express, implied, or otherwise), including implied warranties of merchantability, non-infringement, fitness for a particular purpose, or title, related to this specification, and the entire risk as to implementing this specification is assumed by the implementer. The OpenID Intellectual Property Rights policy requires contributors to offer a patent promise not to assert certain patent claims against other contributors and against implementers. The OpenID Foundation invites any interested party to bring to its attention any copyrights, patents, patent applications, or other proprietary rights that may cover technology that may be required to practice this specification.</p>
<h1 id="rfc.authors"><a href="#rfc.authors">Author's Address</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Darin K. McAdams</span> 
	  <span class="n hidden">
		<span class="family-name">McAdams</span>
	  </span>
	</span>
	<span class="org vcardline">Amazon</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:darinm@amazon.com">darinm@amazon.com</a></span>

  </address>
</div>

</body>
</html>

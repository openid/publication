<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Han,Hiragana,Katakana,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>OpenID for Verifiable Credential Issuance - draft 12</title>
<meta content="Torsten Lodderstedt" name="author">
<meta content="Kristina Yasuda" name="author">
<meta content="Tobias Looker" name="author">
<meta content="
       This specification defines an API for the issuance of Verifiable Credentials. 
    " name="description">
<meta content="xml2rfc 3.16.0" name="generator">
<meta content="security" name="keyword">
<meta content="openid" name="keyword">
<meta content="ssi" name="keyword">
<meta content="openid-4-verifiable-credential-issuance-1_0-12" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.16.0
    Python 3.10.2
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.2
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.2
    MarkupSafe 2.1.2
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.2
    setuptools 57.5.0
    six 1.16.0
    wcwidth 0.2.6
-->
<link href="./openid-4-verifiable-credential-issuance-1_0-12.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
</head>
<body class="xml2rfc">
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left"></td>
<td class="center">openid-4-verifiable-credential-issuance</td>
<td class="right">November 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Lodderstedt, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">OpenID Connect</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2023-11-26" class="published">26 November 2023</time>
    </dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Lodderstedt</div>
<div class="org">sprind.org</div>
</div>
<div class="author">
      <div class="author-name">K. Yasuda</div>
<div class="org">Microsoft</div>
</div>
<div class="author">
      <div class="author-name">T. Looker</div>
<div class="org">Mattr</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">OpenID for Verifiable Credential Issuance - draft 12</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This specification defines an API for the issuance of Verifiable Credentials.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-requirements-notation-and-c" class="internal xref">Requirements Notation and Conventions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-credential-issuer" class="internal xref">Credential Issuer</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-oauth-20" class="internal xref">OAuth 2.0</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-core-concepts" class="internal xref">Core Concepts</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-authorization-code-flow" class="internal xref">Authorization Code Flow</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-pre-authorized-code-flow" class="internal xref">Pre-Authorized Code Flow</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-credential-offer-endpoint" class="internal xref">Credential Offer Endpoint</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-credential-offer" class="internal xref">Credential Offer</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="auto internal xref">4.1.1</a>.  <a href="#name-credential-offer-parameters" class="internal xref">Credential Offer Parameters</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="auto internal xref">4.1.2</a>.  <a href="#name-sending-credential-offer-by" class="internal xref">Sending Credential Offer by Value Using <code>credential_offer</code> Parameter</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a href="#section-4.1.3" class="auto internal xref">4.1.3</a>.  <a href="#name-sending-credential-offer-by-" class="internal xref">Sending Credential Offer by Reference Using <code>credential_offer_uri</code> Parameter</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-credential-offer-response" class="internal xref">Credential Offer Response</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-authorization-endpoint" class="internal xref">Authorization Endpoint</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-authorization-request" class="internal xref">Authorization Request</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-request-issuance-of-a-certa" class="internal xref">Request Issuance of a Certain Credential Type using <code>authorization_details</code> Parameter</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="auto internal xref">5.1.2</a>.  <a href="#name-using-scope-parameter-to-re" class="internal xref">Using <code>scope</code> Parameter to Request Issuance of a Credential</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a href="#section-5.1.3" class="auto internal xref">5.1.3</a>.  <a href="#name-additional-request-paramete" class="internal xref">Additional Request Parameters</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4">
                    <p id="section-toc.1-1.5.2.1.2.4.1"><a href="#section-5.1.4" class="auto internal xref">5.1.4</a>.  <a href="#name-pushed-authorization-reques" class="internal xref">Pushed Authorization Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.5">
                    <p id="section-toc.1-1.5.2.1.2.5.1"><a href="#section-5.1.5" class="auto internal xref">5.1.5</a>.  <a href="#name-dynamic-credential-request" class="internal xref">Dynamic Credential Request</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-successful-authorization-re" class="internal xref">Successful Authorization Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-authorization-error-respons" class="internal xref">Authorization Error Response</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-token-endpoint" class="internal xref">Token Endpoint</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-token-request" class="internal xref">Token Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-successful-token-response" class="internal xref">Successful Token Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-token-error-response" class="internal xref">Token Error Response</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-credential-endpoint" class="internal xref">Credential Endpoint</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-binding-the-issued-credenti" class="internal xref">Binding the Issued Credential to the Identifier of the End-User Possessing that Credential</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-credential-request" class="internal xref">Credential Request</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a href="#section-7.2.1" class="auto internal xref">7.2.1</a>.  <a href="#name-key-proof-types" class="internal xref">Key Proof Types</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.2">
                    <p id="section-toc.1-1.7.2.2.2.2.1"><a href="#section-7.2.2" class="auto internal xref">7.2.2</a>.  <a href="#name-verifying-key-proof" class="internal xref">Verifying Key Proof</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-credential-response" class="internal xref">Credential Response</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.1">
                    <p id="section-toc.1-1.7.2.3.2.1.1"><a href="#section-7.3.1" class="auto internal xref">7.3.1</a>.  <a href="#name-credential-error-response" class="internal xref">Credential Error Response</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.2">
                    <p id="section-toc.1-1.7.2.3.2.2.1"><a href="#section-7.3.2" class="auto internal xref">7.3.2</a>.  <a href="#name-credential-issuer-provided-" class="internal xref">Credential Issuer Provided Nonce</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-batch-credential-endpoint" class="internal xref">Batch Credential Endpoint</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-batch-credential-request" class="internal xref">Batch Credential Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-batch-credential-response" class="internal xref">Batch Credential Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-batch-credential-error-resp" class="internal xref">Batch Credential Error Response</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-deferred-credential-endpoin" class="internal xref">Deferred Credential Endpoint</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-deferred-credential-request" class="internal xref">Deferred Credential Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-deferred-credential-respons" class="internal xref">Deferred Credential Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-deferred-credential-error-r" class="internal xref">Deferred Credential Error Response</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-metadata" class="internal xref">Metadata</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-client-metadata" class="internal xref">Client Metadata</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.1">
                    <p id="section-toc.1-1.10.2.1.2.1.1"><a href="#section-10.1.1" class="auto internal xref">10.1.1</a>.  <a href="#name-client-metadata-retrieval" class="internal xref">Client Metadata Retrieval</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-credential-issuer-metadata" class="internal xref">Credential Issuer Metadata</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.1">
                    <p id="section-toc.1-1.10.2.2.2.1.1"><a href="#section-10.2.1" class="auto internal xref">10.2.1</a>.  <a href="#name-credential-issuer-identifie" class="internal xref">Credential Issuer Identifier</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.2">
                    <p id="section-toc.1-1.10.2.2.2.2.1"><a href="#section-10.2.2" class="auto internal xref">10.2.2</a>.  <a href="#name-credential-issuer-metadata-" class="internal xref">Credential Issuer Metadata Retrieval</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.3">
                    <p id="section-toc.1-1.10.2.2.2.3.1"><a href="#section-10.2.3" class="auto internal xref">10.2.3</a>.  <a href="#name-credential-issuer-metadata-p" class="internal xref">Credential Issuer Metadata Parameters</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="auto internal xref">10.3</a>.  <a href="#name-oauth-20-authorization-serv" class="internal xref">OAuth 2.0 Authorization Server Metadata</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-trust-between-wallet-and-is" class="internal xref">Trust between Wallet and Issuer</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-credential-offer-2" class="internal xref">Credential Offer</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="auto internal xref">11.3</a>.  <a href="#name-pre-authorized-code-flow-2" class="internal xref">Pre-Authorized Code Flow</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3.2.1">
                    <p id="section-toc.1-1.11.2.3.2.1.1"><a href="#section-11.3.1" class="auto internal xref">11.3.1</a>.  <a href="#name-replay-prevention" class="internal xref">Replay Prevention</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3.2.2">
                    <p id="section-toc.1-1.11.2.3.2.2.1"><a href="#section-11.3.2" class="auto internal xref">11.3.2</a>.  <a href="#name-pin-code-phishing" class="internal xref">PIN Code Phishing</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#section-11.4" class="auto internal xref">11.4</a>.  <a href="#name-credential-lifecycle-manage" class="internal xref">Credential Lifecycle Management</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.5">
                <p id="section-toc.1-1.11.2.5.1"><a href="#section-11.5" class="auto internal xref">11.5</a>.  <a href="#name-key-proof-replay" class="internal xref">Key Proof replay</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.6">
                <p id="section-toc.1-1.11.2.6.1"><a href="#section-11.6" class="auto internal xref">11.6</a>.  <a href="#name-tls-requirements" class="internal xref">TLS Requirements</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-implementation-consideratio" class="internal xref">Implementation Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-claim-based-binding-of-the-" class="internal xref">Claim-based Binding of the Credential to the End-User possessing the Credential</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-binding-of-the-credential-w" class="internal xref">Binding of the Credential without Cryptographic Binding or Claim-based Binding</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#section-12.3" class="auto internal xref">12.3</a>.  <a href="#name-multiple-accesses-to-the-cr" class="internal xref">Multiple Accesses to the Credential Endpoint</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a href="#section-12.4" class="auto internal xref">12.4</a>.  <a href="#name-relationship-between-the-cr" class="internal xref">Relationship between the Credential Issuer Identifier in the metadata and the Issuer Identifier in the Issued Credential</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.5">
                <p id="section-toc.1-1.12.2.5.1"><a href="#section-12.5" class="auto internal xref">12.5</a>.  <a href="#name-refreshing-issued-credentia" class="internal xref">Refreshing Issued Credentials</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.6">
                <p id="section-toc.1-1.12.2.6.1"><a href="#section-12.6" class="auto internal xref">12.6</a>.  <a href="#name-protecting-the-access-token" class="internal xref">Protecting the Access Token</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="auto internal xref">15</a>. <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.1">
                <p id="section-toc.1-1.16.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-sub-namespace-registration" class="internal xref">Sub-Namespace Registration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.2">
                <p id="section-toc.1-1.16.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-well-known-uri-registry" class="internal xref">Well-Known URI Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-notices" class="internal xref">Notices</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#appendix-D" class="auto internal xref">Appendix D</a>.  <a href="#name-use-cases" class="internal xref">Use Cases</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.1">
                <p id="section-toc.1-1.19.2.1.1"><a href="#appendix-D.1" class="auto internal xref">D.1</a>.  <a href="#name-credential-offer-same-devic" class="internal xref">Credential Offer - Same-Device</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.2">
                <p id="section-toc.1-1.19.2.2.1"><a href="#appendix-D.2" class="auto internal xref">D.2</a>.  <a href="#name-credential-offer-cross-devi" class="internal xref">Credential Offer - Cross-Device (with Information Pre-Submitted by the End-User)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.3">
                <p id="section-toc.1-1.19.2.3.1"><a href="#appendix-D.3" class="auto internal xref">D.3</a>.  <a href="#name-credential-offer-cross-devic" class="internal xref">Credential Offer - Cross-Device &amp; Deferred</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.4">
                <p id="section-toc.1-1.19.2.4.1"><a href="#appendix-D.4" class="auto internal xref">D.4</a>.  <a href="#name-wallet-initiated-issuance-d" class="internal xref">Wallet Initiated Issuance during Presentation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.5">
                <p id="section-toc.1-1.19.2.5.1"><a href="#appendix-D.5" class="auto internal xref">D.5</a>.  <a href="#name-wallet-initiated-issuance-du" class="internal xref">Wallet Initiated Issuance during Presentation (Requires Presentation of Additional Credentials During Issuance)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#appendix-E" class="auto internal xref">Appendix E</a>.  <a href="#name-credential-format-profiles" class="internal xref">Credential Format Profiles</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.1">
                <p id="section-toc.1-1.20.2.1.1"><a href="#appendix-E.1" class="auto internal xref">E.1</a>.  <a href="#name-w3c-verifiable-credentials" class="internal xref">W3C Verifiable Credentials</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.1.2.1">
                    <p id="section-toc.1-1.20.2.1.2.1.1"><a href="#appendix-E.1.1" class="auto internal xref">E.1.1</a>.  <a href="#name-vc-signed-as-a-jwt-not-usin" class="internal xref">VC Signed as a JWT, Not Using JSON-LD</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.1.2.2">
                    <p id="section-toc.1-1.20.2.1.2.2.1"><a href="#appendix-E.1.2" class="auto internal xref">E.1.2</a>.  <a href="#name-vc-secured-using-data-integ" class="internal xref">VC Secured using Data Integrity, using JSON-LD, with Proof Suite Requiring Linked Data Canonicalization</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.1.2.3">
                    <p id="section-toc.1-1.20.2.1.2.3.1"><a href="#appendix-E.1.3" class="auto internal xref">E.1.3</a>.  <a href="#name-vc-signed-as-a-jwt-using-js" class="internal xref">VC signed as a JWT, Using JSON-LD</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.2">
                <p id="section-toc.1-1.20.2.2.1"><a href="#appendix-E.2" class="auto internal xref">E.2</a>.  <a href="#name-iso-mdl" class="internal xref">ISO mDL</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.2.2.1">
                    <p id="section-toc.1-1.20.2.2.2.1.1"><a href="#appendix-E.2.1" class="auto internal xref">E.2.1</a>.  <a href="#name-format-identifier-4" class="internal xref">Format Identifier</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.2.2.2">
                    <p id="section-toc.1-1.20.2.2.2.2.1"><a href="#appendix-E.2.2" class="auto internal xref">E.2.2</a>.  <a href="#name-credential-issuer-metadata-5" class="internal xref">Credential Issuer Metadata</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.2.2.3">
                    <p id="section-toc.1-1.20.2.2.2.3.1"><a href="#appendix-E.2.3" class="auto internal xref">E.2.3</a>.  <a href="#name-credential-offer-6" class="internal xref">Credential Offer</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.2.2.4">
                    <p id="section-toc.1-1.20.2.2.2.4.1"><a href="#appendix-E.2.4" class="auto internal xref">E.2.4</a>.  <a href="#name-authorization-details-4" class="internal xref">Authorization Details</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.2.2.5">
                    <p id="section-toc.1-1.20.2.2.2.5.1"><a href="#appendix-E.2.5" class="auto internal xref">E.2.5</a>.  <a href="#name-credential-request-5" class="internal xref">Credential Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.2.2.6">
                    <p id="section-toc.1-1.20.2.2.2.6.1"><a href="#appendix-E.2.6" class="auto internal xref">E.2.6</a>.  <a href="#name-credential-response-5" class="internal xref">Credential Response</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21">
            <p id="section-toc.1-1.21.1"><a href="#appendix-F" class="auto internal xref">Appendix F</a>.  <a href="#name-document-history" class="internal xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22">
            <p id="section-toc.1-1.22.1"><a href="#appendix-G" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This specification defines an API that is used to issue Verifiable Credentials. W3C formats <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span> as well as other Credential formats, like <span>[<a href="#ISO.18013-5" class="cite xref">ISO.18013-5</a>]</span>, are supported.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Verifiable Credentials are very similar to identity assertions, like ID Tokens in OpenID Connect <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>, in that they allow a Credential Issuer to assert End-User claims. A Verifiable Credential follows a pre-defined schema (the Credential type) and MAY be bound to a certain holder, e.g., through Cryptographic Holder Binding. Verifiable Credentials can be securely presented for the End-User to the RP, without involvement of the Credential Issuer.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Access to this API is authorized using OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, i.e., the Wallet uses OAuth 2.0 to obtain authorization to receive Verifiable Credentials. This way the issuance process can benefit from the proven security, simplicity, and flexibility of OAuth 2.0 and existing OAuth 2.0 deployments and OpenID Connect OPs (see <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>) can be extended to become Credential Issuers.<a href="#section-1-3" class="pilcrow">¶</a></p>
<div id="requirements-notation-and-conventions">
<section id="section-1.1">
        <h3 id="name-requirements-notation-and-c">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-notation-and-c" class="section-name selfRef">Requirements Notation and Conventions</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in RFC 2119 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span>.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">This specification uses the terms "Access Token", "Authorization Endpoint", "Authorization Request", "Authorization Response", "Authorization Code Grant", "Authorization Server", "Client", "Client Authentication", "Client Identifier", "Grant Type", "Refresh Token", "Token Endpoint", Token Request" and "Token Response" defined by OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, the terms "End-User", "Entity", and "Request Object" as defined by OpenID Connect Core <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>, the term "JSON Web Token (JWT)" defined by JSON Web Token (JWT) <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>, the term "JOSE Header" and "Base64url Encoding" defined by JSON Web Signature (JWS) <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This specification also defines the following terms. In the case where a term has a definition that differs, the definition below is authoritative for this specification.<a href="#section-2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-2-3">
        <dt id="section-2-3.1">Credential:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.2">A set of one or more claims about a subject made by a Credential Issuer. Note that this definition of a term "credential" in this specification is different from that in <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span> and <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-2-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.3">Verifiable Credential (VC):</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.4">An Issuer-signed Credential whose integrity can be cryptographically verified. It can be of any format used in the Issuer-Holder-Verifier Model, including, but not limited to those defined in <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span> and <span>[<a href="#ISO.18013-5" class="cite xref">ISO.18013-5</a>]</span>.<a href="#section-2-3.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.5">W3C Verifiable Credential:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.6">A Verifiable Credential compliant to the <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span> specification.<a href="#section-2-3.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.7">Presentation:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.8">Data that is presented to a specific verifier, derived from one or more Verifiable Credentials that can be from the same or different Credential Issuers.<a href="#section-2-3.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.9">Verifiable Presentation (VP):</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.10">A Holder-signed Credential whose integrity can be cryptographically verified to provide Cryptographic Holder Binding. It can be of any format used in the Issuer-Holder-Verifier Model, including, but not limited to those defined in <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span> and <span>[<a href="#ISO.18013-5" class="cite xref">ISO.18013-5</a>]</span>.<a href="#section-2-3.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.11">W3C Verifiable Presentation:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.12">A Verifiable Presentations compliant to the <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span> specification.<a href="#section-2-3.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.13">Credential Issuer:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.14">An entity that issues Verifiable Credentials. Also called Issuer. In the context of this specification, the Credential Issuer acts as an OAuth 2.0 Authorization Server (see <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>).<a href="#section-2-3.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.15">Holder:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.16">An entity that receives Verifiable Credentials and has control over them to present them to the Verifiers as Verifiable Presentations.<a href="#section-2-3.16" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.17">Verifier:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.18">An entity that requests, receives, and validates Verifiable Presentations. During presentation of Credentials, Verifier acts as an OAuth 2.0 Client towards the Wallet that is acting as an OAuth 2.0 Authorization Server. The Verifier is a specific case of an OAuth 2.0 Client, just like Relying Party (RP) in <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>.<a href="#section-2-3.18" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.19">Issuer-Holder-Verifier Model:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.20">A model for exchanging claims, where claims are issued in the form of Verifiable Credentials independent of the process of presenting them as Verifiable Presentations to the Verifiers. An issued Verifiable Credential can be (but is not necessarily) used multiple times.<a href="#section-2-3.20" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.21">Holder Binding:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.22">Ability of the Holder to prove legitimate possession of a Verifiable Credential.<a href="#section-2-3.22" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.23">Cryptographic Holder Binding:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.24">Ability of the Holder to prove legitimate possession of a Verifiable Credential by proving control over the same private key during the issuance and presentation. Mechanism might depend on the Credential Format. For example, in <code>jwt_vc_json</code> Credential Format, a VC with Cryptographic Holder Binding contains a public key or a reference to a public key that corresponds to the private key controlled by the Holder.<a href="#section-2-3.24" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.25">Claim-based Holder Binding:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.26">Ability of the Holder to prove legitimate possession of a Verifiable Credential by proofing certain claims, e.g., name and date of birth, for example by presenting another Verifiable Credential. Claim-based Holder Binding allows long-term, cross-device use of a credential as it does not depend on cryptographic key material stored on a certain device. One example of such a Verifiable Credential could be a Diploma.<a href="#section-2-3.26" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.27">Biometrics-based Holder Binding:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.28">Ability of the Holder to prove legitimate possession of a Verifiable Credential by demonstrating a certain biometric trait, such as fingerprint or face. One example of a Verifiable Credential with Biometrics-based Holder Binding is a mobile driving license <span>[<a href="#ISO.18013-5" class="cite xref">ISO.18013-5</a>]</span>, which contains a portrait of the holder.<a href="#section-2-3.28" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.29">Wallet:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.30">An entity used by the Holder to receive, store, present, and manage Verifiable Credentials and key material. There is no single deployment model of a Wallet: Verifiable Credentials and keys can both be stored/managed locally, or by using a remote self-hosted service, or a remote third-party service. In the context of this specification, the Wallet acts as an OAuth 2.0 Authorization Server (see <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>) towards the Credential Verifier which acts as the OAuth 2.0 Client.<a href="#section-2-3.30" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.31">Deferred Credential Issuance:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.32">Issuance of Credentials not directly in the response to a Credential issuance request but following a period of time that can be used to perform certain offline business processes.<a href="#section-2-3.32" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="overview">
<section id="section-3">
      <h2 id="name-overview">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<div id="credential-issuer">
<section id="section-3.1">
        <h3 id="name-credential-issuer">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-credential-issuer" class="section-name selfRef">Credential Issuer</a>
        </h3>
<p id="section-3.1-1">This specification defines an API for credential issuance provided by a Credential Issuer. The API is comprised of the following endpoints:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.1-2.1">A mandatory Credential Endpoint from which Credentials can be issued (see <a href="#credential-endpoint" class="auto internal xref">Section 7</a>).<a href="#section-3.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.1-2.2">An optional Batch Credential Endpoint from which multiple Credentials can be issued in one request (see <a href="#batch-credential-endpoint" class="auto internal xref">Section 8</a>).<a href="#section-3.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.1-2.3">An optional Deferred Credential Endpoint to allow for the deferred delivery of credentials (see <a href="#deferred-credential-issuance" class="auto internal xref">Section 9</a>).<a href="#section-3.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.1-2.4">An optional mechanism for the Credential Issuer to make a Credential Offer to the Wallet to encourage the Wallet to start the issuance flow (see <a href="#credential_offer_endpoint" class="auto internal xref">Section 4</a>).<a href="#section-3.1-2.4" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.1-2.5">A mechanism for the Credential Issuer to publish metadata about the Credentials it is capable of issuing (see <a href="#credential-issuer-metadata" class="auto internal xref">Section 10.2</a>).<a href="#section-3.1-2.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.1-3">Both the Credential and the Batch Credential Endpoints have the (optional) ability to bind an issued Credential to certain cryptographic key material. Both requests therefore enable conveying proof of possession for the key material. Multiple key proof types are supported.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oauth-2-0">
<section id="section-3.2">
        <h3 id="name-oauth-20">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-oauth-20" class="section-name selfRef">OAuth 2.0</a>
        </h3>
<p id="section-3.2-1">Every Credential Issuer utilizes an OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> Authorization Server to authorize access. The same OAuth 2.0 Authorization Server can protect one or more Credential Issuers. Wallets determine the Credential Issuer's Authorization Server using the Credential Issuer's metadata (see <a href="#credential-issuer-metadata" class="auto internal xref">Section 10.2</a>).<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">All OAuth 2.0 Grant Types and extensions mechanisms can be used in conjunction with the credential issuance API. Aspects not defined in this specification are expected to follow <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">Existing OAuth 2.0 mechanisms are extended as following:<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2-4.1">A new Grant Type "Pre-Authorized Code" is defined to facilitate flows where the preparation of the credential issuance is conducted before the actual OAuth flow starts (see <a href="#pre-authz-code-flow" class="auto internal xref">Section 3.5</a>).<a href="#section-3.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.2-4.2">A new authorization details <span>[<a href="#RFC9396" class="cite xref">RFC9396</a>]</span> type <code>openid_credential</code> is defined to convey the details about the Credentials (including formats and types) the Wallet wants to obtain (see <a href="#authorization-details" class="auto internal xref">Section 5.1.1</a>).<a href="#section-3.2-4.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.2-4.3">New token response error codes <code>authorization_pending</code> and <code>slow_down</code> are added to allow for deferred authorization of credential issuance. These error codes are supported for the Pre-Authorized Code grant type.<a href="#section-3.2-4.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.2-4.4">Client metadata is used to convey Wallet's metadata. A new metadata parameter <code>credential_offer_endpoint</code> is added to allow a Wallet (acting as OAuth 2.0 Client) to publish its Credential Offer Endpoint (see <a href="#client-metadata" class="auto internal xref">Section 10.1</a>).<a href="#section-3.2-4.4" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.2-4.5">Authorization Endpoint: An additional parameter <code>issuer_state</code> is added to convey state in the context of processing an issuer-initiated Credential Offer (see <a href="#credential-authz-request" class="auto internal xref">Section 5.1</a>). Additional parameters <code>wallet_issuer</code> and <code>user_hint</code> are added to enable the Credential Issuer to request Verifiable Presentations from the calling Wallet during Authorization Request processing.<a href="#section-3.2-4.5" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.2-4.6">Token Endpoint: optional response parameters <code>c_nonce</code> and <code>c_nonce_expires_in</code> are added to the Token Endpoint, Credential Endpoint and Batch Credential Endpoint to provide the Client with a nonce to be used for proof of possession of key material in a subsequent request to the Credential Endpoint (see <a href="#token-response" class="auto internal xref">Section 6.2</a>).<a href="#section-3.2-4.6" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="core-concepts">
<section id="section-3.3">
        <h3 id="name-core-concepts">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-core-concepts" class="section-name selfRef">Core Concepts</a>
        </h3>
<p id="section-3.3-1">The Wallet sends one Credential Request per individual Credential to the Credential Endpoint. The Wallet MAY use the same Access Token to send multiple Credential Requests to request issuance of the following:<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.3-2.1">multiple Credentials of different types/doctypes bound to the same proof, or<a href="#section-3.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.3-2.2">multiple Credentials of the same type/doctype bound to different proofs, or<a href="#section-3.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.3-2.3">multiple Credentials of the different types/doctypes bound to different proofs.<a href="#section-3.3-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.3-3">Note: "type" and "doctype" are terms defined by an individual credential format. For details, see <a href="#format_profiles" class="auto internal xref">Appendix E</a>.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">The Wallet MAY send one Batch Credential Request to the Batch Credential Endpoint to request the following in the Batch Credential Response:<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.3-5.1">multiple Credentials of different types/doctypes bound to the same proof, or<a href="#section-3.3-5.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.3-5.2">multiple Credentials of the same type/doctype bound to different proofs, or<a href="#section-3.3-5.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.3-5.3">multiple Credentials of different types/doctypes bound to different proofs.<a href="#section-3.3-5.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.3-6">In the course of the authorization process, the Credential Issuer MAY also request Credential presentation as a means to authenticate or identify the End-User during the issuance flow, as illustrated in a use case in <a href="#use-case-2" class="auto internal xref">Appendix D.5</a>.<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<p id="section-3.3-7">At its core, this specification is Credential format agnostic and allows implementers to leverage specific capabilities of Credential formats of their choice. Multiple Credential formats can be used within the same transaction.<a href="#section-3.3-7" class="pilcrow">¶</a></p>
<p id="section-3.3-8">The specification achieves this by defining the following:<a href="#section-3.3-8" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.3-9.1">Extension points to add Credential format specific parameters or claims in the Credential Issuer metadata, Credential Offer, Authorization Request, Credential Request and Batch Credential Request,<a href="#section-3.3-9.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.3-9.2">Credential format identifiers to identify Credential format specific set of parameters and claims to be applied at each extension point. This set of Credential format specific set of parameters and claims is referred to as a "Credential Format Profile" in this specification.<a href="#section-3.3-9.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.3-10">This specification defines Credential Format Profiles for W3C Verifiable Credentials as defined in <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span> and ISO/IEC 18013-5 mDL as defined in <span>[<a href="#ISO.18013-5" class="cite xref">ISO.18013-5</a>]</span> in <a href="#format_profiles" class="auto internal xref">Appendix E</a> that contain Credential Format specific parameters to be included at each extension point defined in this specification. Other specifications or deployments can define their own Credential Format Profiles using the above-mentioned extension points.<a href="#section-3.3-10" class="pilcrow">¶</a></p>
<p id="section-3.3-11">The issuance can have multiple characteristics, which can be combined depending on the use cases:<a href="#section-3.3-11" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.3-12.1">Authorization Code Flow or Pre-Authorized Code Flow: The Credential Issuer can obtain End-User information to turn into a Verifiable Credential using End-User authentication and consent at the Credential Issuer's Authorization Endpoint (Authorization Code Flow) or using out-of-band mechanisms outside of the issuance flow (Pre-Authorized Code Flow).<a href="#section-3.3-12.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.3-12.2">Wallet initiated or Issuer initiated: The request from the Wallet can be sent to the Credential Issuer without any gesture from the Credential Issuer (Wallet Initiated) or following the communication from the Credential Issuer (Issuer Initiated).<a href="#section-3.3-12.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.3-12.3">Same-device or Cross-device Credential Offer: The End-User may receive the Credential Offer from the Credential Issuer either on the same device as the device the Wallet resides on, or through any other means, such as another device or physical mail, so that the Credential Offer can be communicated to the Wallet.<a href="#section-3.3-12.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.3-12.4">Immediate or Deferred: The Credential Issuer can issue the Credential directly in response to the Credential Request (immediate) or requires time and needs the Wallet to come back to retrieve Credential (deferred).<a href="#section-3.3-12.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.3-13">The following subsections illustrate some of the authorization flows supported by this specification.<a href="#section-3.3-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authorization-code-flow">
<section id="section-3.4">
        <h3 id="name-authorization-code-flow">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-authorization-code-flow" class="section-name selfRef">Authorization Code Flow</a>
        </h3>
<p id="section-3.4-1">Below is a diagram of a Credential issuance using the Authorization Code Flow, using grant type <code>authorization_code</code> as defined in <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">The diagram shows how a Wallet-initiated flow use case as described in <a href="#use-case-1" class="auto internal xref">Appendix D.4</a> is implemented with the Credential Issuance API defined in this specification. Note that the diagram does not illustrate all the optional features of this specification.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<span id="name-issuance-using-authorizatio"></span><figure id="figure-1">
          <div class="lang-ascii-art sourcecode" id="section-3.4-3.1">
<pre>+--------------+   +-----------+                                    +-------------------+
| User         |   |   Wallet  |                                    | Credential Issuer |
+--------------+   +-----------+                                    +-------------------+
        |                |                                                    |
        |    interacts   |                                                    |
        |---------------&gt;|                                                    |
        |                |  (1) Obtains Issuer's Credential Issuer metadata   |
        |                |&lt;--------------------------------------------------&gt;|
        |                |                                                    |
        |                |  (2) Authorization Request                         |
        |                |      (type(s) of Credentials to be issued)         |
        |                |---------------------------------------------------&gt;|
        |                |                                                    |
        |   User Authentication / Consent                                     |
        |                |                                                    |
        |                |  (3)   Authorization Response (code)               |
        |                |&lt;---------------------------------------------------|
        |                |                                                    |
        |                |  (4) Token Request (code)                          |
        |                |---------------------------------------------------&gt;|
        |                |      Token Response (access_token)                 |
        |                |&lt;---------------------------------------------------|
        |                |                                                    |
        |                |  (5) Credential Request (access_token, proof(s))   |
        |                |---------------------------------------------------&gt;|
        |                |      Credential Response                           |
        |                |      (credential(s) OR transaction_id)           |
        |                |&lt;---------------------------------------------------|
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-issuance-using-authorizatio" class="selfRef">Issuance using Authorization Code Flow</a>
          </figcaption></figure>
<p id="section-3.4-4">(1) The Wallet uses the Credential Issuer's metadata as described in <a href="#credential-issuer-metadata" class="auto internal xref">Section 10.2</a> to learn what credential types and formats the Credential Issuer supports and to determine the issuer URL of the OAuth 2.0 Authorization Server the Credential Issuer relies on. Note in this example, the Credential Issuer also provides the OAuth 2.0 Authorization Server. This specification enables deployments where the Credential Issuer API and the Authorization Server are different services, perhaps even provided by different entities.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<p id="section-3.4-5">(2) The Wallet sends an Authorization Request to the Authorization Endpoint. The Authorization Endpoint processes the Authorization Request, which typically includes End-User authentication and gathering of End-User consent.<a href="#section-3.4-5" class="pilcrow">¶</a></p>
<p id="section-3.4-6">(3) The Authorization Endpoint returns an Authorization Response with the Authorization Code upon successfully processing the Authorization Request.<a href="#section-3.4-6" class="pilcrow">¶</a></p>
<p id="section-3.4-7">Note: Steps (2) and (3) happen in the front channel, by redirecting the End-User via the User Agent. Those steps are defined in <a href="#authorization_endpoint" class="auto internal xref">Section 5</a>.<a href="#section-3.4-7" class="pilcrow">¶</a></p>
<p id="section-3.4-8">(4) The Wallet sends a Token Request to the Token Endpoint with the Authorization Code obtained in step (3). The Token Endpoint returns an Access Token in the Token Response upon successfully validating Authorization Code. This step happens in the back-channel communication (direct communication between two systems using HTTP requests and responses without using redirects through an intermediary such as a browser). This step is defined in <a href="#token_endpoint" class="auto internal xref">Section 6</a>.<a href="#section-3.4-8" class="pilcrow">¶</a></p>
<p id="section-3.4-9">(5) The Wallet sends a Credential Request to the Credential Issuer's Credential Endpoint with the Access Token and (optionally) the proof of possession of the public key to which the issued VC shall be bound to. Upon successfully validating Access Token and proof, the Credential Issuer returns a VC in the Credential Response if it can issue a Credential right away. This step is defined in <a href="#credential-endpoint" class="auto internal xref">Section 7</a>.<a href="#section-3.4-9" class="pilcrow">¶</a></p>
<p id="section-3.4-10">If the Credential Issuer requires more time to issue a Credential, the Credential Issuer MAY return a <code>transaction_id</code> to the Wallet with information about when the Wallet can start sending a Deferred Credential Request to obtain an issued Credential, as defined in <a href="#deferred-credential-issuance" class="auto internal xref">Section 9</a>.<a href="#section-3.4-10" class="pilcrow">¶</a></p>
<p id="section-3.4-11">If the Credential Issuer wants to issue multiple Credentials in one response, the Credential Issuer MAY support the Batch Credential Endpoint and the Wallet MAY send a Batch Credential Request to the Batch Credential Endpoint as defined in <a href="#batch-credential-endpoint" class="auto internal xref">Section 8</a>.<a href="#section-3.4-11" class="pilcrow">¶</a></p>
<p id="section-3.4-12">With grant type <code>authorization_code</code>, it is RECOMMENDED to use PKCE as defined in <span>[<a href="#RFC7636" class="cite xref">RFC7636</a>]</span> to prevent authorization code interception attacks and Pushed Authorization Requests <span>[<a href="#RFC9126" class="cite xref">RFC9126</a>]</span> to ensure integrity and authenticity of the authorization request.<a href="#section-3.4-12" class="pilcrow">¶</a></p>
<p id="section-3.4-13">Note: This flow is based on OAuth 2.0 and the Authorization Code Grant type, but this specification can be used with other OAuth 2.0 grant types as well.<a href="#section-3.4-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pre-authz-code-flow">
<section id="section-3.5">
        <h3 id="name-pre-authorized-code-flow">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-pre-authorized-code-flow" class="section-name selfRef">Pre-Authorized Code Flow</a>
        </h3>
<p id="section-3.5-1">Figure 2 is a diagram of a Credential issuance using the Pre-Authorized Code Flow. In this flow, before initiating the flow with the Wallet, the Credential Issuer first conducts the steps required to prepare the Credential issuance, e.g., End-User authentication and authorization. Consequently, the Pre-Authorized Code is sent by the Credential Issuer to the Wallet. This flow does not use the Authorization Endpoint, and The Wallet exchanges the Pre-Authorized Code for the Access Token directly at the Token Endpoint. Access Token is then used to request Credential issuance at the Credential Endpoint. See <a href="#use-case-4" class="auto internal xref">Appendix D.2</a> for a use case.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">How the End-User provides information required for the issuance of a requested Credential to the Credential Issuer and the business processes conducted by the Credential Issuer to prepare a Credential are out of scope of this specification.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<p id="section-3.5-3">This flow uses the newly defined OAuth 2.0 Grant Type "urn:ietf:params:oauth:grant-type:pre-authorized_code".<a href="#section-3.5-3" class="pilcrow">¶</a></p>
<p id="section-3.5-4">The diagram is based on a Credential Issuer initiated flow illustrated in a use case in <a href="#use-case-4" class="auto internal xref">Appendix D.2</a> and does not illustrate all the optional features.<a href="#section-3.5-4" class="pilcrow">¶</a></p>
<span id="name-issuance-using-pre-authoriz"></span><figure id="figure-2">
          <div class="lang-ascii-art sourcecode" id="section-3.5-5.1">
<pre>+--------------+   +-----------+                                    +-------------------+
| User         |   |   Wallet  |                                    | Credential Issuer |
+--------------+   +-----------+                                    +-------------------+
        |                |                                                    |
        |                |  (1) User provides  information required           |
        |                |      for the issuance of a certain Credential      |
        |--------------------------------------------------------------------&gt;|
        |                |                                                    |
        |                |  (2) Credential Offer (Pre-Authorized Code)        |
        |                |&lt;---------------------------------------------------|
        |                |  (3) Obtains Issuer's Credential Issuer metadata   |
        |                |&lt;--------------------------------------------------&gt;|
        |   interacts    |                                                    |
        |---------------&gt;|                                                    |
        |                |                                                    |
        |                |  (4) Token Request (Pre-Authorized Code, pin)      |
        |                |---------------------------------------------------&gt;|
        |                |      Token Response (access_token)                 |
        |                |&lt;---------------------------------------------------|
        |                |                                                    |
        |                |  (5) Credential Request (access_token, proof(s))   |
        |                |---------------------------------------------------&gt;|
        |                |      Credential Response                           |
        |                |      (credential(s))                               |
        |                |&lt;---------------------------------------------------|
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-issuance-using-pre-authoriz" class="selfRef">Issuance using Pre-Authorized Code Flow</a>
          </figcaption></figure>
<p id="section-3.5-6">(1) The Credential Issuer successfully obtains consent and End-User data required for the issuance of a requested Credential from the End-User using Issuer-specific business process.<a href="#section-3.5-6" class="pilcrow">¶</a></p>
<p id="section-3.5-7">(2) The flow defined in this specification begins as the Credential Issuer generates a Credential Offer for certain Credential(s) and communicates it to the Wallet, for example, as a QR code or as a link.<a href="#section-3.5-7" class="pilcrow">¶</a></p>
<p id="section-3.5-8">(3) The Wallet uses information from the Credential Offer to obtain the Credential Issuer's metadata including details about the Credential that this Credential Issuer wants to issue. This step is defined in <a href="#credential-issuer-metadata" class="auto internal xref">Section 10.2</a>.<a href="#section-3.5-8" class="pilcrow">¶</a></p>
<p id="section-3.5-9">(4) The Wallet sends the Pre-Authorized Code obtained in step (2) in the Token Request to the Token Endpoint. The Wallet will send a PIN provided by the User, if it was required by the Credential Issuer. This step is defined in <a href="#token_endpoint" class="auto internal xref">Section 6</a>.<a href="#section-3.5-9" class="pilcrow">¶</a></p>
<p id="section-3.5-10">(5) This step is the same as Step 5 in the Authorization Code Flow.<a href="#section-3.5-10" class="pilcrow">¶</a></p>
<p id="section-3.5-11">It is important to note that anyone who possesses a valid Pre-Authorized Code, without further security measures, would be able to receive a VC from the Credential Issuer. Implementers MUST implement mitigations most suitable to the use case.<a href="#section-3.5-11" class="pilcrow">¶</a></p>
<p id="section-3.5-12">One such mechanism defined in this specification is the usage of PIN. If in the Credential Offer the Credential Issuer indicated that the PIN is required, the End-User is requested to type in a PIN sent via a channel different than the issuance Flow and the PIN is sent to the Credential Issuer in the Token Request.<a href="#section-3.5-12" class="pilcrow">¶</a></p>
<p id="section-3.5-13">For more details and concrete mitigations, see <a href="#security_considerations_pre-authz-code" class="auto internal xref">Section 11.3</a>.<a href="#section-3.5-13" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="credential_offer_endpoint">
<section id="section-4">
      <h2 id="name-credential-offer-endpoint">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-credential-offer-endpoint" class="section-name selfRef">Credential Offer Endpoint</a>
      </h2>
<p id="section-4-1">This endpoint is used by a Credential Issuer in case it is already in an interaction with the End-User that wishes to initiate a Credential issuance. It is used to pass available information relevant for the Credential issuance to ensure a convenient and secure process.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="credential_offer">
<section id="section-4.1">
        <h3 id="name-credential-offer">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-credential-offer" class="section-name selfRef">Credential Offer</a>
        </h3>
<p id="section-4.1-1">The Credential Issuer sends Credential Offer as an HTTP GET request or an HTTP redirect to the Wallet's Credential Offer Endpoint defined in <a href="#client-metadata" class="auto internal xref">Section 10.1</a>.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">The Credential Offer object, which is a JSON-encoded object with the Credential Offer parameters, can be sent by value or by reference.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">The Credential Offer contains a single URI query parameter <code>credential_offer</code> or <code>credential_offer_uri</code>:<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1-4.1">
            <code>credential_offer</code>: A JSON-encoded object with the Credential Offer parameters. This MUST NOT be present when <code>credential_offer_uri</code> parameter is present.<a href="#section-4.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.1-4.2">
            <code>credential_offer_uri</code>: A URL using the <code>https</code> scheme referencing a resource containing a JSON-encoded object with the Credential Offer parameters. This MUST NOT be present when <code>credential_offer</code> parameter is present.<a href="#section-4.1-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.1-5">The Credential Issuer MAY render a QR code containing the Credential Offer that can be scanned by the End-User using a Wallet, or a link that the End-User can click.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">For security considerations, see <a href="#credential-offer-security" class="auto internal xref">Section 11.2</a>.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<div id="credential_offer_parameters">
<section id="section-4.1.1">
          <h4 id="name-credential-offer-parameters">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-credential-offer-parameters" class="section-name selfRef">Credential Offer Parameters</a>
          </h4>
<p id="section-4.1.1-1">This specification defines the following parameters for the JSON-encoded Credential Offer object:<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1.1-2.1">
              <code>credential_issuer</code>: REQUIRED. The URL of the Credential Issuer, as defined in <a href="#credential-issuer-identifier" class="auto internal xref">Section 10.2.1</a>, from which the Wallet is requested to obtain one or more Credentials. The Wallet uses it to obtain the Credential Issuer's Metadata following the steps defined in <a href="#credential-issuer-wellknown" class="auto internal xref">Section 10.2.2</a>.<a href="#section-4.1.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-4.1.1-2.2">
              <code>credentials</code>: REQUIRED. An array of unique strings that each identify one of the keys in the name/value pairs stored in the <code>credentials_supported</code> Credential Issuer metadata property. The Wallet uses this string value to obtain the respective object that contains information about the Credential being offered as defined in <a href="#credential-issuer-parameters" class="auto internal xref">Section 10.2.3</a>. For example, this string value can be used to obtain <code>scope</code> value to be used in the Authorization Request.<a href="#section-4.1.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-4.1.1-2.3">
              <code>grants</code>: OPTIONAL. An object indicating to the Wallet the Grant Types the Credential Issuer's AS is prepared to process for this Credential Offer. Every grant is represented by a name/value pair. The name is the Grant Type identifier; the value is an object that contains parameters either determining the way the Wallet MUST use the particular grant and/or parameters the Wallet MUST send with the respective request(s). If <code>grants</code> is not present or empty, the Wallet MUST determine the Grant Types the Credential Issuer's AS supports using the respective metadata. When multiple grants are present, it is at the Wallet's discretion which one to use.<a href="#section-4.1.1-2.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.1.1-3">The following values are defined by this specification:<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1.1-4.1">
              <p id="section-4.1.1-4.1.1">Grant Type <code>authorization_code</code>:<a href="#section-4.1.1-4.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1.1-4.1.2.1">
                  <code>issuer_state</code>: OPTIONAL. String value created by the Credential Issuer and opaque to the Wallet that is used to bind the subsequent Authorization Request with the Credential Issuer to a context set up during previous steps. If the Wallet decides to use the Authorization Code Flow and received a value for this parameter, it MUST include it in the subsequent Authorization Request to the Credential Issuer as the <code>issuer_state</code> parameter value.<a href="#section-4.1.1-4.1.2.1" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-4.1.1-4.1.2.2">
                  <code>authorization_server</code>: OPTIONAL string that the Wallet can use to identify the Authorization Server to use with this grant type when <code>authorization_servers</code> parameter in the Credential Issuer metadata has multiple entries. MUST NOT be used otherwise. The value of this parameter MUST match with one of the values in the <code>authorization_servers</code> array obtained from the Credential Issuer metadata.<a href="#section-4.1.1-4.1.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="compact" id="section-4.1.1-4.2">
              <p id="section-4.1.1-4.2.1">Grant Type <code>urn:ietf:params:oauth:grant-type:pre-authorized_code</code>:<a href="#section-4.1.1-4.2.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1.1-4.2.2.1">
                  <code>pre-authorized_code</code>: REQUIRED. The code representing the Credential Issuer's authorization for the Wallet to obtain Credentials of a certain type. This code MUST be short lived and single use. If the Wallet decides to use the Pre-Authorized Code Flow, this parameter value MUST be included in the subsequent Token Request with the Pre-Authorized Code Flow.<a href="#section-4.1.1-4.2.2.1" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-4.1.1-4.2.2.2">
                  <code>user_pin_required</code>: OPTIONAL. Boolean value specifying whether the AS expects presentation of the End-User PIN along with the Token Request in a Pre-Authorized Code Flow. Default is <code>false</code>. This PIN is intended to bind the Pre-Authorized Code to a certain transaction to prevent replay of this code by an attacker that, for example, scanned the QR code while standing behind the legitimate End-User. It is RECOMMENDED to send a PIN via a separate channel. If the Wallet decides to use the Pre-Authorized Code Flow, a PIN value MUST be sent in the <code>user_pin</code> parameter with the respective Token Request.<a href="#section-4.1.1-4.2.2.2" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-4.1.1-4.2.2.3">
                  <code>interval</code>: OPTIONAL. The minimum amount of time in seconds that the Wallet SHOULD wait between polling requests to the token endpoint (in case the Authorization Server responds with error code <code>authorization_pending</code> - see <a href="#token_error_response" class="auto internal xref">Section 6.3</a>). If no value is provided, Wallets MUST use <code>5</code> as the default.<a href="#section-4.1.1-4.2.2.3" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-4.1.1-4.2.2.4">
                  <code>authorization_server</code>: OPTIONAL string that the Wallet can use to identify the Authorization Server to use with this grant type when <code>authorization_servers</code> parameter in the Credential Issuer metadata has multiple entries. MUST NOT be used otherwise. The value of this parameter MUST match with one of the values in the <code>authorization_servers</code> array obtained from the Credential Issuer metadata.<a href="#section-4.1.1-4.2.2.4" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-4.1.1-5">The following non-normative example shows a Credential Offer object where the Credential Issuer can offer the issuance of two Credentials of different formats, one as a string ("UniversityDegree_JWT") and the other one as an object:<a href="#section-4.1.1-5" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-4.1.1-6">
<pre>{
   "credential_issuer": "https://credential-issuer.example.com",
   "credentials": [
      "UniversityDegreeCredential",
      "org.iso.18013.5.1.mDL"
   ],
   "grants": {
      "authorization_code": {
         "issuer_state": "eyJhbGciOiJSU0Et...FYUaBy"
      },
      "urn:ietf:params:oauth:grant-type:pre-authorized_code": {
         "pre-authorized_code": "adhjhdjajkdkhjhdj",
         "user_pin_required": true
      }
   }
}
</pre><a href="#section-4.1.1-6" class="pilcrow">¶</a>
</div>
<p id="section-4.1.1-7">Note: The examples throughout the specification use Credential Format specific parameters defined in the Credential Format Profiles that can be found in <a href="#format_profiles" class="auto internal xref">Appendix E</a>.<a href="#section-4.1.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sending-credential-offer-by-value-using-credential-offer-parameter">
<section id="section-4.1.2">
          <h4 id="name-sending-credential-offer-by">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-sending-credential-offer-by" class="section-name selfRef">Sending Credential Offer by Value Using <code>credential_offer</code> Parameter</a>
          </h4>
<p id="section-4.1.2-1">Below is a non-normative example of a Credential Offer passed by value:<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.2-2">
<pre>  GET /credential_offer?credential_offer=%7B%22credential_issuer%22:%22
  https://credential-issuer.example.com%22,%22credentials%22:%5B%22UniversityDegree_JWT
  %22,%7B%22format%22:%22mso_mdoc%22,%22doctype%22:%22org.iso.18013.5.1.mDL%22%7D%5D,%22
  grants%22:%7B%22authorization_code%22:%7B%22issuer_state%22:%22eyJhbGciOiJSU0Et...FYUaBy
  %22%7D,%22urn:ietf:params:oauth:grant-type:pre-authorized_code%22:%7B%22
  pre-authorized_code%22:%22adhjhdjajkdkhjhdj%22,%22user_pin_required%22:true%7D%7D%7D
</pre><a href="#section-4.1.2-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1.2-3">The following is a non-normative example of a Credential Offer that can be included in a QR code or a link used to invoke a Wallet deployed as a native app:<a href="#section-4.1.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.2-4">
<pre>openid-credential-offer://?credential_offer=%7B%22credential_issuer%22:%22
  https://credential-issuer.example.com%22,%22credentials%22:%5B%22UniversityDegree_JWT
  %22,%7B%22format%22:%22mso_mdoc%22,%22doctype%22:%22org.iso.18013.5.1.mDL%22%7D%5D,%22
  grants%22:%7B%22authorization_code%22:%7B%22issuer_state%22:%22eyJhbGciOiJSU0Et...FYUaBy
  %22%7D,%22urn:ietf:params:oauth:grant-type:pre-authorized_code%22:%7B%22
  pre-authorized_code%22:%22adhjhdjajkdkhjhdj%22,%22user_pin_required%22:true%7D%7D%7D
</pre><a href="#section-4.1.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sending-credential-offer-by-reference-using-credential-offer-uri-parameter">
<section id="section-4.1.3">
          <h4 id="name-sending-credential-offer-by-">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-sending-credential-offer-by-" class="section-name selfRef">Sending Credential Offer by Reference Using <code>credential_offer_uri</code> Parameter</a>
          </h4>
<p id="section-4.1.3-1">Upon receipt of the <code>credential_offer_uri</code>, the Wallet MUST send an HTTP GET request to URI to retrieve the referenced Credential Offer Object, unless it is already cached, and parse it to recreate the Credential Offer parameters.<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
<p id="section-4.1.3-2">Note: The Credential Issuer SHOULD use a unique URI for each Credential Offer utilizing distinct parameters, or otherwise prevent the Credential Issuer from caching the <code>credential_offer_uri</code>.<a href="#section-4.1.3-2" class="pilcrow">¶</a></p>
<p id="section-4.1.3-3">Below is a non-normative example of this fetch process:<a href="#section-4.1.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.3-4">
<pre>GET /credential_offer HTTP/1.1
Host: server.example.com
</pre><a href="#section-4.1.3-4" class="pilcrow">¶</a>
</div>
<p id="section-4.1.3-5">Response from the Credential Issuer that contains a Credential Offer Object MUST have the media type "application/json".<a href="#section-4.1.3-5" class="pilcrow">¶</a></p>
<p id="section-4.1.3-6">This ability to pass Credential Offer by reference is particularly useful for large requests.<a href="#section-4.1.3-6" class="pilcrow">¶</a></p>
<p id="section-4.1.3-7">Below is a non-normative example of the Credential Offer displayed by the Credential Issuer as a QR code when the Credential Offer is passed by reference:<a href="#section-4.1.3-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.3-8">
<pre>openid-credential-offer://?
  credential_offer_uri=https%3A%2F%2Fserver%2Eexample%2Ecom%2Fcredential-offer.json
</pre><a href="#section-4.1.3-8" class="pilcrow">¶</a>
</div>
<p id="section-4.1.3-9">Below is a non-normative example of a response from the Credential Issuer that contains a Credential Offer Object used to encourage the Wallet to start an Authorization Code Flow:<a href="#section-4.1.3-9" class="pilcrow">¶</a></p>
<div class="lang-txt sourcecode" id="section-4.1.3-10">
<pre>HTTP/1.1 200 OK
Content-Type: application/json

{
    "credential_issuer": "https://credential-issuer.example.com",
    "credentials": [
        "UniversityDegreeCredential"
    ],
    "grants": {
        "authorization_code": {
            "issuer_state": "eyJhbGciOiJSU0Et...FYUaBy"
        }
    }
}
</pre><a href="#section-4.1.3-10" class="pilcrow">¶</a>
</div>
<p id="section-4.1.3-11">Below is a non-normative example of a Credential Offer Object for a Pre-Authorized Code Flow (with a credential type reference):<a href="#section-4.1.3-11" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-4.1.3-12">
<pre>{
   "credential_issuer": "https://credential-issuer.example.com",
   "credentials": [
      "UniversityDegree_LDP_VC"
   ],
   "grants": {
      "urn:ietf:params:oauth:grant-type:pre-authorized_code": {
          "pre-authorized_code": "adhjhdjajkdkhjhdj",
          "user_pin_required": true
      }
  }
}
</pre><a href="#section-4.1.3-12" class="pilcrow">¶</a>
</div>
<p id="section-4.1.3-13">When retrieving Credential Offer from the Credential Offer URL, <code>application/json</code> media type MUST be used. The Credential Offer cannot be signed and MUST NOT use <code>application/jwt</code> with <code>"alg": "none"</code>.<a href="#section-4.1.3-13" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="credential-offer-response">
<section id="section-4.2">
        <h3 id="name-credential-offer-response">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-credential-offer-response" class="section-name selfRef">Credential Offer Response</a>
        </h3>
<p id="section-4.2-1">The Wallet is not supposed to create a response. UX control stays with the Wallet after completion of the process.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="authorization_endpoint">
<section id="section-5">
      <h2 id="name-authorization-endpoint">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-authorization-endpoint" class="section-name selfRef">Authorization Endpoint</a>
      </h2>
<p id="section-5-1">The Authorization Endpoint is used in the same manner as defined in <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, taking into account the recommendations given in <span>[<a href="#I-D.ietf-oauth-security-topics" class="cite xref">I-D.ietf-oauth-security-topics</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="credential-authz-request">
<section id="section-5.1">
        <h3 id="name-authorization-request">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-authorization-request" class="section-name selfRef">Authorization Request</a>
        </h3>
<p id="section-5.1-1">An Authorization Request is an OAuth 2.0 Authorization Request as defined in section 4.1.1 of <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, which requests to grant access to the Credential Endpoint as defined in <a href="#credential-endpoint" class="auto internal xref">Section 7</a>.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">There are two possible ways to request issuance of a specific Credential type in an Authorization Request. One way is to use of the <code>authorization_details</code> request parameter as defined in <span>[<a href="#RFC9396" class="cite xref">RFC9396</a>]</span> with one or more authorization details objects of type <code>openid_credential</code>, per <a href="#authorization-details" class="auto internal xref">Section 5.1.1</a>. The other is through the use of scopes as defined in <a href="#credential-request-using-type-specific-scope" class="auto internal xref">Section 5.1.2</a>.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<div id="authorization-details">
<section id="section-5.1.1">
          <h4 id="name-request-issuance-of-a-certa">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-request-issuance-of-a-certa" class="section-name selfRef">Request Issuance of a Certain Credential Type using <code>authorization_details</code> Parameter</a>
          </h4>
<p id="section-5.1.1-1">The request parameter <code>authorization_details</code> defined in Section 2 of <span>[<a href="#RFC9396" class="cite xref">RFC9396</a>]</span> MUST be used to convey the details about the Credentials the Wallet wants to obtain. This specification introduces a new authorization details type <code>openid_credential</code> and defines the following parameters to be used with this authorization details type:<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.1.1-2.1">
              <code>type</code> REQUIRED. String that determines the authorization details type. MUST be set to <code>openid_credential</code> for the purpose of this specification.<a href="#section-5.1.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5.1.1-2.2">
              <code>format</code>: REQUIRED. String representing the format in which the Credential is requested to be issued. This Credential format identifier determines further claims in the authorization details object specifically used to identify the Credential type to be issued. This specification defines Credential Format Profiles in <a href="#format_profiles" class="auto internal xref">Appendix E</a>.<a href="#section-5.1.1-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.1.1-3">The following is a non-normative example of an <code>authorization_details</code> object:<a href="#section-5.1.1-3" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-5.1.1-4">
<pre>[
   {
      "type": "openid_credential",
      "format": "jwt_vc_json",
      "credential_definition": {
         "type": [
            "VerifiableCredential",
            "UniversityDegreeCredential"
         ]
      }
   }
]
</pre><a href="#section-5.1.1-4" class="pilcrow">¶</a>
</div>
<p id="section-5.1.1-5">If the Credential Issuer metadata contains an <code>authorization_servers</code> parameter, the authorization detail's <code>locations</code> common data field MUST be set to the Credential Issuer Identifier value. A non-normative example for a deployment where an AS protects multiple Credential Issuers would look like this:<a href="#section-5.1.1-5" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-5.1.1-6">
<pre>[
   {
      "type": "openid_credential",
      "locations": [
         "https://credential-issuer.example.com"
      ],
      "format": "jwt_vc_json",
      "credential_definition": {
         "type": [
            "VerifiableCredential",
            "UniversityDegreeCredential"
         ]
      }
   }
]
</pre><a href="#section-5.1.1-6" class="pilcrow">¶</a>
</div>
<p id="section-5.1.1-7">Below is a non-normative example of an Authorization Request using the <code>authorization_details</code> parameter that would be sent by the User Agent to the Authorization Server in response to an HTTP 302 redirect response by the Wallet (with line wraps within values for display purposes only):<a href="#section-5.1.1-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.1-8">
<pre>GET /authorize?
  response_type=code
  &amp;client_id=s6BhdRkqt3
  &amp;code_challenge=E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM
  &amp;code_challenge_method=S256
  &amp;authorization_details=%5B%7B%22type%22%3A+%22openid_credential%22
    %2C+%22format%22%3A+%22jwt_vc_json%22%2C+%22credential_definition
    %22%3A+%7B%22type%22%3A+%5B%22VerifiableCredential%22%2C+%22Unive
    rsityDegreeCredential%22%5D%7D%7D%5D
  &amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb

Host: https://server.example.com
</pre><a href="#section-5.1.1-8" class="pilcrow">¶</a>
</div>
<p id="section-5.1.1-9">This non-normative example requests authorization to issue two different Credentials:<a href="#section-5.1.1-9" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-5.1.1-10">
<pre>[
   {
      "type":"openid_credential",
      "format": "ldp_vc",
      "credential_definition": {
         "@context": [
            "https://www.w3.org/2018/credentials/v1",
            "https://www.w3.org/2018/credentials/examples/v1"
         ],
         "type": [
            "VerifiableCredential",
            "UniversityDegreeCredential"
         ]
      }
   },
   {
      "type":"openid_credential",
      "format": "mso_mdoc",
      "doctype":"org.iso.18013.5.1.mDL"
   }
]
</pre><a href="#section-5.1.1-10" class="pilcrow">¶</a>
</div>
<p id="section-5.1.1-11">Note: Applications MAY combine authorization details of type <code>openid_credential</code> with any other authorization details type in an Authorization Request.<a href="#section-5.1.1-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credential-request-using-type-specific-scope">
<section id="section-5.1.2">
          <h4 id="name-using-scope-parameter-to-re">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-using-scope-parameter-to-re" class="section-name selfRef">Using <code>scope</code> Parameter to Request Issuance of a Credential</a>
          </h4>
<p id="section-5.1.2-1">In addition to a mechanism defined in <a href="#credential-authz-request" class="auto internal xref">Section 5.1</a>, Credential Issuers MAY support requesting authorization to issue a credential using OAuth 2.0 scope parameter.<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<p id="section-5.1.2-2">When the Wallet does not know which scope value to use to request issuance of a certain credential, it can discover it using the <code>scope</code> Credential Issuer metadata parameter defined in <a href="#credential-issuer-parameters" class="auto internal xref">Section 10.2.3</a>. When the flow starts with a Credential Offer, the Wallet can use the <code>credentials</code> parameter values to identify object(s) in the <code>credentials_supported</code> map in the Credential Issuer metadata parameter and use <code>scope</code> parameter value from that object.<a href="#section-5.1.2-2" class="pilcrow">¶</a></p>
<p id="section-5.1.2-3">The Wallet can discover the scope values using other options such as normative text in a profile of this specification that defines scope values along with a description of their semantics.<a href="#section-5.1.2-3" class="pilcrow">¶</a></p>
<p id="section-5.1.2-4">The concrete scope values are out of scope of this specification.<a href="#section-5.1.2-4" class="pilcrow">¶</a></p>
<p id="section-5.1.2-5">The Wallet MAY combine scopes discovered from the Credential Issuer metadata with the scopes discovered from the Authorization Server metadata.<a href="#section-5.1.2-5" class="pilcrow">¶</a></p>
<p id="section-5.1.2-6">It is RECOMMENDED to use collision-resistant scope values.<a href="#section-5.1.2-6" class="pilcrow">¶</a></p>
<p id="section-5.1.2-7">Credential Issuers MUST interpret each scope value as a request to access the Credential Endpoint as defined in <a href="#credential-endpoint" class="auto internal xref">Section 7</a> for the issuance of a Credential type identified by that scope value. Multiple scope values MAY be present in a single request whereby each
occurrence MUST be interpreted individually.<a href="#section-5.1.2-7" class="pilcrow">¶</a></p>
<p id="section-5.1.2-8">Credential Issuers MUST ignore unknown scope values in a request.<a href="#section-5.1.2-8" class="pilcrow">¶</a></p>
<p id="section-5.1.2-9">If the Credential Issuer metadata contains an <code>authorization_servers</code> property, it is RECOMMENDED to use a <code>resource</code> parameter <span>[<a href="#RFC8707" class="cite xref">RFC8707</a>]</span> whose value is the Credential Issuer's identifier value to allow the AS to differentiate Credential Issuers.<a href="#section-5.1.2-9" class="pilcrow">¶</a></p>
<p id="section-5.1.2-10">Below is a non-normative example of an Authorization Request provided by the Wallet to the Authorization Server using the scope <code>UniversityDegree_JWT</code> and in response to an HTTP 302 redirect. The line wraps within the values are intended for display purposes only:<a href="#section-5.1.2-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.2-11">
<pre>GET /authorize?
  response_type=code
  &amp;scope=UniversityDegreeCredential
  &amp;resource=https://credential-issuer.example.com
  &amp;client_id=s6BhdRkqt3
  &amp;code_challenge=E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM
  &amp;code_challenge_method=S256
  &amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
Host: https://server.example.com
</pre><a href="#section-5.1.2-11" class="pilcrow">¶</a>
</div>
<p id="section-5.1.2-12">If a scope value related to credential issuance and the <code>authorization_details</code> request parameter containing objects of type <code>openid_credential</code> are both present in a single request, the Credential Issuer MUST interpret these individually. However, if both request the same Credential type, then the Credential Issuer MUST follow the request as given by the authorization details object.<a href="#section-5.1.2-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="additional-request-parameters">
<section id="section-5.1.3">
          <h4 id="name-additional-request-paramete">
<a href="#section-5.1.3" class="section-number selfRef">5.1.3. </a><a href="#name-additional-request-paramete" class="section-name selfRef">Additional Request Parameters</a>
          </h4>
<p id="section-5.1.3-1">This specification defines the following request parameters that can be supplied in an Authorization Request:<a href="#section-5.1.3-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.1.3-2.1">
              <code>wallet_issuer</code>: OPTIONAL. String containing the Wallet's identifier. The Credential Issuer can use the discovery process defined in <span>[<a href="#SIOPv2" class="cite xref">SIOPv2</a>]</span> to determine the Wallet's capabilities and endpoints, using <code>wallet_issuer</code> value as an Issuer Identifier referred to in <span>[<a href="#SIOPv2" class="cite xref">SIOPv2</a>]</span>. This is RECOMMENDED in Dynamic Credential Requests.<a href="#section-5.1.3-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5.1.3-2.2">
              <code>user_hint</code>: OPTIONAL. String containing an opaque End-User hint the Wallet MAY use in subsequent callbacks to optimize the End-User's experience. This is RECOMMENDED in Dynamic Credential Requests.<a href="#section-5.1.3-2.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5.1.3-2.3">
              <code>issuer_state</code>: OPTIONAL. String value identifying a certain processing context at the Credential Issuer. A value for this parameter is typically passed in a Credential Offer from the Credential Issuer to the Wallet (see <a href="#credential_offer" class="auto internal xref">Section 4.1</a>). This request parameter is used to pass the <code>issuer_state</code> value back to the Credential Issuer.<a href="#section-5.1.3-2.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.1.3-3">Note: When processing the Authorization Request, the Credential Issuer MUST take into account that the <code>issuer_state</code> is not guaranteed to originate from this Credential Issuer in all circumstances. It could have been injected by an attacker.<a href="#section-5.1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pushed-authorization-request">
<section id="section-5.1.4">
          <h4 id="name-pushed-authorization-reques">
<a href="#section-5.1.4" class="section-number selfRef">5.1.4. </a><a href="#name-pushed-authorization-reques" class="section-name selfRef">Pushed Authorization Request</a>
          </h4>
<p id="section-5.1.4-1">Use of Pushed Authorization Requests is RECOMMENDED to ensure confidentiality, integrity, and authenticity of the request data and to avoid issues due to large requests sizes.<a href="#section-5.1.4-1" class="pilcrow">¶</a></p>
<p id="section-5.1.4-2">Below is a non-normative example of a Pushed Authorization Request:<a href="#section-5.1.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.4-3">
<pre>POST /op/par HTTP/1.1
Host: as.example.com
Content-Type: application/x-www-form-urlencoded

response_type=code
&amp;client_id=CLIENT1234
&amp;code_challenge=E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM
&amp;code_challenge_method=S256
&amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
&amp;authorization_details=...
</pre><a href="#section-5.1.4-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="dynamic-credential-request">
<section id="section-5.1.5">
          <h4 id="name-dynamic-credential-request">
<a href="#section-5.1.5" class="section-number selfRef">5.1.5. </a><a href="#name-dynamic-credential-request" class="section-name selfRef">Dynamic Credential Request</a>
          </h4>
<p id="section-5.1.5-1">This step is OPTIONAL. After receiving an Authorization Request from the Client, the Credential Issuer MAY use this step to obtain additional Credentials from the End-User required to proceed with the authorization of the credential issuance. The Credential Issuer MAY obtain a Credential and utilize it to identify the End-User before issuing an additional credential. For a use case, see <a href="#use-case-2" class="auto internal xref">Appendix D.5</a>.<a href="#section-5.1.5-1" class="pilcrow">¶</a></p>
<p id="section-5.1.5-2">It is RECOMMENDED that the Credential Issuer use <span>[<a href="#OpenID4VP" class="cite xref">OpenID4VP</a>]</span> to dynamically request presentation of additional Credentials. From a protocol perspective, the Credential Issuer then acts as a verifier and sends a presentation request to the Wallet. The Client SHOULD have these Credentials obtained prior to starting a transaction with this Credential Issuer.<a href="#section-5.1.5-2" class="pilcrow">¶</a></p>
<p id="section-5.1.5-3">To enable dynamic callbacks of the Credential Issuer to the End-User's Wallet, the Wallet MAY provide additional parameters <code>wallet_issuer</code> and <code>user_hint</code> defined in the Authorization Request section of this specification.<a href="#section-5.1.5-3" class="pilcrow">¶</a></p>
<p id="section-5.1.5-4">For non-normative examples of request and response, see section 11.6 in <span>[<a href="#OpenID4VP" class="cite xref">OpenID4VP</a>]</span>.<a href="#section-5.1.5-4" class="pilcrow">¶</a></p>
<p id="section-5.1.5-5">Note to the editors: We need to sort out Credential Issuer's <code>client_id</code> with the Wallet and potentially add an example with <code>wallet_issuer</code> and <code>user_hint</code>.<a href="#section-5.1.5-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="authorization_response">
<section id="section-5.2">
        <h3 id="name-successful-authorization-re">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-successful-authorization-re" class="section-name selfRef">Successful Authorization Response</a>
        </h3>
<p id="section-5.2-1">Authorization Responses MUST be made as defined in <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">Below is a non-normative example of a successful Authorization Response:<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-3">
<pre>HTTP/1.1 302 Found
Location: https://Wallet.example.org/cb?
    code=SplxlOBeZQQYbYS6WxSbIA
</pre><a href="#section-5.2-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authorization-error-response">
<section id="section-5.3">
        <h3 id="name-authorization-error-respons">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-authorization-error-respons" class="section-name selfRef">Authorization Error Response</a>
        </h3>
<p id="section-5.3-1">Authorization Error Response MUST be made as defined in <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">When the requested scope value is invalid, unknown, or malformed, the AS should respond with the error code <code>invalid_scope</code> defined in Section 4.1.2.1 of <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">Below is a non-normative example of an unsuccessful Authorization Response.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<div class="lang-json= sourcecode" id="section-5.3-4">
<pre>HTTP/1.1 302 Found
Location: https://client.example.net/cb?
    error=invalid_request
    &amp;error_description=Unsupported%20response_type%20value
</pre><a href="#section-5.3-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="token_endpoint">
<section id="section-6">
      <h2 id="name-token-endpoint">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-token-endpoint" class="section-name selfRef">Token Endpoint</a>
      </h2>
<p id="section-6-1">The Token Endpoint issues an Access Token and, optionally, a Refresh Token in exchange for the Authorization Code that Client obtained in a successful Authorization Response. It is used in the same manner as defined in <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> and follows the recommendations given in <span>[<a href="#I-D.ietf-oauth-security-topics" class="cite xref">I-D.ietf-oauth-security-topics</a>]</span>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="token_request">
<section id="section-6.1">
        <h3 id="name-token-request">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-token-request" class="section-name selfRef">Token Request</a>
        </h3>
<p id="section-6.1-1">Upon receiving a successful Authorization Response, a Token Request is made as defined in Section 4.1.3 of <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">The following are the extension parameters to the Token Request used in a Pre-Authorized Code Flow defined by this specification:<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-6.1-3.1">
            <code>pre-authorized_code</code>: The code representing the authorization to obtain Credentials of a certain type. This parameter MUST be present if the <code>grant_type</code> is <code>urn:ietf:params:oauth:grant-type:pre-authorized_code</code>.<a href="#section-6.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-6.1-3.2">
            <code>user_pin</code>: OPTIONAL. String value containing the End-User PIN. This value MUST be present if <code>user_pin_required</code> was set to <code>true</code> in the Credential Offer. The string value MUST consist of a maximum of eight numeric characters (the numbers 0 - 9). This parameter MUST only be used if the <code>grant_type</code> is <code>urn:ietf:params:oauth:grant-type:pre-authorized_code</code>.<a href="#section-6.1-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.1-4">Requirements around how the Wallet identifies and, if applicable, authenticates itself with the Authorization Server in the Token Request depends on the Client type defined in Section 2.1 of <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> and the Client authentication method indicated in the <code>token_endpoint_auth_method</code> Client metadata. The requirement as described in Sections 4.1.3 and 3.2.1 of <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> MUST be followed.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">For the Pre-Authorized Code Grant Type, authentication of the Client is OPTIONAL, as described in Section 3.2.1 of OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, and, consequently, the <code>client_id</code> parameter is only needed when a form of Client Authentication that relies on this parameter is used.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<p id="section-6.1-6">If the Token Request contains an <code>authorization_details</code> parameter (as defined by [RFC@!9396]) of type <code>openid_credential</code> and the Credential Issuer's metadata contains an <code>authorization_servers</code> parameter, the <code>authorization_details</code> object MUST contain the Credential Issuer's identifier in the <code>locations</code> element.<a href="#section-6.1-6" class="pilcrow">¶</a></p>
<p id="section-6.1-7">If the Token Request contains a scope value related to credential issuance and the Credential Issuer's metadata contains an <code>authorization_servers</code> parameter, it is RECOMMENDED to use a <code>resource</code> parameter <span>[<a href="#RFC8707" class="cite xref">RFC8707</a>]</span> whose value is the Credential Issuer's identifier value to allow the AS to differentiate Credential Issuers.<a href="#section-6.1-7" class="pilcrow">¶</a></p>
<p id="section-6.1-8">When Pre-Authorized Grant Type is used, it is RECOMMENDED that the Credential Issuer issues an Access Token valid only for the Credentials indicated in the Credential Offer (see <a href="#credential_offer" class="auto internal xref">Section 4.1</a>). The Wallet SHOULD obtain a separate Access Token if it wants to request issuance of any of the Credentials that were not included in the Credential Offer, but were discoverable from the Credential Issuer's <code>credentials_supported</code> metadata parameter.<a href="#section-6.1-8" class="pilcrow">¶</a></p>
<p id="section-6.1-9">Below is a non-normative example of a Token Request in an Authorization Code Flow:<a href="#section-6.1-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1-10">
<pre>POST /token HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW

grant_type=authorization_code
&amp;code=SplxlOBeZQQYbYS6WxSbIA
&amp;code_verifier=dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk
&amp;redirect_uri=https%3A%2F%2FWallet.example.org%2Fcb
</pre><a href="#section-6.1-10" class="pilcrow">¶</a>
</div>
<p id="section-6.1-11">Below is a non-normative example of a Token Request in a Pre-Authorized Code Flow (without Client Authentication):<a href="#section-6.1-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1-12">
<pre>POST /token HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=urn:ietf:params:oauth:grant-type:pre-authorized_code
&amp;pre-authorized_code=SplxlOBeZQQYbYS6WxSbIA
&amp;user_pin=493536
</pre><a href="#section-6.1-12" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="token-response">
<section id="section-6.2">
        <h3 id="name-successful-token-response">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-successful-token-response" class="section-name selfRef">Successful Token Response</a>
        </h3>
<p id="section-6.2-1">Token Responses are made as defined in <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">The AS might decide to authorize issuance of multiple instances for each Credential requested in the Authorization Request. Each Credential instance is described using the same entry in the <code>credentials_supported</code> Credential Issuer metadata, but contains different claim values or different subset of claims within the claimset identified by the Credential description.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">In addition to the response parameters defined in <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, the AS MAY return the following parameters:<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-6.2-4.1">
            <code>c_nonce</code>: OPTIONAL. String containing a nonce to be used when creating a proof of possession of the key proof (see <a href="#credential_request" class="auto internal xref">Section 7.2</a>). When received, the Wallet MUST use this nonce value for its subsequent requests until the Credential Issuer provides a fresh nonce.<a href="#section-6.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-6.2-4.2">
            <code>c_nonce_expires_in</code>: OPTIONAL. Number denoting the lifetime in seconds of the <code>c_nonce</code>.<a href="#section-6.2-4.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-6.2-4.3">
            <p id="section-6.2-4.3.1"><code>authorization_details</code>: REQUIRED when <code>authorization_details</code> parameter is used to request issuance of a certain Credential type as defined in <a href="#authorization-details" class="auto internal xref">Section 5.1.1</a>. MUST NOT be used otherwise. An array of objects as defined in Section 7 of <span>[<a href="#RFC9396" class="cite xref">RFC9396</a>]</span>. This specification defines the following parameter to be used with authorization details type <code>openid_credential</code> in the Token Response:<a href="#section-6.2-4.3.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-6.2-4.3.2.1">
                <code>credential_identifiers</code>: OPTIONAL. Array of strings that each uniquely identify a Credential instance that can be issued using Access Token returned in this response. Each Credential instance is a unique Credential described using the same entry in the <code>credentials_supported</code> Credential Issuer metadata, but can contain different claim values or different subset of claims within the claimset identified by the Credential type. This parameter can also be used to simplify the Credential Request, since as defined in <a href="#credential_request" class="auto internal xref">Section 7.2</a> <code>credential_identifier</code> parameter replaces <code>format</code> and any other Credential format specific parameters in the Credential Request. When received, the Wallet MUST use these values together with an Access Token in the subsequent Credential Request(s).<a href="#section-6.2-4.3.2.1" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-6.2-5">Note: Credential Instance identifier(s) cannot be used when <code>scope</code> parameter is used in the Authorization Request to request issuance of a Credential.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<p id="section-6.2-6">Below is a non-normative example of a Token Response when <code>authorization_details</code> parameter was used to request issuance of a certain Credential type:<a href="#section-6.2-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-7">
<pre>HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

  {
    "access_token": "eyJhbGciOiJSUzI1NiIsInR5cCI6Ikp..sHQ",
    "token_type": "bearer",
    "expires_in": 86400,
    "c_nonce": "tZignsnFbp",
    "c_nonce_expires_in": 86400,
    "authorization_details": [
      {
        "type": "openid_credential",
        "format": "jwt_vc_json",
        "credential_definition": {
          "type": [
              "VerifiableCredential",
              "UniversityDegreeCredential"
          ]
        },
        "credential_identifiers": [ "CivilEngineeringDegree-2023", "ElectricalEngineeringDegree-2023" ]
      }
    ]
  }
</pre><a href="#section-6.2-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="token_error_response">
<section id="section-6.3">
        <h3 id="name-token-error-response">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-token-error-response" class="section-name selfRef">Token Error Response</a>
        </h3>
<p id="section-6.3-1">If the Token Request is invalid or unauthorized, the Authorization Server constructs the error response as defined as in Section 5.2 of OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">The following additional clarifications are provided for some of the error codes already defined in <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>:<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3"><code>invalid_request</code>:<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-6.3-4.1">The Authorization Server does not expect a PIN in the Pre-Authorized Code Flow but the Client provides a PIN.<a href="#section-6.3-4.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-6.3-4.2">The Authorization Server expects a PIN in the Pre-Authorized Code Flow but the Client does not provide a PIN.<a href="#section-6.3-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.3-5"><code>invalid_grant</code>:<a href="#section-6.3-5" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-6.3-6.1">The Authorization Server expects a PIN in the Pre-Authorized Code Flow but the Client provides the wrong PIN.<a href="#section-6.3-6.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-6.3-6.2">The End-User provides the wrong Pre-Authorized Code or the Pre-Authorized Code has expired.<a href="#section-6.3-6.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.3-7"><code>invalid_client</code>:<a href="#section-6.3-7" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-6.3-8.1">The Client tried to send a Token Request with a Pre-Authorized Code without Client ID but the Authorization Server does not support anonymous access.<a href="#section-6.3-8.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.3-9">Below is a non-normative example Token Error Response:<a href="#section-6.3-9" class="pilcrow">¶</a></p>
<div class="lang-json= sourcecode" id="section-6.3-10">
<pre>HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store

{
   "error": "invalid_request"
}
</pre><a href="#section-6.3-10" class="pilcrow">¶</a>
</div>
<p id="section-6.3-11">This specification also uses the error codes <code>authorization_pending</code> and <code>slow_down</code> as defined in <span>[<a href="#RFC8628" class="cite xref">RFC8628</a>]</span> for the Pre-Authorized Code grant type.<a href="#section-6.3-11" class="pilcrow">¶</a></p>
<p id="section-6.3-12"><code>authorization_pending</code>:<a href="#section-6.3-12" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-6.3-13.1">This error code is used if the Authorization Server is waiting for an End-User interaction or downstream process to complete. The Wallet SHOULD repeat the access token request to the token endpoint (a process known as polling). Before each new request, the Wallet MUST wait at least the number of seconds specified by the <code>interval</code> claim of the Credential Offer (see <a href="#credential_offer_parameters" class="auto internal xref">Section 4.1.1</a>) or the authorization response (see <a href="#authorization_response" class="auto internal xref">Section 5.2</a>), or 5 seconds if none was provided, and respect any increase in the polling interval required by the "slow_down" error.<a href="#section-6.3-13.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.3-14"><code>slow_down</code>:<a href="#section-6.3-14" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-6.3-15.1">A variant of <code>authorization_pending</code> error code, the authorization request is still pending and polling should continue, but the interval MUST be increased by 5 seconds for this and all subsequent requests.<a href="#section-6.3-15.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="credential-endpoint">
<section id="section-7">
      <h2 id="name-credential-endpoint">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-credential-endpoint" class="section-name selfRef">Credential Endpoint</a>
      </h2>
<p id="section-7-1">The Credential Endpoint issues a Credential as approved by the End-User upon presentation of a valid Access Token representing this approval.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">Communication with the Credential Endpoint MUST utilize TLS.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">The Client can request issuance of a Credential of a certain type multiple times, e.g., to associate the Credential with different public keys/Decentralized Identifiers (DIDs) or to refresh a certain Credential.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">If the Access Token is valid for requesting issuance of multiple Credentials, it is at the Client's discretion to decide the order in which to request issuance of multiple Credentials requested in the Authorization Request.<a href="#section-7-4" class="pilcrow">¶</a></p>
<div id="credential-binding">
<section id="section-7.1">
        <h3 id="name-binding-the-issued-credenti">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-binding-the-issued-credenti" class="section-name selfRef">Binding the Issued Credential to the Identifier of the End-User Possessing that Credential</a>
        </h3>
<p id="section-7.1-1">Issued Credential SHOULD be cryptographically bound to the identifier of the End-User who possesses the Credential. Cryptographic binding allows the Verifier to verify during the presentation of a Credential that the End-User presenting a Credential is the same End-User to whom that Credential was issued. For non-cryptographic type of binding and Credentials issued without any binding, see Implementation Considerations in <a href="#claim-based-binding" class="auto internal xref">Section 12.1</a> and <a href="#no-binding" class="auto internal xref">Section 12.2</a>.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">Note: Claims in the Credential are usually about the End-User who possesses it, but can be about another entity.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">For cryptographic binding, the Client has the following options to provide cryptographic binding material for a requested Credential as defined in <a href="#credential_request" class="auto internal xref">Section 7.2</a>:<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-7.1-4">
<li id="section-7.1-4.1">Provide proof of control alongside key material (<code>proof</code> that includes <code>sub_jwk</code> or <code>did</code>)<a href="#section-7.1-4.1" class="pilcrow">¶</a>
</li>
          <li id="section-7.1-4.2">Provide only proof of control without the key material (<code>proof</code> that does not include <code>sub_jwk</code> or <code>did</code>)<a href="#section-7.1-4.2" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="credential_request">
<section id="section-7.2">
        <h3 id="name-credential-request">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-credential-request" class="section-name selfRef">Credential Request</a>
        </h3>
<p id="section-7.2-1">A Client makes a Credential Request to the Credential Endpoint by sending the following parameters in the entity-body of an HTTP POST request using the <code>application/json</code> media type.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-7.2-2.1">
            <code>format</code>: REQUIRED when the <code>credential_identifier</code> was not returned from the Token Response. MUST NOT be used otherwise. String that determines the format of the Credential to be issued, which may determine the type and any other information related to the Credential to be issued. Credential Format Profiles consisting of the Credential format specific set of parameters are defined in <a href="#format_profiles" class="auto internal xref">Appendix E</a>. When this parameter is used, <code>credential_identifier</code> parameter MUST NOT be present.<a href="#section-7.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-7.2-2.2">
            <p id="section-7.2-2.2.1"><code>proof</code>: OPTIONAL. Object containing the proof of possession of the cryptographic key material the issued Credential would be bound to.  The <code>proof</code> object MUST contain a following claim:<a href="#section-7.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-7.2-2.2.2.1">
                <code>proof_type</code>: REQUIRED. String denoting the key proof type. The value of this claim determines other claims in the key proof object and its respective processing rules. Key proof types defined in this specification can be found in <a href="#proof_types" class="auto internal xref">Section 7.2.1</a>.<a href="#section-7.2-2.2.2.1" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="compact" id="section-7.2-2.3">
            <code>credential_identifier</code>: REQUIRED when <code>credential_identifier</code> was returned from the Token Response. MUST NOT be used otherwise. String that identifies a Credential that is being requested to be issued. When this parameter is used, the <code>format</code> parameter and any other Credential format specific set of parameters such as those defined in <a href="#format_profiles" class="auto internal xref">Appendix E</a> MUST NOT be present.<a href="#section-7.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-7.2-2.4">
            <code>credential_encryption_jwk</code>: OPTIONAL. An object containing a single public key as a JWK used for encrypting the Credential Response.<a href="#section-7.2-2.4" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-7.2-2.5">
            <code>credential_response_encryption_alg</code>: OPTIONAL. JWE <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span> <code>alg</code> algorithm <span>[<a href="#RFC7518" class="cite xref">RFC7518</a>]</span> REQUIRED for encrypting Credential and/or Batch Credential Responses. If omitted, no encryption is intended to be performed. When the <code>credential_response_encryption_alg</code> is present, the <code>credential_encryption_jwk</code> MUST be present.<a href="#section-7.2-2.5" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-7.2-2.6">
            <code>credential_response_encryption_enc</code>: OPTIONAL. JWE <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span> <code>enc</code> algorithm <span>[<a href="#RFC7518" class="cite xref">RFC7518</a>]</span> REQUIRED for encrypting Credential Responses. If <code>credential_response_encryption_alg</code> is specified, the default for this value is <code>A256GCM</code>. When <code>credential_response_encryption_enc</code> is included, <code>credential_response_encryption_alg</code> MUST also be provided.<a href="#section-7.2-2.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.2-3">The <code>proof_type</code> claim is an extension point that enables the use of different types of proofs for different cryptographic schemes.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<p id="section-7.2-4">The <code>proof</code> element MUST incorporate the Credential Issuer Identifier (audience), and a <code>c_nonce</code> value generated by the Authorization Server or the Credential Issuer to allow the Credential Issuer to detect replay. The way that data is incorporated depends on the key proof type. In a JWT, for example, the <code>c_nonce</code> is conveyed in the <code>nonce</code> claims whereas the audience is conveyed in the <code>aud</code> claim. In a Linked Data proof, for example, the <code>c_nonce</code> is included as the <code>challenge</code> element in the key proof object and the Credential Issuer (the intended audience) is included as the <code>domain</code> element.<a href="#section-7.2-4" class="pilcrow">¶</a></p>
<p id="section-7.2-5">Initial <code>c_nonce</code> value can be returned in a successful Token Response as defined in <a href="#token-response" class="auto internal xref">Section 6.2</a>, in a Credential Error Response as defined in <a href="#issuer-provided-nonce" class="auto internal xref">Section 7.3.2</a>, or in a Batch Credential Error Response as defined in <a href="#batch-credential_error_response" class="auto internal xref">Section 8.3</a>.<a href="#section-7.2-5" class="pilcrow">¶</a></p>
<p id="section-7.2-6">Below is a non-normative example of a Credential Request for a credential in <span>[<a href="#ISO.18013-5" class="cite xref">ISO.18013-5</a>]</span> format using Credential format specific set of parameters and a key proof type <code>cwt</code>:<a href="#section-7.2-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.2-7">
<pre>POST /credential HTTP/1.1
Host: server.example.com
Content-Type: application/json
Authorization: BEARER czZCaGRSa3F0MzpnWDFmQmF0M2JW

{
   "format":"mso_mdoc",
   "doctype":"org.iso.18013.5.1.mDL",
   "proof": {
      "proof_type": "cwt",
      "cwt": "..."
   }
}
</pre><a href="#section-7.2-7" class="pilcrow">¶</a>
</div>
<p id="section-7.2-8">Below is a non-normative example of a Credential Request for a credential in JWT VC format (JSON encoding) using Credential instance identifier and a key proof type <code>jwt</code>:<a href="#section-7.2-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.2-9">
<pre>POST /credential HTTP/1.1
Host: server.example.com
Content-Type: application/json
Authorization: BEARER czZCaGRSa3F0MzpnWDFmQmF0M2JW

{
   "credential_identifier": "CivilEngineeringDegree-2023",
   "proof": {
      "proof_type": "jwt",
      "jwt": "eyJraWQiOiJkaWQ6ZXhhbXBsZTplYmZlYjFmNzEyZWJjNmYxYzI3NmUxMmVjMjEva2V5cy8
      xIiwiYWxnIjoiRVMyNTYiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJzNkJoZFJrcXQzIiwiYXVkIjoiaHR
      0cHM6Ly9zZXJ2ZXIuZXhhbXBsZS5jb20iLCJpYXQiOjE1MzY5NTk5NTksIm5vbmNlIjoidFppZ25zbk
      ZicCJ9.ewdkIkPV50iOeBUqMXCC_aZKPxgihac0aW9EkL1nOzM"
   }
}
</pre><a href="#section-7.2-9" class="pilcrow">¶</a>
</div>
<p id="section-7.2-10">The Client MAY request encrypted responses by providing its encryption parameters in the Credential Request.<a href="#section-7.2-10" class="pilcrow">¶</a></p>
<p id="section-7.2-11">The Credential Issuer MAY require encrypted responses by including <code>require_credential_response_encryption</code> in the Credntial Issuer Metadata.<a href="#section-7.2-11" class="pilcrow">¶</a></p>
<div id="proof_types">
<section id="section-7.2.1">
          <h4 id="name-key-proof-types">
<a href="#section-7.2.1" class="section-number selfRef">7.2.1. </a><a href="#name-key-proof-types" class="section-name selfRef">Key Proof Types</a>
          </h4>
<p id="section-7.2.1-1">This specification defines the following values for the <code>proof_type</code> property:<a href="#section-7.2.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-7.2.1-2.1">
              <code>jwt</code>: A JWT <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span> is used as proof of possession. When <code>proof_type</code> is <code>jwt</code>, a <code>proof</code> object MUST include a <code>jwt</code> claim containing a JWT defined in <a href="#jwt-proof-type" class="auto internal xref">Section 7.2.1.1</a>.<a href="#section-7.2.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-7.2.1-2.2">
              <code>cwt</code>: A CWT <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span> is used as proof of possession. When <code>proof_type</code> is <code>cwt</code>, a <code>proof</code> object MUST include a <code>cwt</code> claim containing a CWT defined in <a href="#cwt-proof-type" class="auto internal xref">Section 7.2.1.2</a>.<a href="#section-7.2.1-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<div id="jwt-proof-type">
<section id="section-7.2.1.1">
            <h5 id="name-jwt-key-proof-type">
<a href="#section-7.2.1.1" class="section-number selfRef">7.2.1.1. </a><a href="#name-jwt-key-proof-type" class="section-name selfRef"><code>jwt</code> Key Proof Type</a>
            </h5>
<p id="section-7.2.1.1-1">The JWT MUST contain the following elements:<a href="#section-7.2.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2.1.1-2.1">
                <p id="section-7.2.1.1-2.1.1">in the JOSE header,<a href="#section-7.2.1.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="compact normal">
<li class="compact normal" id="section-7.2.1.1-2.1.2.1">
                    <code>alg</code>: REQUIRED. A digital signature algorithm identifier such as per IANA "JSON Web Signature and Encryption Algorithms" registry <span>[<a href="#IANA.JOSE.ALGS" class="cite xref">IANA.JOSE.ALGS</a>]</span>. MUST NOT be <code>none</code> or an identifier for a symmetric algorithm (MAC).<a href="#section-7.2.1.1-2.1.2.1" class="pilcrow">¶</a>
</li>
                  <li class="compact normal" id="section-7.2.1.1-2.1.2.2">
                    <code>typ</code>: REQUIRED. MUST be <code>openid4vci-proof+jwt</code>, which explicitly types the key proof JWT as recommended in Section 3.11 of <span>[<a href="#RFC8725" class="cite xref">RFC8725</a>]</span>.<a href="#section-7.2.1.1-2.1.2.2" class="pilcrow">¶</a>
</li>
                  <li class="compact normal" id="section-7.2.1.1-2.1.2.3">
                    <code>kid</code>: OPTIONAL. JOSE Header containing the key ID. If the Credential shall be bound to a DID, the <code>kid</code> refers to a DID URL which identifies a particular key in the DID Document that the Credential shall be bound to. It MUST NOT be present if <code>jwk</code> is present.<a href="#section-7.2.1.1-2.1.2.3" class="pilcrow">¶</a>
</li>
                  <li class="compact normal" id="section-7.2.1.1-2.1.2.4">
                    <code>jwk</code>: OPTIONAL. JOSE Header containing the key material the new Credential shall be bound to. It MUST NOT be present if <code>kid</code> is present.<a href="#section-7.2.1.1-2.1.2.4" class="pilcrow">¶</a>
</li>
                  <li class="compact normal" id="section-7.2.1.1-2.1.2.5">
                    <code>x5c</code>: OPTIONAL. JOSE Header containing a certificate or certificate chain corresponding to the key used to sign the JWT. This element MAY be used to convey a key attestation. In such a case, the actual key certificate will contain attributes related to the key properties.<a href="#section-7.2.1.1-2.1.2.5" class="pilcrow">¶</a>
</li>
                  <li class="compact normal" id="section-7.2.1.1-2.1.2.6">
                    <code>trust_chain</code>: OPTIONAL. JOSE Header containing an <span>[<a href="#OpenID.Federation" class="cite xref">OpenID.Federation</a>]</span> Trust Chain. This element MAY be used to convey key attestation, metadata, metadata policies, federation Trust Marks and any other information related to a specific federation, if available in the chain. When used for signature verification, the header parameter <code>kid</code> MUST be present.<a href="#section-7.2.1.1-2.1.2.6" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="normal" id="section-7.2.1.1-2.2">
                <p id="section-7.2.1.1-2.2.1">in the JWT body,<a href="#section-7.2.1.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="compact normal">
<li class="compact normal" id="section-7.2.1.1-2.2.2.1">
                    <code>iss</code>: OPTIONAL (string). The value of this claim MUST be the <code>client_id</code> of the Client making the credential request. This claim MUST be omitted if the access token authorizing the issuance call was obtained from a Pre-Authorized Code Flow through anonymous access to the token endpoint.<a href="#section-7.2.1.1-2.2.2.1" class="pilcrow">¶</a>
</li>
                  <li class="compact normal" id="section-7.2.1.1-2.2.2.2">
                    <code>aud</code>: REQUIRED (string). The value of this claim MUST be the Credential Issuer Identifier.<a href="#section-7.2.1.1-2.2.2.2" class="pilcrow">¶</a>
</li>
                  <li class="compact normal" id="section-7.2.1.1-2.2.2.3">
                    <code>iat</code>: REQUIRED (number). The value of this claim MUST be the time at which the key proof was issued using the syntax defined in <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-7.2.1.1-2.2.2.3" class="pilcrow">¶</a>
</li>
                  <li class="compact normal" id="section-7.2.1.1-2.2.2.4">
                    <code>nonce</code>: OPTIONAL (string). The value type of this claim MUST be a string, where the value is a server-provided <code>c_nonce</code>. MUST be present when the Wallet received server-provided <code>c_nonce</code>.<a href="#section-7.2.1.1-2.2.2.4" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ul>
<p id="section-7.2.1.1-3">The Credential Issuer MUST validate that the <code>proof</code> is actually signed by a key identified in the JOSE Header.<a href="#section-7.2.1.1-3" class="pilcrow">¶</a></p>
<p id="section-7.2.1.1-4">Below is a non-normative example of a <code>proof</code> parameter (line breaks for display purposes only):<a href="#section-7.2.1.1-4" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-7.2.1.1-5">
<pre>{
  "proof_type": "jwt",
  "jwt": "eyJraWQiOiJkaWQ6ZXhhbXBsZTplYmZlYjFmNzEyZWJjNmYxYzI3NmUxMmVjMjEva2V5cy8
  xIiwiYWxnIjoiRVMyNTYiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJzNkJoZFJrcXQzIiwiYXVkIjoiaHR
  0cHM6Ly9zZXJ2ZXIuZXhhbXBsZS5jb20iLCJpYXQiOjE1MzY5NTk5NTksIm5vbmNlIjoidFppZ25zbk
  ZicCJ9.ewdkIkPV50iOeBUqMXCC_aZKPxgihac0aW9EkL1nOzM"
  }
</pre><a href="#section-7.2.1.1-5" class="pilcrow">¶</a>
</div>
<p id="section-7.2.1.1-6">where the JWT looks like this:<a href="#section-7.2.1.1-6" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-7.2.1.1-7">
<pre>{
  "alg": "ES256",
  "kid": "did:example:ebfeb1f712ebc6f1c276e12ec21/keys/1"
}.
{
  "iss": "s6BhdRkqt3",
  "aud": "https://server.example.com",
  "iat": 1659145924,
  "nonce": "tZignsnFbp"
}
</pre><a href="#section-7.2.1.1-7" class="pilcrow">¶</a>
</div>
<p id="section-7.2.1.1-8">Here is another example JWT not only proving possession of a private key but also providing key attestation data for that key:<a href="#section-7.2.1.1-8" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-7.2.1.1-9">
<pre>{
  "alg": "ES256",
  "x5c": [&lt;key certificate + certificate chain for attestation&gt;]
}.
{
  "iss": "s6BhdRkqt3",
  "aud": "https://server.example.com",
  "iat": 1659145924,
  "nonce": "tZignsnFbp"
}
</pre><a href="#section-7.2.1.1-9" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="cwt-proof-type">
<section id="section-7.2.1.2">
            <h5 id="name-cwt-key-proof-type">
<a href="#section-7.2.1.2" class="section-number selfRef">7.2.1.2. </a><a href="#name-cwt-key-proof-type" class="section-name selfRef"><code>cwt</code> Key Proof Type</a>
            </h5>
<p id="section-7.2.1.2-1">The CWT MUST contain the following elements:<a href="#section-7.2.1.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-7.2.1.2-2.1">
                <p id="section-7.2.1.2-2.1.1">in the COSE protected header (see <span>[<a href="#RFC8152" class="cite xref">RFC8152</a>]</span>, Section 3.1.),<a href="#section-7.2.1.2-2.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-7.2.1.2-2.1.2.1">Label 1 (<code>alg</code>): REQUIRED. A digital signature algorithm identifier such as per IANA "COSE Algorithms" registry <span>[<a href="#IANA.COSE.ALGS" class="cite xref">IANA.COSE.ALGS</a>]</span>. MUST NOT be an identifier for a symmetric algorithm (MAC).<a href="#section-7.2.1.2-2.1.2.1" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="section-7.2.1.2-2.1.2.2">Label 3 (<code>content type</code>): REQUIRED. MUST be <code>openid4vci-proof+cwt</code>, which explicitly types the key proof CWT.<a href="#section-7.2.1.2-2.1.2.2" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="section-7.2.1.2-2.1.2.3">(string-valued) Label <code>COSE_Key</code>: OPTIONAL (byte string). COSE key material the new Credential shall be bound to. It MUST NOT be present if <code>x5chain</code> is present.<a href="#section-7.2.1.2-2.1.2.3" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="section-7.2.1.2-2.1.2.4">Label 33 (<code>x5chain</code>): OPTIONAL (byte string). As defined in <span>[<a href="#RFC9360" class="cite xref">RFC9360</a>]</span>, contains an ordered array of X.509 certificates corresponding to the key used to sign the CWT. It MUST NOT be present if <code>COSE_Key</code> is present.<a href="#section-7.2.1.2-2.1.2.4" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="compact" id="section-7.2.1.2-2.2">
                <p id="section-7.2.1.2-2.2.1">in the content of the message (see <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>, Section 4),<a href="#section-7.2.1.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-7.2.1.2-2.2.2.1">Claim Key 1 (<code>iss</code>): OPTIONAL (text string). The value of this claim MUST be the <code>client_id</code> of the Client making the credential request. This claim MUST be omitted if the access token authorizing the issuance call was obtained from a Pre-Authorized Code Flow through anonymous access to the token endpoint.<a href="#section-7.2.1.2-2.2.2.1" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="section-7.2.1.2-2.2.2.2">Claim Key 3 (<code>aud</code>): REQUIRED (text string). The value of this claim MUST be the Credential Issuer Identifier.<a href="#section-7.2.1.2-2.2.2.2" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="section-7.2.1.2-2.2.2.3">Claim Key 6 (<code>iat</code>): REQUIRED (integer or floating-point number). The value of this claim MUST be the time at which the key proof was issued.<a href="#section-7.2.1.2-2.2.2.3" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="section-7.2.1.2-2.2.2.4">Claim Key 10 (<code>Nonce</code>): OPTIONAL (byte string). The value of this claim MUST be a server-provided <code>c_nonce</code> converted from string to bytes. MUST be present when the Wallet received server-provided <code>c_nonce</code>.<a href="#section-7.2.1.2-2.2.2.4" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ul>
</section>
</div>
</section>
</div>
<div id="verifying-key-proof">
<section id="section-7.2.2">
          <h4 id="name-verifying-key-proof">
<a href="#section-7.2.2" class="section-number selfRef">7.2.2. </a><a href="#name-verifying-key-proof" class="section-name selfRef">Verifying Key Proof</a>
          </h4>
<p id="section-7.2.2-1">To validate a Key Proof, the Credential Issuer MUST ensure that:<a href="#section-7.2.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-7.2.2-2.1">all required claims for that proof type are contained as defined in <a href="#proof_types" class="auto internal xref">Section 7.2.1</a>,<a href="#section-7.2.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-7.2.2-2.2">the Key Proof is explicitly typed using header parameters as defined for that proof type,<a href="#section-7.2.2-2.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-7.2.2-2.3">the header parameter indicates a registered asymmetric digital signature algorithm, <code>alg</code> parameter value is not <code>none</code>, is supported by the application, and is acceptable per local policy,<a href="#section-7.2.2-2.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-7.2.2-2.4">the signature on the Key Proof verifies with the public key contained in the header parameter,<a href="#section-7.2.2-2.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-7.2.2-2.5">the header parameter does not contain a private key,<a href="#section-7.2.2-2.5" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-7.2.2-2.6">the <code>nonce</code> claim (or Claim Key 10) matches the server-provided <code>c_nonce</code> value, if the server had previously provided a <code>c_nonce</code>,<a href="#section-7.2.2-2.6" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-7.2.2-2.7">the creation time of the JWT, as determined by either the issuance time, or a server managed timestamp via the nonce claim, is within an acceptable window (see <a href="#key-proof-replay" class="auto internal xref">Section 11.5</a>).<a href="#section-7.2.2-2.7" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-7.2.2-3">These checks may be performed in any order.<a href="#section-7.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="credential-response">
<section id="section-7.3">
        <h3 id="name-credential-response">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-credential-response" class="section-name selfRef">Credential Response</a>
        </h3>
<p id="section-7.3-1">Credential Response can be immediate or deferred. The Credential Issuer MAY be able to immediately issue a requested Credential and send it to the Client.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">In other cases, the Credential Issuer MAY NOT be able to immediately issue a requested Credential and would want to send a <code>transaction_id</code> parameter to the Client to be used later to receive a Credential when it is ready. The HTTP status code MUST be 202 (section 10.2.3 of <span>[<a href="#RFC2616" class="cite xref">RFC2616</a>]</span>).<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">If the Client requested encrypted responses, the Credential Issuer MUST encode the information in the Credential Reponse as a JWT with <code>credential_response_encryption_alg</code> and <code>credential_response_encryption_enc</code>. The JWT MUST be encrypted using the public key specified by <code>credential_encryption_jwk</code> in the Credential Request. If the Credential Response is encrypted, the media type of the response MUST bet set to <code>application/jwt</code>. If encryption was negotiated in the Credential Request and the Credential Response is not encrypted, the Client SHOULD reject the Credential Response.<a href="#section-7.3-3" class="pilcrow">¶</a></p>
<p id="section-7.3-4">If the Credential Response is not encrypted, the media type of the response MUST be set to <code>application/json</code>.<a href="#section-7.3-4" class="pilcrow">¶</a></p>
<p id="section-7.3-5">The following claims are used in the JSON-encoded Credential Response body:<a href="#section-7.3-5" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-7.3-6.1">
            <code>format</code>: REQUIRED. String denoting the format of the issued Credential.<a href="#section-7.3-6.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-7.3-6.2">
            <code>credential</code>: OPTIONAL. Contains issued Credential. MUST be present when <code>transaction_id</code> is not returned. MAY be a string or an object, depending on the Credential format. See <a href="#format_profiles" class="auto internal xref">Appendix E</a> for the Credential format specific encoding requirements.<a href="#section-7.3-6.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-7.3-6.3">
            <code>transaction_id</code>: OPTIONAL. A string identifying a Deferred Issuance transaction. This claim is contained in the response if the Credential Issuer was unable to immediately issue the credential. The value is subsequently used to obtain the respective Credential with the Deferred Credential Endpoint (see <a href="#deferred-credential-issuance" class="auto internal xref">Section 9</a>). It MUST be present when the <code>credential</code> parameter is not returned. It MUST be invalidated after the credential for which it was meant has been obtained by the Wallet.<a href="#section-7.3-6.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-7.3-6.4">
            <code>c_nonce</code>: OPTIONAL. String containing a nonce to be used to create a proof of possession of key material when requesting a Credential (see <a href="#credential_request" class="auto internal xref">Section 7.2</a>). When received, the Wallet MUST use this nonce value for its subsequent credential requests until the Credential Issuer provides a fresh nonce.<a href="#section-7.3-6.4" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-7.3-6.5">
            <code>c_nonce_expires_in</code>: OPTIONAL. Number denoting the lifetime in seconds of the <code>c_nonce</code>.<a href="#section-7.3-6.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.3-7">The <code>format</code> key determines the Credential format and encoding of the credential in the Credential Response. Details are defined in the Credential Format Profiles in <a href="#format_profiles" class="auto internal xref">Appendix E</a>.<a href="#section-7.3-7" class="pilcrow">¶</a></p>
<p id="section-7.3-8">Credential formats expressed as binary data MUST be base64url-encoded and returned as a string.<a href="#section-7.3-8" class="pilcrow">¶</a></p>
<p id="section-7.3-9">Below is a non-normative example of a Credential Response in an immediate issuance flow for a credential in JWT VC format (JSON-encoded):<a href="#section-7.3-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3-10">
<pre>HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
  "format": "jwt_vc_json",
  "credential": "LUpixVCWJk0eOt4CXQe1NXK....WZwmhmn9OQp6YxX0a2L",
  "c_nonce": "fGFF7UkhLa",
  "c_nonce_expires_in": 86400
}
</pre><a href="#section-7.3-10" class="pilcrow">¶</a>
</div>
<p id="section-7.3-11">Below is a non-normative example of a Credential Response in a deferred flow:<a href="#section-7.3-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3-12">
<pre>HTTP/1.1 202 Accepted
Content-Type: application/json
Cache-Control: no-store

{
  "transaction_id": "8xLOxBtZp8",
  "c_nonce": "wlbQc6pCJp",
  "c_nonce_expires_in": 86400
}
</pre><a href="#section-7.3-12" class="pilcrow">¶</a>
</div>
<div id="credential-error-response">
<section id="section-7.3.1">
          <h4 id="name-credential-error-response">
<a href="#section-7.3.1" class="section-number selfRef">7.3.1. </a><a href="#name-credential-error-response" class="section-name selfRef">Credential Error Response</a>
          </h4>
<p id="section-7.3.1-1">When the Credential Request is invalid or unauthorized, the Credential Issuer constructs the error response as defined in this section.<a href="#section-7.3.1-1" class="pilcrow">¶</a></p>
<div id="authorization-errors">
<section id="section-7.3.1.1">
            <h5 id="name-authorization-errors">
<a href="#section-7.3.1.1" class="section-number selfRef">7.3.1.1. </a><a href="#name-authorization-errors" class="section-name selfRef">Authorization Errors</a>
            </h5>
<p id="section-7.3.1.1-1">If the Credential Request does not contain an Access Token that enables issuance of a requested Credential, the Credential Endpoint returns an authorization error response such as defined in section 3 of <span>[<a href="#RFC6750" class="cite xref">RFC6750</a>]</span>.<a href="#section-7.3.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credential-request-errors">
<section id="section-7.3.1.2">
            <h5 id="name-credential-request-errors">
<a href="#section-7.3.1.2" class="section-number selfRef">7.3.1.2. </a><a href="#name-credential-request-errors" class="section-name selfRef">Credential Request Errors</a>
            </h5>
<p id="section-7.3.1.2-1">For the errors specific to the payload of the Credential Request such as those caused by <code>type</code>, <code>format</code>, <code>proof</code>, or encryption parameters in the request, the error codes values defined in this section MUST be used instead of a generic <code>invalid_request</code> parameter defined in section 3.1 of <span>[<a href="#RFC6750" class="cite xref">RFC6750</a>]</span>.<a href="#section-7.3.1.2-1" class="pilcrow">¶</a></p>
<p id="section-7.3.1.2-2">If the Wallet is requesting the issuance of a Credential that is not supported by the Credential Endpoint, the HTTP response MUST use the HTTP status code 400 (Bad Request) and set the content type to <code>application/json</code> with the following parameters in the JSON-encoded response body:<a href="#section-7.3.1.2-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-7.3.1.2-3.1">
                <p id="section-7.3.1.2-3.1.1"><code>error</code>: REQUIRED. A key at the top level of the object, the value of which SHOULD be a single ASCII <span>[<a href="#USASCII" class="cite xref">USASCII</a>]</span> error code from the following:<a href="#section-7.3.1.2-3.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-7.3.1.2-3.1.2.1">
                    <code>invalid_credential_request</code>: The Credential Request is missing a required parameter, includes an unsupported parameter or parameter value, repeats the same parameter, or is otherwise malformed.<a href="#section-7.3.1.2-3.1.2.1" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="section-7.3.1.2-3.1.2.2">
                    <code>unsupported_credential_type</code>: Requested Credential type is not supported.<a href="#section-7.3.1.2-3.1.2.2" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="section-7.3.1.2-3.1.2.3">
                    <code>unsupported_credential_format</code>: Requested Credential format is not supported.<a href="#section-7.3.1.2-3.1.2.3" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="section-7.3.1.2-3.1.2.4">
                    <code>invalid_proof</code>: The <code>proof</code> in the Credential Request is invalid. The <code>proof</code> field is not present or the provided key proof is invalid or not bound to a nonce provided by the Credential Issuer.<a href="#section-7.3.1.2-3.1.2.4" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="section-7.3.1.2-3.1.2.5">
                    <code>invalid_encryption_parameters</code>: This error occurs when the encryption parameters in the Credential Request are either invalid or missing. In the latter case, it indicates that the Credential Issuer requires the Credential Response to be sent encrypted, but the Credential Request does not contain the necessary encryption parameters.<a href="#section-7.3.1.2-3.1.2.5" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="compact" id="section-7.3.1.2-3.2">
                <code>error_description</code>: OPTIONAL. A key at the top level of the object. The value MUST be a human-readable ASCII <span>[<a href="#USASCII" class="cite xref">USASCII</a>]</span> text, providing any additional information used to assist the Client implementers in understanding the occurred error. The values for the <code>error_description</code> parameter MUST NOT include characters outside the set <code>%x20-21 / %x23-5B / %x5D-7E</code>.<a href="#section-7.3.1.2-3.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-7.3.1.2-4">The usage of these parameters takes precedence over the <code>invalid_request</code> parameter defined in <a href="#authorization-errors" class="auto internal xref">Section 7.3.1.1</a>, since they provide more details about the errors.<a href="#section-7.3.1.2-4" class="pilcrow">¶</a></p>
<p id="section-7.3.1.2-5">The following is a non-normative example of a Credential Error Response where an unsupported Credential format was requested:<a href="#section-7.3.1.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.1.2-6">
<pre>HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store

{
   "error": "unsupported_credential_format"
}
</pre><a href="#section-7.3.1.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="issuer-provided-nonce">
<section id="section-7.3.2">
          <h4 id="name-credential-issuer-provided-">
<a href="#section-7.3.2" class="section-number selfRef">7.3.2. </a><a href="#name-credential-issuer-provided-" class="section-name selfRef">Credential Issuer Provided Nonce</a>
          </h4>
<p id="section-7.3.2-1">The Credential Issuer that requires the Client to send a key proof of possession of the key material for the Credential to be bound to (<code>proof</code>) MAY receive a Credential Request without such a key proof or with an invalid key proof. In such a case, the Credential Issuer MUST provide the Client with a <code>c_nonce</code> defined in <a href="#credential-response" class="auto internal xref">Section 7.3</a> in a Credential Error Response using <code>invalid_proof</code> error code defined in <a href="#credential-error-response" class="auto internal xref">Section 7.3.1</a>.<a href="#section-7.3.2-1" class="pilcrow">¶</a></p>
<p id="section-7.3.2-2">The <code>c_nonce</code> value MUST be incorporated in the respective parameter in the <code>proof</code> object.<a href="#section-7.3.2-2" class="pilcrow">¶</a></p>
<p id="section-7.3.2-3">Below is a non-normative example of a Credential Response when the Credential Issuer is requesting a Wallet to provide in a subsequent Credential Request a key proof that is bound to a <code>c_nonce</code>:<a href="#section-7.3.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.2-4">
<pre>HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store

{
  "error": "invalid_proof"
  "error_description":
       "Credential Issuer requires key proof to be bound to a Credential Issuer provided nonce.",
  "c_nonce": "8YE9hCnyV2",
  "c_nonce_expires_in": 86400
}
</pre><a href="#section-7.3.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="batch-credential-endpoint">
<section id="section-8">
      <h2 id="name-batch-credential-endpoint">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-batch-credential-endpoint" class="section-name selfRef">Batch Credential Endpoint</a>
      </h2>
<p id="section-8-1">The Batch Credential Endpoint issues multiple Credentials in one Batch Credential Response as approved by the End-User upon presentation of a valid Access Token representing this approval.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Communication with the Batch Credential Endpoint MUST utilize TLS.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">The Client can request issuance of multiple Credentials of certain types and formats in one Batch Credential Request. This includes Credentials of the same type and multiple formats, different types and one format, or both.<a href="#section-8-3" class="pilcrow">¶</a></p>
<div id="batch-credential_request">
<section id="section-8.1">
        <h3 id="name-batch-credential-request">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-batch-credential-request" class="section-name selfRef">Batch Credential Request</a>
        </h3>
<p id="section-8.1-1">The Batch Credential Endpoint allows a Client to send multiple Credential Request objects (see <a href="#credential_request" class="auto internal xref">Section 7.2</a>) to request the issuance of multiple credential at once. A Batch Credential Request MUST be sent as a JSON-encoded object using the <code>application/json</code> media type.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">The following keys are used in the Batch Credential Request:<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-8.1-3.1">
            <code>credential_requests</code>: REQUIRED. Array that contains Credential Request objects as defined in <a href="#credential_request" class="auto internal xref">Section 7.2</a>.<a href="#section-8.1-3.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.1-4">Below is a non-normative example of a Batch Credential Request:<a href="#section-8.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.1-5">
<pre>POST /batch_credential HTTP/1.1
Host: server.example.com
Content-Type: application/json
Authorization: BEARER czZCaGRSa3F0MzpnWDFmQmF0M2JW

{
   "credential_requests":[
      {
         "format":"jwt_vc_json",
         "credential_definition": {
           "type":[
             "VerifiableCredential",
             "UniversityDegreeCredential"
           ]
         },
         "proof":{
            "proof_type":"jwt",
            "jwt":"eyJraWQiOiJkaWQ6ZXhhbXBsZTpl...C_aZKPxgihac0aW9EkL1nOzM"
         }
      },
      {
         "format":"mso_mdoc",
         "doctype":"org.iso.18013.5.1.mDL",
         "proof":{
            "proof_type":"jwt",
            "jwt":"eyJraWQiOiJkaWQ6ZXhhbXBsZ...KPxgihac0aW9EkL1nOzM"
         }
      }
   ]
}
</pre><a href="#section-8.1-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="batch-credential_response">
<section id="section-8.2">
        <h3 id="name-batch-credential-response">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-batch-credential-response" class="section-name selfRef">Batch Credential Response</a>
        </h3>
<p id="section-8.2-1">A successful Batch Credential Response MUST contain all the requested credentials. The Batch Credential Response MUST be sent as a JSON-encoded object using the <code>application/json</code> media type.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">The following claims are used in the Batch Credential Response:<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-8.2-3.1">
            <code>credential_responses</code>: REQUIRED. Array that contains Credential Response objects as defined in <a href="#credential_request" class="auto internal xref">Section 7.2</a> and/or Deferred Credential Response objects as defined in <a href="#deferred-credential_request" class="auto internal xref">Section 9.1</a>. Every entry of the array corresponds to the Credential Request object at the same array index in the <code>credential_requests</code> parameter of the Batch Credential Request.<a href="#section-8.2-3.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.2-3.2">
            <code>c_nonce</code>: OPTIONAL. The <code>c_nonce</code> as defined in <a href="#credential-response" class="auto internal xref">Section 7.3</a>.<a href="#section-8.2-3.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.2-3.3">
            <code>c_nonce_expires_in</code>: OPTIONAL. The <code>c_nonce_expires_in</code> as defined in <a href="#credential-response" class="auto internal xref">Section 7.3</a>.<a href="#section-8.2-3.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.2-4">Below is a non-normative example of a Batch Credential Response in an immediate issuance flow:<a href="#section-8.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.2-5">
<pre>HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
  "credential_responses": [{
    "format": "jwt_vc_json",
    "credential": "eyJraWQiOiJkaWQ6ZXhhbXBsZTpl...C_aZKPxgihac0aW9EkL1nOzM"
  },
  {
    "format": "mso_mdoc",
    "credential": "YXNkZnNhZGZkamZqZGFza23....29tZTIzMjMyMzIzMjMy"
  }],
  "c_nonce": "fGFF7UkhLa",
  "c_nonce_expires_in": 86400
}
</pre><a href="#section-8.2-5" class="pilcrow">¶</a>
</div>
<p id="section-8.2-6">Below is a non-normative example of a Batch Credential Response that contains Credential Response and Deferred Credential Response objects:<a href="#section-8.2-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.2-7">
<pre>HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
   "credential_responses":[
      {
         "transaction_id":"8xLOxBtZp8"
      },
      {
         "format":"jwt_vc_json",
         "credential":"YXNkZnNhZGZkamZqZGFza23....29tZTIzMjMyMzIzMjMy"
      }
   ],
   "c_nonce":"fGFF7UkhLa",
   "c_nonce_expires_in":86400
}
</pre><a href="#section-8.2-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="batch-credential_error_response">
<section id="section-8.3">
        <h3 id="name-batch-credential-error-resp">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-batch-credential-error-resp" class="section-name selfRef">Batch Credential Error Response</a>
        </h3>
<p id="section-8.3-1">The Batch Credential Endpoint MUST respond with an HTTP 400 (Bad Request) status code in case of an error, unless specified otherwise.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3-2">Error codes extensions defined in <a href="#credential-error-response" class="auto internal xref">Section 7.3.1</a> apply.<a href="#section-8.3-2" class="pilcrow">¶</a></p>
<p id="section-8.3-3">The Batch Credential Request MUST fail entirely if there is even one credential failed to be issued. <code>transaction_id</code> MUST NOT be returned in this case.<a href="#section-8.3-3" class="pilcrow">¶</a></p>
<p id="section-8.3-4">When the Credential Issuer requires <code>proof</code> objects to be present in the Batch Credential Request, but does not receive them, it will return a Batch Credential Error Response with a <code>c_nonce</code> using <code>invalid_proof</code> error code as defined in <a href="#issuer-provided-nonce" class="auto internal xref">Section 7.3.2</a>.<a href="#section-8.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="deferred-credential-issuance">
<section id="section-9">
      <h2 id="name-deferred-credential-endpoin">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-deferred-credential-endpoin" class="section-name selfRef">Deferred Credential Endpoint</a>
      </h2>
<p id="section-9-1">This endpoint is used to issue a Credential previously requested at the Credential Endpoint or Batch Credential Endpoint in case the Credential Issuer was not able to immediately issue this Credential.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">The Wallet MUST present to the Deferred Endpoint an Access Token valid for the issuance of the Credential previously requested at the Credential Endpoint or the Batch Credential Endpoint.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">Communication with the Deferred Credential Endpoint MUST utilize TLS.<a href="#section-9-3" class="pilcrow">¶</a></p>
<div id="deferred-credential_request">
<section id="section-9.1">
        <h3 id="name-deferred-credential-request">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-deferred-credential-request" class="section-name selfRef">Deferred Credential Request</a>
        </h3>
<p id="section-9.1-1">The Deferred Credential Request is an HTTP POST request. It MUST be sent using the <code>application/json</code> media type.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">The following claims are used in the Batch Credential Response:<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-9.1-3.1">
            <code>transaction_id</code>: REQUIRED. String identifying a Deferred Issuance transaction.<a href="#section-9.1-3.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-9.1-4">Credential Issuer MUST invalidate <code>transaction_id</code> after the credential for which it was meant was obtained by the Wallet.<a href="#section-9.1-4" class="pilcrow">¶</a></p>
<p id="section-9.1-5">The following is a non-normative example of a Deferred Credential Request:<a href="#section-9.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.1-6">
<pre>Host: server.example.com
Content-Type: application/json
Authorization: BEARER czZCaGRSa3F0MzpnWDFmQmF0M2JW

{
   "transaction_id":"8xLOxBtZp8"
}

</pre><a href="#section-9.1-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="deferred-credential_response">
<section id="section-9.2">
        <h3 id="name-deferred-credential-respons">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-deferred-credential-respons" class="section-name selfRef">Deferred Credential Response</a>
        </h3>
<p id="section-9.2-1">The Deferred Credential Response uses the <code>format</code> and <code>credential</code> parameters as defined in <a href="#credential-response" class="auto internal xref">Section 7.3</a>.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">Deferred Credential Response MUST be sent using the <code>application/json</code> media type.<a href="#section-9.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="deferred-credential_error_response">
<section id="section-9.3">
        <h3 id="name-deferred-credential-error-r">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-deferred-credential-error-r" class="section-name selfRef">Deferred Credential Error Response</a>
        </h3>
<p id="section-9.3-1">When the Deferred Credential Request is invalid or the Credential is not available yet, the Credential Issuer constructs the error response as defined in <a href="#credential-error-response" class="auto internal xref">Section 7.3.1</a>.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3-2">The following additional error codes are specified in addition to those already defined in <a href="#credential-request-errors" class="auto internal xref">Section 7.3.1.2</a>:<a href="#section-9.3-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-9.3-3.1">
            <code>issuance_pending</code> - The Credential issuance is still pending. The error response SHOULD also contain the <code>interval</code> member, determining the minimum amount of time in seconds that the Wallet needs to wait before providing a new request to the Deferred Credential Endpoint.  If <code>interval</code> member is missing or its value is not provided, the Wallet MUST use <code>5</code> as the default value.<a href="#section-9.3-3.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-9.3-3.2">
            <code>invalid_transaction_id</code> - The Deferred Credential Request contains an invalid <code>transaction_id</code>. This error occurs when the <code>transaction_id</code> was not issued by the respective Credential Issuer or it was already used to obtain the Credential.<a href="#section-9.3-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-9.3-4">This is a non-normative example of a Deferred Credential Error Response:<a href="#section-9.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.3-5">
<pre>HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store

{
   "error": "invalid_transaction_id"
}
</pre><a href="#section-9.3-5" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="metadata">
<section id="section-10">
      <h2 id="name-metadata">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-metadata" class="section-name selfRef">Metadata</a>
      </h2>
<div id="client-metadata">
<section id="section-10.1">
        <h3 id="name-client-metadata">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-client-metadata" class="section-name selfRef">Client Metadata</a>
        </h3>
<p id="section-10.1-1">This specification defines the following new Client Metadata parameter in addition to <span>[<a href="#RFC7591" class="cite xref">RFC7591</a>]</span> for Wallets acting as OAuth 2.0 Client:<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-10.1-2.1">
            <code>credential_offer_endpoint</code>: OPTIONAL. Credential Offer Endpoint of a Wallet.<a href="#section-10.1-2.1" class="pilcrow">¶</a>
</li>
        </ul>
<div id="client-metadata-retrieval">
<section id="section-10.1.1">
          <h4 id="name-client-metadata-retrieval">
<a href="#section-10.1.1" class="section-number selfRef">10.1.1. </a><a href="#name-client-metadata-retrieval" class="section-name selfRef">Client Metadata Retrieval</a>
          </h4>
<p id="section-10.1.1-1">How to obtain Client Metadata is out of scope of this specification. The profiles of this specification may define static Client Metadata values.<a href="#section-10.1.1-1" class="pilcrow">¶</a></p>
<p id="section-10.1.1-2">If the Credential Issuer is unable to perform discovery of the Wallet's Credential Offer Endpoint, the following claimed URL is used: <code>openid-credential-offer://</code>.<a href="#section-10.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="credential-issuer-metadata">
<section id="section-10.2">
        <h3 id="name-credential-issuer-metadata">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-credential-issuer-metadata" class="section-name selfRef">Credential Issuer Metadata</a>
        </h3>
<div id="credential-issuer-identifier">
<section id="section-10.2.1">
          <h4 id="name-credential-issuer-identifie">
<a href="#section-10.2.1" class="section-number selfRef">10.2.1. </a><a href="#name-credential-issuer-identifie" class="section-name selfRef">Credential Issuer Identifier</a>
          </h4>
<p id="section-10.2.1-1">A Credential Issuer is identified by a case sensitive URL using the <code>https</code> scheme that contains scheme, host and, optionally, port number and path components, but no query or fragment components.<a href="#section-10.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credential-issuer-wellknown">
<section id="section-10.2.2">
          <h4 id="name-credential-issuer-metadata-">
<a href="#section-10.2.2" class="section-number selfRef">10.2.2. </a><a href="#name-credential-issuer-metadata-" class="section-name selfRef">Credential Issuer Metadata Retrieval</a>
          </h4>
<p id="section-10.2.2-1">The Credential Issuer's configuration can be retrieved using the Credential Issuer Identifier.<a href="#section-10.2.2-1" class="pilcrow">¶</a></p>
<p id="section-10.2.2-2">Credential Issuers publishing metadata MUST make a JSON document available at the path formed by concatenating the string <code>/.well-known/openid-credential-issuer</code> to the Credential Issuer Identifier. If the Credential Issuer value contains a path component, any terminating <code>/</code> MUST be removed before appending <code>/.well-known/openid-credential-issuer</code>.<a href="#section-10.2.2-2" class="pilcrow">¶</a></p>
<p id="section-10.2.2-3">The path formed following the steps above MUST point to a JSON document compliant with this specification. The document MUST be returned using the <code>application/json</code> media type.<a href="#section-10.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credential-issuer-parameters">
<section id="section-10.2.3">
          <h4 id="name-credential-issuer-metadata-p">
<a href="#section-10.2.3" class="section-number selfRef">10.2.3. </a><a href="#name-credential-issuer-metadata-p" class="section-name selfRef">Credential Issuer Metadata Parameters</a>
          </h4>
<p id="section-10.2.3-1">This specification defines the following Credential Issuer Metadata:<a href="#section-10.2.3-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-10.2.3-2.1">
              <code>credential_issuer</code>: REQUIRED. The Credential Issuer's identifier, as defined in <a href="#credential-issuer-identifier" class="auto internal xref">Section 10.2.1</a>.<a href="#section-10.2.3-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-10.2.3-2.2">
              <code>authorization_servers</code>: OPTIONAL. An array of strings, where each string is an identifier of the OAuth 2.0 Authorization Server (as defined in <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span>) the Credential Issuer relies on for authorization. If this parameter is omitted, the entity providing the Credential Issuer is also acting as the AS, i.e., the Credential Issuer's identifier is used as the OAuth 2.0 Issuer value to obtain the Authorization Server metadata as per <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span>. When there are multiple entries in the array, the Wallet may be able to determine which AS to use by querying the metadata; for example, by examining the <code>grant_types_supported</code> values, the Wallet can filter the server to use based on the grant type it plans to use. When the Wallet is using <code>authorization_server</code> parameter in the Credential Offer as a hint to determine which AS to use out of multiple, the Wallet MUST NOT proceed with the flow if the <code>authorization_server</code> Credential Offer parameter value does not match any of the entries in the <code>authorization_servers</code> array.<a href="#section-10.2.3-2.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-10.2.3-2.3">
              <code>credential_endpoint</code>: REQUIRED. URL of the Credential Issuer's Credential Endpoint. This URL MUST use the <code>https</code> scheme and MAY contain port, path, and query parameter components.<a href="#section-10.2.3-2.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-10.2.3-2.4">
              <code>batch_credential_endpoint</code>: OPTIONAL. URL of the Credential Issuer's Batch Credential Endpoint. This URL MUST use the <code>https</code> scheme and MAY contain port, path, and query parameter components. If omitted, the Credential Issuer does not support the Batch Credential Endpoint.<a href="#section-10.2.3-2.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-10.2.3-2.5">
              <code>deferred_credential_endpoint</code>: OPTIONAL. URL of the Credential Issuer's Deferred Credential Endpoint. This URL MUST use the <code>https</code> scheme and MAY contain port, path, and query parameter components. If omitted, the Credential Issuer does not support the Deferred Credential Endpoint.<a href="#section-10.2.3-2.5" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-10.2.3-2.6">
              <code>credential_response_encryption_alg_values_supported</code>: OPTIONAL. Array containing a list of the JWE <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span> encryption algorithms (<code>alg</code> values) <span>[<a href="#RFC7518" class="cite xref">RFC7518</a>]</span> supported by the Credential and/or Batch Credential Endpoint to encode the Credential or Batch Credential Response in a JWT <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-10.2.3-2.6" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-10.2.3-2.7">
              <code>credential_response_encryption_enc_values_supported</code>: OPTIONAL. Array containing a list of the JWE <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span> encryption algorithms (<code>enc</code> values) <span>[<a href="#RFC7518" class="cite xref">RFC7518</a>]</span> supported by the Credential and/or Batch Credential Endpoint to encode the Credential or Batch Credential Response in a JWT <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-10.2.3-2.7" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-10.2.3-2.8">
              <code>require_credential_response_encryption</code>: OPTIONAL. Boolean value specifying whether the Credential Issuer requires additional encryption on top of TLS for the Credential Response and expects encryption parameters to be present in the Credential Request and/or Batch Credential Request, with <code>true</code> indicating support. When the value is <code>true</code>, <code>credential_response_encryption_alg_values_supported</code> parameter MUST also be provided.  If omitted, the default value is <code>false</code>.<a href="#section-10.2.3-2.8" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-10.2.3-2.9">
              <code>credential_identifiers_supported</code>: OPTIONAL. Boolean value specifying whether the Credential Issuer supports returning <code>credential_identifiers</code> parameter in the <code>authorization_details</code> Token Response parameter, with <code>true</code> indicating support. If omitted, the default value is <code>false</code>.<a href="#section-10.2.3-2.9" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-10.2.3-2.10">
              <p id="section-10.2.3-2.10.1"><code>display</code>: OPTIONAL. An array of objects, where each object contains display properties of a Credential Issuer for a certain language. Below is a non-exhaustive list of valid parameters that MAY be included:<a href="#section-10.2.3-2.10.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-10.2.3-2.10.2.1">
                  <code>name</code>: OPTIONAL. String value of a display name for the Credential Issuer.<a href="#section-10.2.3-2.10.2.1" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-10.2.3-2.10.2.2">
                  <code>locale</code>: OPTIONAL. String value that identifies the language of this object represented as a language tag taken from values defined in BCP47 <span>[<a href="#RFC5646" class="cite xref">RFC5646</a>]</span>. There MUST be only one object for each language identifier.<a href="#section-10.2.3-2.10.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="compact" id="section-10.2.3-2.11">
              <p id="section-10.2.3-2.11.1"><code>credentials_supported</code>: REQUIRED. An object that describes specifics of the Credential that the Credential Issuer supports issuance of. This object contains a list of name/value pairs, where each name is a unique identifier of the supported credential being described. This identifier is used in the Credential Offer as defined in <a href="#credential_offer_parameters" class="auto internal xref">Section 4.1.1</a> to communicate to the Wallet which Credential is being offered. The value is an object that contains metadata about specific credential and contains the following parameters defined by this specification:<a href="#section-10.2.3-2.11.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-10.2.3-2.11.2.1">
                  <code>format</code>: REQUIRED. A JSON string identifying the format of this credential, i.e., <code>jwt_vc_json</code> or <code>ldp_vc</code>. Depending on the format value, the object contains further elements defining the type and (optionally) particular claims the credential MAY contain and information about how to display the credential. <a href="#format_profiles" class="auto internal xref">Appendix E</a> defines Credential Format Profiles introduced by this specification.<a href="#section-10.2.3-2.11.2.1" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-10.2.3-2.11.2.2">
                  <code>scope</code>: OPTIONAL. A JSON string identifying the scope value that this Credential Issuer supports for this particular credential. The value can be the same accross multiple <code>credentials_supported</code> objects. The Authorization Server MUST be able to uniquely identify the Credential Issuer based on the scope value. The Wallet can use this value in the Authorization Request as defined in <a href="#credential-request-using-type-specific-scope" class="auto internal xref">Section 5.1.2</a>. Scope values in this Credential Issuer metadata MAY duplicate those in the <code>scopes_supported</code> parameter of the Authorization Server.<a href="#section-10.2.3-2.11.2.2" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-10.2.3-2.11.2.3">
                  <code>cryptographic_binding_methods_supported</code>: OPTIONAL. Array of case sensitive strings that identify how the Credential is bound to the identifier of the End-User who possesses the Credential as defined in <a href="#credential-binding" class="auto internal xref">Section 7.1</a>. Support for keys in JWK format <span>[<a href="#RFC7517" class="cite xref">RFC7517</a>]</span> is indicated by the value <code>jwk</code>. Support for keys expressed as a COSE Key object <span>[<a href="#RFC8152" class="cite xref">RFC8152</a>]</span> (for example, used in <span>[<a href="#ISO.18013-5" class="cite xref">ISO.18013-5</a>]</span>) is indicated by the value <code>cose_key</code>. When Cryptographic Binding Method is a DID, valid values MUST be a <code>did:</code> prefix followed by a method-name using a syntax as defined in Section 3.1 of <span>[<a href="#DID-Core" class="cite xref">DID-Core</a>]</span>, but without a <code>:</code>and method-specific-id. For example, support for the DID method with a method-name "example" would be represented by <code>did:example</code>. Support for all DID methods listed in Section 13 of <span>[<a href="#DID_Specification_Registries" class="cite xref">DID_Specification_Registries</a>]</span> is indicated by sending a DID without any method-name.<a href="#section-10.2.3-2.11.2.3" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-10.2.3-2.11.2.4">
                  <code>cryptographic_suites_supported</code>: OPTIONAL. Array of case sensitive strings that identify the cryptographic suites that are supported for the <code>cryptographic_binding_methods_supported</code>. Cryptographic algorithms for Credentials in <code>jwt_vc</code> format should use algorithm names defined in <a href="https://www.iana.org/assignments/jose/jose.xhtml#web-signature-encryption-algorithms">IANA JOSE Algorithms Registry</a>. Cryptographic algorithms for Credentials in <code>ldp_vc</code> format should use signature suites names defined in <a href="https://w3c-ccg.github.io/ld-cryptosuite-registry/">Linked Data Cryptographic Suite Registry</a>.<a href="#section-10.2.3-2.11.2.4" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-10.2.3-2.11.2.5">
                  <code>proof_types_supported</code>: OPTIONAL. A JSON array of case sensitive strings, each representing <code>proof_type</code> that the Credential Issuer supports. Supported values include those defined in <a href="#proof_types" class="auto internal xref">Section 7.2.1</a> or other values defined in a profile of this specification or elsewhere. If omitted, the default value is <code>jwt</code>. <code>proof_type</code> claim is defined in <a href="#credential_request" class="auto internal xref">Section 7.2</a>.<a href="#section-10.2.3-2.11.2.5" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-10.2.3-2.11.2.6">
                  <p id="section-10.2.3-2.11.2.6.1"><code>display</code>: OPTIONAL. An array of objects, where each object contains the display properties of the supported credential for a certain language. Below is a non-exhaustive list of parameters that MAY be included.<a href="#section-10.2.3-2.11.2.6.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-10.2.3-2.11.2.6.2.1">
                      <code>name</code>: REQUIRED. String value of a display name for the Credential.<a href="#section-10.2.3-2.11.2.6.2.1" class="pilcrow">¶</a>
</li>
                    <li class="compact" id="section-10.2.3-2.11.2.6.2.2">
                      <code>locale</code>: OPTIONAL. String value that identifies the language of this object represented as a language tag taken from values defined in BCP47 <span>[<a href="#RFC5646" class="cite xref">RFC5646</a>]</span>. Multiple <code>display</code> objects MAY be included for separate languages. There MUST be only one object for each language identifier.<a href="#section-10.2.3-2.11.2.6.2.2" class="pilcrow">¶</a>
</li>
                    <li class="compact" id="section-10.2.3-2.11.2.6.2.3">
                      <p id="section-10.2.3-2.11.2.6.2.3.1"><code>logo</code>: OPTIONAL. A JSON object with information about the logo of the Credential with a following non-exhaustive list of parameters that MAY be included:<a href="#section-10.2.3-2.11.2.6.2.3.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-10.2.3-2.11.2.6.2.3.2.1">
                          <code>url</code>: OPTIONAL. URL where the Wallet can obtain a logo of the Credential from the Credential Issuer.<a href="#section-10.2.3-2.11.2.6.2.3.2.1" class="pilcrow">¶</a>
</li>
                        <li class="compact" id="section-10.2.3-2.11.2.6.2.3.2.2">
                          <code>alt_text</code>: OPTIONAL. String value of an alternative text of a logo image.<a href="#section-10.2.3-2.11.2.6.2.3.2.2" class="pilcrow">¶</a>
</li>
                      </ul>
</li>
                    <li class="compact" id="section-10.2.3-2.11.2.6.2.4">
                      <code>description</code>: OPTIONAL. String value of a description of the Credential.<a href="#section-10.2.3-2.11.2.6.2.4" class="pilcrow">¶</a>
</li>
                    <li class="compact" id="section-10.2.3-2.11.2.6.2.5">
                      <code>background_color</code>: OPTIONAL. String value of a background color of the Credential represented as numerical color values defined in CSS Color Module Level 37 <span>[<a href="#CSS-Color" class="cite xref">CSS-Color</a>]</span>.<a href="#section-10.2.3-2.11.2.6.2.5" class="pilcrow">¶</a>
</li>
                    <li class="compact" id="section-10.2.3-2.11.2.6.2.6">
                      <code>text_color</code>: OPTIONAL. String value of a text color of the Credential represented as numerical color values defined in CSS Color Module Level 37 <span>[<a href="#CSS-Color" class="cite xref">CSS-Color</a>]</span>.<a href="#section-10.2.3-2.11.2.6.2.6" class="pilcrow">¶</a>
</li>
                  </ul>
</li>
              </ul>
</li>
          </ul>
<p id="section-10.2.3-3">Note: It can be challenging for a Credential Issuer that accepts tokens from multiple Authorization Servers to introspect an Access Token to check the validity and determine the permissions granted. Some ways to achieve this are relying on Authorization Servers that use <span>[<a href="#RFC9068" class="cite xref">RFC9068</a>]</span> or by the Credential Issuer understanding the proprietary Access Token structures of the Authorization Servers.<a href="#section-10.2.3-3" class="pilcrow">¶</a></p>
<p id="section-10.2.3-4">Depending on the Credential format, additional parameters might be present in the <code>credentials_supported</code> object values, such as information about claims in the credential. For Credential format specific claims, see "Credential Issuer Metadata" subsections in <a href="#format_profiles" class="auto internal xref">Appendix E</a>.<a href="#section-10.2.3-4" class="pilcrow">¶</a></p>
<p id="section-10.2.3-5">The AS MUST be able to determine from the Issuer metadata what claims are disclosed with the requested credentials to be able to render a meaningful End-User consent.<a href="#section-10.2.3-5" class="pilcrow">¶</a></p>
<p id="section-10.2.3-6">The following is a non-normative example of a Credential Issuer metadata.<a href="#section-10.2.3-6" class="pilcrow">¶</a></p>
<div class="breakable lang-json sourcecode" id="section-10.2.3-7">
<pre>{
    "credential_issuer": "https://credential-issuer.example.com",
    "authorization_servers": [ "https://server.example.com" ],
    "credential_endpoint": "https://credential-issuer.example.com",
    "batch_credential_endpoint": "https://credential-issuer.example.com/batch_credential",
    "deferred_credential_endpoint": "https://credential-issuer.example.com/deferred_credential",
    "display": [
        {
            "name": "Example University",
            "locale": "en-US"
        },
        {
            "name": "Example Université",
            "locale": "fr-FR"
        }
    ],
    "credentials_supported": {
        "UniversityDegreeCredential": {
            "format": "jwt_vc_json",
            "scope": "UniversityDegree",
            "cryptographic_binding_methods_supported": [
                "did:example"
            ],
            "cryptographic_suites_supported": [
                "ES256K"
            ],
            "credential_definition":{
                "type": [
                    "VerifiableCredential",
                    "UniversityDegreeCredential"
                ],
                "credentialSubject": {
                    "given_name": {
                        "display": [
                            {
                                "name": "Given Name",
                                "locale": "en-US"
                            }
                        ]
                    },
                    "family_name": {
                        "display": [
                            {
                                "name": "Surname",
                                "locale": "en-US"
                            }
                        ]
                    },
                    "degree": {},
                    "gpa": {
                        "display": [
                            {
                                "name": "GPA"
                            }
                        ]
                    }
                }
            },
            "proof_types_supported": [
                "jwt"
            ],
            "display": [
                {
                    "name": "University Credential",
                    "locale": "en-US",
                    "logo": {
                        "url": "https://exampleuniversity.com/public/logo.png",
                        "alt_text": "a square logo of a university"
                    },
                    "background_color": "#12107c",
                    "text_color": "#FFFFFF"
                }
            ]
        }
    }
}
</pre><a href="#section-10.2.3-7" class="pilcrow">¶</a>
</div>
<p id="section-10.2.3-8">Note: The Client MAY use other mechanisms to obtain information about the Verifiable Credentials that a Credential Issuer can issue.<a href="#section-10.2.3-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="oauth-2-0-authorization-server-metadata">
<section id="section-10.3">
        <h3 id="name-oauth-20-authorization-serv">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-oauth-20-authorization-serv" class="section-name selfRef">OAuth 2.0 Authorization Server Metadata</a>
        </h3>
<p id="section-10.3-1">This specification also defines a new OAuth 2.0 Authorization Server metadata <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span> parameter to publish whether the AS that the Credential Issuer relies on for authorization supports anonymous Token Requests with the Pre-Authorized Grant Type. It is defined as follows:<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-10.3-2.1">
            <code>pre-authorized_grant_anonymous_access_supported</code>: OPTIONAL. A boolean indicating whether the Credential Issuer accepts a Token Request with a Pre-Authorized Code but without a <code>client_id</code>. The default is <code>false</code>.<a href="#section-10.3-2.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-11">
      <h2 id="name-security-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="trust-between-wallet-and-issuer">
<section id="section-11.1">
        <h3 id="name-trust-between-wallet-and-is">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-trust-between-wallet-and-is" class="section-name selfRef">Trust between Wallet and Issuer</a>
        </h3>
<p id="section-11.1-1">Credential Issuers often want to know what Wallet they are issuing Credentials to and how private keys are managed for the following reasons:<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-11.1-2.1">The Credential Issuer MAY want to ensure that private keys are properly protected from exfiltration and replay to prevent an adversary from impersonating the legitimate Credential holder by presenting her Credential.<a href="#section-11.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-11.1-2.2">The Credential Issuer MAY also want to ensure that the Wallet managing the Credentials adheres to certain policies and, potentially, was audited and approved under a certain regulatory and/or commercial scheme.<a href="#section-11.1-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-11.1-3">The following mechanisms in concert can be utilized to fulfill those objectives:<a href="#section-11.1-3" class="pilcrow">¶</a></p>
<p id="section-11.1-4"><strong>Key attestation</strong> is a mechanism where the device or security element in a device asserts the key management policy to the application creating and using this key. The Android Operating System, for example, provides apps with a certificate including a certificate chain asserting that a particular key is managed, for example, by a hardware security module [ref]. The Wallet can provide this data along with the proof of possession in the Credential Request (see <a href="#credential_request" class="auto internal xref">Section 7.2</a> for an example) to allow the Credential Issuer to validate the key management policy. This requires the Credential Issuer to rely on the trust anchor of the certificate chain and the respective key management policy. Another variant of this concept is the use of a Qualified Electronic Signature as defined by the eIDAS regulation [ref]. This signature will not reveal the properties of the associated private key to the Credential Issuer. However, as one example, due to the regulatory regime of eIDAS, the Credential Issuer can deduce that the signing service manages the private keys according to this regime and fulfills very high security requirements. As another example, FIDO2 allows RPs to obtain an attestation along with the public key from a FIDO authenticator. That implicitly asserts the key management policy since the assertion is bound to a certain authenticator model and its key management capabilities.<a href="#section-11.1-4" class="pilcrow">¶</a></p>
<p id="section-11.1-5"><strong>App Attestation</strong>: Key attestation, however, does not establish trust in the application storing the Credential and producing presentation of that Credential. App attestation as provided by mobile operating systems, e.g., iOS's DeviceCheck or Android's SafetyNet, allows a server system to ensure it is communicating to a legitimate instance of its genuine app. Those mechanisms can be utilized to validate the internal integrity of the Wallet (as a whole).<a href="#section-11.1-5" class="pilcrow">¶</a></p>
<p id="section-11.1-6"><strong>Device Attestation</strong>: Device Attestation attests the health of the device on which the Wallet is running, as a whole. It helps prevent compromises such as a malicious third-party application tampering with a Wallet that manages keys and Credentials, which cannot be captured only by obtaining app attestation of a Wallet.<a href="#section-11.1-6" class="pilcrow">¶</a></p>
<p id="section-11.1-7"><strong>Client Authentication</strong> allows a Wallet to authenticate with a Credential Issuer. To securely authenticate, the Wallet needs to utilize a backend component managing the key material and processing the secure communication with the Credential Issuer. The Credential Issuer MAY establish trust with the Wallet based on its own auditing or a trusted third-party attestation of the conformance of the Wallet to a certain policy.<a href="#section-11.1-7" class="pilcrow">¶</a></p>
<p id="section-11.1-8">Directly using key, app and/or device attestations to prove certain capabilities towards a Credential Issuer is an obvious option. However, this at least requires platform mechanisms that issue signed assertions that third parties can evaluate, which is not always the case (e.g., iOS's DeviceCheck). Also, such an approach creates dependencies on platform specific mechanisms, trust anchors, and platform specific identifiers (e.g., Android <code>apkPackageName</code>) and it reveals information about the internal design of a Wallet. Implementers should take these consequences into account.<a href="#section-11.1-8" class="pilcrow">¶</a></p>
<p id="section-11.1-9">The approach recommended by this specification is that the Credential Issuer relies on the OAuth 2.0 Client Authentication to establish trust in the Wallet and leaves it to the Wallet to ensure its internal integrity using app and key attestation (if required). This establishes a clean separation between the different components and a uniform interface irrespective of the Wallet's architecture (e.g., native vs. Web Wallet). Client Authentication can be performed with assertions registered with the Credential Issuer or with assertions issued to the Wallet by a third party the Credential Issuer trusts for the purpose of Client Authentication.<a href="#section-11.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credential-offer-security">
<section id="section-11.2">
        <h3 id="name-credential-offer-2">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-credential-offer-2" class="section-name selfRef">Credential Offer</a>
        </h3>
<p id="section-11.2-1">The Wallet MUST consider the parameter values in the Credential Offer as not trustworthy since the origin is not authenticated and the message integrity is not protected. The Wallet MUST apply the same checks on the Credential Issuer that it would apply when the flow is started from the Wallet itself since the Credential Issuer is not trustworthy just because it sent the Credential Offer. An attacker might attempt to use a Credential Offer to conduct a phishing or injection attack.<a href="#section-11.2-1" class="pilcrow">¶</a></p>
<p id="section-11.2-2">The Wallet MUST NOT accept Credentials just because this mechanism was used. All protocol steps defined in this specification MUST be performed in the same way as if the Wallet would have started the flow.<a href="#section-11.2-2" class="pilcrow">¶</a></p>
<p id="section-11.2-3">The Credential Issuer MUST ensure the release of any privacy-sensitive data in Credential Offer is legally based.<a href="#section-11.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security_considerations_pre-authz-code">
<section id="section-11.3">
        <h3 id="name-pre-authorized-code-flow-2">
<a href="#section-11.3" class="section-number selfRef">11.3. </a><a href="#name-pre-authorized-code-flow-2" class="section-name selfRef">Pre-Authorized Code Flow</a>
        </h3>
<div id="replay-prevention">
<section id="section-11.3.1">
          <h4 id="name-replay-prevention">
<a href="#section-11.3.1" class="section-number selfRef">11.3.1. </a><a href="#name-replay-prevention" class="section-name selfRef">Replay Prevention</a>
          </h4>
<p id="section-11.3.1-1">The Pre-Authorized Code Flow is vulnerable to the replay of the Pre-Authorized Code, because by design, it is not bound to a certain device (as the Authorization Code Flow does with PKCE). This means an attacker can replay at another device the Pre-Authorized Code meant for a victim, e.g., the attacker can scan the QR code while it is displayed on the victim's screen, and thereby get access to the Credential. Such replay attacks must be prevented using other means. The design facilitates the following options:<a href="#section-11.3.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-11.3.1-2.1">User PIN: the Credential Issuer might set up a PIN with the End-User (e.g., via text message or email) that needs to be presented in the Token Request.<a href="#section-11.3.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-11.3.1-2.2">Callback to device where the transaction originated: upon receiving the Token Request, the Credential Issuer asks the End-User to confirm the originating device (device that displayed the QR code) that the Credential Issuer MAY proceed with the Credential issuance process. While the Credential Issuer reaches out to the End-User on the other device to get confirmation, the Credential Issuer's Authorization Server returns an error code <code>authorization_pending</code> or <code>slow_down</code> to the Wallet as described in <a href="#token_error_response" class="auto internal xref">Section 6.3</a>. The Wallet is required to call the Token Endpoint again to obtain the Access Token. If the End-User does not confirm, the Token Request is returned with the <code>access_denied</code> error code. This flow gives the End-User on the originating device more control over the issuance process.<a href="#section-11.3.1-2.2" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="pin-code-phishing">
<section id="section-11.3.2">
          <h4 id="name-pin-code-phishing">
<a href="#section-11.3.2" class="section-number selfRef">11.3.2. </a><a href="#name-pin-code-phishing" class="section-name selfRef">PIN Code Phishing</a>
          </h4>
<p id="section-11.3.2-1">An attacker might leverage the Credential issuance process and the End-User's trust into the Wallet to phish PIN codes sent out by a different service that grant the attacker access to services other than Credential issuance. The attacker could set up a Credential Issuer site and in parallel to the issuance request trigger transmission of a PIN code to the End-User's phone from a service other than Credential issuance, e.g., from a payment service. The End-User would then be asked to enter this PIN into the Wallet and since the Wallet sends this PIN to the Token Endpoint of the Credential Issuer (the attacker), the attacker would get access to the PIN code, and access to that other service.<a href="#section-11.3.2-1" class="pilcrow">¶</a></p>
<p id="section-11.3.2-2">In order to cope with that issue, the Wallet is RECOMMENDED to interact with trusted Credential Issuers only. In that case, the Wallet would not process a Credential Offer with an untrusted issuer URL. The Wallet MAY also show the End-User the endpoint of the Credential Issuer it will be sending the PIN code to and ask the End-User for confirmation.<a href="#section-11.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="credential-lifecycle-management">
<section id="section-11.4">
        <h3 id="name-credential-lifecycle-manage">
<a href="#section-11.4" class="section-number selfRef">11.4. </a><a href="#name-credential-lifecycle-manage" class="section-name selfRef">Credential Lifecycle Management</a>
        </h3>
<p id="section-11.4-1">The Credential Issuer is supposed to be responsible for the lifecycle of its Credentials. This means the Credential Issuer will invalidate Credentials when it deems appropriate, e.g., if it detects fraudulent behavior.<a href="#section-11.4-1" class="pilcrow">¶</a></p>
<p id="section-11.4-2">The Wallet is supposed to detect signs of fraudulent behavior related to the Credential management in the Wallet (e.g., device rooting) and to act upon such signals. Options include Credential revocation at the Credential Issuer and/or invalidation of the key material used to cryptographically bind the Credential to the identifier of the End-User possessing that Credential.<a href="#section-11.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-proof-replay">
<section id="section-11.5">
        <h3 id="name-key-proof-replay">
<a href="#section-11.5" class="section-number selfRef">11.5. </a><a href="#name-key-proof-replay" class="section-name selfRef">Key Proof replay</a>
        </h3>
<p id="section-11.5-1">If an adversary is able to get hold of a key proof defined in <a href="#proof_types" class="auto internal xref">Section 7.2.1</a>, the adversary could get a Credential issued that is bound to a key pair controlled by the victim.<a href="#section-11.5-1" class="pilcrow">¶</a></p>
<p id="section-11.5-2">Note: For the attacker to be able to present to the Verifier a Credential bound to a replayed Key Proof, the attacker also needs to obtain the victim's private key. To limit this, servers are RECOMMENDED to check how the Wallet protects the private keys, using mechanisms such as Key Based Client Authentication defined in <span>[<a href="#I-D.looker-oauth-attestation-based-client-auth" class="cite xref">I-D.looker-oauth-attestation-based-client-auth</a>]</span>.<a href="#section-11.5-2" class="pilcrow">¶</a></p>
<p id="section-11.5-3"><code>nonce</code> parameter is the primary countermeasure against key proof replay. To further narrow down the attack vector, the Credential Issuer SHOULD bind a unique <code>nonce</code> parameter to the respective Access Token.<a href="#section-11.5-3" class="pilcrow">¶</a></p>
<p id="section-11.5-4">Note: To accommodate for clock offsets, the Credential Issuer server MAY accept proofs that carry an <code>iat</code> time in the reasonably near future (on the order of seconds or minutes). Because clock skews between servers and Clients may be large, servers MAY limit key proof lifetimes by using server-provided nonce values containing the time at the server rather than comparing the client-supplied <code>iat</code> time to the time at the server. Nonces created in this way yield the same result even in the face of arbitrarily large clock skews.<a href="#section-11.5-4" class="pilcrow">¶</a></p>
<p id="section-11.5-5">Server-provided nonces are an effective means for further reducing the chances for successful key proof replay by an attacker. A Wallet can keep using a certain nonce until the Credential Issuer provides a fresh nonce. This way the Credential Issuer determines how often a certain nonce can be used. Servers MUST have a clear policy whether the same key proof can be presented multiple times and for how long, or whether each Credential Request MUST have a fresh key proof.<a href="#section-11.5-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tls-requirements">
<section id="section-11.6">
        <h3 id="name-tls-requirements">
<a href="#section-11.6" class="section-number selfRef">11.6. </a><a href="#name-tls-requirements" class="section-name selfRef">TLS Requirements</a>
        </h3>
<p id="section-11.6-1">Implementations MUST follow <span>[<a href="#BCP195" class="cite xref">BCP195</a>]</span>.<a href="#section-11.6-1" class="pilcrow">¶</a></p>
<p id="section-11.6-2">Whenever TLS is used, a TLS server certificate check MUST be performed, per <span>[<a href="#RFC6125" class="cite xref">RFC6125</a>]</span>.<a href="#section-11.6-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="implementation-considerations">
<section id="section-12">
      <h2 id="name-implementation-consideratio">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-implementation-consideratio" class="section-name selfRef">Implementation Considerations</a>
      </h2>
<div id="claim-based-binding">
<section id="section-12.1">
        <h3 id="name-claim-based-binding-of-the-">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-claim-based-binding-of-the-" class="section-name selfRef">Claim-based Binding of the Credential to the End-User possessing the Credential</a>
        </h3>
<p id="section-12.1-1">Credentials not cryptographically bound to the identifier of the End-User possessing it (see <a href="#credential-binding" class="auto internal xref">Section 7.1</a>), should be bound to the End-User possessing the Credential, based on the claims included in that Credential.<a href="#section-12.1-1" class="pilcrow">¶</a></p>
<p id="section-12.1-2">In claim-based binding, no cryptographic binding material is provided. Instead, the issued Credential includes End-User claims that can be used by the Verifier to verify possession of the Credential by requesting presentation of existing forms of physical or digital identification that includes the same claims (e.g., a driving license or other ID cards in person, or an online ID verification service).<a href="#section-12.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="no-binding">
<section id="section-12.2">
        <h3 id="name-binding-of-the-credential-w">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-binding-of-the-credential-w" class="section-name selfRef">Binding of the Credential without Cryptographic Binding or Claim-based Binding</a>
        </h3>
<p id="section-12.2-1">Some Credential Issuers might choose to issue bearer Credentials without either cryptographic binding or claim-based binding, because they are meant to be presented without proof of possession.<a href="#section-12.2-1" class="pilcrow">¶</a></p>
<p id="section-12.2-2">One such use case is low assurance Credentials, such as coupons or tickets.<a href="#section-12.2-2" class="pilcrow">¶</a></p>
<p id="section-12.2-3">Another use case is when the Credential Issuer uses cryptographic schemes that can provide binding to the End-User possessing that Credential without explicit cryptographic material being supplied by the application used by that End-User. For example, in the case of the BBS Signature Scheme, the issued Credential itself is a secret and only derivation of a Credential is presented to the Verifier. Effectively, Credential is bound to the Credential Issuer's signature on the Credential, which becomes a shared secret transferred from the Credential Issuer to the End-User.<a href="#section-12.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="multiple-accesses-to-the-credential-endpoint">
<section id="section-12.3">
        <h3 id="name-multiple-accesses-to-the-cr">
<a href="#section-12.3" class="section-number selfRef">12.3. </a><a href="#name-multiple-accesses-to-the-cr" class="section-name selfRef">Multiple Accesses to the Credential Endpoint</a>
        </h3>
<p id="section-12.3-1">The Credential Endpoint can be accessed multiple times by a Wallet using the same Access Token, even for the same Credential. The Credential Issuer determines if the subsequent successful requests will return the same or an updated Credential, such as having a new expiration time or using the most current End-User claims.<a href="#section-12.3-1" class="pilcrow">¶</a></p>
<p id="section-12.3-2">The Credential Issuer MAY also decide to no longer accept the Access Token and a re-authentication or Token Refresh (see <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, section 6) MAY be required at the Credential Issuer's discretion. The policies between the Credential Endpoint and the Authorization Server that MAY change the behavior of what is returned with a new Access Token are beyond the scope of this specification (see <span><a href="https://rfc-editor.org/rfc/rfc6749" class="relref">Section 7</a> of [<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>).<a href="#section-12.3-2" class="pilcrow">¶</a></p>
<p id="section-12.3-3">The action leading to the Wallet performing another Credential Request can also be triggered by a background process, or by the Credential Issuer using an out-of-band mechanism (SMS, email, etc.) to inform the End-User.<a href="#section-12.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="relationship-between-the-credential-issuer-identifier-in-the-metadata-and-the-issuer-identifier-in-the-issued-credential">
<section id="section-12.4">
        <h3 id="name-relationship-between-the-cr">
<a href="#section-12.4" class="section-number selfRef">12.4. </a><a href="#name-relationship-between-the-cr" class="section-name selfRef">Relationship between the Credential Issuer Identifier in the metadata and the Issuer Identifier in the Issued Credential</a>
        </h3>
<p id="section-12.4-1">Credential Issuer Identifier is always a URL using the <code>https</code> scheme as defined in <a href="#credential-issuer-identifier" class="auto internal xref">Section 10.2.1</a>. Depending on the Credential format, the issuer identifier in the issued Credential may not be a URL using the <code>https</code> scheme. Some other forms that it can take are a DID included in the <code>issuer</code> property in a <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span> format, or the <code>Subject</code> value of the document signer certificate included in the <code>x5chain</code> element in a <span>[<a href="#ISO.18013-5" class="cite xref">ISO.18013-5</a>]</span> format.<a href="#section-12.4-1" class="pilcrow">¶</a></p>
<p id="section-12.4-2">When the Issuer identifier in the issued Credential is a DID, below is a non-exhaustive list of mechanisms the Credential Issuer MAY use to bind to the Credential Issuer Identifier:<a href="#section-12.4-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-12.4-3">
<li id="section-12.4-3.1">Use the <span>[<a href="#DIF.Well-Known_DID" class="cite xref">DIF.Well-Known_DID</a>]</span> Specification to provide binding between a DID and a certain domain.<a href="#section-12.4-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-12.4-3.2">If the Issuer identifier in the issued Credential is an object, add to the object a <code>credential_issuer</code> claim, as defined in <a href="#credential-issuer-identifier" class="auto internal xref">Section 10.2.1</a>.<a href="#section-12.4-3.2" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-12.4-4">The Wallet MAY check the binding between the Credential Issuer Identifier and the Issuer identifier in the issued Credential.<a href="#section-12.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="refreshing-issued-credentials">
<section id="section-12.5">
        <h3 id="name-refreshing-issued-credentia">
<a href="#section-12.5" class="section-number selfRef">12.5. </a><a href="#name-refreshing-issued-credentia" class="section-name selfRef">Refreshing Issued Credentials</a>
        </h3>
<p id="section-12.5-1">After a Verifiable Credential has been issued to the Holder, claim values about the subject of a Credential, or a signature on the Credential may need to be updated. There are two possible mechanisms to do so.<a href="#section-12.5-1" class="pilcrow">¶</a></p>
<p id="section-12.5-2">First, the Wallet may receive an updated version of a Credential from a Credential Endpoint or a Batch Credential Endpoint using a valid Access Token. This does not involve interaction with the End-User. If the Credential Issuer issued a Refresh Token to the Wallet, the Wallet would have to obtain a fresh Access Token by making a request to the Token Endpoint as defined in Section 6 of <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-12.5-2" class="pilcrow">¶</a></p>
<p id="section-12.5-3">Second, the Credential Issuer can reissue the Credential by starting the issuance process from the beginning. This would involve interaction with the End-User. A Credential needs to be reissued if the Wallet does not have a valid Access Token or a valid Refresh Token. With this approach, when a new Credential is issued, the Wallet might need to check if it already has a Credential of the same type and, if necessary, delete the old Credential. Otherwise, the Wallet might end up with more than one Credential of the same type, without knowing which one is the latest.<a href="#section-12.5-3" class="pilcrow">¶</a></p>
<p id="section-12.5-4">Credential Refresh can be initiated by the Wallet independently from the Credential Issuer, or the Credential Issuer can send a signal to the Wallet asking it to request Credential refresh. How the Credential Issuer sends such a signal is out of scope for this specification.<a href="#section-12.5-4" class="pilcrow">¶</a></p>
<p id="section-12.5-5">It is up to the Credential Issuer whether to update both the signature and the claim values, or only the signature.<a href="#section-12.5-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protecting-the-access-token">
<section id="section-12.6">
        <h3 id="name-protecting-the-access-token">
<a href="#section-12.6" class="section-number selfRef">12.6. </a><a href="#name-protecting-the-access-token" class="section-name selfRef">Protecting the Access Token</a>
        </h3>
<p id="section-12.6-1">Access Tokens represent End-User authorization and consent to issue certain Credential(s). Long-lived Access Tokens giving access to credentials MUST not be issued unless sender-constrained. Access Tokens with lifetimes longer than 5 minutes are, in general, considered long lived.<a href="#section-12.6-1" class="pilcrow">¶</a></p>
<p id="section-12.6-2">To sender-constrain Access Tokens, see the recommendations in Section 4.10.1 in <span>[<a href="#I-D.ietf-oauth-security-topics" class="cite xref">I-D.ietf-oauth-security-topics</a>]</span>. If Bearer Access Tokens are stored by the Wallet, they MUST be stored in a secure manner, for example, encrypted using a key stored in a protected key store.<a href="#section-12.6-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-13">
      <h2 id="name-privacy-considerations">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-13-1">TBD<a href="#section-13-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-14">
      <h2 id="name-normative-references">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="BCP195">[BCP195]</dt>
      <dd>
<span class="refAuthor">IETF</span>, <span class="refTitle">"BCP195"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/bcp195">https://www.rfc-editor.org/info/bcp195</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CSS-Color">[CSS-Color]</dt>
      <dd>
<span class="refAuthor">Çelik, T.</span>, <span class="refAuthor">Lilley, C.</span>, and <span class="refAuthor">D. Baron</span>, <span class="refTitle">"CSS Color Module Level 3"</span>, <time datetime="2022-01-18" class="refDate">18 January 2022</time>, <span>&lt;<a href="https://www.w3.org/TR/css-color-3">https://www.w3.org/TR/css-color-3</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DID-Core">[DID-Core]</dt>
      <dd>
<span class="refAuthor">Sporny, M.</span>, <span class="refAuthor">Guy, A.</span>, <span class="refAuthor">Sabadello, M.</span>, and <span class="refAuthor">D. Reed</span>, <span class="refTitle">"Decentralized Identifiers (DIDs) v1.0"</span>, <time datetime="2021-08-03" class="refDate">3 August 2021</time>, <span>&lt;<a href="https://www.w3.org/TR/2021/PR-did-core-20210803/">https://www.w3.org/TR/2021/PR-did-core-20210803/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-oauth-security-topics">[I-D.ietf-oauth-security-topics]</dt>
      <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Labunets, A.</span>, and <span class="refAuthor">D. Fett</span>, <span class="refTitle">"OAuth 2.0 Security Best Current Practice"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-security-topics-24</span>, <time datetime="2023-10-23" class="refDate">23 October 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics-24">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics-24</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISO.18013-5">[ISO.18013-5]</dt>
      <dd>
<span class="refAuthor">ISO/IEC JTC 1/SC 17 Cards and security devices for personal identification</span>, <span class="refTitle">"ISO/IEC 18013-5:2021 Personal identification — ISO-compliant driving licence — Part 5: Mobile driving licence (mDL) application"</span>, <time datetime="2021" class="refDate">2021</time>, <span>&lt;<a href="https://www.iso.org/standard/69084.html">https://www.iso.org/standard/69084.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID.Federation">[OpenID.Federation]</dt>
      <dd>
<span class="refAuthor">Ed., R. H.</span>, <span class="refAuthor">Jones, M. B.</span>, <span class="refAuthor">Solberg, A.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Marco, G. D.</span>, and <span class="refAuthor">V. Dzhuvinov</span>, <span class="refTitle">"OpenID Federation 1.0"</span>, <time datetime="2023-11-08" class="refDate">8 November 2023</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-federation-1_0.html">https://openid.net/specs/openid-connect-federation-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2616">[RFC2616]</dt>
      <dd>
<span class="refAuthor">Fielding, R.</span>, <span class="refAuthor">Gettys, J.</span>, <span class="refAuthor">Mogul, J.</span>, <span class="refAuthor">Frystyk, H.</span>, <span class="refAuthor">Masinter, L.</span>, <span class="refAuthor">Leach, P.</span>, and <span class="refAuthor">T. Berners-Lee</span>, <span class="refTitle">"Hypertext Transfer Protocol -- HTTP/1.1"</span>, <span class="seriesInfo">RFC 2616</span>, <span class="seriesInfo">DOI 10.17487/RFC2616</span>, <time datetime="1999-06" class="refDate">June 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2616">https://www.rfc-editor.org/info/rfc2616</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5646">[RFC5646]</dt>
      <dd>
<span class="refAuthor">Phillips, A., Ed.</span> and <span class="refAuthor">M. Davis, Ed.</span>, <span class="refTitle">"Tags for Identifying Languages"</span>, <span class="seriesInfo">BCP 47</span>, <span class="seriesInfo">RFC 5646</span>, <span class="seriesInfo">DOI 10.17487/RFC5646</span>, <time datetime="2009-09" class="refDate">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5646">https://www.rfc-editor.org/info/rfc5646</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5785">[RFC5785]</dt>
      <dd>
<span class="refAuthor">Nottingham, M.</span> and <span class="refAuthor">E. Hammer-Lahav</span>, <span class="refTitle">"Defining Well-Known Uniform Resource Identifiers (URIs)"</span>, <span class="seriesInfo">RFC 5785</span>, <span class="seriesInfo">DOI 10.17487/RFC5785</span>, <time datetime="2010-04" class="refDate">April 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5785">https://www.rfc-editor.org/info/rfc5785</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6125">[RFC6125]</dt>
      <dd>
<span class="refAuthor">Saint-Andre, P.</span> and <span class="refAuthor">J. Hodges</span>, <span class="refTitle">"Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 6125</span>, <span class="seriesInfo">DOI 10.17487/RFC6125</span>, <time datetime="2011-03" class="refDate">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6125">https://www.rfc-editor.org/info/rfc6125</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
      <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6750">[RFC6750]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span> and <span class="refAuthor">D. Hardt</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework: Bearer Token Usage"</span>, <span class="seriesInfo">RFC 6750</span>, <span class="seriesInfo">DOI 10.17487/RFC6750</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6750">https://www.rfc-editor.org/info/rfc6750</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6755">[RFC6755]</dt>
      <dd>
<span class="refAuthor">Campbell, B.</span> and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"An IETF URN Sub-Namespace for OAuth"</span>, <span class="seriesInfo">RFC 6755</span>, <span class="seriesInfo">DOI 10.17487/RFC6755</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6755">https://www.rfc-editor.org/info/rfc6755</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7515">[RFC7515]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Signature (JWS)"</span>, <span class="seriesInfo">RFC 7515</span>, <span class="seriesInfo">DOI 10.17487/RFC7515</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7515">https://www.rfc-editor.org/info/rfc7515</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7516">[RFC7516]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span> and <span class="refAuthor">J. Hildebrand</span>, <span class="refTitle">"JSON Web Encryption (JWE)"</span>, <span class="seriesInfo">RFC 7516</span>, <span class="seriesInfo">DOI 10.17487/RFC7516</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7516">https://www.rfc-editor.org/info/rfc7516</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7517">[RFC7517]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Key (JWK)"</span>, <span class="seriesInfo">RFC 7517</span>, <span class="seriesInfo">DOI 10.17487/RFC7517</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7517">https://www.rfc-editor.org/info/rfc7517</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7518">[RFC7518]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Algorithms (JWA)"</span>, <span class="seriesInfo">RFC 7518</span>, <span class="seriesInfo">DOI 10.17487/RFC7518</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7518">https://www.rfc-editor.org/info/rfc7518</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7591">[RFC7591]</dt>
      <dd>
<span class="refAuthor">Richer, J., Ed.</span>, <span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Machulak, M.</span>, and <span class="refAuthor">P. Hunt</span>, <span class="refTitle">"OAuth 2.0 Dynamic Client Registration Protocol"</span>, <span class="seriesInfo">RFC 7591</span>, <span class="seriesInfo">DOI 10.17487/RFC7591</span>, <time datetime="2015-07" class="refDate">July 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7591">https://www.rfc-editor.org/info/rfc7591</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7636">[RFC7636]</dt>
      <dd>
<span class="refAuthor">Sakimura, N., Ed.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Agarwal</span>, <span class="refTitle">"Proof Key for Code Exchange by OAuth Public Clients"</span>, <span class="seriesInfo">RFC 7636</span>, <span class="seriesInfo">DOI 10.17487/RFC7636</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7636">https://www.rfc-editor.org/info/rfc7636</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8152">[RFC8152]</dt>
      <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE)"</span>, <span class="seriesInfo">RFC 8152</span>, <span class="seriesInfo">DOI 10.17487/RFC8152</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8152">https://www.rfc-editor.org/info/rfc8152</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8392">https://www.rfc-editor.org/info/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8414">[RFC8414]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Sakimura, N.</span>, and <span class="refAuthor">J. Bradley</span>, <span class="refTitle">"OAuth 2.0 Authorization Server Metadata"</span>, <span class="seriesInfo">RFC 8414</span>, <span class="seriesInfo">DOI 10.17487/RFC8414</span>, <time datetime="2018-06" class="refDate">June 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8414">https://www.rfc-editor.org/info/rfc8414</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8628">[RFC8628]</dt>
      <dd>
<span class="refAuthor">Denniss, W.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"OAuth 2.0 Device Authorization Grant"</span>, <span class="seriesInfo">RFC 8628</span>, <span class="seriesInfo">DOI 10.17487/RFC8628</span>, <time datetime="2019-08" class="refDate">August 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8628">https://www.rfc-editor.org/info/rfc8628</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8707">[RFC8707]</dt>
      <dd>
<span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Resource Indicators for OAuth 2.0"</span>, <span class="seriesInfo">RFC 8707</span>, <span class="seriesInfo">DOI 10.17487/RFC8707</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8707">https://www.rfc-editor.org/info/rfc8707</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8725">[RFC8725]</dt>
      <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Hardt, D.</span>, and <span class="refAuthor">M. Jones</span>, <span class="refTitle">"JSON Web Token Best Current Practices"</span>, <span class="seriesInfo">BCP 225</span>, <span class="seriesInfo">RFC 8725</span>, <span class="seriesInfo">DOI 10.17487/RFC8725</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8725">https://www.rfc-editor.org/info/rfc8725</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9068">[RFC9068]</dt>
      <dd>
<span class="refAuthor">Bertocci, V.</span>, <span class="refTitle">"JSON Web Token (JWT) Profile for OAuth 2.0 Access Tokens"</span>, <span class="seriesInfo">RFC 9068</span>, <span class="seriesInfo">DOI 10.17487/RFC9068</span>, <time datetime="2021-10" class="refDate">October 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9068">https://www.rfc-editor.org/info/rfc9068</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9360">[RFC9360]</dt>
      <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Header Parameters for Carrying and Referencing X.509 Certificates"</span>, <span class="seriesInfo">RFC 9360</span>, <span class="seriesInfo">DOI 10.17487/RFC9360</span>, <time datetime="2023-02" class="refDate">February 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9360">https://www.rfc-editor.org/info/rfc9360</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9396">[RFC9396]</dt>
      <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Richer, J.</span>, and <span class="refAuthor">B. Campbell</span>, <span class="refTitle">"OAuth 2.0 Rich Authorization Requests"</span>, <span class="seriesInfo">RFC 9396</span>, <span class="seriesInfo">DOI 10.17487/RFC9396</span>, <time datetime="2023-05" class="refDate">May 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9396">https://www.rfc-editor.org/info/rfc9396</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SIOPv2">[SIOPv2]</dt>
      <dd>
<span class="refAuthor">Yasuda, K.</span> and <span class="refAuthor">M. B. Jones</span>, <span class="refTitle">"Self-Issued OpenID Provider V2"</span>, <time datetime="2023-01-01" class="refDate">1 January 2023</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-self-issued-v2-1_0.html">https://openid.net/specs/openid-connect-self-issued-v2-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="USASCII">[USASCII]</dt>
    <dd>
<span class="refAuthor">American National Standards Institute</span>, <span class="refTitle">"Coded Character Set -- 7-bit American Standard Code for Information Interchange"</span>, <time datetime="1986" class="refDate">1986</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-15">
      <h2 id="name-informative-references">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="DID_Specification_Registries">[DID_Specification_Registries]</dt>
      <dd>
<span class="refAuthor">Steele, O.</span>, <span class="refAuthor">Sporny, M.</span>, and <span class="refAuthor">M. Prorock</span>, <span class="refTitle">"DID Specification Registries"</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.w3.org/TR/did-spec-registries/">https://www.w3.org/TR/did-spec-registries/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DIF.Well-Known_DID">[DIF.Well-Known_DID]</dt>
      <dd>
<span class="refAuthor">Buchner, D.</span>, <span class="refAuthor">Steele, O.</span>, and <span class="refAuthor">T. Looker</span>, <span class="refTitle">"Well Known DID Configuration"</span>, <span>&lt;<a href="https://identity.foundation/specs/did-configuration/">https://identity.foundation/specs/did-configuration/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.looker-oauth-attestation-based-client-auth">[I-D.looker-oauth-attestation-based-client-auth]</dt>
      <dd>
<span class="refAuthor">Looker, T.</span> and <span class="refAuthor">P. Bastian</span>, <span class="refTitle">"OAuth 2.0 Attestation-Based Client Authentication"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-looker-oauth-attestation-based-client-auth-00</span>, <time datetime="2023-07-10" class="refDate">10 July 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-looker-oauth-attestation-based-client-auth-00">https://datatracker.ietf.org/doc/html/draft-looker-oauth-attestation-based-client-auth-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.COSE.ALGS">[IANA.COSE.ALGS]</dt>
      <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Algorithms"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml#algorithms">https://www.iana.org/assignments/cose/cose.xhtml#algorithms</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.JOSE.ALGS">[IANA.JOSE.ALGS]</dt>
      <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"JSON Web Signature and Encryption Algorithms"</span>, <span>&lt;<a href="https://www.iana.org/assignments/jose/jose.xhtml#web-signature-encryption-algorithms">https://www.iana.org/assignments/jose/jose.xhtml#web-signature-encryption-algorithms</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID.Core">[OpenID.Core]</dt>
      <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.</span>, <span class="refAuthor">de Medeiros, B.</span>, and <span class="refAuthor">C. Mortimore</span>, <span class="refTitle">"OpenID Connect Core 1.0 incorporating errata set 1"</span>, <time datetime="2014-11-08" class="refDate">8 November 2014</time>, <span>&lt;<a href="http://openid.net/specs/openid-connect-core-1_0.html">http://openid.net/specs/openid-connect-core-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID4VP">[OpenID4VP]</dt>
      <dd>
<span class="refAuthor">Terbu, O.</span>, <span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Yasuda, K.</span>, <span class="refAuthor">Lemmon, A.</span>, and <span class="refAuthor">T. Looker</span>, <span class="refTitle">"OpenID for Verifiable Presentations"</span>, <time datetime="2022-06-20" class="refDate">20 June 2022</time>, <span>&lt;<a href="https://openid.net/specs/openid-4-verifiable-presentations-1_0.html">https://openid.net/specs/openid-4-verifiable-presentations-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9126">[RFC9126]</dt>
      <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Tonge, D.</span>, and <span class="refAuthor">F. Skokan</span>, <span class="refTitle">"OAuth 2.0 Pushed Authorization Requests"</span>, <span class="seriesInfo">RFC 9126</span>, <span class="seriesInfo">DOI 10.17487/RFC9126</span>, <time datetime="2021-09" class="refDate">September 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9126">https://www.rfc-editor.org/info/rfc9126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="VC_DATA">[VC_DATA]</dt>
    <dd>
<span class="refAuthor">Sporny, M.</span>, <span class="refAuthor">Noble, G.</span>, <span class="refAuthor">Longley, D.</span>, <span class="refAuthor">Burnett, D. C.</span>, <span class="refAuthor">Zundel, B.</span>, and <span class="refAuthor">D. Chadwick</span>, <span class="refTitle">"Verifiable Credentials Data Model 1.0"</span>, <time datetime="2019-11-19" class="refDate">19 November 2019</time>, <span>&lt;<a href="https://www.w3.org/TR/vc-data-model">https://www.w3.org/TR/vc-data-model</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="iana-considerations">
<section id="appendix-A">
      <h2 id="name-iana-considerations">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="sub-namespace-registration">
<section id="appendix-A.1">
        <h3 id="name-sub-namespace-registration">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-sub-namespace-registration" class="section-name selfRef">Sub-Namespace Registration</a>
        </h3>
<p id="appendix-A.1-1">This section registers the value "urn:ietf:params:oauth:grant-type:pre-authorized_code" in the IANA "OAuth URI" registry established by "An IETF URN Sub-Namespace for OAuth" <span>[<a href="#RFC6755" class="cite xref">RFC6755</a>]</span>.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-A.1-2.1">URN: urn:ietf:params:oauth:grant-type:pre-authorized_code<a href="#appendix-A.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-A.1-2.2">Common Name: Pre-Authorized Code<a href="#appendix-A.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-A.1-2.3">Change Controller: AB/Connect Working Group - openid-specs-ab@lists.openid.net<a href="#appendix-A.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-A.1-2.4">Specification Document: <a href="#token_request" class="auto internal xref">Section 6.1</a> of this document<a href="#appendix-A.1-2.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="well-known-uri-registry">
<section id="appendix-A.2">
        <h3 id="name-well-known-uri-registry">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-well-known-uri-registry" class="section-name selfRef">Well-Known URI Registry</a>
        </h3>
<p id="appendix-A.2-1">This specification registers the well-known URI defined in <a href="#credential-issuer-wellknown" class="auto internal xref">Section 10.2.2</a> in the IANA Well-Known URI registry defined in RFC 5785 <span>[<a href="#RFC5785" class="cite xref">RFC5785</a>]</span>.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-A.2-2.1">URI suffix: openid-credential-issuer<a href="#appendix-A.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-A.2-2.2">Change controller: AB/Connect Working Group - openid-specs-ab@lists.openid.net<a href="#appendix-A.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-A.2-2.3">Specification document: <a href="#credential-issuer-wellknown" class="auto internal xref">Section 10.2.2</a> of this document<a href="#appendix-A.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-A.2-2.4">Related information: (none)<a href="#appendix-A.2-2.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="Acknowledgements">
<section id="appendix-B">
      <h2 id="name-acknowledgements">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-B-1">We would like to thank Daniel Fett, Brian Campbell, Joseph Heenan, Daniel McGrogan, David Chadwick, John Bradley, Mark Haine, Alen Horvat, Michael B. Jones, Kenichi Nakamura, Oliver Terbu and David Waite for their valuable contributions to this specification.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="notices">
<section id="appendix-C">
      <h2 id="name-notices">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-notices" class="section-name selfRef">Notices</a>
      </h2>
<p id="appendix-C-1">Copyright (c) 2023 The OpenID Foundation.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">The OpenID Foundation (OIDF) grants to any Contributor, developer, implementer, or other interested party a non-exclusive, royalty free, worldwide copyright license to reproduce, prepare derivative works from, distribute, perform and display, this Implementers Draft or Final Specification solely for the purposes of (i) developing specifications, and (ii) implementing Implementers Drafts and Final Specifications based on such documents, provided that attribution be made to the OIDF as the source of the material, but that such attribution does not indicate an endorsement by the OIDF.<a href="#appendix-C-2" class="pilcrow">¶</a></p>
<p id="appendix-C-3">The technology described in this specification was made available from contributions from various sources, including members of the OpenID Foundation and others. Although the OpenID Foundation has taken steps to help ensure that the technology is available for distribution, it takes no position regarding the validity or scope of any intellectual property or other rights that might be claimed to pertain to the implementation or use of the technology described in this specification or the extent to which any license under such rights might or might not be available; neither does it represent that it has made any independent effort to identify any such rights. The OpenID Foundation and the contributors to this specification make no (and hereby expressly disclaim any) warranties (express, implied, or otherwise), including implied warranties of merchantability, non-infringement, fitness for a particular purpose, or title, related to this specification, and the entire risk as to implementing this specification is assumed by the implementer. The OpenID Intellectual Property Rights policy requires contributors to offer a patent promise not to assert certain patent claims against other contributors and against implementers. The OpenID Foundation invites any interested party to bring to its attention any copyrights, patents, patent applications, or other proprietary rights that MAY cover technology that MAY be required to practice this specification.<a href="#appendix-C-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-cases">
<section id="appendix-D">
      <h2 id="name-use-cases">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-use-cases" class="section-name selfRef">Use Cases</a>
      </h2>
<p id="appendix-D-1">This is a non-exhaustive list of sample use cases.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<div id="use-case-3">
<section id="appendix-D.1">
        <h3 id="name-credential-offer-same-devic">
<a href="#appendix-D.1" class="section-number selfRef">D.1. </a><a href="#name-credential-offer-same-devic" class="section-name selfRef">Credential Offer - Same-Device</a>
        </h3>
<p id="appendix-D.1-1">While browsing the university's home page, the End-User finds a link "request your digital diploma". The End-User clicks on this link and is being redirected to a digital Wallet. The Wallet notifies the End-User that a Credential Issuer offered to issue a diploma Credential. User confirms this inquiry and is taken to the university's Credential issuance service's End-User experience. After authenticating at the university and consenting to the issuance of a digital diploma, the End-User is sent back to the Wallet, where she can check the successful creation of the digital diploma.<a href="#appendix-D.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-case-4">
<section id="appendix-D.2">
        <h3 id="name-credential-offer-cross-devi">
<a href="#appendix-D.2" class="section-number selfRef">D.2. </a><a href="#name-credential-offer-cross-devi" class="section-name selfRef">Credential Offer - Cross-Device (with Information Pre-Submitted by the End-User)</a>
        </h3>
<p id="appendix-D.2-1">The End-User is starting a job at a new employer. An employer has requested the End-User to upload certain documents to the employee portal. A few days later, the End-User receives an email from the employer notifying her that the employee Credential is ready and asking her to scan a QR code to retrieve it. The End-User scans the QR code with her smartphone, which opens her Wallet. Meanwhile, the End-User has received a text message with a PIN code to her smartphone. After entering that PIN code in the Wallet for security reasons, the End-User confirms the Credential issuance, and receives Credential into the Wallet.<a href="#appendix-D.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-case-5">
<section id="appendix-D.3">
        <h3 id="name-credential-offer-cross-devic">
<a href="#appendix-D.3" class="section-number selfRef">D.3. </a><a href="#name-credential-offer-cross-devic" class="section-name selfRef">Credential Offer - Cross-Device &amp; Deferred</a>
        </h3>
<p id="appendix-D.3-1">The End-User wants to obtain a digital criminal record. She visits the local administration's office and requests the issuance of the official criminal record as a digital Credential. After presenting her ID document, she is asked to scan a QR code with her Wallet. She is being told that the actual issuance of the Credential will take some time due to necessary background checks by the authority.<a href="#appendix-D.3-1" class="pilcrow">¶</a></p>
<p id="appendix-D.3-2">In the Wallet, the End-User sees an indication that issuance of the digital record is under way. A few days later, the End-User receives a notification from her Wallet that requested Credential was successfully issued. When the End-User opens the Wallet, she is asked whether she wants to download the Credential. She confirms, and the new Credential is retrieved and stored in the Wallet.<a href="#appendix-D.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-case-1">
<section id="appendix-D.4">
        <h3 id="name-wallet-initiated-issuance-d">
<a href="#appendix-D.4" class="section-number selfRef">D.4. </a><a href="#name-wallet-initiated-issuance-d" class="section-name selfRef">Wallet Initiated Issuance during Presentation</a>
        </h3>
<p id="appendix-D.4-1">An End-User comes across a verifier app that is requesting the End-User to present a Credential, e.g., a driving license. The Wallet determines the requested Credential type(s) from the presentation request and notifies the End-User that there is currently no matching Credential in the Wallet. The Wallet selects a Credential Issuer capable of issuing the lacking Credential and, upon End-User consent, sends the End-User to the Credential Issuer's End-User experience (Web site or app). Upon being authenticated and providing consent to issue the Credential into her Wallet, the End-User is sent back to the Wallet. The Wallet informs the End-User that Credential was successfully issued into the Wallet and is ready to be presented to the verifier app that originally requested presentation of that Credential.<a href="#appendix-D.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-case-2">
<section id="appendix-D.5">
        <h3 id="name-wallet-initiated-issuance-du">
<a href="#appendix-D.5" class="section-number selfRef">D.5. </a><a href="#name-wallet-initiated-issuance-du" class="section-name selfRef">Wallet Initiated Issuance during Presentation (Requires Presentation of Additional Credentials During Issuance)</a>
        </h3>
<p id="appendix-D.5-1">An End-User comes across a verifier app that is requesting the End-User to present a Credential, e.g., a university diploma. The Wallet determines the requested Credential type(s) from the presentation request and notifies the End-User that there is currently no matching Credential in the Wallet. The Wallet then offers the End-User a list of Credential Issuers, which might be based on a Credential Issuer list curated by the Wallet provider. The End-User picks the university she graduated from and is sent to that university's End-User experience (Web site or app).<a href="#appendix-D.5-1" class="pilcrow">¶</a></p>
<p id="appendix-D.5-2">The End-User logs in to the university, which determines that the respective End-User account is not verified yet. Among multiple identification options, the End-User chooses to present a Credential from her Wallet. The End-User is sent back to the Wallet where she consents to present requested Credential(s) to the university. The End-User is sent back to the university End-User experience. Based on the presented Credential, the university completes the End-User verification, looks up End-User data in its database, and offers to issue a diploma as a Verifiable Credential.<a href="#appendix-D.5-2" class="pilcrow">¶</a></p>
<p id="appendix-D.5-3">Upon providing consent, the End-User is sent back to the Wallet. The Wallet informs the End-User Credential was successfully issued into the Wallet and is ready to be presented to the verifier app that originally requested presentation of that Credential.<a href="#appendix-D.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="format_profiles">
<section id="appendix-E">
      <h2 id="name-credential-format-profiles">
<a href="#appendix-E" class="section-number selfRef">Appendix E. </a><a href="#name-credential-format-profiles" class="section-name selfRef">Credential Format Profiles</a>
      </h2>
<p id="appendix-E-1">This specification defines several extension points to accommodate the differences across Credential formats. Sets of Credential format specific parameters or claims referred to as Credential format Identifiers are identified by the Credential format identifier and used at each extension point.<a href="#appendix-E-1" class="pilcrow">¶</a></p>
<p id="appendix-E-2">This section defines Credential Format Profiles for a few of the commonly used Credential formats. Other specifications or deployments can define their own Credential Format Profiles.<a href="#appendix-E-2" class="pilcrow">¶</a></p>
<div id="w3c-verifiable-credentials">
<section id="appendix-E.1">
        <h3 id="name-w3c-verifiable-credentials">
<a href="#appendix-E.1" class="section-number selfRef">E.1. </a><a href="#name-w3c-verifiable-credentials" class="section-name selfRef">W3C Verifiable Credentials</a>
        </h3>
<p id="appendix-E.1-1">Sections 6.1 and 6.2 of <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span> define how Verifiable Credentials MAY or MAY NOT use JSON-LD. As acknowledged in Section 4.1 of <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span>, implementations can behave differently regarding processing of the <code>@context</code> property whether JSON-LD is used or not.<a href="#appendix-E.1-1" class="pilcrow">¶</a></p>
<p id="appendix-E.1-2">This specification therefore differentiates the following three Credential formats for W3C Verifiable Credentials:<a href="#appendix-E.1-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-E.1-3.1">VC signed as a JWT, not using JSON-LD (<code>jwt_vc_json</code>)<a href="#appendix-E.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-E.1-3.2">VC signed as a JWT, using JSON-LD (<code>jwt_vc_json-ld</code>)<a href="#appendix-E.1-3.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-E.1-3.3">VC secured using Data Integrity, using JSON-LD, with proof suite requiring Linked Data canonicalization (<code>ldp_vc</code>)<a href="#appendix-E.1-3.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="appendix-E.1-4">Note: VCs secured using Data Integrity MAY NOT necessarily use JSON-LD and MAY NOT necessarily use proof suites requiring Linked Data canonicalization. Credential Format Profiles for them may be defined in the future versions of this specification.<a href="#appendix-E.1-4" class="pilcrow">¶</a></p>
<p id="appendix-E.1-5">Distinct Credential format identifiers, extension parameters/claims, and processing rules are defined for each of the above-mentioned Credential formats.<a href="#appendix-E.1-5" class="pilcrow">¶</a></p>
<p id="appendix-E.1-6">It is on purpose that the Credential Offer does not contain <code>credentialSubject</code> property, while Authorization Details and Credential Request do. This is because this property is meant to be used by the Wallet to specify which claims it is requesting to be issued out of all the claims the Credential Issuer is capable of issuing for this particular Credential (data minimization), while Credential Offer is a mere "invitation" from the Credential Issuer to the Wallet to start the issuance flow.<a href="#appendix-E.1-6" class="pilcrow">¶</a></p>
<div id="vc-jwt">
<section id="appendix-E.1.1">
          <h4 id="name-vc-signed-as-a-jwt-not-usin">
<a href="#appendix-E.1.1" class="section-number selfRef">E.1.1. </a><a href="#name-vc-signed-as-a-jwt-not-usin" class="section-name selfRef">VC Signed as a JWT, Not Using JSON-LD</a>
          </h4>
<div id="format-identifier">
<section id="appendix-E.1.1.1">
            <h5 id="name-format-identifier">
<a href="#appendix-E.1.1.1" class="section-number selfRef">E.1.1.1. </a><a href="#name-format-identifier" class="section-name selfRef">Format Identifier</a>
            </h5>
<p id="appendix-E.1.1.1-1">The Credential format identifier is <code>jwt_vc_json</code>.<a href="#appendix-E.1.1.1-1" class="pilcrow">¶</a></p>
<p id="appendix-E.1.1.1-2">When the <code>format</code> value is <code>jwt_vc_json</code>, entire Credential Offer, Authorization Details, Credential Request and Credential Issuer metadata, including <code>credential_definition</code> object, MUST NOT be processed using JSON-LD rules.<a href="#appendix-E.1.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server_metadata_jwt_vc_json">
<section id="appendix-E.1.1.2">
            <h5 id="name-credential-issuer-metadata-2">
<a href="#appendix-E.1.1.2" class="section-number selfRef">E.1.1.2. </a><a href="#name-credential-issuer-metadata-2" class="section-name selfRef">Credential Issuer Metadata</a>
            </h5>
<p id="appendix-E.1.1.2-1">The following additional Credential Issuer metadata are defined for this Credential format to be added to the <code>credentials_supported</code> parameter in addition to those defined in <a href="#credential-issuer-parameters" class="auto internal xref">Section 10.2.3</a>.<a href="#appendix-E.1.1.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-E.1.1.2-2.1">
                <p id="appendix-E.1.1.2-2.1.1"><code>credential_definition</code>: REQUIRED. Object containing the detailed description of the credential type. It consists at least of the following two sub claims:<a href="#appendix-E.1.1.2-2.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-E.1.1.2-2.1.2.1">
                    <code>type</code>: REQUIRED. Array designating the types a certain credential type supports according to <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span>, Section 4.3.<a href="#appendix-E.1.1.2-2.1.2.1" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="appendix-E.1.1.2-2.1.2.2">
                    <p id="appendix-E.1.1.2-2.1.2.2.1"><code>credentialSubject</code>: OPTIONAL. An object containing a list of name/value pairs, where each name identifies a claim offered in the Credential. The value can be another such object (nested data structures), or an array of such objects. To express the specifics about the claim, the most deeply nested value MAY be an object that includes a following non-exhaustive list of parameters defined by this specification:<a href="#appendix-E.1.1.2-2.1.2.2.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-E.1.1.2-2.1.2.2.2.1">
                        <code>mandatory</code>: OPTIONAL. Boolean which when set to <code>true</code> indicates the claim MUST be present in the issued Credential. If the <code>mandatory</code> property is omitted its default should be assumed to be <code>false</code>.<a href="#appendix-E.1.1.2-2.1.2.2.2.1" class="pilcrow">¶</a>
</li>
                      <li class="compact" id="appendix-E.1.1.2-2.1.2.2.2.2">
                        <code>value_type</code>: OPTIONAL. String value determining the type of value of the claim. A non-exhaustive list of valid values defined by this specification are <code>string</code>, <code>number</code>, and image media types such as <code>image/jpeg</code> as defined in IANA media type registry for images (<a href="https://www.iana.org/assignments/media-types/media-types.xhtml#image">https://www.iana.org/assignments/media-types/media-types.xhtml#image</a>).<a href="#appendix-E.1.1.2-2.1.2.2.2.2" class="pilcrow">¶</a>
</li>
                      <li class="compact" id="appendix-E.1.1.2-2.1.2.2.2.3">
                        <p id="appendix-E.1.1.2-2.1.2.2.2.3.1"><code>display</code>: OPTIONAL. An array of objects, where each object contains display properties of a certain claim in the Credential for a certain language. Below is a non-exhaustive list of valid parameters that MAY be included:<a href="#appendix-E.1.1.2-2.1.2.2.2.3.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-E.1.1.2-2.1.2.2.2.3.2.1">
                            <code>name</code>: OPTIONAL. String value of a display name for the claim.<a href="#appendix-E.1.1.2-2.1.2.2.2.3.2.1" class="pilcrow">¶</a>
</li>
                          <li class="compact" id="appendix-E.1.1.2-2.1.2.2.2.3.2.2">
                            <code>locale</code>: OPTIONAL. String value that identifies language of this object represented as language tag values defined in BCP47 <span>[<a href="#RFC5646" class="cite xref">RFC5646</a>]</span>. There MUST be only one object for each language identifier.<a href="#appendix-E.1.1.2-2.1.2.2.2.3.2.2" class="pilcrow">¶</a>
</li>
                        </ul>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact" id="appendix-E.1.1.2-2.2">
                <code>order</code>: OPTIONAL. An array of the claim name values that lists them in the order they should be displayed by the Wallet.<a href="#appendix-E.1.1.2-2.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="appendix-E.1.1.2-3">The following is a non-normative example of an object comprising <code>credentials_supported</code> parameter of Credential format <code>jwt_vc_json</code>:<a href="#appendix-E.1.1.2-3" class="pilcrow">¶</a></p>
<div class="breakable lang-json sourcecode" id="appendix-E.1.1.2-4">
<pre>{
    "credentials_supported": {
        "UniversityDegreeCredential": {
            "format": "jwt_vc_json",
            "scope": "UniversityDegree",
            "cryptographic_binding_methods_supported": [
                "did:example"
            ],
            "cryptographic_suites_supported": [
                "ES256K"
            ],
            "credential_definition":{
                "type": [
                    "VerifiableCredential",
                    "UniversityDegreeCredential"
                ],
                "credentialSubject": {
                    "given_name": {
                        "display": [
                            {
                                "name": "Given Name",
                                "locale": "en-US"
                            }
                        ]
                    },
                    "family_name": {
                        "display": [
                            {
                                "name": "Surname",
                                "locale": "en-US"
                            }
                        ]
                    },
                    "degree": {},
                    "gpa": {
                        "display": [
                            {
                                "name": "GPA"
                            }
                        ]
                    }
                }
            },
            "proof_types_supported": [
                "jwt"
            ],
            "display": [
                {
                    "name": "University Credential",
                    "locale": "en-US",
                    "logo": {
                        "url": "https://exampleuniversity.com/public/logo.png",
                        "alt_text": "a square logo of a university"
                    },
                    "background_color": "#12107c",
                    "text_color": "#FFFFFF"
                }
            ]
        }
    }
}
</pre><a href="#appendix-E.1.1.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="credential-offer">
<section id="appendix-E.1.1.3">
            <h5 id="name-credential-offer-3">
<a href="#appendix-E.1.1.3" class="section-number selfRef">E.1.1.3. </a><a href="#name-credential-offer-3" class="section-name selfRef">Credential Offer</a>
            </h5>
<p id="appendix-E.1.1.3-1">The following is a non-normative example of a Credential Offer of Credential format <code>jwt_vc_json</code>:<a href="#appendix-E.1.1.3-1" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="appendix-E.1.1.3-2">
<pre>{
    "credential_issuer": "https://credential-issuer.example.com",
    "credentials": [
        "UniversityDegreeCredential"
    ],
    "grants": {
        "authorization_code": {
            "issuer_state": "eyJhbGciOiJSU0Et...FYUaBy"
        }
    }
}
</pre><a href="#appendix-E.1.1.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authorization_jwt_vc_json">
<section id="appendix-E.1.1.4">
            <h5 id="name-authorization-details">
<a href="#appendix-E.1.1.4" class="section-number selfRef">E.1.1.4. </a><a href="#name-authorization-details" class="section-name selfRef">Authorization Details</a>
            </h5>
<p id="appendix-E.1.1.4-1">The following additional claims are defined for authorization details of type <code>openid_credential</code> and this Credential format.<a href="#appendix-E.1.1.4-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-E.1.1.4-2.1">
                <p id="appendix-E.1.1.4-2.1.1"><code>credential_definition</code>: REQUIRED. Object containing the detailed description of the credential type. It consists at least of the following sub claims:<a href="#appendix-E.1.1.4-2.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-E.1.1.4-2.1.2.1">
                    <code>type</code>: REQUIRED. Array as defined in <a href="#server_metadata_jwt_vc_json" class="auto internal xref">Appendix E.1.1.2</a>. This claim contains the type values the Wallet requests authorization for at the Credential Issuer.<a href="#appendix-E.1.1.4-2.1.2.1" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="appendix-E.1.1.4-2.1.2.2">
                    <code>credentialSubject</code>: OPTIONAL. An object containing a list of name/value pairs, where each name identifies a claim offered in the Credential. The value can be another such object (nested data structures), or an array of such objects. The most deeply nested value MUST be an empty object. This object indicates the claims the Wallet would like to turn up in the credential to be issued.<a href="#appendix-E.1.1.4-2.1.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ul>
<p id="appendix-E.1.1.4-3">The following is a non-normative example of an authorization details object with Credential format <code>jwt_vc_json</code>:<a href="#appendix-E.1.1.4-3" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="appendix-E.1.1.4-4">
<pre>[
    {
        "type": "openid_credential",
        "format": "jwt_vc_json",
        "credential_definition": {
            "type": [
                "VerifiableCredential",
                "UniversityDegreeCredential"
            ],
            "credentialSubject": {
                "given_name": {},
                "family_name": {},
                "degree": {}
            }
        }
    }
]
</pre><a href="#appendix-E.1.1.4-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="credential-request">
<section id="appendix-E.1.1.5">
            <h5 id="name-credential-request-2">
<a href="#appendix-E.1.1.5" class="section-number selfRef">E.1.1.5. </a><a href="#name-credential-request-2" class="section-name selfRef">Credential Request</a>
            </h5>
<p id="appendix-E.1.1.5-1">The following additional parameters are defined for Credential Requests and this Credential format.<a href="#appendix-E.1.1.5-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-E.1.1.5-2.1">
                <p id="appendix-E.1.1.5-2.1.1"><code>credential_definition</code>: REQUIRED. Object containing the detailed description of the credential type. It consists at least of the following sub claims:<a href="#appendix-E.1.1.5-2.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-E.1.1.5-2.1.2.1">
                    <code>type</code>: REQUIRED. Array as defined in <a href="#server_metadata_jwt_vc_json" class="auto internal xref">Appendix E.1.1.2</a>. The credential issued by the Credential Issuer MUST at least contain the values listed in this claim.<a href="#appendix-E.1.1.5-2.1.2.1" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="appendix-E.1.1.5-2.1.2.2">
                    <code>credentialSubject</code>: OPTIONAL. An object as defined in <a href="#authorization_jwt_vc_json" class="auto internal xref">Appendix E.1.1.4</a>.<a href="#appendix-E.1.1.5-2.1.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ul>
<p id="appendix-E.1.1.5-3">The following is a non-normative example of a Credential Request with Credential format <code>jwt_vc_json</code>:<a href="#appendix-E.1.1.5-3" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="appendix-E.1.1.5-4">
<pre>{
   "format": "jwt_vc_json",
   "credential_definition": {
      "type": [
         "VerifiableCredential",
         "UniversityDegreeCredential"
      ],
      "credentialSubject": {
         "given_name": {},
         "family_name": {},
         "degree": {}
      }
   },
   "proof": {
      "proof_type": "jwt",
      "jwt":"eyJraWQiOiJkaWQ6ZXhhbXBsZTplYmZlYjFmNzEyZWJjNmYxYzI3NmUxMmVjMjEva2V5cy8
      xIiwiYWxnIjoiRVMyNTYiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJzNkJoZFJrcXQzIiwiYXVkIjoiaHR
      0cHM6Ly9zZXJ2ZXIuZXhhbXBsZS5jb20iLCJpYXQiOiIyMDE4LTA5LTE0VDIxOjE5OjEwWiIsIm5vbm
      NlIjoidFppZ25zbkZicCJ9.ewdkIkPV50iOeBUqMXCC_aZKPxgihac0aW9EkL1nOzM"
   }
}
</pre><a href="#appendix-E.1.1.5-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="credential_response_jwt_vc_json">
<section id="appendix-E.1.1.6">
            <h5 id="name-credential-response-2">
<a href="#appendix-E.1.1.6" class="section-number selfRef">E.1.1.6. </a><a href="#name-credential-response-2" class="section-name selfRef">Credential Response</a>
            </h5>
<p id="appendix-E.1.1.6-1">The value of the <code>credential</code> claim in the Credential Response MUST be a JWT. Credentials of this format are already a sequence of base64url-encoded values separated by period characters and MUST NOT be re-encoded.<a href="#appendix-E.1.1.6-1" class="pilcrow">¶</a></p>
<p id="appendix-E.1.1.6-2">The following is a non-normative example of a Credential Response with Credential format <code>jwt_vc_json</code>:<a href="#appendix-E.1.1.6-2" class="pilcrow">¶</a></p>
<div class="lang-txt sourcecode" id="appendix-E.1.1.6-3">
<pre>
HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
    "format": "jwt_vc_json",
    "credential": "eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCJ9.eyJ2YyI6eyJAY29udGV4dCI
    6WyJodHRwczovL3d3dy53My5vcmcvMjAxOC9jcmVkZW50aWFscy92MSIsImh0dHBzOi8vd3d3Ln
    czLm9yZy8yMDE4L2NyZWRlbnRpYWxzL2V4YW1wbGVzL3YxIl0sImlkIjoiaHR0cDovL2V4YW1wb
    GUuZWR1L2NyZWRlbnRpYWxzLzM3MzIiLCJ0eXBlIjpbIlZlcmlmaWFibGVDcmVkZW50aWFsIiwi
    VW5pdmVyc2l0eURlZ3JlZUNyZWRlbnRpYWwiXSwiaXNzdWVyIjoiaHR0cHM6Ly9leGFtcGxlLmV
    kdS9pc3N1ZXJzLzU2NTA0OSIsImlzc3VhbmNlRGF0ZSI6IjIwMTAtMDEtMDFUMDA6MDA6MDBaIi
    wiY3JlZGVudGlhbFN1YmplY3QiOnsiaWQiOiJkaWQ6ZXhhbXBsZTplYmZlYjFmNzEyZWJjNmYxY
    zI3NmUxMmVjMjEiLCJkZWdyZWUiOnsidHlwZSI6IkJhY2hlbG9yRGVncmVlIiwibmFtZSI6IkJh
    Y2hlbG9yIG9mIFNjaWVuY2UgYW5kIEFydHMifX19LCJpc3MiOiJodHRwczovL2V4YW1wbGUuZWR
    1L2lzc3VlcnMvNTY1MDQ5IiwibmJmIjoxMjYyMzA0MDAwLCJqdGkiOiJodHRwOi8vZXhhbXBsZS
    5lZHUvY3JlZGVudGlhbHMvMzczMiIsInN1YiI6ImRpZDpleGFtcGxlOmViZmViMWY3MTJlYmM2Z
    jFjMjc2ZTEyZWMyMSJ9.z5vgMTK1nfizNCg5N-niCOL3WUIAL7nXy-nGhDZYO_-PNGeE-0djCpW
    AMH8fD8eWSID5PfkPBYkx_dfLJnQ7NA",
    "c_nonce": "fGFF7UkhLa",
    "c_nonce_expires_in": 86400
}


</pre><a href="#appendix-E.1.1.6-3" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="vc-secured-using-data-integrity-using-json-ld-with-proof-suite-requiring-linked-data-canonicalization">
<section id="appendix-E.1.2">
          <h4 id="name-vc-secured-using-data-integ">
<a href="#appendix-E.1.2" class="section-number selfRef">E.1.2. </a><a href="#name-vc-secured-using-data-integ" class="section-name selfRef">VC Secured using Data Integrity, using JSON-LD, with Proof Suite Requiring Linked Data Canonicalization</a>
          </h4>
<div id="format-identifier-1">
<section id="appendix-E.1.2.1">
            <h5 id="name-format-identifier-2">
<a href="#appendix-E.1.2.1" class="section-number selfRef">E.1.2.1. </a><a href="#name-format-identifier-2" class="section-name selfRef">Format Identifier</a>
            </h5>
<p id="appendix-E.1.2.1-1">The Credential format identifier is <code>ldp_vc</code>.<a href="#appendix-E.1.2.1-1" class="pilcrow">¶</a></p>
<p id="appendix-E.1.2.1-2">When the <code>format</code> value is <code>ldp_vc</code>, entire Credential Offer, Authorization Details, Credential Request and Credential Issuer metadata, including <code>credential_definition</code> object, MUST NOT be processed using JSON-LD rules.<a href="#appendix-E.1.2.1-2" class="pilcrow">¶</a></p>
<p id="appendix-E.1.2.1-3"><code>@context</code> value in the <code>credential_definition</code> object could be used by the Wallet to check whether it supports a certain VC or not. If necessary, the Wallet could apply JSON-LD processing to the Credential issued by the Credential Issuer.<a href="#appendix-E.1.2.1-3" class="pilcrow">¶</a></p>
<p id="appendix-E.1.2.1-4">Note: Data Integrity used to be called Linked Data Proofs, hence "ldp" in the Credential format identifier.<a href="#appendix-E.1.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server_metadata_ldp_vc">
<section id="appendix-E.1.2.2">
            <h5 id="name-credential-issuer-metadata-3">
<a href="#appendix-E.1.2.2" class="section-number selfRef">E.1.2.2. </a><a href="#name-credential-issuer-metadata-3" class="section-name selfRef">Credential Issuer Metadata</a>
            </h5>
<p id="appendix-E.1.2.2-1">The following additional Credential Issuer metadata are defined for this Credential format to be added to the <code>credentials_supported</code> parameter in addition to those defined in <a href="#credential-issuer-parameters" class="auto internal xref">Section 10.2.3</a>:<a href="#appendix-E.1.2.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-E.1.2.2-2.1">
                <p id="appendix-E.1.2.2-2.1.1"><code>credential_definition</code>: REQUIRED. Object containing the detailed description of the credential type. It consists at least of the following three sub claims:<a href="#appendix-E.1.2.2-2.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-E.1.2.2-2.1.2.1">
                    <code>@context</code>: REQUIRED. Array as defined in <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span>, Section 4.1.<a href="#appendix-E.1.2.2-2.1.2.1" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="appendix-E.1.2.2-2.1.2.2">
                    <code>type</code>: REQUIRED. Array designating the types a certain credential type supports according to <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span>, Section 4.3.<a href="#appendix-E.1.2.2-2.1.2.2" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="appendix-E.1.2.2-2.1.2.3">
                    <p id="appendix-E.1.2.2-2.1.2.3.1"><code>credentialSubject</code>: OPTIONAL. An object containing a list of name/value pairs, where each name identifies a claim offered in the Credential. The value can be another such object (nested data structures), or an array of such objects. To express the specifics about the claim, the most deeply nested value MAY be an object that includes a following non-exhaustive list of parameters defined by this specification:<a href="#appendix-E.1.2.2-2.1.2.3.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-E.1.2.2-2.1.2.3.2.1">
                        <code>mandatory</code>: OPTIONAL. Boolean which when set to <code>true</code> indicates the claim MUST be present in the issued Credential. If the <code>mandatory</code> property is omitted its default should be assumed to be <code>false</code>.<a href="#appendix-E.1.2.2-2.1.2.3.2.1" class="pilcrow">¶</a>
</li>
                      <li class="compact" id="appendix-E.1.2.2-2.1.2.3.2.2">
                        <code>value_type</code>: OPTIONAL. String value determining the type of value of the claim. A non-exhaustive list of valid values defined by this specification are <code>string</code>, <code>number</code>, and image media types such as <code>image/jpeg</code> as defined in IANA media type registry for images (<a href="https://www.iana.org/assignments/media-types/media-types.xhtml#image">https://www.iana.org/assignments/media-types/media-types.xhtml#image</a>).<a href="#appendix-E.1.2.2-2.1.2.3.2.2" class="pilcrow">¶</a>
</li>
                      <li class="compact" id="appendix-E.1.2.2-2.1.2.3.2.3">
                        <p id="appendix-E.1.2.2-2.1.2.3.2.3.1"><code>display</code>: OPTIONAL. An array of objects, where each object contains display properties of a certain claim in the Credential for a certain language. Below is a non-exhaustive list of valid parameters that MAY be included:<a href="#appendix-E.1.2.2-2.1.2.3.2.3.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-E.1.2.2-2.1.2.3.2.3.2.1">
                            <code>name</code>: OPTIONAL. String value of a display name for the claim.<a href="#appendix-E.1.2.2-2.1.2.3.2.3.2.1" class="pilcrow">¶</a>
</li>
                          <li class="compact" id="appendix-E.1.2.2-2.1.2.3.2.3.2.2">
                            <code>locale</code>: OPTIONAL. String value that identifies language of this object represented as language tag values defined in BCP47 <span>[<a href="#RFC5646" class="cite xref">RFC5646</a>]</span>. There MUST be only one object for each language identifier.<a href="#appendix-E.1.2.2-2.1.2.3.2.3.2.2" class="pilcrow">¶</a>
</li>
                        </ul>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact" id="appendix-E.1.2.2-2.2">
                <code>order</code>: OPTIONAL. An array of the claim name values that lists them in the order they should be displayed by the Wallet.<a href="#appendix-E.1.2.2-2.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="appendix-E.1.2.2-3">It is recommended to define an <code>@context</code> value to communicate additional information such as which claims are mandatory-to-be-issued, type of claim value (i.e., string, number, etc.), display properties of a credential and the order of the claim values when displayed as in <a href="#vc-jwt" class="auto internal xref">Appendix E.1.1</a>.<a href="#appendix-E.1.2.2-3" class="pilcrow">¶</a></p>
<p id="appendix-E.1.2.2-4">The following is a non-normative example of an object comprising <code>credentials_supported</code> parameter of Credential format <code>ldp_vc</code>:<a href="#appendix-E.1.2.2-4" class="pilcrow">¶</a></p>
<div class="breakable lang-json sourcecode" id="appendix-E.1.2.2-5">
<pre>{
    "credentials_supported": {
        "UniversityDegree_LDP_VC": {
            "format": "ldp_vc",
            "@context": [
                "https://www.w3.org/2018/credentials/v1",
                "https://www.w3.org/2018/credentials/examples/v1"
            ],
            "type": [
                "VerifiableCredential",
                "UniversityDegreeCredential"
            ],
            "cryptographic_binding_methods_supported": [
                "did:example"
            ],
            "cryptographic_suites_supported": [
                "Ed25519Signature2018"
            ],
            "credentials_definition": {
                "@context": [
                    "https://www.w3.org/2018/credentials/v1",
                    "https://www.w3.org/2018/credentials/examples/v1"
                ],
                "type": [
                    "VerifiableCredential",
                    "UniversityDegreeCredential"
                ],
                "credentialSubject": {
                    "given_name": {
                        "display": [
                            {
                                "name": "Given Name",
                                "locale": "en-US"
                            }
                        ]
                    },
                    "family_name": {
                        "display": [
                            {
                                "name": "Surname",
                                "locale": "en-US"
                            }
                        ]
                    },
                    "degree": {},
                    "gpa": {
                        "display": [
                            {
                                "name": "GPA"
                            }
                        ]
                    }
                }
            },
            "display": [
                {
                    "name": "University Credential",
                    "locale": "en-US",
                    "logo": {
                        "url": "https://exampleuniversity.com/public/logo.png",
                        "alt_text": "a square logo of a university"
                    },
                    "background_color": "#12107c",
                    "text_color": "#FFFFFF"
                }
            ]
        }
    }
}
</pre><a href="#appendix-E.1.2.2-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="issuer_initiated_issuance_ldp_vc">
<section id="appendix-E.1.2.3">
            <h5 id="name-credential-offer-4">
<a href="#appendix-E.1.2.3" class="section-number selfRef">E.1.2.3. </a><a href="#name-credential-offer-4" class="section-name selfRef">Credential Offer</a>
            </h5>
<p id="appendix-E.1.2.3-1">The following is a non-normative example of a Credential Offer of Credential format <code>ldp_vc</code>:<a href="#appendix-E.1.2.3-1" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="appendix-E.1.2.3-2">
<pre>{
    "credential_issuer": "https://credential-issuer.example.com",
    "credentials": [
        "UniversityDegree_LDP_VC"
    ]
}
</pre><a href="#appendix-E.1.2.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authorization_ldp_vc">
<section id="appendix-E.1.2.4">
            <h5 id="name-authorization-details-2">
<a href="#appendix-E.1.2.4" class="section-number selfRef">E.1.2.4. </a><a href="#name-authorization-details-2" class="section-name selfRef">Authorization Details</a>
            </h5>
<p id="appendix-E.1.2.4-1">The following additional claims are defined for authorization details of type <code>openid_credential</code> and this Credential format.<a href="#appendix-E.1.2.4-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-E.1.2.4-2.1">
                <p id="appendix-E.1.2.4-2.1.1"><code>credential_definition</code>: REQUIRED. Object containing the detailed description of the credential type. It consists of the following sub claims:<a href="#appendix-E.1.2.4-2.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-E.1.2.4-2.1.2.1">
                    <code>@context</code>: REQUIRED. Array as defined in <a href="#server_metadata_ldp_vc" class="auto internal xref">Appendix E.1.2.2</a>.<a href="#appendix-E.1.2.4-2.1.2.1" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="appendix-E.1.2.4-2.1.2.2">
                    <code>type</code>: REQUIRED. Array as defined in <a href="#server_metadata_ldp_vc" class="auto internal xref">Appendix E.1.2.2</a>.  This claim contains the type values the Wallet requests authorization for at the Credential Issuer.<a href="#appendix-E.1.2.4-2.1.2.2" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="appendix-E.1.2.4-2.1.2.3">
                    <code>credentialSubject</code>: OPTIONAL. An object as defined in <a href="#authorization_jwt_vc_json" class="auto internal xref">Appendix E.1.1.4</a>.<a href="#appendix-E.1.2.4-2.1.2.3" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ul>
<p id="appendix-E.1.2.4-3">The following is a non-normative example of an authorization details object with Credential format <code>ldp_vc</code>:<a href="#appendix-E.1.2.4-3" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="appendix-E.1.2.4-4">
<pre>[
    {
        "type": "openid_credential",
        "format": "ldp_vc",
        "credential_definition": {
            "@context": [
                "https://www.w3.org/2018/credentials/v1",
                "https://www.w3.org/2018/credentials/examples/v1"
            ],
            "type": [
                "VerifiableCredential",
                "UniversityDegreeCredential"
            ],
            "credentialSubject": {
                "given_name": {},
                "family_name": {},
                "degree": {}
            }
        }
    }
]
</pre><a href="#appendix-E.1.2.4-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="credential_request_ldp_vc">
<section id="appendix-E.1.2.5">
            <h5 id="name-credential-request-3">
<a href="#appendix-E.1.2.5" class="section-number selfRef">E.1.2.5. </a><a href="#name-credential-request-3" class="section-name selfRef">Credential Request</a>
            </h5>
<p id="appendix-E.1.2.5-1">The following additional parameters are defined for Credential Requests and this Credential format.<a href="#appendix-E.1.2.5-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-E.1.2.5-2.1">
                <p id="appendix-E.1.2.5-2.1.1"><code>credential_definition</code>: REQUIRED. Object containing the detailed description of the credential type. It consists at least of the following sub claims:<a href="#appendix-E.1.2.5-2.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-E.1.2.5-2.1.2.1">
                    <code>@context</code>: REQUIRED. Array as defined in <a href="#server_metadata_ldp_vc" class="auto internal xref">Appendix E.1.2.2</a>.<a href="#appendix-E.1.2.5-2.1.2.1" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="appendix-E.1.2.5-2.1.2.2">
                    <code>type</code>: REQUIRED. Array as defined in <a href="#server_metadata_ldp_vc" class="auto internal xref">Appendix E.1.2.2</a>. The credential issued by the Credential Issuer MUST at least contain the values listed in this claim.<a href="#appendix-E.1.2.5-2.1.2.2" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="appendix-E.1.2.5-2.1.2.3">
                    <code>credentialSubject</code>: OPTIONAL. An object as defined in <a href="#authorization_ldp_vc" class="auto internal xref">Appendix E.1.2.4</a>.<a href="#appendix-E.1.2.5-2.1.2.3" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ul>
<p id="appendix-E.1.2.5-3">The following is a non-normative example of a Credential Request with Credential format <code>ldp_vc</code>:<a href="#appendix-E.1.2.5-3" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="appendix-E.1.2.5-4">
<pre>{
   "format": "ldp_vc",
   "credential_definition": {
      "@context": [
         "https://www.w3.org/2018/credentials/v1",
         "https://www.w3.org/2018/credentials/examples/v1"
      ],
      "type": [
         "VerifiableCredential",
         "UniversityDegreeCredential"
      ],
      "credentialSubject": {
         "degree": {
            "type": {}
         }
      }
   },
   "proof": {
      "proof_type": "jwt",
      "jwt": "eyJraWQiOiJkaWQ6ZXhhbXBsZ...KPxgihac0aW9EkL1nOzM"
   }
}
</pre><a href="#appendix-E.1.2.5-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="credential-response-1">
<section id="appendix-E.1.2.6">
            <h5 id="name-credential-response-3">
<a href="#appendix-E.1.2.6" class="section-number selfRef">E.1.2.6. </a><a href="#name-credential-response-3" class="section-name selfRef">Credential Response</a>
            </h5>
<p id="appendix-E.1.2.6-1">The value of the <code>credential</code> claim in the Credential Response MUST be a JSON object. Credentials of this format MUST NOT be re-encoded.<a href="#appendix-E.1.2.6-1" class="pilcrow">¶</a></p>
<p id="appendix-E.1.2.6-2">The following is a non-normative example of a Credential Response with Credential format <code>ldp_vc</code>:<a href="#appendix-E.1.2.6-2" class="pilcrow">¶</a></p>
<div class="lang-txt sourcecode" id="appendix-E.1.2.6-3">
<pre>HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
    "format": "ldp_vc",
    "credential": {
        "@context": [
            "https://www.w3.org/2018/credentials/v1",
            "https://www.w3.org/2018/credentials/examples/v1"
        ],
        "id": "http://example.edu/credentials/3732",
        "type": [
            "VerifiableCredential",
            "UniversityDegreeCredential"
        ],
        "issuer": "https://example.edu/issuers/565049",
        "issuanceDate": "2010-01-01T00:00:00Z",
        "credentialSubject": {
            "id": "did:example:ebfeb1f712ebc6f1c276e12ec21",
            "degree": {
                "type": "BachelorDegree",
                "name": "Bachelor of Science and Arts"
            }
        },
        "proof": {
            "type": "Ed25519Signature2020",
            "created": "2022-02-25T14:58:43Z",
            "verificationMethod": "https://example.edu/issuers/565049#key-1",
            "proofPurpose": "assertionMethod",
            "proofValue": "zeEdUoM7m9cY8ZyTpey83yBKeBcmcvbyrEQzJ19rD2UXArU2U1jPGoEt
                           rRvGYppdiK37GU4NBeoPakxpWhAvsVSt"
        }
    },
    "c_nonce": "fGFF7UkhLa",
    "c_nonce_expires_in": 86400
}
</pre><a href="#appendix-E.1.2.6-3" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="vc-signed-as-a-jwt-using-json-ld">
<section id="appendix-E.1.3">
          <h4 id="name-vc-signed-as-a-jwt-using-js">
<a href="#appendix-E.1.3" class="section-number selfRef">E.1.3. </a><a href="#name-vc-signed-as-a-jwt-using-js" class="section-name selfRef">VC signed as a JWT, Using JSON-LD</a>
          </h4>
<div id="format-identifier-2">
<section id="appendix-E.1.3.1">
            <h5 id="name-format-identifier-3">
<a href="#appendix-E.1.3.1" class="section-number selfRef">E.1.3.1. </a><a href="#name-format-identifier-3" class="section-name selfRef">Format Identifier</a>
            </h5>
<p id="appendix-E.1.3.1-1">The Credential format identifier is <code>jwt_vc_json-ld</code>.<a href="#appendix-E.1.3.1-1" class="pilcrow">¶</a></p>
<p id="appendix-E.1.3.1-2">When the <code>format</code> value is <code>jwt_vc_json-ld</code>, entire Credential Offer, Authorization Details, Credential Request and Credential Issuer metadata, including <code>credential_definition</code> object, MUST NOT be processed using JSON-LD rules.<a href="#appendix-E.1.3.1-2" class="pilcrow">¶</a></p>
<p id="appendix-E.1.3.1-3"><code>@context</code> value in the <code>credential_definition</code> object could be used by the Wallet to check whether it supports a certain VC or not. If necessary, the Wallet could apply JSON-LD processing to the Credential issued by the Credential Issuer.<a href="#appendix-E.1.3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credential-issuer-metadata-1">
<section id="appendix-E.1.3.2">
            <h5 id="name-credential-issuer-metadata-4">
<a href="#appendix-E.1.3.2" class="section-number selfRef">E.1.3.2. </a><a href="#name-credential-issuer-metadata-4" class="section-name selfRef">Credential Issuer Metadata</a>
            </h5>
<p id="appendix-E.1.3.2-1">The definitions in <a href="#server_metadata_ldp_vc" class="auto internal xref">Appendix E.1.2.2</a> apply for metadata of credentials of this type as well.<a href="#appendix-E.1.3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credential-offer-1">
<section id="appendix-E.1.3.3">
            <h5 id="name-credential-offer-5">
<a href="#appendix-E.1.3.3" class="section-number selfRef">E.1.3.3. </a><a href="#name-credential-offer-5" class="section-name selfRef">Credential Offer</a>
            </h5>
<p id="appendix-E.1.3.3-1">The definitions in <a href="#issuer_initiated_issuance_ldp_vc" class="auto internal xref">Appendix E.1.2.3</a> apply for credentials of this type as well.<a href="#appendix-E.1.3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authorization-details-1">
<section id="appendix-E.1.3.4">
            <h5 id="name-authorization-details-3">
<a href="#appendix-E.1.3.4" class="section-number selfRef">E.1.3.4. </a><a href="#name-authorization-details-3" class="section-name selfRef">Authorization Details</a>
            </h5>
<p id="appendix-E.1.3.4-1">The definitions in <a href="#issuer_initiated_issuance_ldp_vc" class="auto internal xref">Appendix E.1.2.3</a> apply for credentials of this type as well.<a href="#appendix-E.1.3.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credential-request-1">
<section id="appendix-E.1.3.5">
            <h5 id="name-credential-request-4">
<a href="#appendix-E.1.3.5" class="section-number selfRef">E.1.3.5. </a><a href="#name-credential-request-4" class="section-name selfRef">Credential Request</a>
            </h5>
<p id="appendix-E.1.3.5-1">The definitions in <a href="#credential_request_ldp_vc" class="auto internal xref">Appendix E.1.2.5</a> apply for credentials of this type as well.<a href="#appendix-E.1.3.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credential-response-1-1">
<section id="appendix-E.1.3.6">
            <h5 id="name-credential-response-4">
<a href="#appendix-E.1.3.6" class="section-number selfRef">E.1.3.6. </a><a href="#name-credential-response-4" class="section-name selfRef">Credential Response</a>
            </h5>
<p id="appendix-E.1.3.6-1">The definitions in <a href="#credential_response_jwt_vc_json" class="auto internal xref">Appendix E.1.1.6</a> apply for credentials of this type as well.<a href="#appendix-E.1.3.6-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="iso-mdl">
<section id="appendix-E.2">
        <h3 id="name-iso-mdl">
<a href="#appendix-E.2" class="section-number selfRef">E.2. </a><a href="#name-iso-mdl" class="section-name selfRef">ISO mDL</a>
        </h3>
<p id="appendix-E.2-1">This section defines a Credential Format Profile for credentials complying with <span>[<a href="#ISO.18013-5" class="cite xref">ISO.18013-5</a>]</span>.<a href="#appendix-E.2-1" class="pilcrow">¶</a></p>
<div id="format-identifier-3">
<section id="appendix-E.2.1">
          <h4 id="name-format-identifier-4">
<a href="#appendix-E.2.1" class="section-number selfRef">E.2.1. </a><a href="#name-format-identifier-4" class="section-name selfRef">Format Identifier</a>
          </h4>
<p id="appendix-E.2.1-1">The Credential format identifier is <code>mso_mdoc</code>.<a href="#appendix-E.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server_metadata_mso_mdoc">
<section id="appendix-E.2.2">
          <h4 id="name-credential-issuer-metadata-5">
<a href="#appendix-E.2.2" class="section-number selfRef">E.2.2. </a><a href="#name-credential-issuer-metadata-5" class="section-name selfRef">Credential Issuer Metadata</a>
          </h4>
<p id="appendix-E.2.2-1">The following additional Credential Issuer metadata are defined for this Credential format to be added to the <code>credentials_supported</code> parameter in addition to those defined in <a href="#credential-issuer-parameters" class="auto internal xref">Section 10.2.3</a>.<a href="#appendix-E.2.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-E.2.2-2.1">
              <code>doctype</code>: REQUIRED. String identifying the credential type as defined in <span>[<a href="#ISO.18013-5" class="cite xref">ISO.18013-5</a>]</span>.<a href="#appendix-E.2.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-E.2.2-2.2">
              <p id="appendix-E.2.2-2.2.1"><code>claims</code>: OPTIONAL. An object containing a list of name/value pairs, where the name is a certain <code>namespace</code> as defined in <span>[<a href="#ISO.18013-5" class="cite xref">ISO.18013-5</a>]</span> (or any profile of it), and the value is an object. This object also contains a list of name/value pairs, where the name is a claim name value that is defined in the respective namespace and is offered in the Credential. The value is an object detailing the specifics of the claim with the following non-exhaustive list of parameters that MAY be included:<a href="#appendix-E.2.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-E.2.2-2.2.2.1">
                  <code>mandatory</code>: OPTIONAL. Boolean which when set to <code>true</code> indicates the claim MUST be present in the issued Credential. If the <code>mandatory</code> property is omitted its default should be assumed to be <code>false</code>.<a href="#appendix-E.2.2-2.2.2.1" class="pilcrow">¶</a>
</li>
                <li class="compact" id="appendix-E.2.2-2.2.2.2">
                  <code>value_type</code>: OPTIONAL. String value determining the type of value of the claim. A non-exhaustive list of valid values defined by this specification are <code>string</code>, <code>number</code>, and image media types such as <code>image/jpeg</code> as defined in IANA media type registry for images (<a href="https://www.iana.org/assignments/media-types/media-types.xhtml#image">https://www.iana.org/assignments/media-types/media-types.xhtml#image</a>).<a href="#appendix-E.2.2-2.2.2.2" class="pilcrow">¶</a>
</li>
                <li class="compact" id="appendix-E.2.2-2.2.2.3">
                  <p id="appendix-E.2.2-2.2.2.3.1"><code>display</code>: OPTIONAL. An array of objects, where each object contains display properties of a certain claim in the Credential for a certain language. Below is a non-exhaustive list of valid parameters that MAY be included:<a href="#appendix-E.2.2-2.2.2.3.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-E.2.2-2.2.2.3.2.1">
                      <code>name</code>: OPTIONAL. String value of a display name for the claim.<a href="#appendix-E.2.2-2.2.2.3.2.1" class="pilcrow">¶</a>
</li>
                    <li class="compact" id="appendix-E.2.2-2.2.2.3.2.2">
                      <code>locale</code>: OPTIONAL. String value that identifies language of this object represented as language tag values defined in BCP47 <span>[<a href="#RFC5646" class="cite xref">RFC5646</a>]</span>. There MUST be only one object for each language identifier.<a href="#appendix-E.2.2-2.2.2.3.2.2" class="pilcrow">¶</a>
</li>
                  </ul>
</li>
              </ul>
</li>
            <li class="compact" id="appendix-E.2.2-2.3">
              <code>order</code>: OPTIONAL. An array of namespaced claim name values that lists them in the order they should be displayed by the Wallet. The values MUST be two strings separated by a tilde ('~') character, where the first string is a namespace value and a second is a claim name value. For example, `org.iso.18013.5.1~given_name".<a href="#appendix-E.2.2-2.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="appendix-E.2.2-3">The following is a non-normative example of an object comprising <code>credentials_supported</code> parameter of Credential format <code>mso_mdoc</code>:<a href="#appendix-E.2.2-3" class="pilcrow">¶</a></p>
<div class="breakable lang-json sourcecode" id="appendix-E.2.2-4">
<pre>{
    "credentials_supported": {
        "org.iso.18013.5.1.mDL": {
            "format": "mso_mdoc",
            "doctype": "org.iso.18013.5.1.mDL",
            "credentials_supported_identifier": "org.iso.18013.5.1.mDL",
            "cryptographic_binding_methods_supported": [
                "mso"
            ],
            "cryptographic_suites_supported": [
                "ES256", "ES384", "ES512"
            ],
            "display": [
                {
                    "name": "Mobile Driving License",
                    "locale": "en-US",
                    "logo": {
                        "url": "https://examplestate.com/public/mdl.png",
                        "alt_text": "a square figure of a mobile driving license"
                    },
                    "background_color": "#12107c",
                    "text_color": "#FFFFFF"
                },
                {
                    "name": "在籍証明書",
                    "locale": "ja-JP",
                    "logo": {
                        "url": "https://examplestate.com/public/mdl.png",
                        "alt_text": "大学のロゴ"
                    },
                    "background_color": "#12107c",
                    "text_color": "#FFFFFF"
                }
            ],
            "claims": {
                "org.iso.18013.5.1": {
                    "given_name": {
                        "display": [
                            {
                                "name": "Given Name",
                                "locale": "en-US"
                            },
                            {
                                "name": "名前",
                                "locale": "ja-JP"
                            }
                        ]
                    },
                    "family_name": {
                        "display": [
                            {
                                "name": "Surname",
                                "locale": "en-US"
                            }
                        ]
                    },
                    "birth_date": {}
                },
                "org.iso.18013.5.1.aamva": {
                    "organ_donor": {}
                }
            }
        }
    }
}
</pre><a href="#appendix-E.2.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="credential-offer-2">
<section id="appendix-E.2.3">
          <h4 id="name-credential-offer-6">
<a href="#appendix-E.2.3" class="section-number selfRef">E.2.3. </a><a href="#name-credential-offer-6" class="section-name selfRef">Credential Offer</a>
          </h4>
<p id="appendix-E.2.3-1">The following is a non-normative example of a Credential Offer of Credential format <code>mso_mdoc</code>:<a href="#appendix-E.2.3-1" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="appendix-E.2.3-2">
<pre>{
    "credential_issuer": "https://credential-issuer.example.com",
    "credentials": [
        "org.iso.18013.5.1.mDL"
    ],
    "grants": {
        "urn:ietf:params:oauth:grant-type:pre-authorized_code": {
            "pre-authorized_code": "adhjhdjajkdkhjhdj",
            "user_pin_required": true
        }
    }
}
</pre><a href="#appendix-E.2.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authorization-details-1-1">
<section id="appendix-E.2.4">
          <h4 id="name-authorization-details-4">
<a href="#appendix-E.2.4" class="section-number selfRef">E.2.4. </a><a href="#name-authorization-details-4" class="section-name selfRef">Authorization Details</a>
          </h4>
<p id="appendix-E.2.4-1">The following additional claims are defined for authorization details of type <code>openid_credential</code> and this Credential format.<a href="#appendix-E.2.4-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-E.2.4-2.1">
              <code>doctype</code>: REQUIRED. String as defined in <a href="#server_metadata_mso_mdoc" class="auto internal xref">Appendix E.2.2</a>. This claim contains the type values the Wallet requests authorization for at the Credential Issuer.<a href="#appendix-E.2.4-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-E.2.4-2.2">
              <code>claims</code>: OPTIONAL. An object as defined in <a href="#server_metadata_mso_mdoc" class="auto internal xref">Appendix E.2.2</a>.<a href="#appendix-E.2.4-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="appendix-E.2.4-3">The following is a non-normative example of an authorization details object with Credential format <code>mso_mdoc</code>:<a href="#appendix-E.2.4-3" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="appendix-E.2.4-4">
<pre>[
    {
        "type": "openid_credential",
        "format": "mso_doc",
        "doctype": "org.iso.18013.5.1.mDL",
        "claims": {
            "org.iso.18013.5.1": {
                "given_name": {},
                "family_name": {},
                "birth_date": {}
            },
            "org.iso.18013.5.1.aamva": {
                "organ_donor": {}
            }
        }
    }
]
</pre><a href="#appendix-E.2.4-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="credential-request-2">
<section id="appendix-E.2.5">
          <h4 id="name-credential-request-5">
<a href="#appendix-E.2.5" class="section-number selfRef">E.2.5. </a><a href="#name-credential-request-5" class="section-name selfRef">Credential Request</a>
          </h4>
<p id="appendix-E.2.5-1">The following additional parameters are defined for Credential Requests and this Credential format.<a href="#appendix-E.2.5-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-E.2.5-2.1">
              <code>doctype</code>: REQUIRED. String as defined in <a href="#server_metadata_mso_mdoc" class="auto internal xref">Appendix E.2.2</a>. The credential issued by the Credential Issuer MUST at least contain the values listed in this claim.<a href="#appendix-E.2.5-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-E.2.5-2.2">
              <code>claims</code>: OPTIONAL. An object as defined in <a href="#server_metadata_mso_mdoc" class="auto internal xref">Appendix E.2.2</a>.<a href="#appendix-E.2.5-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="appendix-E.2.5-3">The following is a non-normative example of a Credential Request with Credential format <code>mso_mdoc</code>:<a href="#appendix-E.2.5-3" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="appendix-E.2.5-4">
<pre>{
   "format": "mso_mdoc",
   "doctype": "org.iso.18013.5.1.mDL",
   "claims": {
      "org.iso.18013.5.1": {
         "given_name": {},
         "family_name": {},
         "birth_date": {}
      },
      "org.iso.18013.5.1.aamva": {
         "organ_donor": {}
      }
   },
   "proof": {
      "proof_type": "jwt",
      "jwt": "eyJraWQiOiJkaWQ6ZXhhbXBsZ...KPxgihac0aW9EkL1nOzM"
   }
}
</pre><a href="#appendix-E.2.5-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="credential-response-2">
<section id="appendix-E.2.6">
          <h4 id="name-credential-response-5">
<a href="#appendix-E.2.6" class="section-number selfRef">E.2.6. </a><a href="#name-credential-response-5" class="section-name selfRef">Credential Response</a>
          </h4>
<p id="appendix-E.2.6-1">The value of the <code>credential</code> claim in the Credential Response MUST be a string that is the base64url-encoded representation of the issued Credential.<a href="#appendix-E.2.6-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="document-history">
<section id="appendix-F">
      <h2 id="name-document-history">
<a href="#appendix-F" class="section-number selfRef">Appendix F. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-F-1">[[ To be removed from the final specification ]]<a href="#appendix-F-1" class="pilcrow">¶</a></p>
<p id="appendix-F-2">-12<a href="#appendix-F-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-F-3.1">changed the structure of the <code>credentials_supported</code> parameter to a map from array of objects<a href="#appendix-F-3.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-3.2">changed the structure of <code>credentials</code> parameter in Credential Offer to only be a string (no more objects) whose value is a key in the <code>credentials_supported</code> map<a href="#appendix-F-3.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-3.3">added an option to return credential_identifier in Token Request authorization_details parameter that can be used to identify credentials with the same metadata but different claimset/claim values and/or simplify the credential request even when only one credential is being issued.<a href="#appendix-F-3.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-3.4">renamed proof to key proof and added key proof replay security considerations<a href="#appendix-F-3.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-3.5">Aligned deferred authorization with RFC 8628 and CIBA<a href="#appendix-F-3.5" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-3.6">Changed Deferred Endpoint to require same access tokens as (batch) credential endpoint(s), renamed acceptance_token to transaction_id and changed it to a request parameter, and return HTTP status 202 in case of deferred issuance<a href="#appendix-F-3.6" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-3.7">Added Deferred Endpoint error response section<a href="#appendix-F-3.7" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-3.8">Added Deferred Endpoint metadata<a href="#appendix-F-3.8" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-3.9">added CWT proof type<a href="#appendix-F-3.9" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-F-4">-11<a href="#appendix-F-4" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-F-5.1">editorial changes to improve readability<a href="#appendix-F-5.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-F-6">-10<a href="#appendix-F-6" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-F-7.1">introduced differentiation between Credential Issuer and Authorization Server<a href="#appendix-F-7.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-7.2">relaxed Client identification requirements for Pre-Authorized Code Grant Type<a href="#appendix-F-7.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-7.3">renamed issuance initiation endpoint to Credential Offer Endpoint<a href="#appendix-F-7.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-7.4">added <code>grants</code> structure to credential offer<a href="#appendix-F-7.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-F-8">-09<a href="#appendix-F-8" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-F-9.1">reworked credential type identification and issuer metadata<a href="#appendix-F-9.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-9.2">changed format of issuer initiated Credential Request to JSON<a href="#appendix-F-9.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-9.3">added option to include credential data by reference in issuer initiated Credential Request<a href="#appendix-F-9.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-9.4">added profiles for W3C VCs and ISO mDL<a href="#appendix-F-9.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-9.5">added Batch Credential Endpoint<a href="#appendix-F-9.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-F-10">-08<a href="#appendix-F-10" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-F-11.1">reworked use of OAuth 2.0 scopes to be more flexible for implementers<a href="#appendix-F-11.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-11.2">added text on scope related error handling<a href="#appendix-F-11.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-11.3">changed media type of a Credential Request to application/json from application/x-www-form-urlencoded<a href="#appendix-F-11.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-F-12">-07<a href="#appendix-F-12" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-F-13.1">
          <p id="appendix-F-13.1.1">restructured the entire specification as following:<a href="#appendix-F-13.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-F-13.1.2.1">reorganized defined parameters and mechanisms around endpoints, not the flows<a href="#appendix-F-13.1.2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-F-13.1.2.2">merged requirements section into a simpler overview section<a href="#appendix-F-13.1.2.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-F-13.1.2.3">moved metadata to the after describing the endpoints<a href="#appendix-F-13.1.2.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-F-13.1.2.4">broke down one large diagram into two simpler ones<a href="#appendix-F-13.1.2.4" class="pilcrow">¶</a>
</li>
          </ul>
</li>
      </ul>
<p id="appendix-F-14">-06<a href="#appendix-F-14" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-F-15.1">added issuer metadata<a href="#appendix-F-15.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-15.2">made Credential Response more flexible regarding Credential encoding<a href="#appendix-F-15.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-15.3">changed file name to match specification name<a href="#appendix-F-15.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-15.4">renamed specification to reflect OAuth 2.0 being the base protocol<a href="#appendix-F-15.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-F-16">-05<a href="#appendix-F-16" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-F-17.1">added support for Pre-Authorized Code Flow<a href="#appendix-F-17.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-17.2">changed base protocol to OAuth 2.0<a href="#appendix-F-17.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-F-18">-04<a href="#appendix-F-18" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-F-19.1">added support for requesting Credential authorization with scopes<a href="#appendix-F-19.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-19.2">removed support to pass VPs in the Authorization Request<a href="#appendix-F-19.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-19.3">reworked "proof" parameter definition and added "jwt" proof type<a href="#appendix-F-19.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-F-20">-03<a href="#appendix-F-20" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-F-21.1">added issuance initiation endpoint<a href="#appendix-F-21.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-21.2">Applied cleanups suggested by Mike Jones post adoption<a href="#appendix-F-21.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-F-22">-02<a href="#appendix-F-22" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-F-23.1">Adopted as WG document<a href="#appendix-F-23.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-F-24">-01<a href="#appendix-F-24" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-F-25.1">Added Request &amp; Response syntax and descriptions<a href="#appendix-F-25.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-25.2">Reworked and extended sequence diagram<a href="#appendix-F-25.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-F-26">-00<a href="#appendix-F-26" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-F-27.1">initial revision<a href="#appendix-F-27.1" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-G">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Torsten Lodderstedt</span></div>
<div dir="auto" class="left"><span class="org">sprind.org</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:torsten@lodderstedt.net" class="email">torsten@lodderstedt.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Kristina Yasuda</span></div>
<div dir="auto" class="left"><span class="org">Microsoft</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kristina.yasuda@microsoft.com" class="email">kristina.yasuda@microsoft.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tobias Looker</span></div>
<div dir="auto" class="left"><span class="org">Mattr</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tobias.looker@mattr.global" class="email">tobias.looker@mattr.global</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>

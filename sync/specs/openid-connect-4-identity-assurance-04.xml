<?xml version="1.0" encoding="utf-8"?>
<!-- name="GENERATOR" content="github.com/mmarkdown/mmark Mmark Markdown Processor - mmark.nl" -->
<!DOCTYPE rfc SYSTEM 'rfc2629.dtd' []>
<rfc ipr="trust200902" category="std" xml:lang="en" consensus="yes" docName="openid-connect-4-identity-assurance-04">
<?rfc toc="yes"?><?rfc symrefs="yes"?><?rfc sortrefs="yes"?><?rfc compact="yes"?><?rfc subcompact="no"?><?rfc comments="no"?>
<front>
<title abbrev="openid-connect-4-identity-assurance">OpenID Connect for Identity Assurance</title><author initials="T." surname="Lodderstedt" fullname="Torsten Lodderstedt"><organization>yes.com</organization><address><postal><street></street>
</postal><email>torsten@lodderstedt.net</email>
</address></author>
<author initials="D." surname="Fett" fullname="Daniel Fett"><organization>yes.com</organization><address><postal><street></street>
</postal><email>mail@danielfett.de</email>
</address></author>
<date year="2019" month="May" day="26"></date>
<area>Internet</area><workgroup>connect</workgroup><keyword>security</keyword>
<keyword>openid</keyword>
<keyword>identity assurance</keyword>

<abstract><t>This specification defines an extension of OpenID Connect for providing Relying Parties with verified person data. This extension is intended to be used to verify the identity of a person in compliance with a certain law.</t>
</abstract>

</front>

<middle>

<section anchor="Introduction" title="Introduction">
<t>This specification defines an extension to OpenID Connect <xref target="OpenID"></xref> to address the use case of strong identity verification of a natural person in accordance with certain laws. Examples include Anti Money Laundering Laws, Telecommunication Acts, Anti Terror Laws, and regulations on trust services, such as eIDAS <xref target="eIDAS"></xref>.</t>
<t>In such use cases, the Relying Parties (RPs) need to know the assurance level of the user Claims attested by the OpenID Connect Providers (OPs) along with evidences related to the identity verification process (identity assurance).</t>
<t>Identity assurance significantly differs from authentication assurance, which requires a different representation in the OpenID Connect protocol that is defined in this specification.</t>
<t>The assurance level for authentication is a property of a certain OpenID Connect transaction, determined by the authentication means employed and the underlying user account management processes. The <spanx style="verb">acr</spanx> Claim as defined in Section 2 of the OpenID Connect specification <xref target="OpenID"></xref> is sufficient to convey this information.</t>
<t>The identity assurance for user Claims, i.e. the binding of a certain Claim value to the person controlling the respective user account, typically varies among the different user Claims. For example, the assurance an OP typically will be able to attest for an e-mail address will be “self-asserted”, “verified by opt-in”, or “verified by the respective e-mail provider via an attribute exchange protocol”. The family name of a user, in contrast, might have been verified in accordance with the respective Anti Money Laundering Law by showing an ID Card to a trained employee of the OP operator.</t>
<t>Identity assurance therefore requires a way to convey assurance data along with and coupled to the respective user Claims. This specification proposes a suitable representation and mechanisms the RP will utilize to request verified person data and accompanying identity assurance data.</t>

<section anchor="terminology" title="Terminology">
<t>This section defines some terms relevant to the topic covered in this documents, heavily inspired by NIST SP 800-63A <xref target="NIST-SP-800-63a"></xref>.</t>
<t>
<list style="symbols">
<t>Identity Proofing - process in which a user provides evidence to an OP or claim provider reliably identifying themselves, thereby allowing the OP to assert that identification at a useful identity assurance level.</t>
<t>Identify Verification - process conducted by the OP or a claim provider to verify the user's identity.</t>
<t>Identity Assurance - process in which the OP or a claim provider attests identity data of a certain user with a certain assurance towards a RP, typically expressed by way of an assurance level. Depending on legal requirements, the OP may also be required to provide evidences of the identity verification process to the RP.</t>
<t>Verified Person Data - Claims about a person whose binding to a particular use account were verified in the course of an identity verification process.</t>
</list>
</t>
</section>
</section>

<section anchor="scope-and-requirements" title="Scope and Requirements">
<t>The extension specified in this document SHALL</t>
<t>
<list style="symbols">
<t>allow an OpenID Connect RP to request the minimal identity data set it needs (data minimization) and to express requirements regarding this data and the evidences and processes employed,</t>
<t>allow an OP to attest identity data obtained and maintained in accordance with a certain law, and</t>
<t>allow the RP to map the data obtained from the OP to other laws, e.g. it shall be possible to use identity data maintained in accordance with the Anti Money Laundering Law to fulfill requirements defined by eIDAS.</t>
</list>
</t>
<t>The scope of the extension is to define mechanisms to assert verified person data.</t>
<t>It SHALL be possible to use existing OpenID Connect claims and other extensions defined beside this extension within the same OpenID Connect transaction and especially to render the same ID Token or other representations utilized to convey user claims. For example, OpenID Connect already defines additional claims to inform the RP of the verification status of the <spanx style="verb">phone_number</spanx> and <spanx style="verb">email</spanx> claims. For the same reason, this extension SHALL allow the OP to attest verified and unverified claims in the same transaction.</t>
<t>This extension MAY introduce new user claims to cover user attributes not currently covered by OpenID Connect, one example would be the place of birth.</t>
<t>The representation defined in this specification is intended to be used to provide RPs with verified person data via any appropriate channel. In the context of OpenID Connnect, verified person data can be attested in ID Tokens or as part of the User Info response. It is also possible to utilize the format described here in OAuth Token Introspection responses (see <xref target="RFC7662"></xref> and <xref target="I-D.ietf-oauth-jwt-introspection-response"></xref>) to provide resource servers with
verified person data.</t>
<t>This extension defines a way to assert verified claims only. There is no need to cover unverified claims, or rather Claims without further information about the assurance, since they are already covered by OpenID Connect Core <xref target="OpenID"></xref>.</t>
<t>Even for asserting verified claims, this extension shall attempt to utilize existing OpenID Connect claims if possible and reasonable. It MUST, however, ensure RPs cannot interpret unverified claims as verified claims.</t>
<t>The representation defined in this extension SHALL allow RPs to obtain assertions about verified claims from different OPs using different trust frameworks.</t>
<t>This extension SHALL be usable by OPs operating under a certain regulation related to identity assurance, such as eIDAS notified eID systems, as well as other OPs. Strictly regulated OPs can attest identity data without the need to provide further evidences since they are approved to operate accoriding to well-defined rules with clearly defined liability. For example in case of eIDAS, the peer review ensures eIDAS compliance and the respective member state takes the liability for the identities asserted by its notified eID systems. Every other OP not operating under such well-defined conditions is typically required to provide the RP data about the identity verification process along with identity evidences to allow the RP to conduct their own risk assessment.</t>
<t>From a technical perspective, this means this specification needs to support cases, where basically verified person data are provided along with the information about the regulatory framework (trust framework) the OP complies with and the respective level of assurance, whereas there shall also be support to externalize information about the identity verification process with the OP to the RP.</t>
<t>This extension SHALL be trully international and support identity assurance for different and across jurisdictions. It SHALL be extensible to support new trust frameworks, verification methods, and respective identity evidences.</t>
<t>Note: data transfer between OP and RP requires a legal basis that MUST be established upfront or in the course of the OpenID process.</t>
</section>

<section anchor="claims" title="Claims">

<section anchor="userclaims" title="User Claims">
<t>In order to fulfill the requirements of some jurisdictions on identity assurance, this specification defines the following claims for conveying user data in addition to the claims defined in the OpenID Connect specification <xref target="OpenID"></xref>:</t>
<t>
<list style="symbols">
<t><spanx style="verb">place_of_birth</spanx>: a structured claim representing the end-user’s place of birth. It consists of the following fields:
<list style="symbols">
<t><spanx style="verb">country</spanx>: ISO 3166-1 Alpha-2, e.g. DE, or ISO 3166-3</t>
<t><spanx style="verb">region</spanx>: State, province, prefecture, or region component</t>
<t><spanx style="verb">locality</spanx>: city or other locality</t>
</list></t>
<t><spanx style="verb">nationality</spanx>: represents the user’s nationality in format ISO 3166-1 Alpha-2, e.g. DE</t>
<t><spanx style="verb">birth_name</spanx>: family name someone has when he or she is born, or at least from the time he or she is a child. This term can be used by a man or a woman who changes a name later in life for any reason.</t>
<t><spanx style="verb">salutation</spanx>: end-user’s salutation, e.g. “Mr.”</t>
<t><spanx style="verb">title</spanx>: end-user’s title, e.g. “Dr.”</t>
</list>
</t>
</section>

<section anchor="transaction-id" title="transaction_id">
<t>Strong identity verification typically requires the participants to keep an audit trail of the whole process.</t>
<t>This specification supports building an audit trail across the boundaries between OP and RP by introducing the claim <spanx style="verb">transaction_id</spanx>.</t>
<t>The <spanx style="verb">transaction_id</spanx> claim is a string value which</t>
<t>
<list style="symbols">
<t>MUST be unique within the context of the respective OP,</t>
<t>MUST uniquely identify a certain transaction at the OP, and</t>
<t>MUST allow an RP to obtain further transaction details if needed.</t>
</list>
</t>
<t>If the OP issues a transaction_id, it MUST maintain a corresponding audit trail, which at least consists of the following details:</t>
<t>
<list style="symbols">
<t>the transaction id,</t>
<t>the authentication methods employed, and</t>
<t>the transaction type (e.g. scope values).</t>
</list>
</t>
<t>This transaction data MUST be stored as long as it is required to store transaction data for auditing purposes by the respective regulation.</t>
<t>The RP requests this claim like any other claim via the claims parameter or as part of a default claim set identified by a scope value.</t>
</section>
</section>

<section anchor="verified-data-representation" title="Verified Data Representation">
<t>This extension to OpenID Connect wants to ensure that RPs cannot mixup verified and unverified claims and incidentally process unverified claims as verified claims.</t>
<t>The representation proposed therefore provides the RP with the verified claims within a structured claim <spanx style="verb">verified_person_data</spanx>. This structured claim is composed of the verification evidences related to a certain verification process and the corresponding user claims which were verified in this process.</t>
<t>This section explains the structure and meaning of the claim in detail, the syntax is also given as JSON schema in section <eref target="#json_schema">JSON Schema</eref>.</t>
<t>The <spanx style="verb">verified_person_data</spanx> claim consists of the following sub-elements:</t>
<t>
<list style="symbols">
<t><spanx style="verb">verification</spanx>: REQUIRED. Object that contains all data about the verification process.</t>
<t><spanx style="verb">claims</spanx>: REQUIRED. Object that is the container for the verified user claims.</t>
</list>
</t>

<section anchor="verification" title="verification Element">
<t>This element contains the information about the process conducted to verify a person's identity and bind the respective person data to a user account.</t>
<t>The <spanx style="verb">verification</spanx> element consists of the following elements:</t>
<t><spanx style="verb">trust_framework</spanx>: REQUIRED. String determing the trust framework governing the identity verification process and the identity assurance level of the OP.</t>
<t>An example value is <spanx style="verb">eidas_ial_high</spanx>, which denotes a notified eID system under eIDAS providing identity assurance at level of assurance &quot;High&quot;.</t>
<t>An initial list of standardized values is defined in <eref target="#predefined_values_tf">Trust Frameworks</eref>. Additional trust framework identifiers can be introduced [how?]. RPs SHOULD ignore <spanx style="verb">verified_person_data</spanx> claims containing a trust framework id they don't know.</t>
<t>The <spanx style="verb">trust_framework</spanx> value determines what further data is provided to the RP in the <spanx style="verb">verification</spanx> element. A notified eID system under eIDAS, for example, would not need to provide any further data whereas an OP not governed by eIDAS would need to provide verification evidences in order to allow the RP to fulfill its legal obligations. An example of the latter is an OP acting under the German Anti-Money laundering law (<spanx style="verb">de_aml</spanx>).</t>
<t><spanx style="verb">date</spanx>: Time stamp in ISO 8601:2004 YYYY-MM-DD format representing the date when identity verification took place. Presence of this element might be required for certain trust frameworks.</t>
<t><spanx style="verb">id</spanx>: Unique reference to the identity verification process as performed by the OP. Used for backtracing in case of disputes or audits. Note: In contrast to this field, the claim <spanx style="verb">transaction_id</spanx> refers to the transaction leading the OP to attest the user's verified identity data towards a RP. Presence of this element might be required for certain trust frameworks.</t>
<t><spanx style="verb">evidences</spanx> is a JSON array containing the evidences the IDP used to verifiy the user's identity as separate JSON objects. Every object contains the property <spanx style="verb">type</spanx> determining it's respective type. The RP uses this information to process the <spanx style="verb">evidence</spanx> property appropriately.</t>

<section anchor="evidences" title="Evidences">
<t>The following types of evidences are defined:</t>
<t>
<list style="symbols">
<t>&quot;id_document&quot;: verification based on any kind of government issued identity document</t>
<t>&quot;utility_bill&quot;: verification based on an utility bill</t>
<t>&quot;qes&quot;: verification based on a eIDAS Qualified Electronic Signature</t>
</list>
</t>

<section anchor="id-document" title="id_document">
<t>The following elements are contained in an <spanx style="verb">id_document</spanx> evidence sub-element.</t>
<t><spanx style="verb">method</spanx>: REQUIRED. The method used to verify the id document, predefined values are given in  <eref target="#predefined_values_vm">Verification Methods</eref></t>
<t><spanx style="verb">verifier</spanx>: OPTIONAL. A JSON object denoting the legal entity that performed the identity verification on behalf of the OP. This object SHOULD only be included if the IDP did not perform the identity verification itself. This object consists of the following properties:</t>
<t>
<list style="symbols">
<t><spanx style="verb">organization</spanx>: String denoting the organization which performed the verification on behalf of the OP.</t>
<t><spanx style="verb">agent</spanx>: Agent (person) who conducted the verification. The agent may be identified by Name or an identifier which can be resolved into the agent’s name during an audit.</t>
</list>
</t>
<t><spanx style="verb">document</spanx>: A JSON object representing the id document used to perform the id verification. It consists of the following properties:</t>
<t>
<list style="symbols">
<t><spanx style="verb">type</spanx>: REQUIRED. String denoting the type of the id document, standardized values are defined in <eref target="#predefined_values_idd">Identity Documents</eref>. The OP MAY use other than the predefined values in which case the RPs will either be unable to process the assertion, just store this value for audit purposes, or apply bespoken business logic to it.</t>
<t><spanx style="verb">number</spanx>: String representing the number of the identity document.</t>
<t><spanx style="verb">issuer</spanx>: A JSON object containg information about the government agency that issued this identity document. This object consists of the following properties:
<list style="symbols">
<t><spanx style="verb">name</spanx>: REQUIRED. Designation of the issuer of the identity document</t>
<t><spanx style="verb">country</spanx>: String denoting the country where the document was issued, format: ISO 3166-1 Alpha-2, e.g. &quot;DE&quot;.</t>
</list></t>
<t><spanx style="verb">date_of_issuance</spanx>: CONDITIONALLY REQUIRED. The date the document was issued as ISO 8601:2004 YYYY-MM-DD format, if this attribute exists for the particular type of document.</t>
<t><spanx style="verb">date_of_expiry</spanx>: CONDITIONALLY REQUIRED. The date the document will expire as ISO 8601:2004 YYYY-MM-DD format, if this attribute exists for the particular type of document.</t>
</list>
</t>
</section>

<section anchor="utility-bill" title="utility_bill">
<t>The following elements are contained in a <spanx style="verb">utility_bill</spanx> evidence sub-element.</t>
<t><spanx style="verb">provider</spanx>: REQUIRED. A JSON object identifying the respective provider that issued the bill. The object consists of the following properties:</t>
<t>
<list style="symbols">
<t><spanx style="verb">name</spanx>: A String designating the provider.</t>
<t>All elements of the OpenID Connect <spanx style="verb">address</spanx> Claim (<xref target="OpenID"></xref>)</t>
</list>
</t>
<t><spanx style="verb">date</spanx>: A ISO 8601:2004 YYYY-MM-DD formated string containing the date when this bill was issued.</t>
</section>

<section anchor="qes" title="qes">
<t>The following elements are contained in a <spanx style="verb">qes</spanx> evidence sub-element.</t>
<t><spanx style="verb">issuer</spanx>: REQUIRED. A String denoting the trust service provider that created the eletronic signatue.</t>
<t><spanx style="verb">issued_at</spanx>: REQUIRED. The date the signature was created as ISO 8601:2004 YYYY-MM-DD format</t>
<t><spanx style="verb">serial_number</spanx>: REQUIRED. String containing the serial number of the certificate used to sign.</t>
</section>
</section>
</section>

<section anchor="claimselement" title="claims Element">
<t>The <spanx style="verb">claims</spanx> element contains the user claims which were verified by the process and according to the policies determined by the corresponding <spanx style="verb">verification</spanx> element.</t>
<t>The <spanx style="verb">claims</spanx> element MAY contain one or more of the following user claims as defined in Section 5.1 of the OpenID Connect specification <xref target="OpenID"></xref></t>
<t>
<list style="symbols">
<t><spanx style="verb">name</spanx></t>
<t><spanx style="verb">given_name</spanx></t>
<t><spanx style="verb">middle_name</spanx></t>
<t><spanx style="verb">family_name</spanx></t>
<t><spanx style="verb">birthdate</spanx></t>
<t><spanx style="verb">address</spanx></t>
</list>
</t>
<t>or of the following claims as defined in Section <eref target="#userclaims">User Claims</eref>:</t>
<t>
<list style="symbols">
<t><spanx style="verb">place_of_birth</spanx></t>
<t><spanx style="verb">nationality</spanx></t>
<t><spanx style="verb">birth_name</spanx></t>
</list>
</t>
<t>The <spanx style="verb">claims</spanx> element MAY also contain other claims given the value of the respective claim was verified in the verification process represented by the sibling <spanx style="verb">verification</spanx> element.</t>
</section>
</section>

<section anchor="requesting-verified-person-data" title="Requesting Verified Person Data">

<section anchor="requesting-user-claims" title="Requesting User Claims">
<t>Verified person data can be requested on the level of individual user claims by utilizing the <spanx style="verb">claims</spanx> parameter as defined in Section 5.5. of the OpenID Connect specification <xref target="OpenID"></xref>.</t>
<t>Basically, the claim <spanx style="verb">verified_person_data</spanx> is added to the section <spanx style="verb">userinfo</spanx> or <spanx style="verb">id_token</spanx> of the <spanx style="verb">claims</spanx> parameter.</t>
<t>Since <spanx style="verb">verified_person_data</spanx> contains the effective user claims in a nested <spanx style="verb">claims</spanx> element, the syntax is extended to include expressions on nested elements as follows. The <spanx style="verb">verified_person_data</spanx> element includes a <spanx style="verb">claims</spanx> element, which in turn includes the desired user claims as keys with a <spanx style="verb">null</spanx> value. An example is shown in the following:</t>

<figure><artwork type="json">{  
   &quot;userinfo&quot;:{  
      &quot;verified_person_data&quot;:{  
         &quot;claims&quot;:{  
            &quot;given_name&quot;:null,
            &quot;family_name&quot;:null,
            &quot;birthdate&quot;:null
         }
      }
   }	
}
</artwork></figure>

<t>Use of the <spanx style="verb">claims</spanx> parameter allows the RP to exactly select the user claims needed for its use case. This extension therefore allows RPs to fulfill the requirement for data minimization.</t>
<t>RPs MAY indicate that a certain claim is essential to the sucessful completion of the user journey by utilizing the <spanx style="verb">essential</spanx> field as defined in Section 5.5.1. of the OpenID Connect specification <xref target="OpenID"></xref>. The following example designates both given as well as family name as being essential.</t>

<figure><artwork type="json">{  
   &quot;userinfo&quot;:{  
      &quot;verified_person_data&quot;:{  
         &quot;claims&quot;:{  
            &quot;given_name&quot;:{&quot;essential&quot;: true},
            &quot;family_name&quot;:{&quot;essential&quot;: true},
            &quot;birthdate&quot;:null
         }
      }
   }	
}
</artwork></figure>

<t>Note: A <spanx style="verb">claims</spanx> sub-element with value <spanx style="verb">null</spanx> is interpreted as a request for all possible claims. An example is shown in the following:</t>

<figure><artwork type="json">{  
   &quot;userinfo&quot;:{  
      &quot;verified_person_data&quot;:{  
         &quot;claims&quot;:null
      }
   }	
}
</artwork></figure>

<t>Note: The <spanx style="verb">claims</spanx> sub-element can be omitted, which is equivalent to a claims element whose value is <spanx style="verb">null</spanx>.</t>
<t>Note: If the <spanx style="verb">claims</spanx> sub-element is empty or contains a claim not fulfilling the requirements defined in Section <eref target="#claimselement">claims</eref>, the OP will abort the transaction with an <spanx style="verb">invalid_request</spanx> error.</t>
</section>

<section anchor="constraintedclaims" title="Defining constraints on requested data">
<t>The RP MAY express requirements regarding the elements in the <spanx style="verb">verification</spanx> sub-element.</t>
<t>This, again, requires an extension to the syntax as defined in Section 5.5. of the OpenID Connect specification <xref target="OpenID"></xref> due to the nested nature of the <spanx style="verb">verified_person_data</spanx> claim.</t>
<t>Section 5.5.1 of the OpenID Connect specification <xref target="OpenID"></xref> defines a query syntax that allows for the member value of the claim being requested to be a JSON object with additional information/constraints on the claim. For doing so it defines three members (<spanx style="verb">essential</spanx>, <spanx style="verb">value</spanx> and <spanx style="verb">values</spanx>) with special query
meanings and allows for other special members to be defined (while stating that any members that are not understood must be ignored).</t>
<t>This specification re-uses that mechanism and introduces a new such member <spanx style="verb">max_age</spanx> (see below).</t>
<t>To start with, the RP MAY limit the possible values of the elements <spanx style="verb">trust_framework</spanx>, <spanx style="verb">evidences/id_document/document/type</spanx>, and <spanx style="verb">identity_document/method</spanx> by utilizing the <spanx style="verb">value</spanx> or <spanx style="verb">values</spanx> fields.</t>
<t>The following example shows that the RP wants to obtain an attestation based on AML and limited to users who were identified in a bank branch using government issued id documents.</t>

<figure><artwork type="json">{  
   &quot;userinfo&quot;:{  
      &quot;verified_person_data&quot;:{  
         &quot;verification&quot;:{  
            &quot;trust_framework&quot;:{  
               &quot;value&quot;:&quot;de_aml&quot;
            },
            &quot;id_document&quot;:{  
               &quot;document&quot;:{  
                  &quot;type&quot;:{  
                     &quot;values&quot;:[  
                        &quot;idcard&quot;,
                        &quot;passport&quot;
                     ]
                  }
               },
               &quot;method&quot;:{  
                  &quot;value&quot;:&quot;pipp&quot;
               }
            }
         },
         &quot;claims&quot;:null
      }
   }
}
</artwork></figure>

<t>The RP MAY also express a requirement regarding the age of the verification data, i.e., the time elapsed since the verification process asserted in the <spanx style="verb">verification</spanx> element has taken place.</t>
<t>This specification therefore defines a new member <spanx style="verb">max_age</spanx>.</t>
<t><spanx style="verb">max_age</spanx>: OPTIONAL. Is a JSON number value only applicable to claims that contain dates or timestamps. It defines the maximum time (in seconds) to be allowed to elapse since the value of the date/timestamp up to the point in time of the request. The IDP should make the calculation of elapsed time starting from the last valid second of the date value. The following is an example of a request for claims where the verification process of the data is not allowed to be older than 63113852 seconds.</t>
<t>The following is an example:</t>

<figure><artwork type="json">{  
   &quot;userinfo&quot;:{  
      &quot;verified_person_data&quot;:{  
         &quot;verification&quot;:{  
            &quot;date&quot;:{  
               &quot;max_age&quot;:&quot;63113852&quot;
            }
         },
         &quot;claims&quot;:null
      }
   }
}
</artwork></figure>

<t>The OP SHOULD try to fulfill this requirement. If the verification data of the user is older than the requested <spanx style="verb">max_age</spanx>, the OP MAY attempt to refresh the user’s verification by sending her through a online identity verification process, e.g. by utilizing an electronic ID card or a video identification approach.</t>
<t>If the OP is unable to fulfill the requirement (even in case it is marked as being <spanx style="verb">essential</spanx>), it will provide the RP with the data available and the RP may decide how to use the data. The OP MUST NOT return an error in case it cannot return all claims requested as essential claims.</t>
</section>
</section>

<section anchor="examples" title="Examples">
<t>The following sections show examples of <spanx style="verb">verified_person_data</spanx> objects.</t>
<t>The first and second section show JSON snippets of the general identity assurance case, where the RP is provided with verification evidences for different verification methods along with the actual user claims.</t>
<t>The third section illustrate how the contents of this object could look like in case of a notified eID system under eIDAS, where the OP does not need to provide evidences of the identity verification process to the RP.</t>
<t>Subsequent sections contain examples for using the <spanx style="verb">verified_person_data</spanx> claim on different channels and in combination with other (unverified) user claims.</t>

<section anchor="id-document-1" title="id_document">

<figure><artwork type="JSON">{  
   &quot;verified_person_data&quot;:{  
      &quot;verification&quot;:{  
         &quot;trust_framework&quot;:&quot;de_aml&quot;,
         &quot;date&quot;:&quot;2013-02-21&quot;,
         &quot;id&quot;:&quot;676q3636461467647q8498785747q487&quot;,
         &quot;evidences&quot;:[  
            {  
               &quot;type&quot;:&quot;id_document&quot;,
               &quot;method&quot;:&quot;pipp&quot;,
               &quot;document&quot;:{  
                  &quot;type&quot;:&quot;idcard&quot;,
                  &quot;issuer&quot;:{  
                     &quot;name&quot;:&quot;Stadt Augsburg&quot;,
                     &quot;country&quot;:&quot;DE&quot;
                  },
                  &quot;number&quot;:&quot;53554554&quot;,
                  &quot;date_of_issuance&quot;:&quot;2012-04-23&quot;,
                  &quot;date_of_expiry&quot;:&quot;2022-04-22&quot;
               }
            }
         ]
      },
      &quot;claims&quot;:{  
         &quot;given_name&quot;:&quot;Max&quot;,
         &quot;family_name&quot;:&quot;Meier&quot;,
         &quot;birthdate&quot;:&quot;1956-01-28&quot;,
         &quot;place_of_birth&quot;:{  
            &quot;country&quot;:&quot;DE&quot;,
            &quot;locality&quot;:&quot;Musterstadt&quot;
         },
         &quot;nationality&quot;:&quot;DE&quot;,
         &quot;address&quot;:{  
            &quot;locality&quot;:&quot;Maxstadt&quot;,
            &quot;postal_code&quot;:&quot;12344&quot;,
            &quot;country&quot;:&quot;DE&quot;,
            &quot;street_address&quot;:&quot;An der Sanddüne 22&quot;
         }
      }
   }
}
</artwork></figure>

</section>

<section anchor="id-document-utility-bill" title="id_document + utility bill">

<figure><artwork type="JSON">{  
   &quot;verified_person_data&quot;:{  
      &quot;verification&quot;:{  
         &quot;trust_framework&quot;:&quot;de_aml&quot;,
         &quot;date&quot;:&quot;2013-02-21&quot;,
         &quot;id&quot;:&quot;676q3636461467647q8498785747q487&quot;,
         &quot;evidences&quot;:[  
            {  
               &quot;type&quot;:&quot;id_document&quot;,
               &quot;method&quot;:&quot;pipp&quot;,
               &quot;document&quot;:{  
                  &quot;document_type&quot;:&quot;de_erp_replacement_idcard&quot;,
                  &quot;issuer&quot;:{  
                     &quot;name&quot;:&quot;Stadt Augsburg&quot;,
                     &quot;country&quot;:&quot;DE&quot;
                  },
                  &quot;number&quot;:&quot;53554554&quot;,
                  &quot;date_of_issuance&quot;:&quot;2012-04-23&quot;,
                  &quot;date_of_expiry&quot;:&quot;2022-04-22&quot;
               }
            },
            {  
               &quot;type&quot;:&quot;utility_bill&quot;,
               &quot;provider&quot;:{  
                  &quot;name&quot;:&quot;Stadtwerke Musterstadt&quot;,
                  &quot;country&quot;:&quot;DE&quot;,
                  &quot;region&quot;:&quot;Thüringen&quot;,
                  &quot;street_address&quot;:&quot;Energiestrasse 33&quot;
               },
               &quot;date&quot;:&quot;2013-01-31&quot;
            }
         ]
      },
      &quot;claims&quot;:{  
         &quot;given_name&quot;:&quot;Max&quot;,
         &quot;family_name&quot;:&quot;Meier&quot;,
         &quot;birthdate&quot;:&quot;1956-01-28&quot;,
         &quot;place_of_birth&quot;:{  
            &quot;country&quot;:&quot;DE&quot;,
            &quot;locality&quot;:&quot;Musterstadt&quot;
         },
         &quot;nationality&quot;:&quot;DE&quot;,
         &quot;address&quot;:{  
            &quot;locality&quot;:&quot;Maxstadt&quot;,
            &quot;postal_code&quot;:&quot;12344&quot;,
            &quot;country&quot;:&quot;DE&quot;,
            &quot;street_address&quot;:&quot;An der Sanddüne 22&quot;
         }
      }
   }
}
</artwork></figure>

</section>

<section anchor="notified-eid-system-eidas" title="Notified eID system (eIDAS)">

<figure><artwork type="JSON">{  
   &quot;verified_person_data&quot;:{  
      &quot;verification&quot;:{  
         &quot;trust_framework&quot;:&quot;eidas_ial_substantial&quot;
      },
      &quot;claims&quot;:{  
         &quot;given_name&quot;:&quot;Max&quot;,
         &quot;family_name&quot;:&quot;Meier&quot;,
         &quot;birthdate&quot;:&quot;1956-01-28&quot;,
         &quot;place_of_birth&quot;:{  
            &quot;country&quot;:&quot;DE&quot;,
            &quot;locality&quot;:&quot;Musterstadt&quot;
         },
         &quot;nationality&quot;:&quot;DE&quot;,
         &quot;address&quot;:{  
            &quot;locality&quot;:&quot;Maxstadt&quot;,
            &quot;postal_code&quot;:&quot;12344&quot;,
            &quot;country&quot;:&quot;DE&quot;,
            &quot;street_address&quot;:&quot;An der Sanddüne 22&quot;
         }
      }
   }
}
</artwork></figure>

</section>

<section anchor="verified-person-data-in-user-info-response" title="Verified Person Data in User Info Response">

<section anchor="request" title="Request">
<t>In this example we assume the RP uses the scope parameter to request the email address and, additionally, the claims parameter, to request verified person data.</t>
<t>The scope value is: <spanx style="verb">scope=openid email</spanx></t>
<t>The value of the claims parameter is:</t>

<figure><artwork type="json">{  
   &quot;userinfo&quot;:{  
       &quot;verified_person_data&quot;:{  
         &quot;claims&quot;:{  
            &quot;given_name&quot;:null,
            &quot;family_name&quot;:null,
            &quot;birthdate&quot;:null
         }
      }
   }	
}
</artwork></figure>

</section>

<section anchor="user-info-response" title="User Info Response">
<t>The respective user info response would be</t>

<figure><artwork type="http">HTTP/1.1 200 OK
Content-Type: application/json

{  
   &quot;iss&quot;:&quot;https://server.example.com&quot;,
   &quot;sub&quot;:&quot;248289761001&quot;,
   &quot;email&quot;:&quot;janedoe@example.com&quot;,
   &quot;email_verified&quot;:true,
   &quot;verified_person_data&quot;:{  
      &quot;verification&quot;:{  
         &quot;trust_framework&quot;:&quot;de_aml&quot;,
         &quot;date&quot;:&quot;2013-02-21&quot;,
         &quot;id&quot;:&quot;676q3636461467647q8498785747q487&quot;,
         &quot;evidences&quot;:[  
            {  
               &quot;type&quot;:&quot;id_document&quot;,
               &quot;method&quot;:&quot;pipp&quot;,
               &quot;document&quot;:{  
                  &quot;type&quot;:&quot;idcard&quot;,
                  &quot;issuer&quot;:{  
                     &quot;name&quot;:&quot;Stadt Augsburg&quot;,
                     &quot;country&quot;:&quot;DE&quot;
                  },
                  &quot;number&quot;:&quot;53554554&quot;,
                  &quot;date_of_issuance&quot;:&quot;2012-04-23&quot;,
                  &quot;date_of_expiry&quot;:&quot;2022-04-22&quot;
               }
            }
         ]
      },
      &quot;claims&quot;:{  
         &quot;given_name&quot;:&quot;Max&quot;,
         &quot;family_name&quot;:&quot;Meier&quot;,
         &quot;birthdate&quot;:&quot;1956-01-28&quot;
      }
   }
}
</artwork></figure>

</section>
</section>

<section anchor="verified-person-data-in-id-tokens" title="Verified Person Data in ID Tokens">

<section anchor="request-1" title="Request">
<t>In this case, the RP requests verfied person data along with other user claims in the claims parameter and allocates the response to the ID Token (delivered from the token endpoint in case of grant type <spanx style="verb">code</spanx>).</t>
<t>The <spanx style="verb">claims</spanx> parameter value is</t>

<figure><artwork type="json">{  
   &quot;id_token&quot;:{  
      &quot;email&quot;:null,
      &quot;preferred_username&quot;:null,
      &quot;picture&quot;:null,
      &quot;verified_person_data&quot;:{  
         &quot;claims&quot;:{  
            &quot;given_name&quot;:null,
            &quot;family_name&quot;:null,
            &quot;birthdate&quot;:null
         }
      }
   }
}
</artwork></figure>

</section>

<section anchor="id-token" title="ID Token">
<t>The respective ID Token could be</t>

<figure><artwork type="json">{  
   &quot;iss&quot;:&quot;https://server.example.com&quot;,
   &quot;sub&quot;:&quot;24400320&quot;,
   &quot;aud&quot;:&quot;s6BhdRkqt3&quot;,
   &quot;nonce&quot;:&quot;n-0S6_WzA2Mj&quot;,
   &quot;exp&quot;:1311281970,
   &quot;iat&quot;:1311280970,
   &quot;auth_time&quot;:1311280969,
   &quot;acr&quot;:&quot;urn:mace:incommon:iap:silver&quot;,
   &quot;email&quot;:&quot;janedoe@example.com&quot;,
   &quot;preferred_username&quot;:&quot;j.doe&quot;,
   &quot;picture&quot;:&quot;http://example.com/janedoe/me.jpg&quot;,
   &quot;verified_person_data&quot;:{  
      &quot;verification&quot;:{  
         &quot;trust_framework&quot;:&quot;de_aml&quot;,
         &quot;date&quot;:&quot;2013-02-21&quot;,
         &quot;id&quot;:&quot;676q3636461467647q8498785747q487&quot;,
         &quot;evidences&quot;:[  
            {  
               &quot;type&quot;:&quot;id_document&quot;,
               &quot;method&quot;:&quot;pipp&quot;,
               &quot;document&quot;:{  
                  &quot;type&quot;:&quot;idcard&quot;,
                  &quot;issuer&quot;:{  
                     &quot;name&quot;:&quot;Stadt Augsburg&quot;,
                     &quot;country&quot;:&quot;DE&quot;
                  },
                  &quot;number&quot;:&quot;53554554&quot;,
                  &quot;date_of_issuance&quot;:&quot;2012-04-23&quot;,
                  &quot;date_of_expiry&quot;:&quot;2022-04-22&quot;
               }
            }
         ]
      },
      &quot;claims&quot;:{  
         &quot;given_name&quot;:&quot;Max&quot;,
         &quot;family_name&quot;:&quot;Meier&quot;,
         &quot;birthdate&quot;:&quot;1956-01-28&quot;
      }
   }
}
</artwork></figure>

</section>
</section>

<section anchor="aggregated-claims" title="Aggregated Claims">
<t>Note: line breaks for display purposes only</t>

<figure><artwork type="http">HTTP/1.1 200 OK
Content-Type: application/json

{ 
   &quot;iss&quot;:&quot;https://server.example.com&quot;, 
   &quot;sub&quot;:&quot;248289761001&quot;,
   &quot;email&quot;:&quot;janedoe@example.com&quot;,
   &quot;email_verified&quot;:true,
   &quot;_claim_names&quot;:{  
      &quot;verified_person_data&quot;:&quot;src1&quot;
   },
   &quot;_claim_sources&quot;:{  
      &quot;src1&quot;:{  
      &quot;JWT&quot;:&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL3NlcnZlci5vd
GhlcmlkcC5jb20iLCJ2ZXJpZmllZF9wZXJzb25fZGF0YSI6eyJ2ZXJpZmljYXRpb24iOnsidHJ1c3RfZnJh
bWV3b3JrIjoiZWlkYXNfaWFsX3N1YnN0YW50aWFsIn0sImNsYWltcyI6eyJnaXZlbl9uYW1lIjoiTWF4Iiw
iZmFtaWx5X25hbWUiOiJNZWllciIsImJpcnRoZGF0ZSI6IjE5NTYtMDEtMjgifX19.aRrgmBWQTJPqMgmkg
WGyqNu1QlDjtQ8YuXoHjUzJbq4&quot;
      }
   }
}
</artwork></figure>

</section>

<section anchor="distributed-claims" title="Distributed Claims">

<figure><artwork type="http">HTTP/1.1 200 OK
Content-Type: application/json

{
   &quot;iss&quot;:&quot;https://server.example.com&quot;,  
   &quot;sub&quot;:&quot;248289761001&quot;,
   &quot;email&quot;:&quot;janedoe@example.com&quot;,
   &quot;email_verified&quot;:true,
   &quot;_claim_names&quot;:{  
      &quot;verified_person_data&quot;:&quot;src1&quot;
   },
   &quot;_claim_sources&quot;:{  
      &quot;src1&quot;:{  
         &quot;endpoint&quot;:&quot;https://server.yetanotheridp.com/claim_source&quot;,
         &quot;access_token&quot;:&quot;ksj3n283dkeafb76cdef&quot;
      }
   }
}
</artwork></figure>

</section>
</section>

<section anchor="opmetadata" title="OP Metadata">
<t>The OP advertises its capabilities with respect to verified person data in its openid-configuration (see <xref target="OpenID-Discovery"></xref>) using the following new elements:</t>
<t><spanx style="verb">verified_person_data_supported</spanx>: Boolean value indicating support for the <spanx style="verb">verified_person_data</spanx>, i.e. the OpenID Connect for Identity Assurance extension.</t>
<t><spanx style="verb">trust_frameworks_supported</spanx> This is a JSON array containing all supported trust frameworks.</t>
<t><spanx style="verb">evidences_supported</spanx> This JSON array contains all types of identity evidences the OP uses.</t>
<t><spanx style="verb">id_documents_supported</spanx> This JSON array contains all identity documents utilized by the OP for identity verification.</t>
<t><spanx style="verb">id_documents_verification_methods_supported</spanx> This element is a JSON array containing the id document verification methods a OP supports as defined in Section <eref target="#verification">verification</eref>.</t>
<t><spanx style="verb">verified_person_data_supported</spanx> This JSON array contains all claims supported within <spanx style="verb">verified_person_data</spanx>.</t>
<t>This is an example openid-configuration snippet:</t>

<figure><artwork type="json">{  
...
   &quot;verified_person_data_supported&quot;:true,
   &quot;trust_frameworks_supported&quot;:[
     &quot;nist_800_63A_ial_2&quot;,
     &quot;nist_800_63A_ial_3&quot;
   ],
   &quot;evidences_supported&quot;:[
      &quot;id_document&quot;,
      &quot;utility_bill&quot;,
      &quot;qes&quot;
   ]
   &quot;id_documents_supported&quot;:[  
       &quot;idcard&quot;,
       &quot;passport&quot;,
       &quot;driving_permit&quot;
   ]
   &quot;id_documents_verification_methods_supported&quot;:[  
       &quot;pipp&quot;,
       &quot;sripp&quot;,
       &quot;eid&quot;
   ]
   &quot;verified_person_data_supported&quot;:[  
      &quot;given_name&quot;,
      &quot;family_name&quot;,
      &quot;birthdate&quot;,
      &quot;place_of_birth&quot;,
      &quot;nationality&quot;,
      &quot;address&quot;
   ],
...
}
</artwork></figure>

<t>The OP MUST support the <spanx style="verb">claims</spanx> parameter and needs to publish this in its openid-configuration using the <spanx style="verb">claims_parameter_supported</spanx> element.</t>
</section>

<section anchor="purpose" title="Transaction-specific Purpose">
<t>This specification introduces the request parameter <spanx style="verb">purpose</spanx> to allow a RP
to state the purpose for the transfer of user data it is asking for.</t>
<t><spanx style="verb">purpose</spanx> OPTIONAL. String describing the purpose for obtaining certain user data from the OP. The purpose MUST NOT be shorter than 3 characters and MUST NOT be longer than 300 characters. If these rules are violated, the authentication request MUST fail and the OP returns an error <spanx style="verb">invalid_request</spanx> to the RP.</t>
<t>The OP MUST display this purpose in the respective user consent screen(s) in order to inform the user about the designated use of the data to be transferred or the authorization to be approved.</t>
<t>If the parameter <spanx style="verb">purpose</spanx> is not present in the request, the OP MAY utilize a description that was pre-configured for the respective RP.</t>
<t>Note: In order to prevent injection attacks, the IDP MUST escape the text appropriately before it will be shown in a user interface. The IDP MUST expect special characters in the URL decoded purpose text provided by the RP. The IDP MUST ensure that any special characters in the purpose text cannot be used to inject code into the web interface of the OP (e.g. cross-site scripting, defacing). Proper escaping MUST be applied by the OP. The OP SHALL NOT remove characters from the purpose text to this end.</t>
</section>

<section anchor="Acknowledgements" title="Acknowledgements">
<t>The following people at yes.com and partner companies contributed to the concept described in the initial contribution to this specification: Karsten Buch, Lukas Stiebig, Sven Manz, Waldemar Zimpfer, Willi Wiedergold, Fabian Hoffmann, Daniel Keijsers, Ralf Wagner, Sebastian Ebling, Peter Eisenhofer.</t>
<t>I would like to thank Sebastian Ebling, Marcos Sanz, Tom Jones, Mike Pegman, and Jeff Lombardo for their valuable feedback that helped to evolve this specification.</t>
</section>

<section anchor="Privacy" title="Privacy Consideration">
<t>OP and RP MUST establish a legal basis before exchanging any personally identifiable information.</t>
</section>

<section anchor="Security" title="Security Considerations">
<t>TBD</t>
</section>

<section anchor="predefined_values" title="Predefined Values">

<section anchor="predefined_values_tf" title="Trust Frameworks">
<t>This section defines trust framework identifiers for use with this specification.</t>
<t>
<list style="symbols">
<t>Identifier: <spanx style="verb">de_aml</spanx></t>
<t>Definition: The OP verifies and maintains user identities in conforms with the German Anti-Money Laundering Law.</t>
<t>Identifier: <spanx style="verb">eidas_ial_substantial</spanx></t>
<t>Definition: The OP is able to attest user identities in accordance with the EU regulation No 910/2014 (eIDAS) at the identitfication assurance level &quot;Substantial&quot;.</t>
<t>Identifier: <spanx style="verb">eidas_ial_high</spanx></t>
<t>Definition: The OP is able to attest user identities in accordance with the EU regulation No 910/2014 (eIDAS) at the identitfication assurance level &quot;High&quot;.</t>
<t>Identifier: <spanx style="verb">nist_800_63A_ial_2</spanx></t>
<t>Definition: The OP is able to attest user identities in accordance with the NIST Special Publication 800-63A at the Identity Assurance Level 2.</t>
<t>Identifier: <spanx style="verb">nist_800_63A_ial_3</spanx></t>
<t>Definition: The OP is able to attest user identities in accordance with the NIST Special Publication 800-63A at the Identity Assurance Level 3.</t>
</list>
</t>
</section>

<section anchor="predefined_values_idd" title="Identity Documents">
<t>This section defines identity document identifiers for use with this specification.</t>
<t>
<list style="symbols">
<t>Identifier: <spanx style="verb">idcard</spanx></t>
<t>Definition: An identity document issued by a country's government for the purpose of identifying a citizen.</t>
<t>Identifier: <spanx style="verb">passport</spanx></t>
<t>Definition: A passport is a travel document, usually issued by a country's government, that certifies the identity and nationality of its holder primarily for the purpose of international travel.<xref target="OxfordPassport"></xref></t>
<t>Identifier: <spanx style="verb">driving_permit</spanx></t>
<t>Definition: Offical document permitting an individual to operate motorized vehicles. In the absence of a formal identity document, a driver's license may be accepted in many countries for identity verification.</t>
<t>Identifier: <spanx style="verb">de_idcard_foreigners</spanx></t>
<t>Definition: ID Card issued by the German government to foreign nationals.</t>
<t>Identifier: <spanx style="verb">de_emergency_idcard</spanx></t>
<t>Definition: ID Card issued by the German government to foreign nationals as passports replacement</t>
<t>Identifier: <spanx style="verb">de_erp</spanx></t>
<t>Definition: Electronic Resident Permit issued by the German government to foreign nationals</t>
<t>Identifier: <spanx style="verb">de_erp_replacement_idcard</spanx></t>
<t>Definition: Electronic Resident Permit issued by the German government to foreign nationals as replacement for another identity document</t>
<t>Identifier: <spanx style="verb">de_idcard_refugees</spanx></t>
<t>Definition: ID Card issued by the German government to refugees as passports replacement</t>
<t>Identifier: <spanx style="verb">de_idcard_apatrids</spanx></t>
<t>Defintion: ID Card issued by the German government to apatrids as passports replacement</t>
<t>Identifier: <spanx style="verb">de_certificate_of_suspension_of_deportation</spanx></t>
<t>Definition: identity document issued to refugees in case of suspension of deportation that are marked as &quot;id card replacement&quot;</t>
<t>Identifier: <spanx style="verb">de_permission_to_reside</spanx></t>
<t>Definition: permission to reside issued by the German governed to foreign nationals appliying for asylum</t>
<t>Identifier: <spanx style="verb">de_replacement_idcard</spanx></t>
<t>Defintion: ID Card replacement document issued by the German government to foreign nationals (see Act on the Residence, Economic Activity and Integration of Foreigners in the Federal Territory, Residence Act, Appendix D1 ID Card replacement according to § 48 Abs. 2 i.V.m. § 78a Abs. 4)</t>
</list>
</t>
</section>

<section anchor="predefined_values_vm" title="Verification Methods">
<t>This section defines identity document identifiers for use with this specification.</t>
<t>
<list style="symbols">
<t>Identifier: <spanx style="verb">pipp</spanx></t>
<t>Definition: Physical In-Person Proofing</t>
<t>Identifier: <spanx style="verb">sripp</spanx></t>
<t>Definition: Supervised remote In-Person Proofing</t>
<t>Identifier: <spanx style="verb">eid</spanx></t>
<t>Definition: Online ID card verification function</t>
</list>
</t>
</section>
</section>

<section anchor="json_schema" title="JSON Schema">
<t>This section contains the JSON Schema of assertions containing the <spanx style="verb">verified_person_data</spanx> claim.</t>

<figure><artwork type="JSON">{  
   &quot;definitions&quot;:{  
      &quot;qes&quot;:{  
         &quot;type&quot;:&quot;object&quot;,
         &quot;properties&quot;:{  
            &quot;type&quot;:{  
               &quot;type&quot;:&quot;string&quot;,
               &quot;enum&quot;:[  
                  &quot;qes&quot;
               ]
            },
            &quot;issuer&quot;:{  
               &quot;type&quot;:&quot;string&quot;
            },
            &quot;issued_at&quot;:{  
               &quot;type&quot;:&quot;string&quot;,
               &quot;format&quot;:&quot;date&quot;
            },
            &quot;serial_number&quot;:{  
               &quot;type&quot;:&quot;string&quot;
            }
         },
         &quot;required&quot;:[  
            &quot;type&quot;,
            &quot;issuer&quot;,
            &quot;serial_number&quot;,
            &quot;issued_at&quot;
         ]
      },
      &quot;utility_bill&quot;:{  
         &quot;type&quot;:&quot;object&quot;,
         &quot;properties&quot;:{  
            &quot;type&quot;:{  
               &quot;type&quot;:&quot;string&quot;,
               &quot;enum&quot;:[  
                  &quot;utility_bill&quot;
               ]
            },
            &quot;provider&quot;:{  
               &quot;type&quot;:&quot;object&quot;,
               &quot;properties&quot;:{  
                  &quot;name&quot;:{  
                     &quot;type&quot;:&quot;string&quot;
                  },
                  &quot;country&quot;:{  
                     &quot;type&quot;:&quot;string&quot;
                  },
                  &quot;region&quot;:{  
                     &quot;type&quot;:&quot;string&quot;
                  },
                  &quot;street_address&quot;:{  
                     &quot;type&quot;:&quot;string&quot;
                  }
               }
            },
            &quot;date&quot;:{  
               &quot;type&quot;:&quot;string&quot;
            }
         },
         &quot;required&quot;:[  
            &quot;type&quot;,
            &quot;provider&quot;,
            &quot;date&quot;
         ]
      },
      &quot;id_document&quot;:{  
         &quot;type&quot;:&quot;object&quot;,
         &quot;properties&quot;:{  
            &quot;type&quot;:{  
               &quot;type&quot;:&quot;string&quot;,
               &quot;enum&quot;:[  
                  &quot;id_document&quot;
               ]
            },
            &quot;method&quot;:{  
               &quot;type&quot;:&quot;string&quot;,
               &quot;enum&quot;:[  
                  &quot;pipp&quot;,
                  &quot;sripp&quot;,
                  &quot;eid&quot;
               ]
            },
            &quot;verifier&quot;:{  
               &quot;type&quot;:&quot;object&quot;,
               &quot;properties&quot;:{  
                  &quot;organization&quot;:{  
                     &quot;type&quot;:&quot;string&quot;
                  },
                  &quot;agent&quot;:{  
                     &quot;type&quot;:&quot;string&quot;
                  }
               }
            },
            &quot;document&quot;:{  
               &quot;type&quot;:&quot;object&quot;,
               &quot;properties&quot;:{  
                  &quot;type&quot;:{  
                     &quot;type&quot;:&quot;string&quot;,
                     &quot;enum&quot;:[  
                        &quot;idcard&quot;,
                        &quot;passport&quot;,
                        &quot;driving_permit&quot;,
                        &quot;de_idcard_foreigners&quot;,
                        &quot;de_emergency_idcard&quot;,
                        &quot;de_erp&quot;,
                        &quot;de_erp_replacement_idcard&quot;,
                        &quot;de_idcard_refugees&quot;,
                        &quot;de_idcard_apatrids&quot;,
                        &quot;de_certificate_of_suspension_of_deportation&quot;,
                        &quot;de_permission_to_reside&quot;,
                        &quot;de_replacement_idcard&quot;
                     ]
                  },
                  &quot;number&quot;:{  
                     &quot;type&quot;:&quot;string&quot;
                  },
                  &quot;issuer&quot;:{  
                     &quot;type&quot;:&quot;object&quot;,
                     &quot;properties&quot;:{  
                        &quot;name&quot;:{  
                           &quot;type&quot;:&quot;string&quot;
                        },
                        &quot;country&quot;:{  
                           &quot;type&quot;:&quot;string&quot;
                        }
                     }
                  },
                  &quot;date_of_issuance&quot;:{  
                     &quot;type&quot;:&quot;string&quot;,
                     &quot;format&quot;:&quot;date&quot;
                  },
                  &quot;date_of_expiry&quot;:{  
                     &quot;type&quot;:&quot;string&quot;,
                     &quot;format&quot;:&quot;date&quot;
                  }
               }
            }
         },
         &quot;required&quot;:[  
            &quot;type&quot;,
            &quot;method&quot;,
            &quot;id_document&quot;
         ]
      }
   },
   &quot;type&quot;:&quot;object&quot;,
   &quot;properties&quot;:{  
      &quot;verified_person_data&quot;:{  
         &quot;type&quot;:&quot;object&quot;,
         &quot;properties&quot;:{  
            &quot;verification&quot;:{  
               &quot;type&quot;:&quot;object&quot;,
               &quot;properties&quot;:{  
                  &quot;trust_framework&quot;:{  
                     &quot;type&quot;:&quot;string&quot;,
                     &quot;enum&quot;:[  
                        &quot;de_aml&quot;,
                        &quot;eidas_ial_substantial&quot;,
                        &quot;eidas_ial_hig&quot;,
                        &quot;nist_800_63A_ial_2&quot;,
                        &quot;nist_800_63A_ial_3&quot;
                     ]
                  },
                  &quot;date&quot;:{  
                     &quot;type&quot;:&quot;string&quot;,
                     &quot;format&quot;:&quot;date&quot;
                  },
                  &quot;id&quot;:{  
                     &quot;type&quot;:&quot;string&quot;
                  },
                  &quot;evidences&quot;:{  
                     &quot;type&quot;:&quot;array&quot;,
                     &quot;minItems&quot;:1,
                     &quot;items&quot;:{  
                        &quot;oneOf&quot;:[  
                           {  
                              &quot;$ref&quot;:&quot;#/definitions/id_document&quot;
                           },
                           {  
                              &quot;$ref&quot;:&quot;#/definitions/utility_bill&quot;
                           },
                           {  
                              &quot;$ref&quot;:&quot;#/definitions/qes&quot;
                           }
                        ]
                     }
                  }
               },
               &quot;required&quot;:[  
                  &quot;trust_framework&quot;
               ],
               &quot;additionalProperties&quot;:false
            },
            &quot;claims&quot;:{  
               &quot;type&quot;:&quot;object&quot;,
               &quot;minProperties&quot;:1
            }
         },
         &quot;required&quot;:[  
            &quot;verification&quot;,
            &quot;claims&quot;
         ],
         &quot;additionalProperties&quot;:false
      }
   },
   &quot;required&quot;:[  
      &quot;verified_person_data&quot;
   ]
}
</artwork></figure>

</section>

</middle>

<back>
<references title="Normative References">
<reference anchor="OpenID-Discovery" target="https://openid.net/specs/openid-connect-discovery-1_0.html">
  <front>
    <title>OpenID Connect Discovery 1.0 incorporating errata set 1</title>
    <author fullname="Nat Sakimura" initials="N." surname="Sakimura">
      <organization>NRI</organization>
    </author>
    <author fullname="John Bradley" initials="J." surname="Bradley">
      <organization>Ping Identity</organization>
    </author>
    <author fullname="Breno de Medeiros" initials="B." surname="de Medeiros">
      <organization>Google</organization>
    </author>
    <author fullname="Edmund Jay" initials="E." surname="Jay">
      <organization> Illumila </organization>
    </author>
    <date year="2014" month="Nov" day="8"></date>
  </front>
</reference>
<reference anchor="OpenID" target="http://openid.net/specs/openid-connect-core-1_0.html">
  <front>
    <title>OpenID Connect Core 1.0 incorporating errata set 1</title>
    <author fullname="Nat Sakimura" initials="N." surname="Sakimura">
      <organization>NRI</organization>
    </author>
    <author fullname="John Bradley" initials="J." surname="Bradley">
      <organization>Ping Identity</organization>
    </author>
    <author fullname="Mike Jones" initials="M." surname="Jones">
      <organization>Microsoft</organization>
    </author>
    <author fullname="Breno de Medeiros" initials="B." surname="de Medeiros">
      <organization>Google</organization>
    </author>
    <author fullname="Chuck Mortimore" initials="C." surname="Mortimore">
      <organization>Salesforce</organization>
    </author>
    <date year="2014" month="Nov" day="8"></date>
  </front>
</reference>
</references>
<references title="Informative References">
<reference anchor="eIDAS" target="https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=CELEX:32014R0910">
  <front>
    <title>REGULATION (EU) No 910/2014 OF THE EUROPEAN PARLIAMENT AND OF THE COUNCIL on electronic identification and trust services for electronic transactions in the internal market and repealing Directive 1999/93/EC</title>
    <author surname="European Parliament">
      <organization>European Parliament</organization>
    </author>
    <date year="2014" month="July" day="23"></date>
  </front>
</reference>
<reference anchor="NIST-SP-800-63a" target="https://doi.org/10.6028/NIST.SP.800-63a">
  <front>
    <title>NIST Special Publication 800-63A, Digital Identity Guidelines, Enrollment and Identity Proofing Requirements</title>
    <author fullname="Paul A. Grassi">
      <organization>NIST</organization>
    </author>
    <author fullname="James L. Fentony" initials="James L." surname="Fentony">
      <organization>Altmode Networks</organization>
    </author>
    <author fullname="Naomi B. Lefkovitz" initials="Naomi B." surname="Lefkovitz">
      <organization>NIST</organization>
    </author>
    <author fullname="Jamie M. Danker" initials="Jamie M." surname="Danker">
      <organization>Department of Homeland Security</organization>
    </author>
    <author fullname="Yee-Yin Choong" initials="Yee-Yin" surname="Choong">
      <organization>NIST</organization>
    </author>
    <author fullname="Kristen K. Greene" initials="Kristen K." surname="Greene">
      <organization>NIST</organization>
    </author>
    <author fullname="Mary F. Theofanos" initials="Mary F." surname="Theofanos">
      <organization>NIST</organization>
    </author>
    <date year="2017" month="June"></date>
  </front>
</reference>
<?rfc include="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7662.xml"?>
<?rfc include="https://xml2rfc.ietf.org/public/rfc/bibxml-ids/reference.I-D.ietf-oauth-jwt-introspection-response.xml"?>
<reference anchor="OxfordPassport" target="http://www.oxfordreference.com/view/10.1093/acref/9780199290543.001.0001/acref-9780199290543-e-1616">
  <front>
    <title>The New Oxford Companion to Law. ISBN 9780199290543.</title>
    <author fullname="P. Cane" initials="P" surname="Cane"></author>
    <author fullname="J. Conaghan" initials="Mary F." surname="Conaghan"></author>
    <date year="2008"></date>
  </front>
</reference>
</references>

<section anchor="document-history" title="Document History">
<t>[[ To be removed from the final specification ]]</t>
<t>-04</t>
<t>
<list style="symbols">
<t>incorporated review feedback by Marcos Sanz</t>
</list>
</t>
<t>-03</t>
<t>
<list style="symbols">
<t>enhanced draft to support multiple evidences</t>
<t>added a JSON Schema for assertions containing the <spanx style="verb">verified_person_data</spanx> Claim</t>
<t>added more identity document definitions</t>
<t>added <spanx style="verb">region</spanx> field to <spanx style="verb">place_of_birth</spanx> Claim</t>
<t>changed <spanx style="verb">eidas_loa_substantial/high</spanx> to <spanx style="verb">eidas_ial_substantial/high</spanx></t>
<t>fixed typos in examples</t>
<t>uppercased all editorial occurences of the term <spanx style="verb">claims</spanx> to align with OpenID Connect Core</t>
</list>
</t>
<t>-02</t>
<t>
<list style="symbols">
<t>added new request parameter <spanx style="verb">purpose</spanx></t>
<t>simplified/reduced number of verification methods</t>
<t>simplfied identifiers</t>
<t>added <spanx style="verb">identity_documents_supported</spanx> to metadata section</t>
<t>improved examples</t>
</list>
</t>
<t>-01</t>
<t>
<list style="symbols">
<t>fixed some typos</t>
<t>remove organization element (redundant) (issue 1080)</t>
<t>allow other user claims in the <spanx style="verb">claims</spanx> sub element (issue 1079)</t>
<t>changed <spanx style="verb">legal_context</spanx> to <spanx style="verb">trust_framework</spanx></t>
<t>added explanation how the content of the verification element is determined by the trust framework</t>
<t>added URI-based identifiers for <spanx style="verb">trust_framework</spanx>, <spanx style="verb">identity_document</spanx> and (verification) <spanx style="verb">method</spanx></t>
<t>added example attestation for notified/regulated eID system</t>
<t>adopted OP metadata section accordingly</t>
<t>changed error behavior for <spanx style="verb">max_age</spanx> member to alig with OpenID Core</t>
<t>Added feature to let the RP express requirements for verification data (trust framework, identity documents, verification method)</t>
<t>Added privacy consideration section and added text on legal basis for data exchange</t>
<t>Added explanation about regulated and un-regulated eID systems</t>
</list>
</t>
<t>-00 (WG document)</t>
<t>
<list style="symbols">
<t>turned the proposal into a WG document</t>
<t>changed name</t>
<t>added terminology section and reworked introduction</t>
<t>added several examples (ID Token vs User Info, unverified &amp; verified claims, aggregated &amp; distributed claims)</t>
<t>incorporated text proposal of Marcos Sanz regarding max_age</t>
<t>added IANA registration for new error code <spanx style="verb">unable_to_meet_requirement</spanx></t>
</list>
</t>
</section>

</back>

</rfc>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Health Relationship Trust Profile for Fast Healthcare Interoperability Resources (FHIR) OAuth 2.0 Scopes</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Requirements Notation and Conventions">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Terminology">
<link href="#rfc.section.2" rel="Chapter" title="2 Resource Access Scopes">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Permission type">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Resource type">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 Access type">
<link href="#rfc.section.3" rel="Chapter" title="3 Confidentiality and Sensitivity">
<link href="#rfc.section.4" rel="Chapter" title="4 Break the glass">
<link href="#rfc.section.5" rel="Chapter" title="5 Resource selection">
<link href="#rfc.section.6" rel="Chapter" title="6 IANA Considerations">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 HEART Permission Type Registry">
<link href="#rfc.section.6.1.1" rel="Chapter" title="6.1.1 Registration Template">
<link href="#rfc.section.6.1.2" rel="Chapter" title="6.1.2 Initial Registry Contents">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 HEART Access Type Registry">
<link href="#rfc.section.6.2.1" rel="Chapter" title="6.2.1 Registration Template">
<link href="#rfc.section.6.2.2" rel="Chapter" title="6.2.2 Initial Registry Contents">
<link href="#rfc.section.6.3" rel="Chapter" title="6.3 Additions to the OAuth Parameters Registry">
<link href="#rfc.section.7" rel="Chapter" title="7 Security Considerations">
<link href="#rfc.section.8" rel="Chapter" title="8 Privacy Considerations">
<link href="#rfc.references" rel="Chapter" title="9 Normative References">
<link href="#rfc.appendix.A" rel="Chapter" title="A Acknowledgements">
<link href="#rfc.appendix.B" rel="Chapter" title="B Fully computed scope values">
<link href="#rfc.appendix.C" rel="Chapter" title="C Purpose of Use">
<link href="#rfc.appendix.D" rel="Chapter" title="D Notices">
<link href="#rfc.appendix.E" rel="Chapter" title="E Document History">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.16.3 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Richer, J., Ed. and J. Mandel" />
  <meta name="dct.identifier" content="urn:ietf:id:openid-heart-fhir-oauth2" />
  <meta name="dct.issued" scheme="ISO8601" content="2018-07-08" />
  <meta name="dct.abstract" content="FHIR is an HTTP-based, resource-oriented RESTful API based on a set of clinical, administrative, financial, and infrastructure resource definitions. The API supports create, read, update, delete, and search operations, as well as a framework for ad-hoc operations.The OAuth 2.0 protocol framework defines a mechanism to allow a resource owner to delegate access to a protected resource for a client application, optionally limited by a set of scopes.This specification profiles the OAuth 2.0 protocol scopes to be used with the FHIR protocol to increase baseline security, provide greater interoperability, and structure deployments in a manner specifically applicable to (but not limited to) the healthcare domain." />
  <meta name="description" content="FHIR is an HTTP-based, resource-oriented RESTful API based on a set of clinical, administrative, financial, and infrastructure resource definitions. The API supports create, read, update, delete, and search operations, as well as a framework for ad-hoc operations.The OAuth 2.0 protocol framework defines a mechanism to allow a resource owner to delegate access to a protected resource for a client application, optionally limited by a set of scopes.This specification profiles the OAuth 2.0 protocol scopes to be used with the FHIR protocol to increase baseline security, provide greater interoperability, and structure deployments in a manner specifically applicable to (but not limited to) the healthcare domain." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left"></td>
<td class="right">J. Richer, Ed.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right"></td>
</tr>
<tr>
<td class="left"></td>
<td class="right">J. Mandel</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Harvard Medical School Department of Biomedical Informatics</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">July 8, 2018</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Health Relationship Trust Profile for Fast Healthcare Interoperability Resources (FHIR) OAuth 2.0 Scopes<br />
  <span class="filename">openid-heart-fhir-oauth2</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>FHIR is an HTTP-based, resource-oriented RESTful API based on a set of clinical, administrative, financial, and infrastructure resource definitions. The API supports create, read, update, delete, and search operations, as well as a framework for ad-hoc operations.</p>
<p>The OAuth 2.0 protocol framework defines a mechanism to allow a resource owner to delegate access to a protected resource for a client application, optionally limited by a set of scopes.</p>
<p>This specification profiles the OAuth 2.0 protocol scopes to be used with the FHIR protocol to increase baseline security, provide greater interoperability, and structure deployments in a manner specifically applicable to (but not limited to) the healthcare domain.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Requirements Notation and Conventions</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Terminology</a>
</li>
</ul><li>2.   <a href="#rfc.section.2">Resource Access Scopes</a>
</li>
<ul><li>2.1.   <a href="#rfc.section.2.1">Permission type</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Resource type</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">Access type</a>
</li>
</ul><li>3.   <a href="#rfc.section.3">Confidentiality and Sensitivity</a>
</li>
<li>4.   <a href="#rfc.section.4">Break the glass</a>
</li>
<li>5.   <a href="#rfc.section.5">Resource selection</a>
</li>
<li>6.   <a href="#rfc.section.6">IANA Considerations</a>
</li>
<ul><li>6.1.   <a href="#rfc.section.6.1">HEART Permission Type Registry</a>
</li>
<ul><li>6.1.1.   <a href="#rfc.section.6.1.1">Registration Template</a>
</li>
<li>6.1.2.   <a href="#rfc.section.6.1.2">Initial Registry Contents</a>
</li>
</ul><li>6.2.   <a href="#rfc.section.6.2">HEART Access Type Registry</a>
</li>
<ul><li>6.2.1.   <a href="#rfc.section.6.2.1">Registration Template</a>
</li>
<li>6.2.2.   <a href="#rfc.section.6.2.2">Initial Registry Contents</a>
</li>
</ul><li>6.3.   <a href="#rfc.section.6.3">Additions to the OAuth Parameters Registry</a>
</li>
</ul><li>7.   <a href="#rfc.section.7">Security Considerations</a>
</li>
<li>8.   <a href="#rfc.section.8">Privacy Considerations</a>
</li>
<li>9.   <a href="#rfc.references">Normative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.A">Acknowledgements</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.B">Fully computed scope values</a>
</li>
<li>Appendix C.   <a href="#rfc.appendix.C">Purpose of Use</a>
</li>
<li>Appendix D.   <a href="#rfc.appendix.D">Notices</a>
</li>
<li>Appendix E.   <a href="#rfc.appendix.E">Document History</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#Introduction" id="Introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">This document profiles the OAuth 2.0 web authorization framework for use in the context of securing Representational State Transfer (RESTful) interfaces using the Fast Health Interoperable Resources (FHIR) protocol. The FHIR OAuth 2.0 profile defined in this document serve to define a baseline set of FHIR OAuth scopes suitable for a wide range of use cases, while maintaining reasonable ease of implementation and functionality.</p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#rnc" id="rnc">Requirements Notation and Conventions</a>
</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119" class="xref">RFC 2119</a>.</p>
<p id="rfc.section.1.1.p.2">All uses of <a href="#RFC7517" class="xref">JSON Web Signature (JWS)</a> and <a href="#RFC7518" class="xref">JSON Web Encryption (JWE)</a> data structures in this specification utilize the JWS Compact Serialization or the JWE Compact Serialization; the JWS JSON Serialization and the JWE JSON Serialization are not used.</p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> <a href="#Terminology" id="Terminology">Terminology</a>
</h1>
<p id="rfc.section.1.2.p.1">This specification uses the terms "Access Token", "Authorization Code", "Authorization Endpoint", "Authorization Grant", "Authorization Server", "Client", "Client Authentication", "Client Identifier", "Client Secret", "Grant Type", "Protected Resource", "Redirection URI", "Refresh Token", "Resource Owner", "Resource Server", "Response Type", and "Token Endpoint" defined by <a href="#RFC6749" class="xref">OAuth 2.0</a>, the terms "Claim Name", "Claim Value", and "JSON Web Token (JWT)" defined by <a href="#RFC7519" class="xref">JSON Web Token (JWT)</a>, and the terms defined by <a href="#OpenID.Core" class="xref">OpenID Connect Core 1.0</a>.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#Scopes" id="Scopes">Resource Access Scopes</a>
</h1>
<p id="rfc.section.2.p.1">In this specification, scope values are a composite string describing the type of permission, the type of resource, and the type of access to that resource being requested. These scopes are plain strings made by combining the permission type, followed by a single forward slash "/" character, followed by the resource type, followed by a single period character ".", followed by the access type. The asterisk character "*" is reserved as a special value to stand in for any valid value within a category.</p>
<p id="rfc.section.2.p.2">The entire scope definition is:</p>
<p><samp>scope := permission/resource.access</samp></p>
<p><samp>permission, resource, access := any string (without space, period, slash, or asterisk) | asterisk</samp></p>
<p id="rfc.section.2.p.5">Strings within each category MUST NOT include the space " ", period ".", forward slash "/", or asterisk "*" character.</p>
<p id="rfc.section.2.p.6">Implementation of these scope strings is a matter of choice for the OAuth system. The authorization server and protected resource MAY decide to pre-compute all viable combinations within the system as simple strings as shown in <a href="#ComputedScopeValues" class="xref">Appendix B</a>, or they MAY decide to parse the values within the strings at run time.</p>
<p id="rfc.section.2.p.7">Protected resources MUST define and document which scopes are required for access to the resource, listing all appropriate scope component combinations including wildcards.</p>
<p id="rfc.section.2.p.8">Authorization servers SHOULD define and document default scope values that will be used if an authorization request does not specify a requested set of scopes.</p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> <a href="#Permission" id="Permission">Permission type</a>
</h1>
<p id="rfc.section.2.1.p.1">The permission type component of a scope definition indicates whether the access being requested is for a single patient record or a bulk set of patient records. This specification defines two possible values.</p>
<p></p>

<dl>
<dt>patient</dt>
<dd style="margin-left: 8">The scope is for a single patient's record, either for the current user or someone else that they have been given access to.</dd>
<dt>user</dt>
<dd style="margin-left: 8">The scope is for a bulk set of records or for aggregate data not representing a single patient, based on what is available to the current user.</dd>
</dl>
<p id="rfc.section.2.1.p.3">Extensions to this specification MAY define additional permission types using the registry defined in <a href="#iana" class="xref">Section 6</a>.</p>
<p id="rfc.section.2.1.p.4">The patient permission type SHOULD be used only with user-delegated access client types as defined in <a href="#HEART.OAuth2" class="xref">[HEART.OAuth2]</a>. The user permission type SHOULD be used only with bulk-access client types as defined in <a href="#HEART.OAuth2" class="xref">[HEART.OAuth2]</a>. This specification does not define a wildcard (asterisk, "*") general permission type definition.</p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> <a href="#Resource" id="Resource">Resource type</a>
</h1>
<p id="rfc.section.2.2.p.1">The resource type indicates the kind of FHIR resource and consequently the kind of information available at it. Any FHIR resource MAY be used, and in particular this specification defines scopes for resources based on FHIR resource type designation for the Patient compartment as found on <samp>http://www.hl7.org/fhir/compartmentdefinition-patient.html</samp>.</p>
<p id="rfc.section.2.2.p.2">This document specifically lists the following common resources from FHIR version STU3. Full normative definitions for each type can be found at <samp>http://www.hl7.org/fhir/stu3/compartmentdefinition-patient.html</samp>.</p>
<p></p>

<dl>
<dt>Patient</dt>
<dd style="margin-left: 8">Demographic information about the patient, http://www.hl7.org/fhir/stu3/patient.html</dd>
<dt>MedicationRequest</dt>
<dd style="margin-left: 8">Information about requests for medications for patients, http://www.hl7.org/fhir/stu3/medicationrequest.html</dd>
<dt>MedicationDispense</dt>
<dd style="margin-left: 8">Information about supply of medications to a patient, http://www.hl7.org/fhir/stu3/medicationdispense.html</dd>
<dt>MedicationAdministration</dt>
<dd style="margin-left: 8">Information about medications consumption or other administration, http://www.hl7.org/fhir/stu3/medicationadministration.html</dd>
<dt>MedicationStatement</dt>
<dd style="margin-left: 8">Information about the believed state of a medication, http://www.hl7.org/fhir/stu3/medicationstatement.html</dd>
<dt>Observation</dt>
<dd style="margin-left: 8">Information about observations performed by a healthcare provider, http://www.hl7.org/fhir/stu3/observation.html</dd>
<dt>Appointment</dt>
<dd style="margin-left: 8">Information about scheduled appointments, http://www.hl7.org/fhir/stu3/appointment.html</dd>
<dt>AllergyIntolerance</dt>
<dd style="margin-left: 8">Information about allergies and drug intolerance, http://www.hl7.org/fhir/stu3/allergyintolerance.html</dd>
<dt>Condition</dt>
<dd style="margin-left: 8">Information about a patient's condition, http://www.hl7.org/fhir/stu3/condition.html</dd>
<dt>Immunization</dt>
<dd style="margin-left: 8">Information about a patient's immunizations, http://www.hl7.org/fhir/stu3/immunization.html</dd>
<dt>CarePlan</dt>
<dd style="margin-left: 8">Information about a patient's care plan, http://www.hl7.org/fhir/stu3/careplan.html</dd>
<dt>*</dt>
<dd style="margin-left: 8">Wildcard representing all available resources under the given context.</dd>
</dl>
<p id="rfc.section.2.2.p.4">A protected resource MUST document which version of FHIR applies to the resources it offers.</p>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> <a href="#Access" id="Access">Access type</a>
</h1>
<p id="rfc.section.2.3.p.1">The access type defines the kinds of actions that can be taken on a particular resource. This specification defines the following access types.</p>
<p></p>

<dl>
<dt>read</dt>
<dd style="margin-left: 8">Allows information to be read from the resource in a way that does not directly modify the resource. These interactions MAY include <samp>read</samp>, <samp>vread</samp>, <samp>history</samp>, <samp>search</samp>, and <samp>capabilities</samp> as defined at <samp>https://www.hl7.org/fhir/http.html</samp>.</dd>
<dt>write</dt>
<dd style="margin-left: 8">Allows information to be written to the resource. These interactions MAY include <samp>update</samp>, <samp>patch</samp>, <samp>delete</samp>, <samp>create</samp>, and <samp>batch/transaction</samp> as defined at <samp>https://www.hl7.org/fhir/http.html</samp>.</dd>
<dt>*</dt>
<dd style="margin-left: 8">Wildcard representing all possible actions under the given context. These interactions include those defined by the <samp>read</samp> and <samp>write</samp> scopes as well as any additional interactions supported by the resource.</dd>
</dl>
<p id="rfc.section.2.3.p.3">Extensions to this specification MAY define additional specific resource types using the registry defined in <a href="#iana" class="xref">Section 6</a>.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#ConfidentialitySensitivity" id="ConfidentialitySensitivity">Confidentiality and Sensitivity</a>
</h1>
<p id="rfc.section.3.p.1">In addition to the scopes listed above, a client MAY request and an authorization server MAY issue tokens with the following scopes indicating that the token has been authorized by the AS for accessing information of a particular confidentiality level.</p>
<p></p>

<dl>
<dt>conf/N</dt>
<dd style="margin-left: 8">Normal confidentiality</dd>
<dt>conf/R</dt>
<dd style="margin-left: 8">Restricted confidentiality</dd>
<dt>conf/V</dt>
<dd style="margin-left: 8">Very Restricted confidentiality</dd>
</dl>
<p id="rfc.section.3.p.3">An absence of a confidentiality scope makes no indication of the confidentiality of information therein.</p>
<p id="rfc.section.3.p.4">A client MAY request access to and an authorization server MAY issue tokens allowing access to data with particular sensitivities.</p>
<p></p>

<dl>
<dt>sens/ETH</dt>
<dd style="margin-left: 8">Substance abuse</dd>
<dt>sens/PSY</dt>
<dd style="margin-left: 8">Psychiatry</dd>
<dt>sens/GDIS</dt>
<dd style="margin-left: 8">Genetic disease</dd>
<dt>sens/HIV</dt>
<dd style="margin-left: 8">HIV/AIDS</dd>
<dt>sens/SCA</dt>
<dd style="margin-left: 8">Sickle cell anemia</dd>
<dt>sens/SOC</dt>
<dd style="margin-left: 8">Social services</dd>
<dt>sens/SDV</dt>
<dd style="margin-left: 8">Sexual assault, abuse, or domestic violence</dd>
<dt>sens/SEX</dt>
<dd style="margin-left: 8">Sexuality and reproductive health</dd>
<dt>sens/STD</dt>
<dd style="margin-left: 8">Sexually transmitted disease</dd>
<dt>sens/DEMO</dt>
<dd style="margin-left: 8">All demographic information</dd>
<dt>sens/DOB</dt>
<dd style="margin-left: 8">Date of birth</dd>
<dt>sens/GENDER</dt>
<dd style="margin-left: 8">Gender and sexual orientation</dd>
<dt>sens/LIVARG</dt>
<dd style="margin-left: 8">Living arrangement</dd>
<dt>sens/MARST</dt>
<dd style="margin-left: 8">Marital status</dd>
<dt>sens/RACE</dt>
<dd style="margin-left: 8">Race</dd>
<dt>sens/REL</dt>
<dd style="margin-left: 8">Religion</dd>
<dt>sens/B</dt>
<dd style="margin-left: 8">Business information</dd>
<dt>sens/EMPL</dt>
<dd style="margin-left: 8">Employer</dd>
<dt>sens/LOCIS</dt>
<dd style="margin-left: 8">Location</dd>
<dt>sens/SSP</dt>
<dd style="margin-left: 8">Sensitive service provider</dd>
<dt>sens/ADOL</dt>
<dd style="margin-left: 8">Adolescent</dd>
<dt>sens/CEL</dt>
<dd style="margin-left: 8">Celebrity</dd>
<dt>sens/DIAG</dt>
<dd style="margin-left: 8">Diagnosis</dd>
<dt>sens/DRGIS</dt>
<dd style="margin-left: 8">Drug information</dd>
<dt>sens/EMP</dt>
<dd style="margin-left: 8">Employee</dd>
</dl>
<p id="rfc.section.3.p.6">Additional sensitivity scopes MAY be defined by using codes any of the FHIR Information Sensitivity Policy labels at http://hl7.org/fhir/v3/InformationSensitivityPolicy/vs.html.</p>
<p id="rfc.section.3.p.7">This specification makes no assumptions regarding the ability of resource servers to tag and filter data. A resource server that is capable of filtering information MUST advertise this capability through the use of these scopes. Resource servers SHOULD use this access information to filter out data being returned to a client, if possible.  If an access token does not contain a given confidentiality or sensitivity marker, the resource server SHOULD assume that the client does not have access to that information and SHOULD apply appropriate filters to the data, where possible.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#break-the-glass" id="break-the-glass">Break the glass</a>
</h1>
<p id="rfc.section.4.p.1">A special scope is used to indicate that access is requested when the resource owner is unavailable. This scope is in addition to any of the resource-marked identifications above.</p>
<p></p>

<dl>
<dt>btg</dt>
<dd style="margin-left: 8">The resource is intended to be accessed when the resource owner is unavailable.</dd>
</dl>
<p id="rfc.section.4.p.3">The means by which the authorization server determines which clients are allowed access to the <samp>btg</samp> scope is outside the scope of this document.</p>
<p id="rfc.section.4.p.4">If the resource server receives a token that includes the <samp>btg</samp> scope, the resource server MUST log such access in an auditable format available to the resource owner.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Resource selection</h1>
<p id="rfc.section.5.p.1">In many OAuth transactions, the client does not need to indicate to the authorization server the protected resource that it is trying to access, as that information is discernible from the context of the scopes and the resource owner present during authorization. For example, a patient authorizing access to their own record would not need to specify which record is theirs since the resource server would presumably be able to find the record based on the identity of the resource owner. In other transactions, the resource owner will need to specify to the authorization server and resource server which protected resource is to be accessed. For example, a user with access to not only their own patient record but also that of their children would need to specify which record is to be accessed by the client.</p>
<p id="rfc.section.5.p.2">If the client knows the protected resource that it is trying to gain access to, it can indicate this protected resource to the authorization server during the request to the authorization endpoint (for the authorization code and implicit flow) or the token endpoint (for the client credentials flow) using the OPTIONAL <samp>aud</samp> (audience) or <samp>rec</samp> (records) parameters.</p>
<p></p>

<dl>
<dt>aud</dt>
<dd style="margin-left: 8">A URI string representing the resource server where the client will access records.</dd>
<dt>rec</dt>
<dd style="margin-left: 8">A URI string representing the specific patient record being accessed by the client.</dd>
</dl>
<p id="rfc.section.5.p.4">If the client does not provide a <samp>rec</samp> parameter in its request, the authorization server MUST perform one of these three actions:</p>
<p></p>

<ul>
<li>Select a default resource based on the resource owner's identity, such as selecting the resource representing the resource owner themselves. This is anticipated to be the default behavior in most cases. The authorization server SHOULD inform the user which record is being selected on an interactive authorization screen.</li>
<li>Return an <samp>invalid_request</samp> error response, indicating it was unable to determine which resource the client is requesting.</li>
<li>Allow the resource owner to interactively select or specify an appropriate resource on the authorization page.</li>
</ul>
<p id="rfc.section.5.p.6">The authorization server SHOULD either select a default resource or give the resource owner an opportunity to specify the resource if none is selected, reserving the error response for cases in which neither of these are possible.</p>
<p id="rfc.section.5.p.7">If a specific resource is selected, the authorization server MUST return an <samp>aud</samp> parameter in the token response to the client containing the audience identifier value. For example, when using the authorization code grant type the response would be as follows.</p>
<pre>HTTP/1.1 200 OK
Date: Tue, 16 Dec 2014 03:00:14 GMT
Access-Control-Allow-Origin: *
Content-Type: application/json;charset=ISO-8859-1
Connection: close

{
   "access_token": "eyJhbGciOiJSUzI1NiJ9.ew0KICAgImV4cCI6IDE0MTg3MDIzODgsDQogICAiYXpwIjo
gIjU1ZjlmNTU5LTI0OTYtNDlkNC1iNmMzLTM1MWE1ODZiNzQ4NCIsDQogICAiaXNzIjo
gImh0dHBzOi8vaWRwLXAuZXhhbXBsZS5jb20vIiwNCiAgICJqdGkiOiAiMjQwMmY4N2M
tYjZjZS00NWM0LTk1YjAtN2EzZjI5MDQ5OTdmIiwNCiAgICJpYXQiOiAxNDE4Njk4Nzg
4LA0KICAgImtpZCI6ICJyc2ExIg0KfQ.iB6Ix8Xeg-L-nMStgE1X75w7zgXabzw7znWU
ECOsXpHfnYYqb-CET9Ah5IQyXIDZ20qEyN98UydgsTpiO1YJDDcZV4f4DgY0ZdG3yBW3
XqwUQwbgF7Gwza9Z4AdhjHjzQx-lChXAyfL1xz0SBDkVbJdDjtXbvaSIyfF7ueWF3M1C
M70-GXuRY4iucKbuytz9e7eW4Egkk4Aagl3iTk9-l5V-tvL6dYu8IlR93GKsaKE8bng0
EZ04xcnq8s4V5Yykuc_NARBJENiKTJM8w3wh7xWP2gvMp39Y0XnuCOLyIx-J1ttX83xm
pXDaLyyY-4HT9XHT9V73fKF8rLWJu9grrA",
   "scope": "patient/*.* sens/ETH sens/PSY btg",
   "token_type": "Bearer",
   "aud": "https://resource.example.net/",
   "rec": "https://resource.example.net/patient/123141/"
}
</pre>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#iana" id="iana">IANA Considerations</a>
</h1>
<p id="rfc.section.6.p.1">This specification creates two registries for the values in the two of the three different components of the resource access scope.</p>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> HEART Permission Type Registry</h1>
<p id="rfc.section.6.1.p.1">This specification establishes the HEART Permission Type Registry.</p>
<p id="rfc.section.6.1.p.2">Permission types are registered by <a href="#RFC5226" class="xref">Specification Required</a> after a two-week review period on the openid-specs-heart@openid.net mailing list, on the advice of one or more Designated Experts.</p>
<p id="rfc.section.6.1.p.3">Criteria that should be applied by the Designated Experts includes determining whether the proposed registration duplicates existing functionality, whether it is likely to be of general applicability or whether it is useful only for a single application, and whether the registration description is clear.</p>
<p id="rfc.section.6.1.p.4">Registration requests sent to the mailing list for review should use an appropriate subject (e.g., "Request to register HEART Permission Type: example"). Within the review period, the Designated Expert(s) will either approve or deny the registration request, communicating this decision to the review list and IANA. Denials should include an explanation and, if applicable, suggestions as to how to make the request successful. IANA must only accept registry updates from the Designated Expert(s) and should direct all requests for registration to the review mailing list.</p>
<h1 id="rfc.section.6.1.1">
<a href="#rfc.section.6.1.1">6.1.1.</a> Registration Template</h1>
<p></p>

<dl>
<dt>Permission Type</dt>
<dd style="margin-left: 8">
<br>A string representation of the permission being registered, to be used in scope construction.</dd>
<dt>Description:</dt>
<dd style="margin-left: 8">
<br> Brief description of the permission (e.g., "Example description").</dd>
<dt>Change controller:</dt>
<dd style="margin-left: 8">
<br> For Standards Track RFCs, state "IESG". For other documents, give the name of the responsible party. Other details (e.g., postal address, email address, home page URI) may also be included.</dd>
<dt>Specification document(s):</dt>
<dd style="margin-left: 8">
<br> Reference to the document(s) that specify the token endpoint authorization method, preferably including a URI that can be used to retrieve a copy of the document(s). An indication of the relevant sections may also be included but is not required.</dd>
</dl>
<h1 id="rfc.section.6.1.2">
<a href="#rfc.section.6.1.2">6.1.2.</a> Initial Registry Contents</h1>
<p id="rfc.section.6.1.2.p.1">The HEART Permission Type Registry contains the following definitions of scope components for permission types.</p>
<p></p>

<ul>
<li>Scope Value: patient</li>
<li>Description: Access to a single patient record</li>
<li>Change Controller: OpenID Foundation (http://openid.net/)</li>
<li>Specification document(s):: [[ this document ]]</li>
</ul>

<ul>
<li>Scope Value: user</li>
<li>Description: Access to all records accessible to the current user</li>
<li>Change Controller: OpenID Foundation (http://openid.net/)</li>
<li>Specification document(s):: [[ this document ]]</li>
</ul>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> HEART Access Type Registry</h1>
<p id="rfc.section.6.2.p.1">This specification establishes the HEART Access Type Registry.</p>
<p id="rfc.section.6.2.p.2">Access types are registered by <a href="#RFC5226" class="xref">Specification Required</a> after a two-week review period on the openid-specs-heart@openid.net mailing list, on the advice of one or more Designated Experts.</p>
<p id="rfc.section.6.2.p.3">Criteria that should be applied by the Designated Experts includes determining whether the proposed registration duplicates existing functionality, whether it is likely to be of general applicability or whether it is useful only for a single application, and whether the registration description is clear.</p>
<p id="rfc.section.6.2.p.4">Registration requests sent to the mailing list for review should use an appropriate subject (e.g., "Request to register HEART Permission Type: example"). Within the review period, the Designated Expert(s) will either approve or deny the registration request, communicating this decision to the review list and IANA. Denials should include an explanation and, if applicable, suggestions as to how to make the request successful. IANA must only accept registry updates from the Designated Expert(s) and should direct all requests for registration to the review mailing list.</p>
<h1 id="rfc.section.6.2.1">
<a href="#rfc.section.6.2.1">6.2.1.</a> Registration Template</h1>
<p></p>

<dl>
<dt>Access Type</dt>
<dd style="margin-left: 8">
<br>A string representation of the access being registered, to be used in scope construction.</dd>
<dt>Description:</dt>
<dd style="margin-left: 8">
<br> Brief description of the access (e.g., "Example description").</dd>
<dt>Change controller:</dt>
<dd style="margin-left: 8">
<br> For Standards Track RFCs, state "IESG". For other documents, give the name of the responsible party. Other details (e.g., postal address, email address, home page URI) may also be included.</dd>
<dt>Specification document(s):</dt>
<dd style="margin-left: 8">
<br> Reference to the document(s) that specify the token endpoint authorization method, preferably including a URI that can be used to retrieve a copy of the document(s). An indication of the relevant sections may also be included but is not required.</dd>
</dl>
<h1 id="rfc.section.6.2.2">
<a href="#rfc.section.6.2.2">6.2.2.</a> Initial Registry Contents</h1>
<p id="rfc.section.6.2.2.p.1">The HEART Access Type Registry contains the definitions of scope components for access types.</p>
<p></p>

<ul>
<li>Scope Value: read</li>
<li>Description: Read access</li>
<li>Change Controller: OpenID Foundation (http://openid.net/)</li>
<li>Specification document(s):: [[ this document ]]</li>
</ul>

<ul>
<li>Scope Value: write</li>
<li>Description: Write access</li>
<li>Change Controller: OpenID Foundation (http://openid.net/)</li>
<li>Specification document(s):: [[ this document ]]</li>
</ul>

<ul>
<li>Scope Value: *</li>
<li>Description: All access</li>
<li>Change Controller: OpenID Foundation (http://openid.net/)</li>
<li>Specification document(s):: [[ this document ]]</li>
</ul>
<h1 id="rfc.section.6.3">
<a href="#rfc.section.6.3">6.3.</a> Additions to the OAuth Parameters Registry</h1>
<p id="rfc.section.6.3.p.1">This specification adds the following values to the OAuth Parameters Registry established by <a href="#RFC6749" class="xref">[RFC6749]</a>.</p>
<p></p>

<ul>
<li>Name: aud</li>
<li>Parameter usage location: authorization request, token request</li>
<li>Change Controller: IESG</li>
<li>Document: [[ this document ]]</li>
</ul>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> Security Considerations</h1>
<p id="rfc.section.7.p.1">Access tokens MAY have multiple scopes of potentially different types associated with them. Each additional scope is additive to the capabilities of the token. An authorization token containing multiple scopes MUST be treated as appropriate for all combinations of scopes in the token. For example, if an access token contains <samp>patient/Observation.*</samp>, <samp>patient/MedicationOrder.read</samp>, and <samp>ETH</samp>, then the <samp>ETH</samp> scope SHOULD be applied by the RS to both the <samp>patient/Observation.*</samp> and <samp>patient/MedicationOrder.read</samp> record types. Use cases requiring more fine grained access for combinations SHOULD use multiple tokens with only the appropriate rights associated with them.</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> Privacy Considerations</h1>
<p id="rfc.section.8.p.1">Resource servers should register or advertise scopes as a statement of capabilities, not as an indication of the absence or presence of particular kinds of data. This is especially pertinent with regard to the <a href="#ConfidentialitySensitivity" class="xref">confidentiality and sensitivity</a> scopes. Namely, if a resource server is associated with the <samp>sens/PSY</samp> scope, it is indicating that it has the capability to filter out psychiatry information, not that it currently holds any psychiatry information. Likewise, if a resource server is not associated with the <samp>sens/PSY</samp> scope, it is indicating that it does not have the ability to process or filter out psychiatry information, not that it contains no information that is psychiatric in nature.</p>
<h1 id="rfc.references">
<a href="#rfc.references">9.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="HEART.OAuth2">[HEART.OAuth2]</b></td>
<td class="top">
<a href="mailto:openid@justin.richer.org">Richer, J.</a>, "<a href="http://openid.net/specs/openid-heart-oauth2-1_0.html">Health Relationship Trust Profile for OAuth 2.0</a>", February 2016.</td>
</tr>
<tr>
<td class="reference"><b id="OpenID.Core">[OpenID.Core]</b></td>
<td class="top">
<a title="Nomura Research Institute, Ltd.">Sakimura, N.</a>, <a title="Ping Identity">Bradley, J.</a>, <a title="Microsoft">Jones, M.</a>, <a title="Google">de Medeiros, B.</a> and <a title="Salesforce">C. Mortimore</a>, "<a>OpenID Connect Core 1.0</a>", November 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2246">[RFC2246]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>C. Allen</a>, "<a href="https://tools.ietf.org/html/rfc2246">The TLS Protocol Version 1.0</a>", RFC 2246, DOI 10.17487/RFC2246, January 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3986">[RFC3986]</b></td>
<td class="top">
<a>Berners-Lee, T.</a>, <a>Fielding, R.</a> and <a>L. Masinter</a>, "<a href="https://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>", STD 66, RFC 3986, DOI 10.17487/RFC3986, January 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5226">[RFC5226]</b></td>
<td class="top">
<a>Narten, T.</a> and <a>H. Alvestrand</a>, "<a href="https://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>", RFC 5226, DOI 10.17487/RFC5226, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5246">[RFC5246]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="https://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, DOI 10.17487/RFC5246, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5322">[RFC5322]</b></td>
<td class="top">
<a>Resnick, P.</a>, "<a href="https://tools.ietf.org/html/rfc5322">Internet Message Format</a>", RFC 5322, DOI 10.17487/RFC5322, October 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5646">[RFC5646]</b></td>
<td class="top">
<a>Phillips, A.</a> and <a>M. Davis</a>, "<a href="https://tools.ietf.org/html/rfc5646">Tags for Identifying Languages</a>", BCP 47, RFC 5646, DOI 10.17487/RFC5646, September 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5785">[RFC5785]</b></td>
<td class="top">
<a>Nottingham, M.</a> and <a>E. Hammer-Lahav</a>, "<a href="https://tools.ietf.org/html/rfc5785">Defining Well-Known Uniform Resource Identifiers (URIs)</a>", RFC 5785, DOI 10.17487/RFC5785, April 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6125">[RFC6125]</b></td>
<td class="top">
<a>Saint-Andre, P.</a> and <a>J. Hodges</a>, "<a href="https://tools.ietf.org/html/rfc6125">Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)</a>", RFC 6125, DOI 10.17487/RFC6125, March 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6749">[RFC6749]</b></td>
<td class="top">
<a>Hardt, D.</a>, "<a href="https://tools.ietf.org/html/rfc6749">The OAuth 2.0 Authorization Framework</a>", RFC 6749, DOI 10.17487/RFC6749, October 2012.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6750">[RFC6750]</b></td>
<td class="top">
<a>Jones, M.</a> and <a>D. Hardt</a>, "<a href="https://tools.ietf.org/html/rfc6750">The OAuth 2.0 Authorization Framework: Bearer Token Usage</a>", RFC 6750, DOI 10.17487/RFC6750, October 2012.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6819">[RFC6819]</b></td>
<td class="top">
<a>Lodderstedt, T.</a>, <a>McGloin, M.</a> and <a>P. Hunt</a>, "<a href="https://tools.ietf.org/html/rfc6819">OAuth 2.0 Threat Model and Security Considerations</a>", RFC 6819, DOI 10.17487/RFC6819, January 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7033">[RFC7033]</b></td>
<td class="top">
<a>Jones, P.</a>, <a>Salgueiro, G.</a>, <a>Jones, M.</a> and <a>J. Smarr</a>, "<a href="https://tools.ietf.org/html/rfc7033">WebFinger</a>", RFC 7033, DOI 10.17487/RFC7033, September 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7517">[RFC7517]</b></td>
<td class="top">
<a>Jones, M.</a>, "<a href="https://tools.ietf.org/html/rfc7517">JSON Web Key (JWK)</a>", RFC 7517, DOI 10.17487/RFC7517, May 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7518">[RFC7518]</b></td>
<td class="top">
<a>Jones, M.</a>, "<a href="https://tools.ietf.org/html/rfc7518">JSON Web Algorithms (JWA)</a>", RFC 7518, DOI 10.17487/RFC7518, May 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7519">[RFC7519]</b></td>
<td class="top">
<a>Jones, M.</a>, <a>Bradley, J.</a> and <a>N. Sakimura</a>, "<a href="https://tools.ietf.org/html/rfc7519">JSON Web Token (JWT)</a>", RFC 7519, DOI 10.17487/RFC7519, May 2015.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.A">
<a href="#rfc.appendix.A">Appendix A.</a> <a href="#Acknowledgements" id="Acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.A.p.1">The OpenID Community would like to thank the following people for their contributions to this specification:</p>
<p id="rfc.section.A.p.2">Sarah Squire, Nancy Lush, Debbie Bucci, Eve Maler, Luis Maas, Thomas Sullivan</p>
<h1 id="rfc.appendix.B">
<a href="#rfc.appendix.B">Appendix B.</a> <a href="#ComputedScopeValues" id="ComputedScopeValues">Fully computed scope values</a>
</h1>
<p id="rfc.section.B.p.1">The resource access scopes in this specification are composed from individual components, but scopes in OAuth are treated as string by many parts of the system. Clients, authorization servers, and protected resources should not be expected to compose these strings from parts, merely be able to understand the rights associated with a given string.  Consequently, we are providing here a table of pre-computed values for all possible scope string combinations defined form the components in this document, along with their meaning.</p>
<p></p>

<dl>
<dt>patient/Patient.read</dt>
<dd style="margin-left: 8">Read access to a single patient's demographic information.</dd>
<dt>patient/Patient.write</dt>
<dd style="margin-left: 8">Read and write access to a single patient's demographic information.</dd>
<dt>patient/Patient.*</dt>
<dd style="margin-left: 8">Full access to a single patient's demographic information.</dd>
<dt>patient/MedicationRequest.read</dt>
<dd style="margin-left: 8">Read access to a single patient's requests for medications.</dd>
<dt>patient/MedicationRequest.write</dt>
<dd style="margin-left: 8">Read and write access to a single patient's requests for medications.</dd>
<dt>patient/MedicationRequest.*</dt>
<dd style="margin-left: 8">Full access to a single patient's requests for medications.</dd>
<dt>patient/MedicationDispense.read</dt>
<dd style="margin-left: 8">Read access to supply of medications to a single patient.</dd>
<dt>patient/MedicationDispense.write</dt>
<dd style="margin-left: 8">Read and write access to supply of medications to a single patient.</dd>
<dt>patient/MedicationDispense.*</dt>
<dd style="margin-left: 8">Full access to supply of medications to a single patient.</dd>
<dt>patient/MedicationAdministration.read</dt>
<dd style="margin-left: 8">Read access to a single patient's medications consumption or other administration.</dd>
<dt>patient/MedicationAdministration.write</dt>
<dd style="margin-left: 8">Read and write access to a single patient's medications consumption or other administration.</dd>
<dt>patient/MedicationAdministration.*</dt>
<dd style="margin-left: 8">Full access to a single patient's medications consumption or other administration.</dd>
<dt>patient/MedicationStatement.read</dt>
<dd style="margin-left: 8">Read access to the believed state of a medication for a single patient.</dd>
<dt>patient/MedicationStatement.write</dt>
<dd style="margin-left: 8">Read and write access to the believed state of a medication for a single patient.</dd>
<dt>patient/MedicationStatement.*</dt>
<dd style="margin-left: 8">Full access to the believed state of a medication for a single patient.</dd>
<dt>patient/Observation.read</dt>
<dd style="margin-left: 8">Read access to a single patient's observations performed by a healthcare provider.</dd>
<dt>patient/Observation.write</dt>
<dd style="margin-left: 8">Read and write access to a single patient's observations performed by a healthcare provider.</dd>
<dt>patient/Observation.*</dt>
<dd style="margin-left: 8">Full access to a single patient's observations performed by a healthcare provider.</dd>
<dt>patient/Appointment.read</dt>
<dd style="margin-left: 8">Read access to a single patient's scheduled appointments.</dd>
<dt>patient/Appointment.write</dt>
<dd style="margin-left: 8">Read and write access to a single patient's scheduled appointments.</dd>
<dt>patient/Appointment.*</dt>
<dd style="margin-left: 8">Full access to a single patient's scheduled appointments.</dd>
<dt>patient/*.read</dt>
<dd style="margin-left: 8">Read access to a single patient's complete records.</dd>
<dt>patient/*.write</dt>
<dd style="margin-left: 8">Read and write access to a single patient's complete records.</dd>
<dt>patient/*.*</dt>
<dd style="margin-left: 8">Full access to a single patient's complete records.</dd>
<dt>user/Patient.read</dt>
<dd style="margin-left: 8">Read access to all authorized demographic information.</dd>
<dt>user/Patient.write</dt>
<dd style="margin-left: 8">Read and write access to all authorized demographic information.</dd>
<dt>user/Patient.*</dt>
<dd style="margin-left: 8">Full access to all authorized demographic information.</dd>
<dt>user/MedicationRequest.read</dt>
<dd style="margin-left: 8">Read access to all authorized requests for medications.</dd>
<dt>user/MedicationRequest.write</dt>
<dd style="margin-left: 8">Read and write access to all authorized requests for medications.</dd>
<dt>user/MedicationRequest.*</dt>
<dd style="margin-left: 8">Full access to all authorized requests for medications.</dd>
<dt>user/MedicationDispense.read</dt>
<dd style="margin-left: 8">Read access to all authorized supply of medications.</dd>
<dt>user/MedicationDispense.write</dt>
<dd style="margin-left: 8">Read and write access to all authorized supply of medications.</dd>
<dt>user/MedicationDispense.*</dt>
<dd style="margin-left: 8">Full access to all authorized supply of medications.</dd>
<dt>user/MedicationAdministration.read</dt>
<dd style="margin-left: 8">Read access to all authorized medications consumption or other administration.</dd>
<dt>user/MedicationAdministration.write</dt>
<dd style="margin-left: 8">Read and write access all authorized medications consumption or other administration.</dd>
<dt>user/MedicationAdministration.*</dt>
<dd style="margin-left: 8">Full access to all authorized medications consumption or other administration.</dd>
<dt>user/MedicationStatement.read</dt>
<dd style="margin-left: 8">Read access to all authorized believed states of medication.</dd>
<dt>user/MedicationStatement.write</dt>
<dd style="margin-left: 8">Read and write access to all authorized believed states of medication.</dd>
<dt>user/MedicationStatement.*</dt>
<dd style="margin-left: 8">Full access to all authorized believed states of medication.</dd>
<dt>user/Observation.read</dt>
<dd style="margin-left: 8">Read access to all authorized observations performed by a healthcare provider.</dd>
<dt>user/Observation.write</dt>
<dd style="margin-left: 8">Read and write access to all authorized observations performed by a healthcare provider.</dd>
<dt>user/Observation.*</dt>
<dd style="margin-left: 8">Full access to all authorized observations performed by a healthcare provider.</dd>
<dt>user/Appointment.read</dt>
<dd style="margin-left: 8">Read access to all authorized scheduled appointments.</dd>
<dt>user/Appointment.write</dt>
<dd style="margin-left: 8">Read and write access to all authorized scheduled appointments.</dd>
<dt>user/Appointment.*</dt>
<dd style="margin-left: 8">Full access to all authorized scheduled appointments.</dd>
<dt>user/*.read</dt>
<dd style="margin-left: 8">Read access to all authorized complete records.</dd>
<dt>user/*.write</dt>
<dd style="margin-left: 8">Read and write access to all authorized complete records.</dd>
<dt>user/*.*</dt>
<dd style="margin-left: 8">Full access to all authorized complete records.</dd>
</dl>
<h1 id="rfc.appendix.C">
<a href="#rfc.appendix.C">Appendix C.</a> Purpose of Use</h1>
<p id="rfc.section.C.p.1">The ability to specify information be made available for a specific purpose of use is key to many different medical information use cases.  For example, a patient might determine that some things are available for research, while others are only available for treatment. At this time, these specifications do not define methods for indicating purpose of use beyond the "break the glass" mechanism defined in <a href="#break-the-glass" class="xref">Section 4</a>. The working group anticipates that expansion of this mechanism in implementations, which could lead to expansions of this protocol going forward.</p>
<h1 id="rfc.appendix.D">
<a href="#rfc.appendix.D">Appendix D.</a> <a href="#Notices" id="Notices">Notices</a>
</h1>
<p id="rfc.section.D.p.1">Copyright (c) 2017 The OpenID Foundation.</p>
<p id="rfc.section.D.p.2">The OpenID Foundation (OIDF) grants to any Contributor, developer, implementer, or other interested party a non-exclusive, royalty free, worldwide copyright license to reproduce, prepare derivative works from, distribute, perform and display, this Implementers Draft or Final Specification solely for the purposes of (i) developing specifications, and (ii) implementing Implementers Drafts and Final Specifications based on such documents, provided that attribution be made to the OIDF as the source of the material, but that such attribution does not indicate an endorsement by the OIDF.</p>
<p id="rfc.section.D.p.3">The technology described in this specification was made available from contributions from various sources, including members of the OpenID Foundation and others. Although the OpenID Foundation has taken steps to help ensure that the technology is available for distribution, it takes no position regarding the validity or scope of any intellectual property or other rights that might be claimed to pertain to the implementation or use of the technology described in this specification or the extent to which any license under such rights might or might not be available; neither does it represent that it has made any independent effort to identify any such rights. The OpenID Foundation and the contributors to this specification make no (and hereby expressly disclaim any) warranties (express, implied, or otherwise), including implied warranties of merchantability, non-infringement, fitness for a particular purpose, or title, related to this specification, and the entire risk as to implementing this specification is assumed by the implementer. The OpenID Intellectual Property Rights policy requires contributors to offer a patent promise not to assert certain patent claims against other contributors and against implementers. The OpenID Foundation invites any interested party to bring to its attention any copyrights, patents, patent applications, or other proprietary rights that may cover technology that may be required to practice this specification.</p>
<h1 id="rfc.appendix.E">
<a href="#rfc.appendix.E">Appendix E.</a> Document History</h1>
<p id="rfc.section.E.p.1">-2018-02-19</p>
<p></p>

<ul>
<li>Changed aud parameter to point to server not record</li>
<li>Added rec parameter to point to specific record</li>
</ul>
<p id="rfc.section.E.p.3">-2017-05-25</p>
<p></p>

<ul><li>Changed purpose of use examples from roles to actions</li></ul>
<p id="rfc.section.E.p.5">-2017-05-15</p>
<p></p>

<ul>
<li>Added note on purpose of use</li>
<li>Cleaned up IANA copy-paste errors</li>
</ul>
<p id="rfc.section.E.p.7">-2017-04-29</p>
<p></p>

<ul>
<li>Added FHIR resource type references</li>
<li>Clarified that FHIR is canonical for resource types</li>
<li>Explicitly defined "read" and "write" as mapped to FHIR actions</li>
</ul>
<p id="rfc.section.E.p.9">-2017-04-25</p>
<p></p>

<ul>
<li>Added additional FHIR resource types</li>
<li>Strengthened normative requirement for cross-resource scopes to be applied to all resources</li>
</ul>
<p id="rfc.section.E.p.11">-2017-04-18</p>
<p></p>

<ul>
<li>Clarified that the resource types in scopes can be any valid FHIR resource but we're using examples from STU3</li>
<li>Changed "MedicationOrder" to "MedicationRequest"</li>
<li>Removed introductory material about OAuth scopes</li>
<li>Clarified that "aud" is generally for single-patient uses</li>
<li>Added IANA registry templates</li>
</ul>
<p id="rfc.section.E.p.13">-2017-04-10</p>
<p></p>

<ul><li>Added additional sensitivity category information from http://hl7.org/fhir/v3/InformationSensitivityPolicy/vs.html</li></ul>
<p id="rfc.section.E.p.15">-2017-04-03</p>
<p></p>

<ul><li>Added clarifying information regarding sensitivity scopes.</li></ul>
<p id="rfc.section.E.p.17">-2017-03-20</p>
<p></p>

<ul><li>Added confidentiality and sensitivity scopes</li></ul>
<p id="rfc.section.E.p.19">-2017-02-27</p>
<p></p>

<ul><li>Added break the glass scope</li></ul>
<p id="rfc.section.E.p.21">-2015-09-16</p>
<p></p>

<ul><li>Created first semantic scope profile</li></ul>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Justin Richer</span> (editor)
	  <span class="n hidden">
		<span class="family-name">Richer</span>
	  </span>
	</span>
	<span class="org vcardline"></span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:openid@justin.richer.org">openid@justin.richer.org</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Josh Mandel</span> 
	  <span class="n hidden">
		<span class="family-name">Mandel</span>
	  </span>
	</span>
	<span class="org vcardline">Harvard Medical School Department of Biomedical Informatics</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:Joshua.Mandel@childrens.harvard.edu">Joshua.Mandel@childrens.harvard.edu</a></span>

  </address>
</div>

</body>
</html>

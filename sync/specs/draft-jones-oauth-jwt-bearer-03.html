<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0">
<meta name="keywords" content="OAuth, JWT, Assertion, Token, Security Token">
<meta name="generator" content="xml2rfc v1.36 (http://xml.resource.org/)">
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: small; color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: small; font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: small; font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: small; text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">M. Jones</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Microsoft</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">B. Campbell</td></tr>
<tr><td class="header">Expires: June 15, 2012</td><td class="header">Ping Identity Corp.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">C. Mortimore</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Salesforce.com</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">December 13, 2011</td></tr>
</table></td></tr></table>
<h1><br />JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0<br />draft-jones-oauth-jwt-bearer-03</h1>

<h3>Abstract</h3>

<p>This specification defines the use of a JSON Web Token (JWT) Bearer Token as means for requesting an OAuth 2.0 access
        token as well as for use as a means of client authentication.
      
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on June 15, 2012.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2011 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Notational Conventions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.2.</a>&nbsp;
Terminology<br />
<a href="#anchor4">2.</a>&nbsp;
HTTP Parameter Bindings for Transporting Assertions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.1.</a>&nbsp;
Using JWTs as Authorization Grants<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">2.2.</a>&nbsp;
Using JWTs for Client Authentication<br />
<a href="#JWT_reqs">3.</a>&nbsp;
JWT Format and Processing Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.1.</a>&nbsp;
Authorization Grant Processing<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.2.</a>&nbsp;
Client Authentication Processing<br />
<a href="#example">4.</a>&nbsp;
Authorization Grant Example<br />
<a href="#Security">5.</a>&nbsp;
Security Considerations<br />
<a href="#anchor9">6.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">6.1.</a>&nbsp;
Sub-Namespace Registration of urn:ietf:params:oauth:grant-type:jwt-bearer<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">6.2.</a>&nbsp;
Sub-Namespace Registration of urn:ietf:params:oauth:client-assertion-type:jwt-bearer<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
Informative References<br />
<a href="#anchor14">Appendix&nbsp;A.</a>&nbsp;
Acknowledgements<br />
<a href="#anchor15">Appendix&nbsp;B.</a>&nbsp;
Document History<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
	<a class='info' href='#JWT'>JSON Web Token (JWT)<span> (</span><span class='info'>Jones, M., Balfanz, D., Bradley, J., Goland, Y., Panzer, J., Sakimura, N., and P. Tarjan, &ldquo;JSON Web Token (JWT),&rdquo; December&nbsp;2011.</span><span>)</span></a> [JWT]
	is a JSON-based security token encoding that enables
	identity and security information to be shared across security
	domains.  JWTs utilize JSON data structures, as defined in
	<a class='info' href='#RFC4627'>RFC 4627<span> (</span><span class='info'>Crockford, D., &ldquo;The application/json Media Type for JavaScript Object Notation (JSON),&rdquo; July&nbsp;2006.</span><span>)</span></a> [RFC4627].
        A security token is generally issued by an identity provider
        and consumed by a relying party that relies on its content to
        identify the token's subject for security related purposes.
      
</p>
<p>
        <a class='info' href='#I-D.ietf.oauth-v2'>The OAuth 2.0 Authorization Protocol<span> (</span><span class='info'>Hammer-Lahav, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Authorization Protocol,&rdquo; September&nbsp;2011.</span><span>)</span></a> [I&#8209;D.ietf.oauth&#8209;v2]
        provides
        a method for making authenticated HTTP requests to a resource using an access token.
        Access tokens are issued to third-party clients by an
        authorization server (AS) with the (sometimes implicit) approval of the resource owner.
        In OAuth, an authorization grant is an abstract term used to describe
        intermediate credentials that represent the resource owner
        authorization.  An authorization grant is used by the client to obtain an access token.
        Several authorization grant types are defined to support a wide range
        of client types and user experiences.
        OAuth also allows for the definition of new extension grant types
        to support additional clients or to provide a bridge between OAuth and other trust frameworks.
        Finally, OAuth allows the definition of additional authentication mechanisms to be used by clients when interacting with the authorization server.
      
</p>
<p>The <a class='info' href='#I-D.ietf.oauth-assertions'>OAuth 2.0 Assertion Profile<span> (</span><span class='info'>Mortimore, C., Ed., Campbell, B., Jones, M., and Y. Goland, &ldquo;OAuth 2.0 Assertion Profile,&rdquo; October&nbsp;2011.</span><span>)</span></a> [I&#8209;D.ietf.oauth&#8209;assertions] is an abstract extension to OAuth 2.0 that provides a general
        framework for the use of Assertions (a.k.a. Security Tokens) as client credentials and/or authorization grants with OAuth 2.0.
        This specification profiles the <a class='info' href='#I-D.ietf.oauth-assertions'>OAuth 2.0 Assertion Profile<span> (</span><span class='info'>Mortimore, C., Ed., Campbell, B., Jones, M., and Y. Goland, &ldquo;OAuth 2.0 Assertion Profile,&rdquo; October&nbsp;2011.</span><span>)</span></a> [I&#8209;D.ietf.oauth&#8209;assertions] to define an extension grant type that uses a JSON Web Token (JWT) Bearer Token to
        request an OAuth 2.0 access token as well as for use as client credentials.
        The format and processing rules for the JWT defined in this specification are intentionally similar,
        though not identical, to those in the closely related
	<a class='info' href='#I-D.ietf-oauth-saml2-bearer'>SAML 2.0 Bearer Assertion Profiles for OAuth 2.0<span> (</span><span class='info'>Mortimore, C., &ldquo;SAML 2.0 Bearer Assertion Profiles for OAuth 2.0,&rdquo; October&nbsp;2011.</span><span>)</span></a> [I&#8209;D.ietf&#8209;oauth&#8209;saml2&#8209;bearer].
      
</p>
<p>This document defines how a JSON Web Token (JWT) Bearer Token can be used to request an access token when a client wishes to utilize an existing trust
        relationship, expressed through the semantics of (and digital signature calculated over) the JWT,
        without a direct user approval step at the authorization server.  It also defines how a JWT can be used as a client authentication mechanism.
        The use of a security token for client authentication is orthogonal and separable from
        using a security token as an authorization grant and the two can be used either in combination or in isolation.
      
</p>
<p>The process by which the client obtains the JWT, prior to exchanging it with the authorization server or using it for client authentication, is out of scope.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Notational Conventions</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
          "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
          document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
        
</p>
<p>
          Unless otherwise noted, all the protocol parameter names and values are case sensitive.
        
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Terminology</h3>

<p>
          All terms are as defined in
	  <a class='info' href='#I-D.ietf.oauth-v2'>The OAuth 2.0 Authorization Protocol<span> (</span><span class='info'>Hammer-Lahav, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Authorization Protocol,&rdquo; September&nbsp;2011.</span><span>)</span></a> [I&#8209;D.ietf.oauth&#8209;v2],
	  <a class='info' href='#I-D.ietf.oauth-assertions'>OAuth 2.0 Assertion Profile<span> (</span><span class='info'>Mortimore, C., Ed., Campbell, B., Jones, M., and Y. Goland, &ldquo;OAuth 2.0 Assertion Profile,&rdquo; October&nbsp;2011.</span><span>)</span></a> [I&#8209;D.ietf.oauth&#8209;assertions], and
	  <a class='info' href='#JWT'>JSON Web Token (JWT)<span> (</span><span class='info'>Jones, M., Balfanz, D., Bradley, J., Goland, Y., Panzer, J., Sakimura, N., and P. Tarjan, &ldquo;JSON Web Token (JWT),&rdquo; December&nbsp;2011.</span><span>)</span></a> [JWT].
        
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
HTTP Parameter Bindings for Transporting Assertions</h3>

<p>
	The <a class='info' href='#I-D.ietf.oauth-assertions'>OAuth 2.0 Assertion Profile<span> (</span><span class='info'>Mortimore, C., Ed., Campbell, B., Jones, M., and Y. Goland, &ldquo;OAuth 2.0 Assertion Profile,&rdquo; October&nbsp;2011.</span><span>)</span></a> [I&#8209;D.ietf.oauth&#8209;assertions] defines generic HTTP parameters for transporting Assertions (a.k.a. Security Tokens) during interactions with a token endpoint.
       This section defines the values of those parameters for use with JWT Bearer Tokens.  
      
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Using JWTs as Authorization Grants</h3>

<p>To use a JWT Bearer Token as an authorization grant, use the following parameter values and encodings.
</p>
<p>The value of "grant_type" parameter MUST be "urn:ietf:params:oauth:grant-type:jwt-bearer".
</p>
<p>
	  The value of the "assertion" parameter MUST contain a single JWT.
	
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Using JWTs for Client Authentication</h3>

<p>To use a JWT Bearer Token for client authentication grant, use the following parameter values and encodings.
</p>
<p>The value of "client_assertion_type" parameter MUST be "urn:ietf:params:oauth:client-assertion-type:jwt-bearer".
</p>
<p>
	  The value of the "client_assertion" parameter MUST contain a single JWT.
	
</p>
<a name="JWT_reqs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
JWT Format and Processing Requirements</h3>

<p>
	In order to issue an access token response as described in
	<a class='info' href='#I-D.ietf.oauth-v2'>The OAuth 2.0 Authorization Protocol<span> (</span><span class='info'>Hammer-Lahav, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Authorization Protocol,&rdquo; September&nbsp;2011.</span><span>)</span></a> [I&#8209;D.ietf.oauth&#8209;v2]
	or to rely on a JWT for client authentication,
	the authorization server MUST validate the JWT according to the criteria below.
	Application of additional restrictions and policy are at the discretion of the authorization server.
      
</p>
<p>
	</p>
<ul class="text">
<li>
	    The JWT MUST contain an <tt>iss</tt>
	    (issuer) claim that contains a unique identifier for the
	    entity that issued the JWT.
	  
</li>
<li>
	    The JWT MUST contain a <tt>prn</tt>
	    (principal) claim identifying the subject of the transaction.
	    The principal MAY identify the resource owner for
	    whom the access token is being requested.
	    For client authentication, the principal MUST be the client_id of the OAuth client.  When using
	    JWTs as an authorization grant, the principal SHOULD identify
	    an authorized accessor for whom the access token is being requested (typically the resource owner, or an authorized delegate).
	  
</li>
<li>
	    The JWT MUST contain an <tt>aud</tt>
	    (audience) claim containing a URI reference that
	    identifies the
	    authorization server, or the service provider principal entity of its controlling domain, as an
	    intended audience.  The token endpoint URL of the authorization server MAY be used as an
	    acceptable value for an <tt>aud</tt> element.
	    The authorization server MUST verify that it is an intended audience for
	    the JWT.
	  
</li>
<li>
	    The JWT MUST contain an <tt>exp</tt>
	    (expiration) claim that limits the time window during
	    which the JWT can be used.  The authorization server
	    MUST verify that the expiration time has not passed,
	    subject to allowable clock skew between systems.  The
	    authorization server MAY reject JWTs with an <tt>exp</tt> claim value that is
	    unreasonably far in the future.
	  
</li>
<li>
	    The JWT MAY contain an <tt>nbf</tt>
	    (not before) claim that identifies the time before which
	    the token MUST NOT be accepted for processing.
	  
</li>
<li>
	    The JWT MAY contain a <tt>jti</tt>
	    (JWT ID) claim that provides a unique identifier for
	    the token.
	    The authorization server MAY ensure that JWTs are not
	    replayed by maintaining the set of used
	    <tt>jti</tt> values for the length of
	    time for which the JWT would be considered valid based
	    on the applicable <tt>exp</tt> instant.
	  
</li>
<li>
	    The JWT MAY contain other claims.
	  
</li>
<li>
	    The JWT MUST be digitally signed by the issuer and the
	    authorization server MUST verify the signature.
	  
</li>
<li>
	    The authorization server MUST verify that the JWT is
	    valid in all other respects per
	    <a class='info' href='#JWT'>JSON Web Token (JWT)<span> (</span><span class='info'>Jones, M., Balfanz, D., Bradley, J., Goland, Y., Panzer, J., Sakimura, N., and P. Tarjan, &ldquo;JSON Web Token (JWT),&rdquo; December&nbsp;2011.</span><span>)</span></a> [JWT].
	  
</li>
</ul><p>
      
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Authorization Grant Processing</h3>

<p>If present, the authorization server MUST also validate the client credentials.
</p>
<p>Authorization servers SHOULD issue access tokens with a limited
	lifetime and require clients to refresh them by requesting a new
	access token using the same JWT, if it is still valid, or with a new JWT.
	The authorization server SHOULD NOT issue a refresh token.
</p>
<p>If the JWT is not valid, or the current time is not within the token's valid time window for use, the
	authorization server MUST construct an error response as defined in
	<a class='info' href='#I-D.ietf.oauth-v2'>The OAuth 2.0 Authorization Protocol<span> (</span><span class='info'>Hammer-Lahav, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Authorization Protocol,&rdquo; September&nbsp;2011.</span><span>)</span></a> [I&#8209;D.ietf.oauth&#8209;v2].
	The value of the error parameter MUST be the "invalid_grant" error code.  The authorization server
	MAY include additional information regarding the reasons the JWT was considered invalid using the
	error_description or error_uri parameters.
	
<p>For example:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store

{
 "error":"invalid_grant",
 "error_description":"Audience validation failed"
}</pre></div>
	

<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Client Authentication Processing</h3>

<p>If the client JWT is not valid, or its subject confirmation requirements cannot be met, the
	authorization server MUST construct an error response as defined in
	<a class='info' href='#I-D.ietf.oauth-v2'>The OAuth 2.0 Authorization Protocol<span> (</span><span class='info'>Hammer-Lahav, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Authorization Protocol,&rdquo; September&nbsp;2011.</span><span>)</span></a> [I&#8209;D.ietf.oauth&#8209;v2].
	The value of the error parameter MUST be the "invalid_client" error code.  The authorization server
	MAY include additional information regarding the reasons the JWT was considered invalid using the
	error_description or error_uri parameters.
	
</p>
<a name="example"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Authorization Grant Example</h3>

<p>Though non-normative, the following examples illustrate what a conforming JWT and access token request would look like.
      
</p>
<p>
	  Below is an example JSON object that could be encoded to
	  produce the JWT Claims Object for a JWT:
	
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>{"iss":"https://jwt-idp.example.com",
 "prn":"mailto:mike@example.com",
 "aud":"https://jwt-rp.example.net",
 "nbf":1300815780,
 "exp":1300819380,
 "http://claims.example.com/member":true}</pre></div>
<p>
	  The following example JSON object, used as the header of a
	  JWT, declares that the JWT is signed with the ECDSA P-256
	  SHA-256 algorithm.
	
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>{"alg":"ES256"}</pre></div>
<p>
	  To present the JWT with the claims and header shown in the previous example as part of an access token request, for example,
	  the client might make the following HTTPS request
	  (with long lines broken for display purposes only):
	
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>POST /token.oauth2 HTTP/1.1
Host: authz.example.net
Content-Type: application/x-www-form-urlencoded

grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-bearer
&amp;assertion=eyJhbGciOiJFUzI1NiJ9.
eyJpc3Mi[...omitted for brevity...].
J9l-ZhwP_2n[...omitted for brevity...]</pre></div>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Considerations</h3>

<p>
	No additional security considerations apply beyond those described within
	<a class='info' href='#I-D.ietf.oauth-v2'>The OAuth 2.0 Authorization Protocol<span> (</span><span class='info'>Hammer-Lahav, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Authorization Protocol,&rdquo; September&nbsp;2011.</span><span>)</span></a> [I&#8209;D.ietf.oauth&#8209;v2],
	<a class='info' href='#I-D.ietf.oauth-assertions'>OAuth 2.0 Assertion Profile<span> (</span><span class='info'>Mortimore, C., Ed., Campbell, B., Jones, M., and Y. Goland, &ldquo;OAuth 2.0 Assertion Profile,&rdquo; October&nbsp;2011.</span><span>)</span></a> [I&#8209;D.ietf.oauth&#8209;assertions], and
	<a class='info' href='#JWT'>JSON Web Token (JWT)<span> (</span><span class='info'>Jones, M., Balfanz, D., Bradley, J., Goland, Y., Panzer, J., Sakimura, N., and P. Tarjan, &ldquo;JSON Web Token (JWT),&rdquo; December&nbsp;2011.</span><span>)</span></a> [JWT].
      
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Sub-Namespace Registration of urn:ietf:params:oauth:grant-type:jwt-bearer</h3>

<p>
	  This is a request to IANA to please register the value grant-type:jwt-bearer in the
	  registry urn:ietf:params:oauth established in
	  <a class='info' href='#I-D.ietf.oauth-urn-sub-ns'>An IETF URN Sub-Namespace for OAuth<span> (</span><span class='info'>Campbell, B., Ed. and H. Tschofenig, &ldquo;An IETF URN Sub-Namespace for OAuth,&rdquo; Aug&nbsp;2011.</span><span>)</span></a> [I&#8209;D.ietf.oauth&#8209;urn&#8209;sub&#8209;ns].

	  </p>
<ul class="text">
<li>URN: urn:ietf:params:oauth:grant-type:jwt-bearer
</li>
<li>Common Name: JWT Bearer Token Grant Type Profile for OAuth 2.0
</li>
<li>Change controller: IETF
</li>
<li>Description: [[this document]]
</li>
</ul><p>
	
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Sub-Namespace Registration of urn:ietf:params:oauth:client-assertion-type:jwt-bearer</h3>

<p>
	  This is a request to IANA to please register the value client-assertion-type:jwt-bearer in the
	  registry urn:ietf:params:oauth established in
	  <a class='info' href='#I-D.ietf.oauth-urn-sub-ns'>An IETF URN Sub-Namespace for OAuth<span> (</span><span class='info'>Campbell, B., Ed. and H. Tschofenig, &ldquo;An IETF URN Sub-Namespace for OAuth,&rdquo; Aug&nbsp;2011.</span><span>)</span></a> [I&#8209;D.ietf.oauth&#8209;urn&#8209;sub&#8209;ns].

	  </p>
<ul class="text">
<li>URN: urn:ietf:params:oauth:client-assertion-type:jwt-bearer
</li>
<li>Common Name: JWT Bearer Token Profile for OAuth 2.0 Client Authentication 
</li>
<li>Change controller: IETF
</li>
<li>Description: [[this document]]
</li>
</ul><p>
	
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf.oauth-assertions">[I-D.ietf.oauth-assertions]</a></td>
<td class="author-text">Mortimore, C., Ed., Campbell, B., Jones, M., and Y. Goland, &ldquo;OAuth 2.0 Assertion Profile,&rdquo; ID&nbsp;draft-ietf-oauth-assertions-01 (work in progress), October&nbsp;2011 (<a href="http://tools.ietf.org/html/draft-ietf-oauth-assertions-01.txt">TXT</a>, <a href="http://tools.ietf.org/html/draft-ietf-oauth-assertions-01.html">HTML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf.oauth-urn-sub-ns">[I-D.ietf.oauth-urn-sub-ns]</a></td>
<td class="author-text">Campbell, B., Ed. and H. Tschofenig, &ldquo;An IETF URN Sub-Namespace for OAuth,&rdquo; ID&nbsp;draft-ietf-oauth-urn-sub-ns-00 (work in progress), Aug&nbsp;2011 (<a href="http://tools.ietf.org/html/draft-ietf-oauth-urn-sub-ns-00.txt">TXT</a>, <a href="http://tools.ietf.org/html/draft-ietf-oauth-urn-sub-ns-00.html">HTML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf.oauth-v2">[I-D.ietf.oauth-v2]</a></td>
<td class="author-text">Hammer-Lahav, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Authorization Protocol,&rdquo; ID&nbsp;draft-ietf-oauth-v2-22 (work in progress), September&nbsp;2011 (<a href="http://tools.ietf.org/id/draft-ietf-oauth-v2-22.txt">TXT</a>, <a href="http://tools.ietf.org/id/draft-ietf-oauth-v2-22.html">HTML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="JWT">[JWT]</a></td>
<td class="author-text"><a href="mailto:mbj@microsoft.com">Jones, M.</a>, <a href="mailto:balfanz@google.com">Balfanz, D.</a>, <a href="mailto:ve7jtb@ve7jtb.com">Bradley, J.</a>, <a href="mailto:yarong@microsoft.com">Goland, Y.</a>, <a href="mailto:jpanzer@google.com">Panzer, J.</a>, <a href="mailto:n-sakimura@nri.co.jp">Sakimura, N.</a>, and <a href="mailto:pt@fb.com">P. Tarjan</a>, &ldquo;<a href="http://tools.ietf.org/html/draft-jones-json-web-token">JSON Web Token (JWT)</a>,&rdquo; December&nbsp;2011.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4627">[RFC4627]</a></td>
<td class="author-text">Crockford, D., &ldquo;<a href="http://tools.ietf.org/html/rfc4627">The application/json Media Type for JavaScript Object Notation (JSON)</a>,&rdquo; RFC&nbsp;4627, July&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4627.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-oauth-saml2-bearer">[I-D.ietf-oauth-saml2-bearer]</a></td>
<td class="author-text">Mortimore, C., &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-oauth-saml2-bearer-09">SAML 2.0 Bearer Assertion Profiles for OAuth 2.0</a>,&rdquo; draft-ietf-oauth-saml2-bearer-09 (work in progress), October&nbsp;2011 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-oauth-saml2-bearer-09.txt">TXT</a>).</td></tr>
</table>

<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Acknowledgements</h3>

<p>
	This profile was derived from
	<a class='info' href='#I-D.ietf-oauth-saml2-bearer'>SAML 2.0 Bearer Assertion Profiles for OAuth 2.0<span> (</span><span class='info'>Mortimore, C., &ldquo;SAML 2.0 Bearer Assertion Profiles for OAuth 2.0,&rdquo; October&nbsp;2011.</span><span>)</span></a> [I&#8209;D.ietf&#8209;oauth&#8209;saml2&#8209;bearer]
	by Brian Campbell and Chuck Mortimore.
      
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Document History</h3>

<p>
	[[ to be removed by RFC editor before publication as an RFC ]]
      
</p>
<p>
	-03
	</p>
<ul class="text">
<li>
	    Added the <tt>jti</tt> (JWT ID)
	    claim to enable replay protection.
	  
</li>
<li>
	    Respect line length restrictions in examples.
	  
</li>
</ul><p>
      
</p>
<p>
	-02
	</p>
<ul class="text">
<li>
	    Removed remaining vestiges of normative text talking about
	    SAML that remained from the SAML Profile draft.
	  
</li>
<li>
	    Replaced all references where the reference is used as if
	    it were part of the sentence (such as "defined by
	    [I-D.whatever]") with ones where the specification name is
	    used, followed by the reference (such as "defined by
	    Whatever [I-D.whatever]").
	  
</li>
</ul><p>
      
</p>
<p>
	-01
	</p>
<ul class="text">
<li>
	    Merged in changes from draft-ietf-oauth-saml2-bearer-09.
	    In particular, this draft now uses
	    draft-ietf-oauth-assertions, rather than being standalone.
	    It also now defines how to use JWT bearer tokens both for
	    Authorization Grants and for Client Authentication.
	  
</li>
</ul><p>
      
</p>
<p>
	-00
	</p>
<ul class="text">
<li>
	    Initial draft.
	  
</li>
</ul><p>
      
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Michael B. Jones</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Microsoft</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mbj@microsoft.com">mbj@microsoft.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://self-issued.info/">http://self-issued.info/</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Brian Campbell</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ping Identity Corp.</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:brian.d.campbell@gmail.com">brian.d.campbell@gmail.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Chuck Mortimore</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Salesforce.com</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:cmortimore@salesforce.com">cmortimore@salesforce.com</a></td></tr>
</table>
</body></html>
